"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2714],{62714:function(e,t,a){a.r(t),a.d(t,{default:function(){return n}});a(44114),a(18111),a(22489),a(7588);var s=a(95353),r=a(41776),i=a(82997),o={components:{shopSelect:a(25159).default},data(){return{activeName:"all",loading:!1,create_time:"",params:{page:1,pageSize:20},datapass_block:1,order_status:"",time_start_begin:"",time_start_end:"",total_count:0,order_type:"service",list:[],currentShop:"",identifier:"",source_list:[],source_name:"",source_id:"",downloadView:!1,downloadUrl:"",downloadName:""}},computed:{...(0,s.L8)(["wheight"])},mounted(){this.params.order_type=this.order_type,this.getOrders(this.params),this.getAllSourcesList()},methods:{onCopy(){this.$notify({message:$t("bkv2mw4","复制成功","lang"),type:"success"})},handleClick(e,t){this.activeName=e.name,this.params.order_status="all"==e.name?"":e.name,this.params.page=1,this.getParams(),this.getOrders(this.params)},shopHandle(e){e&&e.shop_id,this.currentShop=e.shop_id,this.params.page=1,this.getParams(),this.getOrders(this.params)},TypeHandle(){this.params.page=1,this.getParams(),this.getOrders(this.params)},orderStatusSelectHandle(){this.params.order_status=this.order_status,this.params.page=1,this.getParams(),this.getOrders(this.params)},numberSearch(e){this.params.page=1,this.getParams(),this.getOrders(this.params)},dateChange(e){e.length>0?(this.time_start_begin=this.dateStrToTimeStamp(e[0]+" 00:00:00"),this.time_start_end=this.dateStrToTimeStamp(e[1]+" 23:59:59")):(this.time_start_begin="",this.time_start_end=""),this.params.page=1,this.getParams(),this.getOrders(this.params)},sourceSearch(e){this.params.source_id=e.source_id,this.params.page=1,this.getParams(),this.getOrders(this.params)},handleCurrentChange(e){this.params.page=e,this.loading=!1,this.getParams(),this.getOrders(this.params)},handleSizeChange(e){this.loading=!1,this.params.page=1,this.params.pageSize=e,this.getParams(),this.getOrders(this.params)},getParams(){this.params.time_start_begin=this.time_start_begin,this.params.time_start_end=this.time_start_end,this.params.order_type=this.order_type,"service"==this.order_type?this.params.shop_id=this.currentShop:"bargain"==this.order_type&&delete this.params.shop_id,11==this.identifier.length?this.params.mobile=this.identifier:(this.params.mobile="",this.params.order_id=this.identifier)},dateStrToTimeStamp(e){return Date.parse(new Date(e))/1e3},getOrders(e){this.loading=!0,(0,r.getOrderList)(e).then(e=>{let t=e.data.data.list;t.forEach(e=>{let t="";if(e.operator_desc){let a=e.operator_desc.split(":");t={mobile:a[0],name:a[1]},e.operator_desc=t}}),this.list=t,this.total_count=void 0===e.data.data.pager?e.data.data.total_count:Number(e.data.data.pager.count),this.datapass_block=e.data.data.datapass_block,this.loading=!1})},getAllSourcesList(){(0,i.getSourcesList)({page:1,pageSize:1e3}).then(e=>{e.data.data.list&&e.data.data.list.forEach(e=>{this.source_list.push({value:e.sourceName,source_id:e.sourceId})})})},querySearch(e,t){var a=this.source_list;t(e?a.filter(this.createFilter(e)):a)},createFilter(e){return t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},exportData(){this.getParams(),this.params.page=1,"service"==this.params.order_type?(0,r.orderExport)(this.params).then(e=>{e.data.data.status?this.$message({type:"success",message:$t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")}):e.data.data.url?(this.downloadUrl=e.data.data.url,this.downloadName=e.data.data.filename,this.downloadView=!0):this.$message({type:"error",message:$t("d17rj2j","无内容可导出 或 执行失败，请检查重试","lang")})}):this.$message({type:"error",message:$t("2miv3db","暂不支持该类型订单导出","lang")})}}},l=o,n=(0,a(81656).A)(l,function(){var e=this,t=e._self._c;return t("div",[-1===e.$route.path.indexOf("detail")?t("div",[t("el-row",{staticClass:"filter-header",attrs:{gutter:20}},[t("el-col",["distributor"!=e.$store.getters.login_type?t("shop-select",{attrs:{wxshops:""},on:{update:e.shopHandle}}):e._e(),t("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy/MM/dd",placeholder:$t("to1gvf6","选择日期范围","lang")},on:{change:e.dateChange},model:{value:e.create_time,callback:function(t){e.create_time=t},expression:"create_time"}}),t("el-input",{staticClass:"input-m",attrs:{placeholder:$t("tbbl997","手机号/订单号","lang")},model:{value:e.identifier,callback:function(t){e.identifier=t},expression:"identifier"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.numberSearch},slot:"append"})],1),t("el-select",{attrs:{placeholder:$t("x9oiau7","请选择订单类型","lang")},on:{change:e.TypeHandle},model:{value:e.order_type,callback:function(t){e.order_type=t},expression:"order_type"}},[e._l(e.orderType,function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.type}})}),t("el-option",{key:2,attrs:{label:$t("cuujtl4","拼团订单","lang"),value:"groups"}})],2),t("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:$t("2j7y8c5","请输入来源","lang")},on:{select:e.sourceSearch},model:{value:e.source_name,callback:function(t){e.source_name=t},expression:"source_name"}}),t("el-button",{attrs:{type:"primary"},on:{click:e.exportData}},[e._v($t("efepu4"," 导出 ","lang"))]),t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:$t("lntxa712","导出任务会以队列执行，点击导出后，请至‘设置-导出列表’页面中查看及下载数据","lang")}},[t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1)],1),t("el-dialog",{attrs:{title:$t("hym6114","订单下载","lang"),visible:e.downloadView,"close-on-click-modal":!1},on:{"update:visible":function(t){e.downloadView=t}}},[e.downloadUrl?[t("a",{attrs:{href:e.downloadUrl,download:""}},[e._v(e._s(e.downloadName))])]:e._e()],2),t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:$t("en402","全部","lang"),name:"all"}}),t("el-tab-pane",{attrs:{label:$t("e7hbq3","已完成","lang"),name:"done"}}),t("el-tab-pane",{attrs:{label:$t("flmib3","未支付","lang"),name:"notpay"}}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.list}},[t("el-table-column",{attrs:{"min-width":"160",label:$t("o7hv2","订单","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"order-num"},[e._v(" "+e._s(a.row.order_id)+" "),t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.order_id,expression:"scope.row.order_id",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"el-icon-document-copy"})])],1),t("div",[e._v($t("eec744"," 实付：","lang")),t("span",{staticClass:"mark"},[t("span",{staticClass:"cur"},[e._v(e._s(a.row.fee_symbol))]),e._v(e._s(a.row.total_fee/100))])]),t("div",{staticClass:"order-time"},[t("el-tooltip",{attrs:{effect:"dark",content:$t("a72nl44","下单时间","lang"),placement:"top-start"}},[t("i",{staticClass:"el-icon-time"})]),e._v(" "+e._s(e._f("datetime")(a.row.create_time,"YYYY-MM-DD HH:mm:ss"))+" ")],1)]}}],null,!1,4187675107)}),t("el-table-column",{attrs:{"min-width":"150",prop:"title",label:$t("dcfl2n4","服务商品","lang")}}),t("el-table-column",{attrs:{width:"150",label:$t("ewbd43","手机号","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("i",{staticClass:"el-icon-mobile"}),e._v(" "+e._s(a.row.mobile)+" "),0==e.datapass_block?t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.mobile,expression:"scope.row.mobile",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"el-icon-document-copy"})]):e._e()]}}],null,!1,3171601862)}),t("el-table-column",{attrs:{width:"100",prop:"order_type",label:$t("lnjk2","类型","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["groups"==a.row.order_class?t("span",[t("span",[e._v($t("cgxcqh6"," 拼团订单 ","lang"))])]):t("span",e._l(e.orderType,function(s,r){return s.type==a.row.order_type?t("span",{key:r},[e._v(" "+e._s(s.name)+" ")]):e._e()}),0)]}}],null,!1,174852864)}),t("el-table-column",{attrs:{width:"100",prop:"order_status",label:$t("hys56m4","订单状态","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["DONE"==a.row.order_status||"PAYED"==a.row.order_status?t("el-tag",{attrs:{type:"success",size:"mini"}},[e._v($t("cq1c3u5"," 已完成 ","lang"))]):"NOTPAY"==a.row.order_status?t("el-tag",{attrs:{size:"mini"}},[e._v($t("dx7srx5"," 未支付 ","lang"))]):"CLOSED"==a.row.order_status||"CANCEL"==a.row.order_status?t("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v($t("coyml85"," 已取消 ","lang"))]):"WAIT_GROUPS_SUCCESS"==a.row.order_status?t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v($t("kxnvwv8"," 等待拼团成功 ","lang"))]):"REFUND_PROCESS"==a.row.order_status?t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v($t("svi31v7"," 退款处理中 ","lang"))]):"REFUND_SUCCESS"==a.row.order_status?t("el-tag",{attrs:{type:"info",size:"mini"}},[e._v($t("nvk9cj6"," 退款成功 ","lang"))]):"REFUND_FAIL"==a.row.order_status?t("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v($t("nujfqm6"," 退款失败 ","lang"))]):e._e()]}}],null,!1,3343785339)}),t("el-table-column",{attrs:{prop:"source_name",label:$t("i6yz2","来源","lang")}}),t("el-table-column",{attrs:{prop:"operator_desc",width:"150",label:$t("97hz1c7","代客下单操作员","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.operator_desc?t("div",{},[t("div",[t("i",{staticClass:"el-icon-user"}),e._v(e._s(a.row.operator_desc.name))]),t("div",[t("i",{staticClass:"el-icon-mobile"}),e._v(" "+e._s(a.row.operator_desc.mobile)+" "),0==e.datapass_block?t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.operator_desc.mobile,expression:"scope.row.operator_desc.mobile",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"el-icon-document-copy"})]):e._e()],1)]):e._e()]}}],null,!1,3753116911)}),t("el-table-column",{attrs:{width:"90",label:$t("hkxb2","操作","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("router-link",{attrs:{to:{path:e.matchRoutePath("detail"),query:{orderId:a.row.order_id,resource:"/mall/trade/service"}}}},[e._v($t("likox4"," 详情 ","lang"))])]}}],null,!1,4064499490)})],1),t("div",{staticClass:"mt-4 text-right"},[t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.params.page,"page-sizes":[10,20,50],total:e.total_count,"page-size":e.params.pageSize},on:{"update:currentPage":function(t){return e.$set(e.params,"page",t)},"update:current-page":function(t){return e.$set(e.params,"page",t)},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1):e._e(),t("router-view")],1)},[],!1,null,null,null).exports}}]);