"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8082],{68082:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});a(44114);var s=a(95353),i=a(2212),l=a(77944),r=a(5748),o={props:["isLoad","resourceName"],data(){return{shopListData:[],shopId:"",resourceLevelList:[],levelParams:{},pageLimit:10,loading:!1,params:{shopId:"",page:1,pageSize:20},detailDialog:!1,serverproject:[],expiredAt:"",detailForm:{},nowTime:Date.parse(new Date)/1e3,total_count:""}},computed:{...(0,s.L8)(["wheight"])},watch:{isLoad(e,t){e&&(this.resourceLevelList=[],this.getStoreList(),this.shopId&&(this.params.shopId=this.shopId,this.getLevelList()))}},mounted(){this.getStoreList(),this.getLevelList()},methods:{handleCurrentChange(e){this.params.page=e,this.params.shopId=this.shopId,this.getLevelList()},addResource(){this.$router.push({path:this.matchRoutePath("editor"),query:{id:""}})},updateResource(e,t){var a;for(a in this.shopListData)if(t==this.shopListData[a].wxShopId){var s=this.shopListData[a].expiredAt;if(!s||s&&s<=this.nowTime)return void this.$message({type:"error",message:$t("fmj6uhg","该资源位不可被编辑，所属门店过期","lang")})}this.$router.push({path:this.matchRoutePath("editor"),query:{id:e}})},deleteResource(e,t){this.$confirm($t("d38xi9a","确定删除该条数据么？","lang"),$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(a,s,l)=>{if("confirm"===a){var r={resource_level_id:e,shop_id:t};(0,i.deleteResourceLevel)(r).then(e=>{e.data.data.status&&this.$message({type:"success",message:$t("azeh8z4","删除成功","lang")}),this.getLevelList()})}l()}})},getDetail(e){e&&(this.detailDialog=!0,(0,i.getResourceLevel)(e).then(e=>{this.detailForm=e.data.data;var t=e.data.data.materialIds;this.getLabelsList(t)}))},storeChange(e){this.params.shopId=e,this.params.page=1,this.getLevelList()},getLevelList(){this.loading=!0,(0,i.getListResourceLevel)(this.params).then(e=>{e.data.data.list?(this.resourceLevelList=e.data.data.list,this.total_count=e.data.data.total_count):this.resourceLevelList=[],this.loading=!1})},getStoreList(){this.storeList=[],this.loading=!0;(0,l.getWxShopsList)({page:1,pageSize:500}).then(e=>{this.shopListData=e.data.data.list,""==this.shopId&&this.shopListData[0].wxShopId&&(this.shopId=this.shopListData[0].wxShopId,this.storeChange(this.shopListData[0].wxShopId)),this.loading=!1})},getLabelsList(e){this.serverproject=[];var t={page:1,pageSize:100,service_type:"timescard"};(0,r.getServiceLabelsList)(t).then(t=>{for(var a=t.data.data.list,s=0;s<a.length;s++)for(var i=0;i<e.length;i++)a[s].labelId==e[i]&&this.serverproject.push(a[s].labelName)})},updateStatus(e,t){let a={resourceLevelId:e,status:"invalid"==t?"true":"false"},s="invalid"==t?$t("jsychx6","确定开启？？","lang"):$t("l8uqca6","确定关闭？？","lang");this.$confirm(s,$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(e,t,s)=>{"confirm"===e&&(0,i.updateResourceLevelStatus)(a).then(e=>{this.$message({type:"success",message:$t("ai8d7e4","修改成功","lang")}),this.getLevelList()}),s()}})}}},n=a(81656),d=(0,n.A)(o,function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{span:20}},[t("el-col",{attrs:{span:12}},[e._v($t("jtblg55"," 门店： ","lang")),t("el-select",{on:{change:e.storeChange},model:{value:e.shopId,callback:function(t){e.shopId=t},expression:"shopId"}},e._l(e.shopListData,function(e){return t("el-option",{key:e.wxShopId,attrs:{label:e.storeName,value:e.wxShopId}})}),1)],1),t("el-col",{staticClass:"content-right",attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.addResource}},[e._v($t("jtid3"," 添加","lang")+e._s(e.resourceName)+" ")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.resourceLevelList,height:e.wheight-170,border:""}},[t("el-table-column",{attrs:{prop:"shopName",label:$t("csd8i54","所属门店","lang")}}),t("el-table-column",{attrs:{prop:"name",label:e.resourceName+$t("eyrn2","名称","lang")}}),t("el-table-column",{attrs:{prop:"materialIds.length",label:$t("c78h155","服务项目数","lang")}}),t("el-table-column",{attrs:{prop:"materialIds.status",label:$t("c78h155","服务项目数","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["active"==a.row.status?t("el-tag",[e._v($t("cqh6m75"," 已开启 ","lang"))]):e._e(),"invalid"==a.row.status?t("el-tag",{attrs:{type:"success"}},[e._v($t("coswvo5"," 已关闭 ","lang"))]):e._e()]}}])}),t("el-table-column",{attrs:{label:$t("hkxb2","操作","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.getDetail(a.row.resourceLevelId)}}},[e._v($t("ibpi2","查看","lang"))]),e._v("   "),t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.updateResource(a.row.resourceLevelId,a.row.shopId)}}},[e._v($t("mekb2","编辑","lang"))]),e._v("   "),t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.deleteResource(a.row.resourceLevelId,a.row.shopId)}}},[e._v($t("eslg2","删除","lang"))]),e._v("   "),"active"==a.row.status?t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.updateStatus(a.row.resourceLevelId,a.row.status)}}},[e._v($t("eod62","关闭","lang"))]):e._e(),"invalid"==a.row.status?t("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.updateStatus(a.row.resourceLevelId,a.row.status)}}},[e._v($t("gmcv2","开启","lang"))]):e._e()]}}])})],1),e.total_count>e.params.pageSize?t("div",{staticClass:"mt-4 text-right"},[t("el-pagination",{attrs:{layout:"prev, pager, next","current-page":e.params.page,total:e.total_count,"page-size":e.params.pageSize},on:{"update:currentPage":function(t){return e.$set(e.params,"page",t)},"update:current-page":function(t){return e.$set(e.params,"page",t)},"current-change":e.handleCurrentChange}})],1):e._e(),t("el-dialog",{attrs:{title:$t("obrz2","详情","lang"),visible:e.detailDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.detailDialog=t}}},[t("el-form",{attrs:{"label-width":"160px"},model:{value:e.detailForm,callback:function(t){e.detailForm=t},expression:"detailForm"}},[t("el-form-item",{attrs:{label:$t("cxc6v3","名称：","lang")}},[t("span",{staticClass:"text-ellipsis",attrs:{title:e.detailForm.name}},[e._v(e._s(e.detailForm.name))])]),t("el-form-item",{attrs:{label:$t("tr8lub5","所属门店：","lang")}},[e._v(" "+e._s(e.detailForm.shopName)+" ")]),t("el-form-item",{attrs:{label:$t("c77mof5","服务项目：","lang")}},[t("el-row",e._l(e.serverproject,function(a){return t("el-col",{key:e.index,attrs:{span:6,title:a.label}},[t("span",[e._v(e._s(a))])])}),1)],1),t("el-form-item",{attrs:{label:$t("ii0j33","简介：","lang")}},[t("span",{staticClass:"text-ellipsis",attrs:{title:e.detailForm.description}},[e._v(e._s(e.detailForm.description))])]),t("el-form-item",{attrs:{label:$t("c5g84h4","展示图：","lang")}},[e.detailForm.imageUrl?t("img",{staticClass:"avatar",attrs:{src:e.detailForm.imageUrl?e.wximageurl+e.detailForm.imageUrl:""}}):t("span",[e._v($t("fclwp3","无图片","lang"))])])],1),t("div",{staticClass:"dialog-footer content-center",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailDialog=!1}}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)],1)],1)},[],!1,null,"31f0638c",null).exports,c={props:["isLoad","resourceName"],data(){return{loading:!1,shopListData:[],shopId:"",manageData:[],currWeek:"",currWeekIndex:0,weekData:[],sevenDays:{monday:{md:"",ymd:""},tuesday:{md:"",ymd:""},wednesday:{md:"",ymd:""},thursday:{md:"",ymd:""},friday:{md:"",ymd:""},saturday:{md:"",ymd:""},sunday:{md:"",ymd:""}},week:[],typeList:[],addItem:{typeName:"",beginTime:"",endTime:""},relResource:{resourceLevelId:"",dateDay:"",shiftTypeId:"",shopId:"",id:""},filterSelect:{shopId:"",dateData:""},isAdd:!1,currRowIndex:-1,currColIndex:-1,chooseItem:{},defaultDialogVisible:!1,manageDialogVisible:!1,chooseTypeDialogVisible:!1,i:-1,shopHour:"",shopName:"",expiredAt:"",nowTime:Date.parse(new Date)/1e3,params:{page:1,pageSize:20},weekdays:[{label:$t("es9k2","周一","lang"),name:"monday",value:"-1"},{label:$t("esdg2","周二","lang"),name:"tuesday",value:"-1"},{label:$t("es9t2","周三","lang"),name:"wednesday",value:"-1"},{label:$t("eu0j2","周四","lang"),name:"thursday",value:"-1"},{label:$t("esdo2","周五","lang"),name:"friday",value:"-1"},{label:$t("esxx2","周六","lang"),name:"saturday",value:"-1"},{label:$t("ewzh2","周日","lang"),name:"sunday",value:"-1"}],currYear:""}},computed:{...(0,s.L8)(["wheight"])},watch:{isLoad(e,t){e&&(this.manageData=[],this.getStoreList(),this.getEveryYearWeek())}},mounted(){this.manageData=[],this.getStoreList(),this.getEveryYearWeek()},methods:{getStoreList(){this.loading=!0;(0,l.getWxShopsList)({page:1,pageSize:500}).then(e=>{this.shopListData=e.data.data.list,""==this.shopId&&this.shopListData[0].wxShopId&&(this.shopId=this.shopListData[0].wxShopId,this.shopName=this.shopListData[0].storeName,this.shopHour=this.shopListData[0].hour,this.expiredAt=this.shopListData[0].expiredAt),this.loading=!1})},getDefaultWorkShift(){this.defaultDialogVisible=!0,(0,i.getListShiftType)().then(e=>{if(e.data.data.list){this.typeList=e.data.data.list;var t={shop_id:this.shopId};(0,i.getDefaultShift)(t).then(e=>{var t=e.data.data,a=this.weekdays;if(t.length>0)for(var s=0;s<a.length;s++)if(t[a[s].name].typeId){this.weekdays[s].value=t[a[s].name].typeId;for(var i=!1,l=0;l<this.typeList.length;l++)if(this.weekdays[s].value==this.typeList[l].typeId){i=!0;break}i||(this.weekdays[s].value="-1")}})}})},getShiftType(){this.manageDialogVisible=!0,this.getShiftTypeList()},addShiftType(){this.isAdd=!0},addDefaultShift(){var e={shop_id:this.shopId,defaultData:this.weekdays};(0,i.createDefautlShift)(e).then(e=>{e.data.data&&(this.$message({type:"success",message:$t("o9i7rd8","配置默认排班成功","lang")}),this.getDefaultWorkShift())})},saveShiftType(){""!=this.addItem.typeName?""!=this.addItem.beginTime?""!=this.addItem.endTime?((0,i.createShiftType)(this.addItem).then(e=>{e.data.data&&(this.$message({type:"success",message:$t("kuf66j8","保存排班类型成功","lang")}),this.getShiftTypeList())}),this.addItem={typeName:"",beginTime:"",endTime:""}):this.$message.error($t("yibguac","班次类型结束时间不能为空","lang")):this.$message.error($t("p3vb19c","班次类型开始时间不能为空","lang")):this.$message.error($t("6olqhja","班次类型名称不能为空","lang"))},deleteShiftType(e){(0,i.deleteShiftType)(e).then(e=>{0!=e.data.data.status?(this.$message({type:"success",message:$t("drhhsu8","删除排班类型成功","lang")}),this.getShiftType()):this.$message.error($t("2rwv488","该类型不可被删除","lang"))})},typeAdd(e,t){this.relResource.id="",this.relResource.resourceLevelId=e.resourceLevelId,this.relResource.shopId=e.shopId,this.relResource.dateDay=t,this.chooseTypeDialogVisible=!0,this.getShiftTypeList()},showTypeAdd(e,t,a){this.relResource.resourceLevelId=e.resourceLevelId,this.relResource.shopId=e.shopId,this.relResource.dateDay=t,this.relResource.id=a.id,this.chooseTypeDialogVisible=!0,this.getShiftTypeList(a.typeId)},clearCell(e,t,a){var s={id:a};(0,i.deleteWorkShift)(s).then(a=>{if(a.data.data.status)switch(this.$message({type:"success",message:$t("xwrfyi8","删除该次排班成功","lang")}),this.getWorkShiftList(this.filterSelect),t){case 0:this.manageData[e].monday=null;break;case 1:this.manageData[e].tuesday=null;break;case 2:this.manageData[e].wednesday=null;break;case 3:this.manageData[e].thursday=null;break;case 4:this.manageData[e].friday=null;break;case 5:this.manageData[e].saturday=null;break;case 6:this.manageData[e].sunday=null}})},cancel(){this.manageDialogVisible=!1,this.defaultDialogVisible=!1,this.isAdd=!1},chooseCancel(){this.i=-1,this.chooseTypeDialogVisible=!1},chooseType(e,t){this.relResource.shiftTypeId=e.typeId,this.chooseItem=e,this.i=t},saveChoose(){this.i=-1,this.relResource.shiftTypeId?(this.relResource.id?(0,i.updateWorkShift)(this.relResource).then(e=>{e.data.data&&this.$message({type:"success",message:$t("glrm527","更改该排班成功","lang")}),this.getWorkShiftList(this.filterSelect)}):(0,i.createWorkShift)(this.relResource).then(e=>{e.data.data&&this.$message({type:"success",message:$t("g5s1sm7","添加该排班成功","lang")}),this.getWorkShiftList(this.filterSelect)}),this.chooseTypeDialogVisible=!1):this.$message({type:"error",message:$t("wuapdu7","请选择排班类型","lang")})},getShiftTypeList(e){(0,i.getListShiftType)({}).then(t=>{if(t.data.data.list&&(this.typeList=t.data.data.list,""!=e))for(var a=0;a<this.typeList.length;a++)if(this.typeList[a].typeId==e){this.i=a;break}})},getWorkShiftList(e){this.loading=!0,(0,i.getListWorkShift)(e).then(e=>{this.manageData=e.data.data.resourceLevel,this.sevenDays=e.data.data.weekDay,this.total_count=e.data.data.total_count,this.loading=!1})},getEveryYearWeek(){var e={year:this.currYear};(0,i.getweekday)(e).then(e=>{if(this.weekData=e.data.data.list,this.weekData.length>0){let e=this.weekData[this.weekData.length-1].label;this.currYear=this.getTimeStr(e.split("-")[0]).split("-")[0]}""!=this.currWeek&&this.currWeek==e.data.data.week.label?this.getWorkShiftList(this.filterSelect):(this.currWeek=e.data.data.week.label,this.currWeekIndex=e.data.data.week.value,setTimeout(()=>{this.weekChange(e.data.data.week.label)},200))})},storeChange(){var e;for(e in this.filterSelect.shopId=this.shopId,this.shopListData)this.shopId==this.shopListData[e].wxShopId&&(this.shopName=this.shopListData[e].storeName,this.shopHour=this.shopListData[e].hour,this.expiredAt=this.shopListData[e].expiredAt);this.getWorkShiftList(this.filterSelect)},weekChange(e){if(this.filterSelect.dateData=e,this.shopId){this.filterSelect.shopId=this.shopId,this.getWorkShiftList(this.filterSelect);for(var t=0;t<this.weekData.length;t++)if(this.weekData[t].label==e){this.currWeekIndex=t;break}}},preWeek(){0==this.currWeekIndex?(this.currYear=Number(this.currYear)-1,this.getEveryYearWeek()):this.currWeekIndex=this.currWeekIndex-1;let e=this.weekData[this.currWeekIndex].label;this.currWeek=e,this.weekChange(e)},nextWeek(){this.currWeekIndex>=this.weekData.length-1?(this.currYear=Number(this.currYear)+1,this.getEveryYearWeek(),this.currWeekIndex=0):this.currWeekIndex=this.currWeekIndex+1;let e=this.weekData[this.currWeekIndex].label;this.currWeek=e,this.weekChange(e)},getTaskTime(e){let t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s<10?"0"+s:s;let i=t.getDate();return i=i<10?"0"+i:i,a+"-"+s+"-"+i},getTimeStr(e){return this.getTaskTime(new Date(1e3*parseInt(e)))}}},h=c,u=(0,n.A)(h,function(){var e=this,t=e._self._c;return t("div",{staticClass:"setting-manage-box"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[e._v($t("jtblg55"," 门店： ","lang")),t("el-select",{on:{change:e.storeChange},model:{value:e.shopId,callback:function(t){e.shopId=t},expression:"shopId"}},e._l(e.shopListData,function(e){return t("el-option",{key:e.wxShopId,attrs:{label:e.storeName,value:e.wxShopId}})}),1)],1),t("el-col",{staticClass:"content-right",attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.getDefaultWorkShift}},[e._v($t("hw3cfc8"," 配置默认排班 ","lang"))]),t("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.getShiftType}},[e._v($t("v2hfx38"," 管理班次类型 ","lang"))])],1)],1),t("div",{staticClass:"content-center",staticStyle:{"margin-bottom":"10px"}},[t("el-button",{attrs:{type:"default"},on:{click:e.preWeek}},[e._v($t("anriby5"," 上一周 ","lang"))]),t("el-select",{on:{change:e.weekChange},model:{value:e.currWeek,callback:function(t){e.currWeek=t},expression:"currWeek"}},e._l(e.weekData,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.label}},[e._v(" "+e._s(a.name)+" ")])}),1),t("el-button",{attrs:{type:"default"},on:{click:e.nextWeek}},[e._v($t("ans5bh5"," 下一周 ","lang"))])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.manageData,height:e.wheight-220}},[t("el-table-column",{staticClass:"content-center",attrs:{prop:"name",label:e.resourceName}}),t("el-table-column",{attrs:{label:e.sevenDays.monday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.monday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.monday.ymd,a.row.monday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.monday.typeName}},[e._v(" "+e._s(a.row.monday.typeName)+" ")]),t("div",[e._v(e._s(a.row.monday.beginTime)+"~"+e._s(a.row.monday.endTime))])]),"0"!=a.row.monday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,0,a.row.monday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.monday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])}),t("el-table-column",{attrs:{label:e.sevenDays.tuesday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.tuesday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.tuesday.ymd,a.row.tuesday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.tuesday.typeName}},[e._v(" "+e._s(a.row.tuesday.typeName)+" ")]),t("div",[e._v(e._s(a.row.tuesday.beginTime)+"~"+e._s(a.row.tuesday.endTime))])]),"0"!=a.row.tuesday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,1,a.row.tuesday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.tuesday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])}),t("el-table-column",{attrs:{label:e.sevenDays.wednesday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.wednesday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.wednesday.ymd,a.row.wednesday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.wednesday.typeName}},[e._v(" "+e._s(a.row.wednesday.typeName)+" ")]),t("div",[e._v(e._s(a.row.wednesday.beginTime)+"~"+e._s(a.row.wednesday.endTime))])]),"0"!=a.row.wednesday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,2,a.row.wednesday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.wednesday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])}),t("el-table-column",{attrs:{label:e.sevenDays.thursday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.thursday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.thursday.ymd,a.row.thursday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.thursday.typeName}},[e._v(" "+e._s(a.row.thursday.typeName)+" ")]),t("div",[e._v(e._s(a.row.thursday.beginTime)+"~"+e._s(a.row.thursday.endTime))])]),"0"!=a.row.thursday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,3,a.row.thursday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.thursday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])}),t("el-table-column",{attrs:{label:e.sevenDays.friday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.friday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.friday.ymd,a.row.friday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.friday.typeName}},[e._v(" "+e._s(a.row.friday.typeName)+" ")]),t("div",[e._v(e._s(a.row.friday.beginTime)+"~"+e._s(a.row.friday.endTime))])]),"0"!=a.row.friday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,4,a.row.friday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.friday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])}),t("el-table-column",{attrs:{label:e.sevenDays.saturday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.saturday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.saturday.ymd,a.row.saturday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.saturday.typeName}},[e._v(" "+e._s(a.row.saturday.typeName)+" ")]),t("div",[e._v(e._s(a.row.saturday.beginTime)+"~"+e._s(a.row.saturday.endTime))])]),"0"!=a.row.saturday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,5,a.row.saturday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.saturday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])}),t("el-table-column",{attrs:{label:e.sevenDays.sunday.md},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.sunday?[t("div",{staticClass:"cell-item-box"},[t("div",{staticClass:"cell-item",on:{click:function(t){return e.showTypeAdd(a.row,e.sevenDays.sunday.ymd,a.row.sunday)}}},[t("div",{staticClass:"type-name",attrs:{title:a.row.sunday.typeName}},[e._v(" "+e._s(a.row.sunday.typeName)+" ")]),t("div",[e._v(e._s(a.row.sunday.beginTime)+"~"+e._s(a.row.sunday.endTime))])]),"0"!=a.row.sunday.id?t("i",{staticClass:"el-icon-circle-close",on:{click:function(t){return e.clearCell(a.$index,6,a.row.sunday.id)}}}):e._e()])]:[t("span",{staticClass:"type-add",on:{click:function(t){return e.typeAdd(a.row,e.sevenDays.sunday.ymd)}}},[t("i",{staticClass:"el-icon-plus"})])]]}}])})],1),t("el-dialog",{attrs:{title:$t("hsd4886","配置默认排班","lang"),visible:e.defaultDialogVisible,"close-on-click-modal":!1,"before-close":e.cancel}},[t("div",{staticClass:"type-list content-center"},[t("el-alert",{attrs:{title:"",type:"warning",closable:!1}},[t("el-row",{},[t("el-col",{attrs:{span:12}},[e._v($t("fl9sq07"," 门店名称： ","lang")+e._s(e.shopName)+" ")]),t("el-col",{attrs:{span:12}},[e._v($t("8jezsr7"," 开店时间： ","lang")+e._s(e.shopHour)+" ")])],1)],1),e._l(e.weekdays,function(a){return t("el-row",{key:a.name,staticClass:"type-item"},[t("el-col",{attrs:{span:8}},[e._v(" "+e._s(a.label)+" ")]),t("el-col",{attrs:{span:16}},[t("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:$t("i96rt24","请选班次","lang"),size:"large"},model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"weekitem.value"}},e._l(e.typeList,function(a){return e.typeList?t("el-option",{key:a.typeId,attrs:{label:a.typeName,value:a.typeId}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.typeName))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(a.beginTime)+" ~ "+e._s(a.endTime))])]):t("el-option",{key:"-1",attrs:{label:$t("dz7i2","休息","lang"),value:"-1"}},[t("span",{staticStyle:{float:"left"}},[e._v($t("dz7i2","休息","lang"))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("00:00 ~ 23:59")])])}),1)],1)],1)})],2),t("div",{staticClass:"footer-dialog content-center",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",disabled:e.isAdd},on:{click:e.addDefaultShift}},[e._v($t("96hd9o8"," 添加默认排班 ","lang"))]),t("el-button",{on:{click:e.cancel}},[e._v($t("d7exy4"," 关闭 ","lang"))])],1)]),t("el-dialog",{attrs:{title:$t("42zfyj6","班次类型列表","lang"),visible:e.manageDialogVisible,"close-on-click-modal":!1,"before-close":e.cancel}},[t("div",{staticClass:"type-list content-center"},[t("el-alert",{attrs:{title:"",type:"warning",closable:!1}},[t("el-row",{},[t("el-col",{attrs:{span:12}},[e._v($t("fl9sq07"," 门店名称： ","lang")+e._s(e.shopName)+" ")]),t("el-col",{attrs:{span:12}},[e._v($t("8jezsr7"," 开店时间： ","lang")+e._s(e.shopHour)+" ")])],1)],1),e._l(e.typeList,function(a,s){return[t("el-row",{staticClass:"type-item"},[t("el-col",{attrs:{span:8}},[e._v(" "+e._s(a.typeName)+" ")]),t("el-col",{attrs:{span:12}},[e._v(" "+e._s(a.beginTime)+" ~ "+e._s(a.endTime)+" ")]),t("el-col",{attrs:{span:4}},["-1"==a.typeId?t("el-button",{attrs:{disabled:"",type:"text"},on:{click:function(t){return e.deleteShiftType(a.typeId)}}},[e._v($t("db22k4"," 删除 ","lang"))]):t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteShiftType(a.typeId)}}},[e._v($t("db22k4"," 删除 ","lang"))])],1)],1)]}),e.isAdd?t("el-row",{staticClass:"type-item"},[t("el-col",{attrs:{span:8}},[t("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:$t("42z6t56","班次类型名称","lang"),maxlength:10},model:{value:e.addItem.typeName,callback:function(t){e.$set(e.addItem,"typeName",t)},expression:"addItem.typeName"}}),e._v(" "),t("span",{staticClass:"frm-tips"},[e._v(e._s(e.addItem.typeName.length)+"/10")])],1),t("el-col",{attrs:{span:16}},[t("el-time-select",{staticStyle:{width:"120px"},attrs:{"picker-options":{start:"00:00",step:"00:15",end:"23:59"},placeholder:$t("cd0k3t4","开始时间","lang")},model:{value:e.addItem.beginTime,callback:function(t){e.$set(e.addItem,"beginTime",t)},expression:"addItem.beginTime"}}),e._v(" ~ "),t("el-time-select",{staticStyle:{width:"120px"},attrs:{"picker-options":{start:"00:00",step:"00:15",end:"23:59",minTime:e.addItem.beginTime},placeholder:$t("gfi7qi4","结束时间","lang")},model:{value:e.addItem.endTime,callback:function(t){e.$set(e.addItem,"endTime",t)},expression:"addItem.endTime"}}),e._v("    "),t("el-button",{attrs:{type:"text"},on:{click:e.saveShiftType}},[e._v($t("h2eu34"," 添加 ","lang"))])],1)],1):e._e()],2),t("div",{staticClass:"footer-dialog content-center",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",disabled:e.isAdd},on:{click:e.addShiftType}},[e._v($t("w3ncd38"," 添加班次类型 ","lang"))]),t("el-button",{on:{click:e.cancel}},[e._v($t("d7exy4"," 关闭 ","lang"))])],1)]),t("el-dialog",{attrs:{title:$t("42p41o6","班次类型选择","lang"),visible:e.chooseTypeDialogVisible,"close-on-click-modal":!1,"before-close":e.chooseCancel}},[t("div",{staticClass:"type-list type-choose-box content-center"},[t("el-alert",{attrs:{title:"",type:"warning",closable:!1}},[t("el-row",{},[t("el-col",{attrs:{span:12}},[e._v($t("fl9sq07"," 门店名称： ","lang")+e._s(e.shopName)+" ")]),t("el-col",{attrs:{span:12}},[e._v($t("8jezsr7"," 开店时间： ","lang")+e._s(e.shopHour)+" ")])],1)],1),e._l(e.typeList,function(a,s){return[t("div",{staticClass:"type-item",class:{checked:e.i==s},on:{click:function(t){return e.chooseType(a,s)}}},[t("el-row",[t("el-col",{attrs:{span:8}},[e._v(" "+e._s(a.typeName)+" ")]),t("el-col",{attrs:{span:16}},[e._v(" "+e._s(a.beginTime)+" ~ "+e._s(a.endTime)+" ")])],1)],1)]})],2),t("div",{staticClass:"footer-dialog content-center",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.chooseCancel}},[e._v($t("dd4ni4"," 取消 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveChoose}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)])],1)},[],!1,null,"317d7cf8",null).exports,p={provide(){return{refresh:this.getList}},components:{resourceList:d,workShift:u},data(){return{activeName:"settingMange",resourceName:"",shopListData:"",resouceLoad:!1,settingMangeLoad:!0}},mounted(){(0,i.getSetting)().then(e=>{e.data.data.resourceName?this.resourceName=e.data.data.resourceName:this.resourceName=$t("l84qp3","资源位","lang")})},methods:{handleClick(){"reservationModel"==this.activeName?(this.resouceLoad=!0,this.settingMangeLoad=!1):"settingMange"==this.activeName&&(this.resouceLoad=!1,this.settingMangeLoad=!0)},getList(){this.$refs.getLevelList,this.$refs.getStoreList}}},m=(0,n.A)(p,function(){var e=this,t=e._self._c;return t("div",[-1===e.$route.path.indexOf("editor")?t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:$t("d1oxgg4","排班管理","lang"),name:"settingMange"}},[t("work-shift",{attrs:{"is-load":e.settingMangeLoad,"shop-list-data":e.shopListData,"resource-name":e.resourceName}})],1),t("el-tab-pane",{attrs:{label:e.resourceName+$t("epm92","列表","lang"),name:"reservationModel"}},[t("resource-list",{ref:"resource",attrs:{"is-load":e.resouceLoad,"shop-list-data":e.shopListData,"resource-name":e.resourceName}})],1)],1):e._e(),t("router-view")],1)},[],!1,null,null,null).exports}}]);