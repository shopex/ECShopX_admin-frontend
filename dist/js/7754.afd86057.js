"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[7754],{77754:function(e,t,i){i.r(t),i.d(t,{default:function(){return r}});i(18111),i(61701);var a={inject:["refresh"],data(){const e=this.$createElement;return{articleForm:{title:"",summary:"",author:"",head_portrait:"",category_id:"",region_id:[],region_name:[],image_url:"",share_image_url:""},articleFormList:[{label:$t("ij5d2","标题","lang"),key:"title",type:"input"},{label:$t("cl7a83","副标题","lang"),key:"summary",type:"input"},{label:$t("aji9v04","作者名称","lang"),key:"author",type:"input"},{label:$t("ajixac4","作者头像","lang"),key:"head_portrait",component:({key:t},i)=>e("SpImagePicker",{model:{value:i[t],callback:e=>{this.$set(i,t,e)}}})},{label:$t("h4xfws6","文章类目选择","lang"),key:"category_id",type:"select",options:[]},{label:$t("bcrrey4","地区选择","lang"),key:"region_id",component:({key:t},i)=>e("div",{class:"flex gap-2"},[e("SpRegionSelect",{on:{change:this.handleRegionChange},style:"width: 260px;",model:{value:i[t],callback:e=>{this.$set(i,t,e)}}}),e("el-button",{attrs:{type:"default"},on:{click:this.asyncToArticleTitle}},[$t("nf05iy7","点击同步到标题","lang")])])},{label:$t("c8ctvu4","封面图片","lang"),key:"image_url",component:({key:t},i)=>e("SpImagePicker",{model:{value:i[t],callback:e=>{this.$set(i,t,e)}}}),tip:$t("jvk7goi","建议尺寸：200像素 * 200像素","lang")},{label:$t("aodz5a4","分享图片","lang"),key:"share_image_url",component:({key:t},i)=>e("SpImagePicker",{model:{value:i[t],callback:e=>{this.$set(i,t,e)}}}),tip:$t("jvk7goi","建议尺寸：200像素 * 200像素","lang")}],content:[]}},computed:{pageTitle(){return this.$route.query.id?$t("gmrqer4","编辑软文","lang"):$t("arews74","创建软文","lang")}},mounted(){this.$route.query.id&&this.getArticle(),this.$route.meta.name=this.$route.query.id?"edit":"create",this.getArticleCategory()},methods:{async getArticle(){const e=await this.$api.article.getArticleInfo(this.$route.query.id);e&&(this.articleForm={title:e.title,summary:e.summary,author:e.author,head_portrait:e.head_portrait,category_id:e.category_id,region_id:e.regions_id,region_name:e.regions,image_url:e.image_url,share_image_url:e.share_image_url},this.content=e.content)},async getArticleCategory(){const e=(await this.$api.article.getArticleCategoryList({category_type:"bring"})).map(e=>({title:e.category_name,value:e.category_id}));this.$refs.articleForm.setField(this.articleFormList,"category_id",{options:e})},asyncToArticleTitle(){const e=this.articleForm.title.replace(/^\[(.+?)\]/g,"");this.articleForm.title=`[${this.articleForm.region_name.join("")}]${e}`},handleRegionChange({region_name:e}){this.articleForm.region_name=e},async onSubmitTabList(){const e={...this.articleForm,article_type:"bring",content:this.content};this.$route.query.id?(await this.$api.article.updateArticle(this.$route.query.id,e),this.$message.success($t("axgh776","修改文章成功","lang")),this.refresh(),this.$router.go(-1)):(await this.$api.article.createArticle(e),this.$message.success($t("t3nsp96","添加文章成功","lang")),this.refresh(),this.$router.go(-1))}}},r=(0,i(81656).A)(a,function(){var e=this,t=e._self._c;return t("div",[t("SpPageHeader",{attrs:{title:e.pageTitle}}),t("div",{staticClass:"flex gap-5"},[t("div",{staticClass:"px-5"},[t("SpIphone",[t("SpDecorate",{ref:"decorateRef",attrs:{scene:"1005",title:$t("iit1a94","软文装修","lang")},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)],1),t("div",{staticClass:"flex-1"},[t("SpForm",{ref:"articleForm",attrs:{submit:"","label-width":"120px","form-list":e.articleFormList},on:{onSubmit:e.onSubmitTabList},model:{value:e.articleForm,callback:function(t){e.articleForm=t},expression:"articleForm"}})],1)])],1)},[],!1,null,"403e8ce6",null).exports}}]);