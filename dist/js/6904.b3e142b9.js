"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[6904],{76904:function(t,e,i){i.r(e),i.d(e,{default:function(){return b}});i(44114),i(18111),i(7588),i(61701);var s=i(95353),a=i(18979),r=i.n(a),l=i(87378),n=i(5134),o=i(65124),d=i(98818),c=(i(81193),i(99502)),m=i(54573),g=i(21837),h=i(5748),u=i(26456),_=i(59025),f={components:{GoodsSelect:m.default,StoreSelect:c.default,SkuSelector:g.A,imgPicker:l.default,Treeselect:r()},inject:["refresh"],data(){return{cursymbol:"￥",storeVisible:!1,relItems:[],relStores:[],setStatus:!1,form:{marketing_id:"",marketing_type:"plus_price_buy",marketing_name:"",marketing_desc:"",start_time:"",end_time:"",used_platform:0,use_bound:"1",use_shop:0,shop_ids:[],item_ids:[],item_type:"normal",valid_grade:[],condition_type:"totalfee",condition_value:[],join_limit:0,promotion_tag:$t("chvw63","加价购","lang"),canjoin_repeat:!1,item_category:[],tag_ids:[],brand_ids:[],activity_background:"",navbar_color:"",timeBackgroundColor:"",source_id:""},vipGrade:[],memberGrade:[],validGrade:[],activity_date:"",selectItemType:"normal",itemVisible:!1,setItemStatus:!1,imgDialog:!1,isGetImage:!1,isIndeterminate:!0,checkAll:!1,relGifts:[],relGiftIds:[],giftVisible:!1,purchaseRules:[{price:"",gift_item:[]}],conditionValue:[{full:""}],setGiftStatus:!1,ruleKey:0,getParams:{price:0},zdItemHidden:!1,categoryHidden:!0,categoryList:[],tagHidden:!0,tag:{list:[],form:{tag_ids:[]},currentTags:[],tags:[]},brandHidden:!0,brand:{list:[],form:{brand_ids:[]},currentBrands:[],brands:[]},ItemsList:[],invalidItemsList:[],params:{page:1,pageSize:-1,item_type:"normal",templates_id:"",keywords:"",category:0,is_warning:!1,tag_id:"",is_gift:"false",type:0,is_sku:"true",item_id:""}}},computed:{...(0,s.L8)(["login_type"])},watch:{relItems(t){},relStores(t){}},mounted(){this.fetchMainCate(),this.getAllTagLists(),this.getBrandList("",!0),this.$route.params.marketing_id&&this.getActivityDetail(this.$route.params.marketing_id),(0,d.listVipGrade)().then(t=>{null!=t&&t.data.data&&t.data.data.length>0&&(this.vipGrade=t.data.data)}),(0,o.getGradeList)().then(t=>{if(null!=t&&t.data.data&&t.data.data.length>0){var e=t.data.data;e&&(this.memberGrade=e)}})},methods:{useShopVisible(){const{marketing_id:t}=this.$route.params;return t?!(!this.IS_ADMIN()||"0"!=this.form.source_id):!!this.IS_ADMIN()},btnSaveVisible(){const{marketing_id:t}=this.$route.params;return!t||(!(!this.IS_ADMIN()||"0"!=this.form.source_id)||!(!this.IS_DISTRIBUTOR()||"0"==this.form.source_id))},addRules(){this.purchaseRules.push({price:"",gift_item:[]})},delRules(t){this.purchaseRules.splice(t,1)},relItemsClick(){this.itemVisible=!0,this.setItemStatus=!0},getItems(t){let e=[];t.forEach(t=>{e.push(t.itemId)}),this.form.item_ids=e},closeItemDialogAction(){this.itemVisible=!1},deleteItemRow:function(t){this.setItemStatus=!1,this.relItems.splice(t,1)},relStoresClick(){this.storeVisible=!0,this.setStatus=!0},chooseStoreAction(t){this.storeVisible=!1,this.form.shop_ids=[],null===t||t.length<=0||(this.relStores=t)},closeStoreDialogAction(){this.storeVisible=!1},deleteStoreRow(t){this.setStatus=!1,this.relStores.splice(t,1)},handleImgChange(){this.imgDialog=!0,this.isGetImage=!0},pickImg(t){this.form.activity_background=t.url,this.imgDialog=!1},closeImgDialog(){this.imgDialog=!1},submitActivityAction(){const t=this;if(this.activity_date.length>0&&(this.form.start_time=this.activity_date[0],this.form.end_time=this.activity_date[1]),this.conditionValue.length>0&&this.conditionValue.forEach(t=>{0!=t.full&&t.full||this.$message.error($t("18loa88","加价购条件必填!","lang"))}),this.validGrade.length>0&&(this.form.valid_grade=this.validGrade),this.form.shop_ids=[],this.relStores&&this.relStores.length>0&&this.relStores.forEach(t=>{this.form.shop_ids.push(t.distributor_id)}),this.form.item_ids&&this.form.item_ids.length<=0)return this.$message.error($t("7x440pa","参加活动的商品必填!","lang")),!1;if(this.purchaseRules.length>0){let t=[],e={},i=[];this.purchaseRules.forEach(s=>{s.price>0&&0==s.gift_item.length?this.$message.error($t("d15l73b","加价购商品至少选一件!","lang")):(s.gift_item.forEach(i=>{e={item_id:i.itemId,item_name:i.itemName,item_type:i.item_type,price:s.price,gift_num:i.gift_num,pics:i.pics,filter_ful:this.conditionValue[0].full},t.push(e)}),i.push({full:this.conditionValue[0].full,price:s.price}))}),this.form.gifts=JSON.stringify(t),this.form.condition_value=JSON.stringify(i)}this.form.marketing_id?(0,n.updateMarketingActivity)(this.form).then(e=>{if(!e.data.data.marketing_id)return this.$message.error($t("uzl20e5","保存失败!","lang")),!1;this.loading=!1,this.$message({message:$t("deua4r4","更新成功","lang"),type:"success",duration:2e3,onClose(){t.refresh(),t.$router.go(-1)}})}):(0,n.addMarketingActivity)(this.form).then(e=>{if(!e.data.data.marketing_id)return this.$message.error($t("uzl20e5","保存失败!","lang")),!1;this.loading=!1,this.$message({message:$t("e7ygyc4","添加成功","lang"),type:"success",duration:2e3,onClose(){t.refresh(),t.$router.go(-1)}})})},getActivityDetail(t){(0,n.getMarketingActivityInfo)({marketing_id:t}).then(t=>{let e=t.data.data,i={marketing_type:"plus_price_buy",promotion_tag:$t("chvw63","加价购","lang"),marketing_id:e.marketing_id,marketing_name:e.marketing_name,marketing_desc:e.marketing_desc,activity_background:e.activity_background,timeBackgroundColor:e.timeBackgroundColor,navbar_color:e.navbar_color,start_time:e.start_time,end_time:e.end_time,used_platform:e.used_platform,use_bound:e.use_bound.toString(),use_shop:e.use_shop,valid_grade:e.valid_grade,condition_type:e.condition_type,join_limit:e.join_limit,item_type:e.item_type,canjoin_repeat:e.canjoin_repeat,item_category:e.item_category,tag_ids:e.tag_ids,tag_list:e.tag_list,brand_ids:e.brand_ids,brand_list:e.brand_list,rel_brand_ids:e.rel_brand_ids,rel_category_ids:e.rel_category_ids,rel_tag_ids:e.rel_tag_ids,source_id:e.source_id};Object.assign(this.form,i),this.conditionValue=e.condition_value,this.validGrade=e.valid_grade,this.activity_date=[e.start_time,e.end_time],this.relItems=e.itemTreeLists?e.itemTreeLists:[],this.relStores=e.storeLists?e.storeLists:[],this.purchaseRules=e.giftsItemLists?e.giftsItemLists:[],this.zdItemHidden=!0,this.categoryHidden=!0,this.tagHidden=!0,this.brandHidden=!0,1==e.use_bound&&(this.zdItemHidden=!1),2==e.use_bound&&(this.categoryHidden=!1,this.generateSku()),3==e.use_bound&&(this.tagHidden=!1,this.tag.currentTags=e.tag_list||[],this.showTags(),this.generateSku()),4==e.use_bound&&(this.brandHidden=!1,this.brand.currentBrands=e.brand_list||[],this.showBrands(),this.generateSku())})},handleCancel:function(){this.$router.back(-1)},relGiftsClick(t,e){if(!this.purchaseRules[t].price)return this.$message.error($t("9zklvs7","加价金额必填!","lang")),!1;this.getParams.price=this.purchaseRules[t].price,this.ruleKey=t,this.relGiftIds=e,this.giftVisible=!0,this.setGiftStatus=!0},chooseGiftsAction(t){if(this.giftVisible=!1,null===t||t.length<=0)return;t.forEach((t,e)=>{t.gift_num=1});let e=this.ruleKey;this.purchaseRules[e].gift_item=t},closeGiftsDialogAction(){this.giftVisible=!1},deleteGiftRow:function(t,e){this.setGiftStatus=!1,this.purchaseRules[t].gift_item.splice(e,1)},itemTypeChange:function(t){this.relItems=[],this.params.main_cat_id="",this.params.tag_id="",this.params.brand_id="",this.zdItemHidden=!0,this.categoryHidden=!0,this.tagHidden=!0,this.brandHidden=!0,this.form.items=[],this.invalidItemsList=[],this.form.item_ids=[],this.form.itemTreeLists=[],this.form.item_category=[],this.form.item_category=[],this.form.tag_ids=[],this.form.brand_ids=[],this.tag.currentTags=[],"0"===t?(this.form.item_ids=[],this.form.itemTreeLists=[],this.form.item_category=[]):"1"===t?this.zdItemHidden=!1:"2"===t?(this.form.item_ids=[],this.form.itemTreeLists=[],this.categoryHidden=!1,this.form.item_category=[]):"3"===t?(this.tagHidden=!1,this.tag.currentTags=[],this.showTags()):"4"===t&&(this.brandHidden=!1,this.brand.currentBrands=[],this.showBrands())},fetchMainCate:function(){(0,h.getCategory)({is_main_category:!0,ignore_none:!0}).then(t=>{this.categoryList=(0,u.IO)(t.data.data,{id:"category_id",label:"category_name",children:"children"})})},addItemTag:function(){this.tag.currentTags=[],this.item_id.length?(this.showTags(),this.tag.form.item_ids=this.item_id):this.$message({type:"error",message:$t("eajgmxa","请选择至少一个商品!","lang")})},showTags:function(){this.tag.tags=[...this.tag.list],this.tag.tags.forEach((t,e)=>{-1!=this.tag.currentTags.findIndex(e=>e.tag_id==t.tag_id)&&this.tag.tags.splice(e,1)})},tagRemove:function(t){this.tag.tags.unshift(this.tag.currentTags[t]),this.tag.currentTags.splice(t,1),this.form.tag_ids=[];let e=[],i=[];this.tag.currentTags.forEach(t=>{this.form.tag_ids.push(t.tag_id);let s=[];this.ItemsList.forEach(e=>{-1!=e.tag_ids.indexOf(t.tag_id)&&s.push(e)}),e=s;let a=[];this.invalidItemsList.forEach(e=>{-1!=e.tag_ids.indexOf(t.tag_id)&&a.push(e)}),i=a}),this.ItemsList=e,this.invalidItemsList=i,this.getItems(this.ItemsList)},tagAdd:function(t,e){if(this.activity_date.length<=0)return this.$message({type:"error",message:$t("dvs78h8","请选择活动时间!","lang")}),!1;-1==this.tag.currentTags.findIndex(e=>e.tag_id==t.tag_id)&&(this.tag.currentTags.push(t),this.tag.tags.splice(e,1)),this.form.tag_ids=[],this.tag.currentTags.forEach(t=>{this.form.tag_ids.push(t.tag_id)}),this.params.tag_id=t.tag_id,this.getGoodsList()},getAllTagLists:function(){(0,h.getTagList)({page:1,pageSize:500}).then(t=>{this.tag.list=t.data.data.list})},getBrandList:function(t="",e=!1){const i=[];(0,h.getGoodsAttr)({page:1,pageSize:1e3,attribute_type:"brand",attribute_name:t,attribute_ids:e?this.form.brand_id:""}).then(t=>{for(let e of t.data.data.list)i.push({attribute_name:e.attribute_name,attribute_id:e.attribute_id});this.brand.list=i})},showBrands:function(){this.brand.brands=[...this.brand.list],this.brand.brands.forEach((t,e)=>{-1!=this.brand.currentBrands.findIndex(e=>e.attribute_id==t.attribute_id)&&this.brand.brands.splice(e,1)})},brandAdd:function(t,e){if(this.activity_date.length<=0)return this.$message({type:"error",message:$t("dvs78h8","请选择活动时间!","lang")}),!1;-1==this.brand.currentBrands.findIndex(e=>e.attribute_id==t.attribute_id)&&(this.brand.currentBrands.push(t),this.brand.brands.splice(e,1)),this.form.brand_ids=[],this.brand.currentBrands.forEach(t=>{this.form.brand_ids.push(t.attribute_id)}),this.params.brand_id=t.attribute_id,this.getGoodsList()},brandRemove:function(t){let e=[];this.ItemsList.forEach(i=>{this.brand.currentBrands[t].attribute_id!=i.brand_id&&e.push(i)});let i=[];this.invalidItemsList.forEach(e=>{this.brand.currentBrands[t].attribute_id!=e.brand_id&&i.push(e)}),this.invalidItemsList=i,this.ItemsList=e,this.getItems(this.ItemsList),this.brand.brands.unshift(this.brand.currentBrands[t]),this.brand.currentBrands.splice(t,1),this.form.brand_ids=[],this.brand.currentBrands.forEach(t=>{this.form.brand_ids.push(t.attribute_id)})},getGoodsList:function(){let t=JSON.parse(JSON.stringify(this.params));this.$route.params.marketing_id&&(t.activity_id=this.$route.params.marketing_id),t.marketing_type=this.form.marketing_type,t.activity_release_time=t.activity_start_time=this.activity_date[0],t.activity_end_time=this.activity_date[1],"all"==t.is_gift&&this.$delete(t,"is_gift"),(0,n.seckillActivityGetItemsList)(t).then(t=>{let e=t.data.data.list.validItems.concat(this.ItemsList),i=t.data.data.list.invalidItems.concat(this.invalidItemsList),s=[],a=[],r={},l={};e.forEach(t=>{let e=[];t.tagList.forEach(t=>{e.push(t.tag_id)}),t.tag_ids=e,r[t.item_id]||(s.push(t),r[t.item_id]=!0)}),i.forEach(t=>{let e=[];t.tagList.forEach(t=>{e.push(t.tag_id)}),t.tag_ids=e,l[t.item_id]||(a.push(t),l[t.item_id]=!0)}),this.ItemsList=s,this.invalidItemsList=a,this.getItems(this.ItemsList)})},categoryOpen(){this.activity_date.length<=0&&this.$message({type:"error",message:$t("dvs78h8","请选择活动时间!","lang")})},categorySelect:function(t,e){this.params.main_cat_id=t.category_id,this.getGoodsList()},categoryDeselect:function(t,e){let i;i=[],this.ItemsList.forEach((e,s)=>{t.category_id!=e.item_main_cat_id&&i.push(e)});let s=[];this.invalidItemsList.forEach(e=>{t.category_id!=e.item_main_cat_id&&s.push(e)}),this.invalidItemsList=s,this.ItemsList=i,this.getItems(this.ItemsList)},generateSku(){let t;t=[];let e=[],i=JSON.parse(JSON.stringify(this.relItems));if(i.forEach(e=>{e.nospec||0!==e.spec_items.length||t.push(e.default_item_id)}),t.length>0){this.params.item_id=t,(0,h.getItemsList)(this.params).then(t=>{i.forEach(e=>{e.nospec||t.data.data.list.forEach(t=>{e.item_id===t.default_item_id&&e.spec_items.push(t)})}),i.forEach(t=>{e=t.nospec?[...e,t]:[...e,...t.spec_items]}),this.ItemsList=e,this.getItems(e)})}else i.forEach(t=>{e=t.nospec?[...e,t]:[...e,...t.spec_items]}),this.ItemsList=e,this.getItems(e)},uploadHandleTemplate(){let t={file_type:"marketing_goods",file_name:$t("b44ik94","商品模板","lang")};(0,_.exportUploadTemplate)(t).then(t=>{let{data:e}=t.data;if(e.file){var i=document.createElement("a");i.href=e.file,i.download=e.name,document.body.appendChild(i),i.click(),i.remove()}else this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})})},uploadHandleChange(t,e){let i={isUploadFile:!0,file_type:"marketing_goods",file:t.raw};(0,_.handleUploadFile)(i).then(t=>{this.$message({type:"success",message:$t("a6esth4","上传成功","lang")});let{data:e}=t.data;if(e.fail.length>0){let t=e.fail.map(t=>t.item_bn);setTimeout(()=>{this.$message({showClose:!0,message:`${$t("ojz3zza","以下商品编号不存在：","lang")}${t}`,type:"error",duration:5e3})},1500)}if(e.succ.length<=0)return;this.relItems=e.succ;let i=[];e.succ.forEach(t=>{t.nospec?i.push(t):i.push(Object.assign(t,{spec_items:[]}))})})}}},p=(0,i(81656).A)(f,function(){var t=this,e=t._self._c;return e("div",{staticClass:"section section-white pluspricebuyAdd"},[e("el-form",{ref:"form",staticClass:"box-set",attrs:{model:t.form,"label-width":"120px"}},[e("div",{staticClass:"section-header with-border"},[e("div",[t._v($t("7tp7dea","添加/编辑加价购促销","lang"))])]),e("div",{staticClass:"form-wrapper clearfix"},[e("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:$t("eyrn2","名称","lang"),prop:"marketing_name",rules:{required:!0,message:$t("750pjq6","活动名称必填","lang"),trigger:"blur"}}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{maxlength:30,placeholder:$t("nm4xng6","最多30个字","lang")},model:{value:t.form.marketing_name,callback:function(e){t.$set(t.form,"marketing_name",e)},expression:"form.marketing_name"}})],1)],1),e("el-form-item",{attrs:{label:$t("fl3fk3","有效期","lang")}},[e("el-col",{attrs:{span:20}},[e("el-date-picker",{attrs:{type:"datetimerange","range-separator":$t("po31","至","lang"),"start-placeholder":$t("f753lz4","生效时间","lang"),"end-placeholder":$t("ikg3cm4","过期时间","lang"),"value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:t.activity_date,callback:function(e){t.activity_date=e},expression:"activity_date"}})],1)],1),e("el-form-item",{attrs:{label:$t("gdnois4","绑定商品","lang")}},[e("el-radio-group",{on:{change:t.itemTypeChange},model:{value:t.form.use_bound,callback:function(e){t.$set(t.form,"use_bound",e)},expression:"form.use_bound"}},[e("el-radio",{attrs:{label:"1"}},[t._v($t("qgq7c78"," 指定商品可用 ","lang"))]),e("el-radio",{attrs:{label:"2"}},[t._v($t("xx0gpa8"," 指定分类适用 ","lang"))]),e("el-radio",{attrs:{label:"3"}},[t._v($t("5ghnxxa"," 指定商品标签适用 ","lang"))]),e("el-radio",{attrs:{label:"4"}},[t._v($t("oiwwqs8"," 指定品牌适用 ","lang"))])],1),t.zdItemHidden?t._e():e("el-col",{attrs:{span:23}},[e("SkuSelector",{attrs:{data:t.relItems},on:{change:t.getItems}}),e("div",{staticStyle:{position:"absolute",bottom:"0px",left:"112px"}},[e("el-upload",{staticStyle:{display:"inline-block",height:"0"},attrs:{action:"","on-change":t.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}},[e("el-button",{attrs:{type:"primary"}},[t._v($t("7afr9o6"," 批量上传 ","lang"))])],1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.uploadHandleTemplate()}}},[t._v($t("gbapcg6"," 下载模板 ","lang"))])],1)],1),e("el-col",{attrs:{xs:12,sm:12,md:24}},[t.categoryHidden?t._e():e("div",[e("treeselect",{staticStyle:{width:"500px"},attrs:{options:t.categoryList,"show-count":!0,multiple:!0,"disable-branch-nodes":!0,clearable:!1},on:{open:t.categoryOpen,select:t.categorySelect,deselect:t.categoryDeselect},model:{value:t.form.item_category,callback:function(e){t.$set(t.form,"item_category",e)},expression:"form.item_category"}})],1)]),t.tagHidden?t._e():[e("div",{staticClass:"selected-tags view-flex"},[e("div",{staticClass:"label"},[t._v($t("rbsw8d6","已选中标签：","lang"))]),e("div",{staticClass:"view-flex-item"},t._l(t.tag.currentTags,function(i,s){return e("el-tag",{key:s,attrs:{closable:"",size:"small","disable-transitions":!1},on:{close:function(e){return t.tagRemove(s)}}},[t._v(" "+t._s(i.tag_name)+" ")])}),1)]),e("div",t._l(t.tag.tags,function(i,s){return e("el-tag",{key:s,staticClass:"tag-item",attrs:{size:"medium",color:"#ffffff","disable-transitions":!1},nativeOn:{click:function(e){return t.tagAdd(i,s)}}},[t._v(" "+t._s(i.tag_name)+" ")])}),1)],t.brandHidden?t._e():[e("div",{staticClass:"selected-tags view-flex"},[e("div",{staticClass:"label"},[t._v($t("r8xpax6","已选中品牌：","lang"))]),e("div",{staticClass:"view-flex-item"},t._l(t.brand.currentBrands,function(i,s){return e("el-tag",{key:s,attrs:{closable:"",size:"small","disable-transitions":!1},on:{close:function(e){return t.brandRemove(s)}}},[t._v(" "+t._s(i.attribute_name)+" ")])}),1)]),e("div",t._l(t.brand.brands,function(i,s){return e("el-tag",{key:s,staticClass:"tag-item",attrs:{size:"medium",color:"#ffffff","disable-transitions":!1},nativeOn:{click:function(e){return t.brandAdd(i,s)}}},[t._v(" "+t._s(i.attribute_name)+" ")])}),1)]],2),t.useShopVisible()?e("el-form-item",{attrs:{label:$t("cvj5km4","指定店铺","lang")}},[e("el-radio",{attrs:{label:0},model:{value:t.form.use_shop,callback:function(e){t.$set(t.form,"use_shop",e)},expression:"form.use_shop"}},[t._v($t("acj85n6"," 全场可用 ","lang"))]),t.VERSION_PLATFORM()?t._e():e("el-radio",{attrs:{label:1},model:{value:t.form.use_shop,callback:function(e){t.$set(t.form,"use_shop",e)},expression:"form.use_shop"}},[t._v($t("i293698"," 指定店铺可用 ","lang"))]),1==t.form.use_shop?e("el-col",{attrs:{span:23}},[e("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",size:"mini",round:""},on:{click:t.relStoresClick}},[t._v($t("j25ub85"," 选店铺 ","lang"))]),t.relStores.length>0?e("el-table",{staticStyle:{"line-height":"normal"},attrs:{data:t.relStores}},[e("el-table-column",{attrs:{label:"ID",prop:"distributor_id",width:"60"}}),e("el-table-column",{attrs:{label:$t("eyrn2","名称","lang"),prop:"name"}}),e("el-table-column",{attrs:{prop:"address",label:$t("fb4g2","地址","lang"),"show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"50"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"iconfont icon-trash-alt",on:{click:function(e){return t.deleteStoreRow(i.$index,t.form.items)}}})]}}],null,!1,3604158687)})],1):t._e()],1):t._e()],1):t._e(),e("el-form-item",{attrs:{label:$t("aonl824","促销规则","lang")}},[e("el-row",{attrs:{gutter:1}},[e("el-col",{attrs:{span:7}},[e("el-radio",{attrs:{label:"quantity"},model:{value:t.form.condition_type,callback:function(e){t.$set(t.form,"condition_type",e)},expression:"form.condition_type"}},[t._v($t("5z3wbd8"," 按订单总件数 ","lang"))]),e("el-radio",{attrs:{label:"totalfee"},model:{value:t.form.condition_type,callback:function(e){t.$set(t.form,"condition_type",e)},expression:"form.condition_type"}},[t._v($t("5p2nyj8"," 按订单总金额 ","lang"))])],1),e("el-col",{attrs:{span:6}},[t._l(t.conditionValue,function(i,s){return"totalfee"==t.form.condition_type?e("span",{key:s},[t._v($t("eejr2o4","消费满 ","lang")),e("el-input",{staticStyle:{width:"100px"},attrs:{type:"input",placeholder:"0.00",size:"mini"},model:{value:i.full,callback:function(e){t.$set(i,"full",e)},expression:"item.full"}}),t._v($t("a8s1xp6"," 元，加价购","lang"))],1):t._e()}),t._l(t.conditionValue,function(i,s){return"quantity"==t.form.condition_type?e("span",{key:s},[t._v($t("eejr2o4","消费满 ","lang")),e("el-input",{staticStyle:{width:"100px"},attrs:{type:"input",placeholder:"0",size:"mini"},model:{value:i.full,callback:function(e){t.$set(i,"full",e)},expression:"item.full"}}),t._v($t("18x8g06"," 件，加价购","lang"))],1):t._e()})],2)],1),e("div",t._l(t.purchaseRules,function(i,s){return e("div",{key:s},[e("el-row",[e("el-col",{attrs:{span:5}},[t._v($t("f2sriw7"," 加价购金额：","lang")),e("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:i.price,callback:function(e){t.$set(i,"price",e)},expression:"item.price"}})],1),e("el-col",{attrs:{span:15}},[e("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",size:"mini",round:""},on:{click:function(e){return t.relGiftsClick(s,i.gift_item)}}},[t._v($t("j0hsjg5"," 选商品 ","lang"))]),e("el-table",{staticStyle:{"line-height":"normal"},attrs:{data:i.gift_item,width:"20%"}},[e("el-table-column",{attrs:{label:"ID",prop:"item_id",width:"60"}}),e("el-table-column",{attrs:{label:$t("eyrn2","名称","lang"),prop:"item_name"}}),e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc"}}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"iconfont icon-trash-alt",on:{click:function(e){return t.deleteGiftRow(s,i.$index)}}})]}}],null,!0)})],1)],1),e("el-col",{attrs:{span:2}},[s>0?e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.delRules(s)}}}):t._e()],1)],1),e("div")],1)}),0)],1),e("el-form-item",{staticStyle:{flex:"2"},attrs:{label:$t("ld38zb5","导航栏颜色","lang")}},[e("el-color-picker",{model:{value:t.form.navbar_color,callback:function(e){t.$set(t.form,"navbar_color",e)},expression:"form.navbar_color"}})],1),e("el-form-item",{staticStyle:{flex:"2"},attrs:{label:$t("yvd0oo6","倒计时背景色","lang")}},[e("el-color-picker",{model:{value:t.form.timeBackgroundColor,callback:function(e){t.$set(t.form,"timeBackgroundColor",e)},expression:"form.timeBackgroundColor"}})],1),e("el-form-item",{attrs:{label:$t("bv6sem5","活动背景图","lang"),prop:"activity_background"}},[e("p",{staticClass:"frm-tips"},[t._v($t("afg3x8k","点击图片可更换，图片大小不能超过 2MB","lang"))]),e("div",[e("div",{staticClass:"upload-box",on:{click:t.handleImgChange}},[t.form.activity_background?e("img",{staticClass:"avatar",attrs:{src:t.wximageurl+t.form.activity_background}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])]),e("imgPicker",{attrs:{"dialog-visible":t.imgDialog,"sc-status":t.isGetImage},on:{chooseImg:t.pickImg,closeImgDialog:t.closeImgDialog}})],1),e("el-form-item",{attrs:{label:$t("hq25cm4","规则描述","lang")}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:$t("hq25cm4","规则描述","lang")},model:{value:t.form.marketing_desc,callback:function(e){t.$set(t.form,"marketing_desc",e)},expression:"form.marketing_desc"}})],1)],1),e("el-form-item",{attrs:{label:$t("g2vel25","可参与次数","lang")}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{type:"input",placeholder:$t("d80e3n4","整数数字","lang")},model:{value:t.form.join_limit,callback:function(e){t.$set(t.form,"join_limit",e)},expression:"form.join_limit"}})],1)],1),e("el-form-item",{attrs:{label:$t("infiw44","适用会员","lang")}},[e("el-checkbox-group",{model:{value:t.validGrade,callback:function(e){t.validGrade=e},expression:"validGrade"}},[t._l(t.memberGrade,function(i){return e("el-checkbox",{key:i.grade_id,attrs:{label:i.grade_id}},[t._v(" "+t._s(i.grade_name)+" ")])}),t._l(t.vipGrade,function(i){return e("el-checkbox",{key:i.vip_grade_id,attrs:{label:i.lv_type}},[t._v($t("euf53"," 付费","lang")+t._s(i.grade_name)+" ")])})],2)],1),e("div",[t.btnSaveVisible()?e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitActivityAction()}}},[t._v($t("cp35x4"," 保存 ","lang"))]):t._e(),e("el-button",{nativeOn:{click:function(e){return t.handleCancel.apply(null,arguments)}}},[t._v($t("m1m0m4"," 返回 ","lang"))])],1)],1)]),e("GoodsSelect",{attrs:{"items-visible":t.giftVisible,"get-status":t.setGiftStatus,"get-params":t.getParams,"rel-items-ids":t.relGiftIds,"is-spec":"","item-type":t.form.item_type},on:{chooseStore:t.chooseGiftsAction,closeStoreDialog:t.closeGiftsDialogAction}}),e("StoreSelect",{attrs:{"store-visible":t.storeVisible,"is-valid":!0,"rel-shop-ids":t.relStores,"get-status":t.setStatus},on:{chooseStore:t.chooseStoreAction,closeStoreDialog:t.closeStoreDialogAction}})],1)},[],!1,null,null,null),b=p.exports}}]);