"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2976],{12976:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});a(44114);var i=a(33318),r=a(17659),n=a(22541),s=a(26456),o=a(95093),l=a.n(o),m={name:"",data(){return{queryForm:{name:"",display_time_begin:"",datetime:[],enterprise_id:[],activityState:"all",distributor_id:""},defaultTime:["00:00:00","23:59:59"],pickerOptions:i.Dv,enterpriseList:[],activityStatus:[{title:$t("en402","全部","lang"),value:"all"},{title:$t("fkmt13","未开始","lang"),value:"not_started"},{title:$t("mvujo3","预热中","lang"),value:"warm_up"},{title:$t("lq5q43","进行中","lang"),value:"ongoing"},{title:$t("e98y43","已暂停","lang"),value:"pending"},{title:$t("e68dg3","已取消","lang"),value:"cancel"},{title:$t("edie63","已结束","lang"),value:"over"}],setting:(0,n.createSetting)({actions:[{name:$t("mekb2","编辑","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>"cancel"!=t.status&&"over"!=t.status&&!(this.IS_ADMIN()&&"0"!=t.distributor_id),action:{handler:async([t])=>{this.$router.push({path:this.matchRoutePath("create/")+t.id})}}},{name:$t("ibpi2","查看","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>"cancel"==t.status||"over"==t.status,action:{handler:async([t])=>{this.$router.push({path:this.matchRoutePath("create/")+t.id})}}},{name:$t("eywr2","商品","lang"),key:"modify",type:"button",buttonType:"text",action:{handler:async([t])=>{this.$router.push({path:this.matchRoutePath("goods/")+`${t.id}?distributor_id=${t.distributor_id}`})}}},{name:$t("aa3cpj4","亲友数据","lang"),key:"modify",type:"button",buttonType:"text",action:{handler:async([t])=>{this.$router.push({path:this.matchRoutePath("dependents/")+t.id})}}},{name:$t("e4r43k4","活动订单","lang"),key:"modify",type:"button",buttonType:"text",action:{handler:async([t])=>{this.$router.push({path:`${(0,s.JR)()?"/shopadmin":""}/applications/enterprise-purchase/activity-order?activity_id=${t.id}`})}}},{name:$t("ev022","取消","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>"not_started"==t.status,action:{handler:async([t])=>{await this.$confirm(`${$t("8db9vt5","确认取消？","lang")}`,$t("hn562","提示","lang")),await this.$api.marketing.cancelPurchaseActivity(t.id),this.$refs.finder.refresh()}}},{name:$t("cxq77s4","提前开始","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>"warm_up"==t.status,action:{handler:async([t])=>{await this.$confirm(`${$t("8brria5","确认开始？","lang")}`,$t("hn562","提示","lang")),await this.$api.marketing.aheadPurchaseActivity(t.id),this.$refs.finder.refresh()}}},{name:$t("gngr2","开始","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>"pending"==t.status,action:{handler:async([t])=>{await this.$confirm(`${$t("8brria5","确认开始？","lang")}`,$t("hn562","提示","lang")),await this.$api.marketing.activePurchaseActivity(t.id),this.$refs.finder.refresh()}}},{name:$t("hvkq2","暂停","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>"ongoing"==t.status&&!(this.IS_ADMIN()&&"0"!=t.distributor_id),action:{handler:async([t])=>{await this.$confirm(`${$t("8aps355","确认暂停？","lang")}`,$t("hn562","提示","lang")),await this.$api.marketing.pendingPurchaseActivity(t.id),this.$refs.finder.refresh()}}},{name:$t("m50s2","结束","lang"),key:"modify",type:"button",buttonType:"text",visible:t=>!("warm_up"!=t.status&&"pending"!=t.status&&"ongoing"!=t.status||this.IS_ADMIN()&&"0"!=t.distributor_id),action:{handler:async([t])=>{await this.$confirm(`${$t("871n9f5","确认结束？","lang")}`,$t("hn562","提示","lang")),await this.$api.marketing.endPurchaseActivity(t.id),this.$refs.finder.refresh()}}}],columns:[{name:$t("e4hvdc4","活动名称","lang"),key:"name",width:180},{name:$t("ww3n2g7","员工额度（元）","lang"),key:"employee_limitfee",width:"120",formatter:(t,e,a)=>t>0?t/100:0},{name:$t("zgrkyc7","亲友额度（元）","lang"),key:"relative_limitfee",width:"120",formatter:(t,e,a)=>t>0?t/100:0},{name:$t("jpk67b4","预热时间","lang"),key:"display_time",width:"220",formatter:(t,e,a)=>l()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},{name:$t("di507i4","来源店铺","lang"),key:"distributor_name"},{name:$t("i50ogx4","购买时间","lang"),key:"employee_end_time",width:"320",formatter:(t,{employee_end_time:e,employee_begin_time:a},i)=>`${l()(1e3*a).format("YYYY-MM-DD HH:mm:ss")} ~ ${l()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}`},{name:$t("k1e32","状态","lang"),key:"status_desc"}]})}},created(){this.pagesQuery=new r.A({fetch:this.getEnterpriseList}).nextPage()},methods:{beforeSearch(t){const{name:e,display_time_begin:a,datetime:[i,r],enterprise_id:n,distributor_id:s,activityState:o}=this.queryForm;return t={...t,enterprise_id:n,distributor_id:s,name:e},a&&(t={...t,display_time_begin:l()(a).unix()}),i&&(t={...t,buy_time_begin:l()(i).unix()}),r&&(t={...t,buy_time_end:l()(r).unix()}),"all"!=o&&(t={...t,status:o}),t},onSearch(){this.$refs.finder.refresh()},createActivity(){this.$router.push({path:this.matchRoutePath("create")})},async getEnterpriseList({page:t,pageSize:e}){const{list:a,total_count:i}=await this.$api.member.getPurchaseCompanyList({page:t,pageSize:e});this.pagesQuery.setTotal(i),this.enterpriseList=this.enterpriseList.concat(a)}}},u=m,c=(0,a(81656).A)(u,function(){var t=this,e=t._self._c;return e("SpRouterView",[e("SpPage",[e("SpFilterForm",{attrs:{model:t.queryForm},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"name",label:$t("bopooa5","活动名称:","lang")}},[e("el-input",{attrs:{placeholder:$t("86hfcy7","活动名称关键词","lang")},model:{value:t.queryForm.name,callback:function(e){t.$set(t.queryForm,"name",e)},expression:"queryForm.name"}})],1),e("SpFilterFormItem",{attrs:{prop:"display_time_begin",label:$t("s9n5fx5","预热时间:","lang")}},[e("el-date-picker",{attrs:{type:"date",placeholder:$t("ikzrh64","选择日期","lang")},model:{value:t.queryForm.display_time_begin,callback:function(e){t.$set(t.queryForm,"display_time_begin",e)},expression:"queryForm.display_time_begin"}})],1),e("SpFilterFormItem",{attrs:{prop:"datetime",label:$t("5xbd6v5","购买时间:","lang"),size:"max"}},[e("el-date-picker",{attrs:{clearable:"",type:"datetimerange",align:"right",format:"yyyy-MM-dd HH:mm:ss","range-separator":$t("po31","至","lang"),"start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"default-time":t.defaultTime,"picker-options":t.pickerOptions},model:{value:t.queryForm.datetime,callback:function(e){t.$set(t.queryForm,"datetime",e)},expression:"queryForm.datetime"}})],1),e("SpFilterFormItem",{attrs:{prop:"enterprise_id",label:$t("hhivor5","参与企业:","lang"),size:"max"}},[e("el-select",{directives:[{name:"scroll",rawName:"v-scroll",value:()=>t.pagesQuery.nextPage(),expression:"() => pagesQuery.nextPage()"}],attrs:{multiple:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:t.queryForm.enterprise_id,callback:function(e){t.$set(t.queryForm,"enterprise_id",e)},expression:"queryForm.enterprise_id"}},t._l(t.enterpriseList,function(t,a){return e("el-option",{key:`enterprise-item__${a}`,attrs:{label:t.name,value:t.id}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"distributor_id",label:$t("7kd5ck5","来源店铺:","lang")}},[e("SpSelectShop",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:t.queryForm.distributor_id,callback:function(e){t.$set(t.queryForm,"distributor_id",e)},expression:"queryForm.distributor_id"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary",icon:"iconfont icon-xinzengcaozuo-01"},on:{click:t.createActivity}},[t._v($t("1054mv6"," 新建活动 ","lang"))])],1),e("el-tabs",{staticClass:"activity-status-tabs",attrs:{type:"card"},on:{"tab-click":t.onSearch},model:{value:t.queryForm.activityState,callback:function(e){t.$set(t.queryForm,"activityState",e)},expression:"queryForm.activityState"}},t._l(t.activityStatus,function(t){return e("el-tab-pane",{key:t.value,attrs:{label:t.title,name:t.value}})}),1),e("SpFinder",{ref:"finder",attrs:{"no-selection":"",setting:t.setting,"row-actions-align":"left",hooks:{beforeSearch:t.beforeSearch},url:"/employeepurchase/activities"}})],1)],1)},[],!1,null,"2300a97e",null).exports}}]);