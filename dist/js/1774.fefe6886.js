"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[1774],{51774:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var a=i(68962),s={data(){return{loading:!1,form:{is_open:"",person_id:"",app_id:"",app_key:"",is_hide:"",type:"yilianyun"},query:{type:"yilianyun"}}},mounted(){this.getInfo()},methods:{getInfo(){(0,a.getPrinterInfo)(this.query).then(t=>{this.form=t.data.data})},onSubmit(){(0,a.savePrinter)(this.form).then(t=>{this.$message({message:$t("aghf564","保存成功","lang"),type:"success"}),this.getInfo()})}}},l=i(81656),r=(0,l.A)(s,function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",attrs:{"label-width":"100px"}},[e("el-form-item",{attrs:{label:$t("ravm365","开启小票机","lang")}},[e("el-switch",{attrs:{width:60,"active-value":"true","inactive-value":"false","inactive-color":"#ccc","active-text":$t("gmcv2","开启","lang"),"inactive-text":$t("eod62","关闭","lang"),"active-color":"#13ce66"},model:{value:t.form.is_open,callback:function(e){t.$set(t.form,"is_open",e)},expression:"form.is_open"}})],1),e("el-form-item",{attrs:{label:$t("x9vr065","隐藏收货人","lang")}},[e("el-switch",{attrs:{width:60,"active-value":"true","inactive-value":"false","inactive-color":"#ccc","active-text":$t("gmcv2","开启","lang"),"inactive-text":$t("eod62","关闭","lang"),"active-color":"#13ce66"},model:{value:t.form.is_hide,callback:function(e){t.$set(t.form,"is_hide",e)},expression:"form.is_hide"}})],1),e("el-form-item",{attrs:{label:$t("f6ck8a4","用户ID","lang")}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:$t("f6ck8a4","用户ID","lang")},model:{value:t.form.person_id,callback:function(e){t.$set(t.form,"person_id",e)},expression:"form.person_id"}}),e("div",{staticClass:"frm-tips"},[e("a",{attrs:{href:"http://dev.10ss.net/admin/listapp",target:"_blank"}},[t._v($t("idrgkdi","应用列表地址，点击进入应用，进行查询","lang"))])])],1),e("el-form-item",{attrs:{label:$t("celrn34","应用ID","lang")}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:$t("f6ck8a4","用户ID","lang")},model:{value:t.form.app_id,callback:function(e){t.$set(t.form,"app_id",e)},expression:"form.app_id"}}),e("div",{staticClass:"frm-tips"},[e("a",{attrs:{href:"http://dev.10ss.net/admin/listapp",target:"_blank"}},[t._v($t("idrgkdi","应用列表地址，点击进入应用，进行查询","lang"))])])],1),e("el-form-item",{attrs:{label:$t("cf256b4","应用密钥","lang")}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:$t("f6ck8a4","用户ID","lang")},model:{value:t.form.app_key,callback:function(e){t.$set(t.form,"app_key",e)},expression:"form.app_key"}}),e("div",{staticClass:"frm-tips"},[e("a",{attrs:{href:"http://dev.10ss.net/admin/listapp",target:"_blank"}},[t._v($t("idrgkdi","应用列表地址，点击进入应用，进行查询","lang"))])])],1),e("div",{staticClass:"section-footer with-border content-center"},[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],1)},[],!1,null,"08a721ce",null).exports,o=(i(44114),i(2038)),n={props:{relDataIds:{type:Array,default:function(){return[]}},getStatus:{type:Boolean,default:!1},isValid:{type:Boolean,default:!1},storeVisible:{type:Boolean,default:!1},sourceType:{type:String,default:""}},data(){return{templateRadio:"",dataType:"distributor",loading:!1,storeData:[],multipleSelection:[],pageLimit:10,total_count:"",params:{page:1,pageSize:10,is_valid:"true"},name:""}},computed:{showDialog(){return this.storeVisible}},watch:{sourceType(t,e){this.dataType=this.sourceType},relDataIds(t,e){this.selectRows=t},getStatus(t,e){this.getDistributor()}},methods:{getTemplateRow(t,e){this.multipleSelection=new Array(e)},getDistributor(){(0,o.getDistributorList)(this.params).then(t=>{this.storeData=t.data.data.list,this.total_count=parseInt(t.data.data.total_count),this.loading=!1,this.multipleSelection=[]})},handleCurrentChange(t){this.params.page=t,this.getDistributor()},handleIconClick(){this.params.name=this.name,this.getDistributor()},cancelAction(){this.$emit("closeStoreDialog")},saveStoreAction(){this.$emit("chooseStore",this.multipleSelection)}}},c={components:{DistributorSelect:(0,l.A)(n,function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"store-dialog",attrs:{title:$t("ikyrsz4","选择店铺","lang"),visible:t.showDialog,"close-on-click-modal":!1,"before-close":t.cancelAction},on:{"update:visible":function(e){t.showDialog=e}}},[e("div",{staticStyle:{"margin-bottom":"15px"}},[e("el-input",{attrs:{placeholder:$t("oebdu06","输入店铺名称","lang"),clearable:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleIconClick},slot:"append"})],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.storeData,"tooltip-effect":"dark"}},[e("el-table-column",{attrs:{label:$t("p1j42","选择","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-radio",{attrs:{label:i.row.distributor_id},nativeOn:{change:function(e){return t.getTemplateRow(i.$index,i.row)}},model:{value:t.templateRadio,callback:function(e){t.templateRadio=e},expression:"templateRadio"}},[t._v("   ")])]}}])}),e("el-table-column",{attrs:{prop:"name",label:$t("cjqdxi4","店铺名称","lang")}}),e("el-table-column",{attrs:{prop:"contact",label:$t("jed0z3","联系人","lang")}}),e("el-table-column",{attrs:{prop:"store_name",label:$t("q0mn2","门店","lang")}}),e("el-table-column",{attrs:{prop:"address",label:$t("fb4g2","地址","lang"),"show-overflow-tooltip":""}})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"tr"},[e("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total_count,"page-size":t.pageLimit},on:{"current-change":t.handleCurrentChange}})],1):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cancelAction}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveStoreAction}},[t._v($t("hnjoo3","确 定","lang"))])],1)],1)},[],!1,null,null,null).exports},props:{status:{type:Boolean,default:!1}},data(){return{loading:!1,distributor:1,DistributorStatus:!1,DistributorVisible:!1,isValid:!1,isEdit:!1,editVisible:!1,editTitle:"",relDistributors:[],printerShopList:[],total_count:0,params:{page:1,pageSize:20},id:"",form:{name:"",distributor_id:0,app_terminal:"",app_key:"",type:"yilianyun"}}},mounted(){this.getPrinterShopList()},methods:{handleCurrentChange(t){this.params.page=t,this.getPrinterShopList()},getPrinterShopList(){(0,a.getPrinterShopList)(this.params).then(t=>{this.printerShopList=t.data.data.list})},handleClose(t){this.relDistributors.splice(t,1),this.form.distributor_id=0},addDistributoreAction(){this.DistributorVisible=!0,this.DistributorStatus=!0},getDistributor(t){let e={distributor_id:t};(0,o.getDistributorList)(e).then(t=>{this.relDistributors=t.data.data.list})},handleCancel(){this.editVisible=!1,this.id="",this.form.name="",this.distributor=1,this.form.distributor_id=0,this.form.app_terminal="",this.form.app_key="",this.relDistributors=[]},addLabels(){this.handleCancel(),this.editTitle=$t("xxs5tw6","添加账号信息","lang"),this.editVisible=!0,this.isEdit=!1,this.distributor=1,this.id=""},editAction(t,e){if(this.handleCancel(),this.editTitle=$t("1jfmbe6","编辑账号信息","lang"),this.editVisible=!0,this.isEdit=!0,0==e.distributor_id?this.distributor=1:this.distributor=2,this.id=e.id,this.form.name=e.name,this.form.distributor_id=e.distributor_id,this.form.app_terminal=e.app_terminal,this.form.app_key=e.app_key,this.form.type=e.type,e.distributor_id){let t=[];t.push(e.distributor_id),this.getDistributor(t)}},deleteAction(t,e){this.$confirm($t("jg8rzcj","此操作将删除该小票打印机, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,a.deletePrinter)(e.id).then(t=>{this.$message({message:$t("azeh8z4","删除成功","lang"),type:"success"}),this.editVisible=!1,this.getPrinterShopList()}).catch(t=>{})})},submitAction(){this.form.distributor_id=0,2==this.distributor&&this.relDistributors.length>0&&(this.form.distributor_id=this.relDistributors[0].distributor_id),this.id?(0,a.updatePrinter)(this.id,this.form).then(t=>{this.$message({message:$t("aghf564","保存成功","lang"),type:"success"}),this.editVisible=!1,this.getPrinterShopList()}).catch(t=>{}):(0,a.createPrinter)(this.form).then(t=>{this.$message({message:$t("epjvxw5"," 添加成功","lang"),type:"success"}),this.editVisible=!1,this.getPrinterShopList(),this.handleCancel()}).catch(t=>{})},DistributorChooseAction(t){this.DistributorVisible=!1,this.DistributorStatus=!1,null===t||t.length<=0||(this.relDistributors=t)},ShopChooseAction(t){this.ShopVisible=!1,this.ShopStatus=!1,null===t||t.length<=0||(this.relShops=t)},closeDialogAction(){this.ShopVisible=!1,this.ShopStatus=!1,this.DistributorStatus=!1,this.DistributorVisible=!1}}},p=(0,l.A)(c,function(){var t=this,e=t._self._c;return e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addLabels}},[t._v($t("l7hi899"," 添加关联打印机 ","lang"))])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.printerShopList}},[e("el-table-column",{attrs:{prop:"name",label:$t("us8uhs5","打印机名称","lang")}}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.editAction(i.$index,i.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.deleteAction(i.$index,i.row)}}},[t._v($t("db22k4"," 删除 ","lang"))])]}}])})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"content-center content-top-padded"},[e("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e(),e("el-dialog",{attrs:{title:t.editTitle,visible:t.editVisible,"before-close":t.handleCancel},on:{"update:visible":function(e){t.editVisible=e}}},[[e("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:t.form,"label-width":"120px"}},[e("el-form-item",{attrs:{label:$t("us8uhs5","打印机名称","lang")}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:$t("us8uhs5","打印机名称","lang")},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:$t("gwn72","店铺","lang")}},[e("el-radio-group",{model:{value:t.distributor,callback:function(e){t.distributor=e},expression:"distributor"}},[e("el-radio",{attrs:{label:1}},[t._v($t("fci374"," 总部 ","lang"))]),e("el-radio",{attrs:{label:2}},[t._v($t("f4jkt4"," 店铺 ","lang"))])],1)],1),2==t.distributor?e("el-form-item",{attrs:{label:$t("cs44ip4","所属店铺","lang")}},[t._l(t.relDistributors,function(i,a){return e("el-tag",{key:a,staticClass:"new-tag",attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(a)}}},[t._v(" "+t._s(i.name)+" ")])}),e("el-button",{staticClass:"button-new-tag",attrs:{size:"medium"},on:{click:t.addDistributoreAction}},[t._v($t("ud7swa"," + 点击搜索店铺 ","lang"))])],2):t._e(),e("el-form-item",{attrs:{label:$t("uqvljh6","打印机终端号","lang")}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:$t("us8uhs5","打印机名称","lang")},model:{value:t.form.app_terminal,callback:function(e){t.$set(t.form,"app_terminal",e)},expression:"form.app_terminal"}}),e("div",{staticClass:"frm-tips"},[t._v($t("pzpr0x6","见打印机底部","lang"))])],1),e("el-form-item",{attrs:{label:$t("us29sm5","打印机秘钥","lang")}},[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:$t("us8uhs5","打印机名称","lang")},model:{value:t.form.app_key,callback:function(e){t.$set(t.form,"app_key",e)},expression:"form.app_key"}}),e("div",{staticClass:"frm-tips"},[t._v($t("pzpr0x6","见打印机底部","lang"))])],1)],1)],e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{nativeOn:{click:function(e){return t.handleCancel.apply(null,arguments)}}},[t._v($t("dd4ni4"," 取消 ","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitAction}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],2),e("DistributorSelect",{attrs:{"store-visible":t.DistributorVisible,"is-valid":t.isValid,"rel-data-ids":t.relDistributors,"get-status":t.DistributorStatus},on:{chooseStore:t.DistributorChooseAction,closeStoreDialog:t.closeDialogAction}})],1)},[],!1,null,"74a41f2c",null),u={components:{yilianyunTemplates:r,shopPosTemplates:p.exports},data(){return{loading:!1,yilianyunTemplates:!1,shopPosTemplates:!1,activeName:"first",list:[]}},mounted(){void 0!==this.$route.query.activeName&&(this.activeName=this.$route.query.activeName)},methods:{handleClick(t,e){"first"===this.activeName?this.yilianyunTemplates=!0:"second"===this.activeName&&(this.shopPosTemplates=!0)}}},d=(0,l.A)(u,function(){var t=this,e=t._self._c;return e("SpPage",[e("div",[e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:$t("ajw0mn5","易联云配置","lang"),name:"first"}},[e("yilianyunTemplates",{ref:"yilianyunTemplates",attrs:{"get-status":t.yilianyunTemplates}})],1),e("el-tab-pane",{attrs:{label:$t("jb878w4","门店配置","lang"),name:"second"}},[e("shopPosTemplates",{ref:"shopPosTemplates",attrs:{"get-status":t.shopPosTemplates}})],1)],1)],1),e("router-view")],1)},[],!1,null,"0f740278",null).exports}}]);