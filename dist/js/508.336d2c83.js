"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[508],{60508:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var i=a(94644),n=a(95093),s=a.n(n),r=a(17659),o=(a(26456),{data(){const t=s()().subtract(8,"day"),e=s()().subtract(1,"day");return{loading:!0,exportloading:!1,activeName:"goods_count",queryForm:{datetime:[t,e],activity_id:""},defaultTime:["00:00:00","23:59:59"],tableData:[],pickerOptions:{shortcuts:[{text:$t("dl4oop4","最近一周","lang"),onClick(t){const a=new Date;a.setTime(a.getTime()-6912e5),t.$emit("pick",[a,e])}},{text:$t("4znkgj5","最近一个月","lang"),onClick(t){const a=new Date;a.setTime(a.getTime()-26784e5),t.$emit("pick",[a,e])}},{text:$t("4zndsa5","最近三个月","lang"),onClick(t){const a=new Date;a.setTime(a.getTime()-78624e5),t.$emit("pick",[a,e])}}],disabledDate:t=>t.getTime()>e},allListData:[],setting:(0,i.createSetting)({columns:[{name:"No",key:"no"},{name:$t("b47z184","商品编号","lang"),key:"sap_code"},{name:$t("emut2","分类","lang"),key:"top_level"},{name:$t("b40v0e4","商品名称","lang"),key:"product"},{name:$t("q5732","销量","lang"),key:"quantity"},{name:$t("m8zzj3","销售额","lang"),key:"fix_price"},{name:$t("dtcdf3","实付额","lang"),key:"settle_price"}]}),purchaseActivityList:[]}},created(){this.pagesQuery=new r.A({fetch:this.getPurchaseActivity}).nextPage()},mounted(){this.fetch()},methods:{async fetch(){const{datetime:t,activity_id:e}=this.queryForm||{},[a,i]=t||[],{list:n}=await this.$api.datacube.getGoodsData({start:s()(a).format("YYYY-MM-DD"),end:s()(i).format("YYYY-MM-DD"),order_class:e.length>0?"employee_purchase":"",act_id:e.length>0?e.toString():""});this.tableData=n,this.$nextTick(()=>{this.$refs.finder.refresh()})},onSearch(){this.fetch()},async exportData(){this.exportloading=!0;const{datetime:t,activity_id:e}=this.queryForm||{},[a,i]=t||[],{status:n,url:r}=await this.$api.datacube.getGoodsData({start:s()(a).format("YYYY-MM-DD"),end:s()(i).format("YYYY-MM-DD"),order_class:e.length>0?"employee_purchase":"",act_id:e.length>0?e.toString():"",export:1});this.exportloading=!1,n?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("goods_data")):this.$message.error($t("d17rj2j","无内容可导出 或 执行失败，请检查重试","lang"))},async getPurchaseActivity({page:t,pageSize:e}){const{list:a,total_count:i}=await this.$api.marketing.getPurchaseActivity({page:t,pageSize:e});this.pagesQuery.setTotal(i),this.purchaseActivityList=this.purchaseActivityList.concat(a)}}}),c=(0,a(81656).A)(o,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpFilterForm",{attrs:{model:t.queryForm},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"datetime",label:$t("1w000t5","查询日期:","lang")}},[e("el-date-picker",{attrs:{type:"daterange",format:"yyyy-MM-dd",clearable:!1,"range-separator":$t("po31","至","lang"),"start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"default-time":t.defaultTime,"picker-options":t.pickerOptions},model:{value:t.queryForm.datetime,callback:function(e){t.$set(t.queryForm,"datetime",e)},expression:"queryForm.datetime"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.exportloading,expression:"exportloading"}],attrs:{type:"primary"},on:{click:t.exportData}},[t._v($t("efepu4"," 导出 ","lang"))]),e("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:$t("m52dbi12",'导出任务会以队列执行，点击导出后，请至"设置-导出列表"页面中查看及下载数据',"lang")}},[e("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),e("SpFinder",{ref:"finder",attrs:{"no-selection":"","show-pager":!1,setting:t.setting,"row-actions-align":"left",data:t.tableData}})],1)},[],!1,null,null,null).exports}}]);