"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[9126],{79126:function(t,e,a){a.r(e),a.d(e,{default:function(){return Y}});var s=a(95353),i=a(91142),r=(a(44114),a(18111),a(7588),a(41776)),n=a(5748),o={props:["userId","isLoad","userMobile"],data(){return{user_id:0,loading:!1,addRightsDialog:!1,mobile:"",searchMobile:"",goodsList:[],mobile:"",addRightsItems:[],goodsListSelect:[],rightsList:[],total_count:0,goods_total_count:0,goods_page:1,goodsParams:{page:1,pageSize:20},params:{page:1,pageSize:20,user_id:0}}},watch:{userId(t,e){this.isLoad&&(this.rightsList=[],this.params.user_id=t,this.getRightsList())},isLoad(t,e){t&&(this.rightsList=[],this.params.user_id=this.userId,this.getRightsList())},userMobile(t,e){this.mobile=t}},mounted(){this.getRightsList()},methods:{onSubmit(){let t={mobile:this.userMobile,itemids:this.addRightsItems};(0,r.createRights)(t).then(t=>{this.addRightsItems=[],this.$message({type:"success",message:$t("taxr976","添加权益成功","lang")}),this.getRightsList(),this.addRightsDialog=!1})},addResource(){this.getGoodsList(),this.addRightsDialog=!0},handleCancelLabelsDialog(){this.addRightsDialog=!1},handleCurrentChange(t){this.loading=!1,this.params.page=t,this.getRightsList()},handleGoodsChange(t){this.goodsParams.page=t,this.goodsListSelect=[],this.goodsList.forEach(t=>{-1!=this.addRightsItems.indexOf(t.key)&&this.goodsListSelect.push(t)}),this.getGoodsList()},getGoodsList(){(0,n.getItemsList)(this.goodsParams).then(t=>{let e=[];t.data.data.list.forEach(t=>{-1===this.addRightsItems.indexOf(t.itemId)&&e.push({key:t.itemId,label:t.itemName})}),this.goodsList=e.concat(this.goodsListSelect),this.goods_total_count=t.data.data.total_count})},getRightsList(){this.loading=!0,(0,r.findRightsList)(this.params).then(t=>{this.rightsList=t.data.data.list,this.total_count=Number(t.data.data.total_count),this.loading=!1})}}},l=a(81656),d=(0,l.A)(o,function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-white"},[e("el-row",{staticClass:"content-bottom-padded",attrs:{gutter:20}},[e("el-col",{attrs:{span:3}},[e("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addResource}},[t._v($t("tudqs46"," 添加权益 ","lang"))])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.rightsList,border:""}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.label_infos,function(a){return e("div",[e("span",[t._v($t("jgcm2k5","包含物料：","lang"))]),e("el-tag",{attrs:{type:"success"}},[t._v(" "+t._s(a.label_name)+" ")])],1)})}}])}),e("el-table-column",{attrs:{prop:"rights_name",label:$t("eyrn2","名称","lang"),"min-width":"140"}}),e("el-table-column",{attrs:{prop:"rights_from",label:$t("i6yz2","来源","lang"),"min-width":"100"}}),e("el-table-column",{attrs:{prop:"operator_desc",label:$t("97hz1c7","代客下单操作员","lang")}}),e("el-table-column",{attrs:{prop:"total_num",label:$t("elh3u3","总数量","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[2==a.row.is_not_limit_num?e("span",[t._v(t._s(a.row.total_num))]):t._e(),1==a.row.is_not_limit_num?e("span",[t._v($t("fnc8h3","无限次","lang"))]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"total_consum_num",label:$t("pxn8rd5","已核销数量","lang")}}),e("el-table-column",{attrs:{label:$t("ikg3cm4","过期时间","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.end_time)))])]}}])}),e("el-table-column",{attrs:{label:$t("k1e32","状态","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[2==a.row.is_not_limit_num?[a.row.total_num==a.row.total_consum_num?e("el-tag",{attrs:{size:"mini"}},[t._v($t("ctr9ka5"," 已用完 ","lang"))]):t._e()]:t._e(),1==a.row.is_not_limit_num?[e("el-tag",{attrs:{size:"mini"}},[t._v($t("dyoyb35"," 无限次 ","lang"))])]:"1"==a.row.is_valid?e("el-tag",{attrs:{type:"success",size:"mini"}},[t._v($t("g4yo14"," 有效 ","lang"))]):e("el-tag",{attrs:{size:"mini"}},[t._v($t("cxplue5"," 已过期 ","lang"))])]}}])})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"content-padded tc"},[e("el-pagination",{attrs:{total:t.total_count,"page-size":t.params.pageSize},on:{"current-change":t.handleCurrentChange}})],1):t._e(),e("el-dialog",{staticClass:"right-dialog",attrs:{title:$t("e7zjxo4","添加权益","lang"),visible:t.addRightsDialog,"before-close":t.handleCancelLabelsDialog},on:{"update:visible":function(e){t.addRightsDialog=e}}},[[e("el-form",[e("el-form-item",{attrs:{"label-width":"100px",label:$t("twbrz66","选择权益商品","lang")}},[e("el-transfer",{attrs:{titles:[$t("b40lv04","商品列表","lang"),$t("egat23","已选中","lang")],data:t.goodsList},model:{value:t.addRightsItems,callback:function(e){t.addRightsItems=e},expression:"addRightsItems"}},[e("div",{staticClass:"transfer-footer",attrs:{slot:"left-footer"},slot:"left-footer"},[t.goods_total_count>t.goodsParams.pageSize?e("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:t.goods_total_count,"page-size":t.goodsParams.pageSize},on:{"current-change":t.handleGoodsChange}}):t._e()],1),e("div",{staticClass:"transfer-footer",attrs:{slot:"right-footer"},slot:"right-footer"})])],1),e("el-form-item",{staticClass:"content-center"},[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v($t("tnxv36"," 确定添加 ","lang"))])],1)],1)]],2)],1)},[],!1,null,null,null).exports,m={props:["userId","isLoad"],data(){return{loading:!1,params:{},orderStatusList:[{name:$t("flmib3","未支付","lang"),value:"notpay"},{name:$t("e7hbq3","已完成","lang"),value:"done"}],total_count:0,currentPage:1,pageSize:20,list:[],currentShop:"",wxShopsList:[]}},watch:{userId(t,e){this.isLoad&&(this.params={page:this.currentPage,pageSize:this.pageSize,user_id:t},this.getOrders(this.params))},isLoad(t,e){t&&(this.params={page:this.currentPage,pageSize:this.pageSize,user_id:this.userId},this.getOrders(this.params))}},mounted(){},methods:{handleCurrentChange(t){this.currentPage=t,this.loading=!1,this.getParams(),this.getOrders(this.params)},getParams(){this.params.page=this.currentPage,this.params.pageSize=this.pageSize},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3},getOrders(t){this.loading=!0,(0,r.getOrderList)(t).then(t=>{this.list=t.data.data.list,this.total_count=Number(t.data.data.pager.count),this.loading=!1})},getDetail(t){this.$router.push({path:""+("distributor"!=this.$store.getters.login_type?"/order/order-manage/order-list/detail":"/shopadmin/order/order-manage/order-list/detail"),query:{orderId:t,resource:"/member/manage/members/detail?user_id="+this.userId,user_id:this.userId}})}}},g=(0,l.A)(m,function(){var t=this,e=t._self._c;return e("div",[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list,border:""}},[e("el-table-column",{attrs:{prop:"create_time",label:$t("ar84e54","创建时间","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.create_time,"YYYY-MM-DD HH:mm:ss")))])]}}])}),e("el-table-column",{attrs:{prop:"order_id",label:$t("kuwys3","订单号","lang")}}),e("el-table-column",{attrs:{prop:"title",label:$t("ij5d2","标题","lang")}}),e("el-table-column",{attrs:{prop:"total_fee",label:$t("pn1o2","金额","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ￥"+t._s(e.row.total_fee/100)+" ")]}}])}),e("el-table-column",{attrs:{prop:"order_type",label:$t("lnjk2","类型","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(t.orderType,function(s,i){return s.type==a.row.order_type?e("span",{key:i},[t._v(" "+t._s(s.name)+" ")]):t._e()})}}])}),e("el-table-column",{attrs:{prop:"order_status",label:$t("hys56m4","订单状态","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["DONE"==a.row.order_status?e("el-tag",{attrs:{type:"success"}},[t._v($t("cq1c3u5"," 已完成 ","lang"))]):"NOTPAY"==a.row.order_status?e("el-tag",[t._v($t("dx7srx5"," 未支付 ","lang"))]):"CLOSED"==a.row.order_status?e("el-tag",{attrs:{type:"danger"}},[t._v($t("coyml85"," 已取消 ","lang"))]):t._e()]}}])}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["membercard"!=a.row.order_type?e("el-button",{attrs:{size:"small",icon:"view"},on:{click:function(e){return t.getDetail(a.row.order_id)}}},[t._v($t("likox4"," 详情 ","lang"))]):t._e()]}}])})],1),t.total_count>t.pageSize?e("div",{staticClass:"content-padded tc"},[e("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total_count,"page-size":t.pageSize},on:{"current-change":t.handleCurrentChange}})],1):t._e()],1)},[],!1,null,"4f05bd5d",null).exports,p=a(67440),c={filters:{formatTypeStr(t){switch(t){case"recharge":t=$t("alfuyk4","充值记录","lang");break;case"consume":t=$t("eep6ae4","消费记录","lang");break;case"recharge_gift":t=$t("ifp3ba4","赠送记录","lang");break;case"refund":t=$t("ij8web4","退回记录","lang");break;case"recharge_send":t=$t("ihdcz84","返佣记录","lang")}return t}},props:["userId","isLoad"],data(){return{loading:!1,trade_type:"",total_count:0,pageSize:20,recordList:[],typeFilters:[{text:$t("alfuyk4","充值记录","lang"),value:"recharge"},{text:$t("ifp3ba4","赠送记录","lang"),value:"recharge_gift"},{text:$t("eep6ae4","消费记录","lang"),value:"consume"},{text:$t("ihdcz84","返佣记录","lang"),value:"recharge_send"},{text:$t("ij8web4","退回记录","lang"),value:"refund"}],params:{page:1},date_begin:"",date_end:""}},watch:{userId(t,e){if(this.isLoad){let e={pageSize:this.pageSize,page:1,user_id:t};this.getList(e)}},isLoad(t,e){if(t){let t={pageSize:this.pageSize,page:1,user_id:this.userId};this.getList(t)}}},mounted(){},methods:{filterTag(t){t.type.length>0&&t.type.length!=this.typeFilters.length?this.trade_type=t.type.join(","):this.trade_type="",this.getParams(),this.params.page=1,this.params.user_id=this.userId,this.getList(this.params)},handleCurrentChange(t){this.params.page=t,this.params.pageSize=this.pageSize,this.getList(this.params)},getList(t){this.loading=!0,(0,p.getDepositTradeList)(t).then(t=>{this.recordList=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})},getParams(){this.params.trade_type=this.trade_type},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3}}},u=(0,l.A)(c,function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-white"},[e("div",{staticClass:"record-list"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.recordList,border:""},on:{"filter-change":t.filterTag}},[e("el-table-column",{attrs:{prop:"tradeType","column-key":"type",label:$t("4s1hl06","交易记录类型","lang"),width:"180",filters:t.typeFilters,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatTypeStr")(e.row.tradeType))+" ")]}}])}),e("el-table-column",{attrs:{prop:"timeStart",label:$t("ar84e54","创建时间","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.timeStart,"YYYY-MM-DD HH:mm:ss")))])]}}])}),e("el-table-column",{attrs:{prop:"depositTradeId",label:$t("yc5zij5","交易流水号","lang")}}),e("el-table-column",{attrs:{prop:"money",label:$t("pn1o2","金额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.money/100)+$t("g1v1","元","lang"))])]}}])}),e("el-table-column",{attrs:{prop:"detail",label:$t("fqo12","备注","lang")}}),e("el-table-column",{attrs:{prop:"shopName",label:$t("q0mn2","门店","lang")}})],1)],1),t.total_count>t.pageSize?e("div",{staticClass:"content-padded tc"},[e("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e()])},[],!1,null,null,null).exports,h={props:["userId","userMobile","isLoad"],data(){return{loading:!1,total_count:0,transferList:[],currentPage:1,pageSize:20,params:{}}},watch:{userId(t,e){this.isLoad&&(this.params={page:this.currentPage,pageSize:this.pageSize,user_id:t},this.getList(this.params))},isLoad(t,e){t&&(this.params={page:this.currentPage,pageSize:this.pageSize,user_id:this.userId},this.getList(this.params))}},mounted(){this.params.user_id=this.userId,this.getParams(),this.getList(this.params)},methods:{getList(t){this.loading=!0,(0,r.transferRightsList)(t).then(t=>{this.transferList=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})},handleCurrentChange(t){this.currentPage=t,this.loading=!1,this.getParams(),this.getList(this.params)},getParams(){this.params.page=this.currentPage,this.params.pageSize=this.pageSize}}},_=(0,l.A)(h,function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-white"},[e("div",{staticClass:"transfer-list"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.transferList,border:""}},[e("el-table-column",{attrs:{prop:"rights_name",label:$t("dioqei4","权益名称","lang")}}),e("el-table-column",{attrs:{prop:"timeStart",label:$t("io6nnf4","转让时间","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.created)))])]}}])}),e("el-table-column",{attrs:{prop:"mobile",label:$t("ayp61q4","原持有者","lang")}}),e("el-table-column",{attrs:{prop:"transfer_mobile",label:$t("f0atd94","现持有者","lang")}}),e("el-table-column",{attrs:{prop:"remark",label:$t("fqo12","备注","lang")}})],1)],1),t.total_count>t.params.pageSize?e("div",{staticClass:"content-padded tc"},[e("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e()])},[],!1,null,null,null).exports,b={props:["userId","isLoad"],data(){return{loading:!1,total_count:0,dataList:[],identifier:"",create_time:"",date_begin:"",date_end:"",params:{page:1,pageSize:20}}},computed:{...(0,s.L8)(["wheight"])},watch:{userId(t,e){this.isLoad&&(this.params.user_id=t,this.getParams(),this.getDataList(this.params))},isLoad(t,e){t&&(this.params.user_id=this.userId,this.getParams(),this.getDataList(this.params))}},mounted(){this.params.user_id=this.userId,this.getParams(),this.getDataList(this.params)},methods:{numberSearch(t){this.params.page=1,this.getParams(),this.getDataList(this.params)},dateChange(t){t&&t.length>0?(this.date_begin=this.dateStrToTimeStamp(t[0]+" 00:00:00"),this.date_end=this.dateStrToTimeStamp(t[1]+" 23:59:59")):(this.date_begin="",this.date_end=""),this.params.page=1,this.getParams(),this.getDataList(this.params)},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3},getParams(){this.params.time_start_begin=this.date_begin,this.params.time_start_end=this.date_end,this.params.mobile=this.identifier},getDataList(t){this.loading=!0,(0,r.getRightsLogList)(t).then(t=>{this.dataList=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})},handleCurrentChange(t){this.params.page=t,this.getDataList(this.params)}}},f=(0,l.A)(b,function(){var t=this,e=t._self._c;return e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("el-input",{attrs:{placeholder:$t("dml9sa7","服务人员手机号","lang")},model:{value:t.identifier,callback:function(e){t.identifier=e},expression:"identifier"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.numberSearch},slot:"append"})],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.dataList,height:t.wheight-150}},[e("el-table-column",{attrs:{prop:"shop_name",label:$t("jaxr3m4","门店名称","lang"),width:"150"}}),e("el-table-column",{attrs:{prop:"attendant",label:$t("dcegwi4","服务人员","lang"),width:"120"}}),e("el-table-column",{attrs:{prop:"name",label:$t("fzcls3","核销员","lang"),width:"120"}}),e("el-table-column",{attrs:{prop:"salesperson_mobile",label:$t("e661o86","核销员手机号","lang"),width:"120"}}),e("el-table-column",{attrs:{prop:"rights_name",label:$t("dcr7bd4","服务项目","lang"),width:"200"}}),e("el-table-column",{attrs:{prop:"user_name",label:$t("abylqw4","会员姓名","lang"),width:"100"}}),e("el-table-column",{attrs:{prop:"user_mobile",label:$t("ytf6465","会员手机号","lang"),width:"120"}}),e("el-table-column",{attrs:{prop:"user_sex",label:$t("abzo4i4","会员性别","lang"),width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return["2"==a.row.user_sex?e("span",[t._v($t("ho31","女","lang"))]):"1"==a.row.user_sex?e("span",[t._v($t("n5j1","男","lang"))]):e("span",[t._v($t("iv4r3"," 未知","lang"))])]}}])}),e("el-table-column",{attrs:{prop:"end_time",label:$t("dcis4y4","服务时间","lang"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.end_time,"YYYY-MM-DD HH:mm:ss")))])]}}])})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e()],1)},[],!1,null,null,null).exports,v=a(50002),y={data(){return{loading:!1,activeName:"salespersonlogs",total_count:0,list:[],user_id:0,params:{page:1,pageSize:20}}},computed:{...(0,s.L8)(["wheight"])},mounted(){this.user_id=this.$route.query.user_id,this.getWorkWechatRelLogsList()},methods:{handleCurrentChange(){this.getWorkWechatRelLogsList()},getWorkWechatRelLogsList(){this.loading=!0,(0,v.getWorkWechatRelLogsList)(this.user_id,this.params).then(t=>{this.list=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})}}},L=(0,l.A)(y,function(){var t=this,e=t._self._c;return e("div",[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list,height:t.wheight-150}},[e("el-table-column",{attrs:{label:$t("lnjk2","类型","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.log_type)+" ")]}}])}),e("el-table-column",{attrs:{prop:"remarks",label:$t("e46m2","信息","lang"),"min-width":"90"}}),e("el-table-column",{attrs:{label:$t("d97ftc4","日志时间","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("datetime")(e.row.created,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{"current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e()],1)},[],!1,null,null,null).exports,$=a(22541),S=a(95093),k=a.n(S),C={props:["info"],data(){return{vipGradeIsOpen:!1,userVipGrade:[],setting:(0,$.createSetting)({columns:[{name:$t("kuwys3","订单号","lang"),key:"order_id"},{name:$t("yvi5y75","会员卡等级","lang"),key:"lv_type"},{name:$t("yvov4q5","会员卡名称","lang"),key:"title"},{name:$t("yvi6ct5","会员卡类型","lang"),key:"card_type",formatter:(t,e,a)=>t.desc},{name:$t("ytf6465","会员手机号","lang"),key:"mobile"},{name:$t("i585jj4","购买金额","lang"),key:"price",formatter:(t,e,a)=>"￥"+t/100},{name:$t("ex2353","折扣值","lang"),key:"discount",formatter:(t,e,a)=>`${(100-t)/100}${$t("jh41","折","lang")}`},{name:$t("a72nl44","下单时间","lang"),key:"created",width:"160px",formatter:(t,e,a)=>k()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},{name:$t("i6yz2","来源","lang"),key:"source_type",formatter:(t,e,a)=>({receive:$t("jlgtlc4","领取获得","lang"),sale:$t("i55fxf4","购买获得","lang"),gift:$t("ifnqjl4","赠送获得","lang"),admin:$t("gkr4ge6","后台手动操作","lang")}[t])}]}),formData:{}}},created(){},mounted(){this.getAllUserVipGrade()},methods:{beforeSearch(t){const{user_id:e}=this.$route.query;return t={...t,user_id:e,page:t.page,pageSize:t.pageSize}},async addStoreValue(){await this.$confirm($t("5ckzx6c","请确认是否延期会员日期?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang")});const{user_id:t}=this.$route.query;await this.$api.cardticket.receiveMemberCard({user_id:t,mobile:this.info.mobile,vipGradeAddDay:JSON.stringify(this.formData)}),this.$message.success($t("d1spvi4","操作成功","lang")),this.$refs.finder.refresh(!0)},async getAllUserVipGrade(){const{user_id:t}=this.$route.query,{list:e,is_open:a}=await this.$api.cardticket.getAllUserVipGrade({user_id:t});this.vipGradeIsOpen=a,this.userVipGrade=e,e.forEach(t=>{this.$set(this.formData,t.lv_type,{day:0,vip_grade_id:t.vip_grade_id})})},onSearch(){},async onChuZhiFormSubmit(){const{user_id:t}=this.$route.query;await this.$api.deposit.rechargeDeposit({user_id:t,money:parseInt(100*this.chuzhiForm.money)}),this.$message.success($t("e7ygyc4","添加成功","lang")),this.chuzhiDialog=!1,this.$refs.finder.refresh(!0)}}},w=(0,l.A)(C,function(){var t=this,e=t._self._c;return e("div",{staticClass:"member-card-list"},[e("SpFinder",{ref:"finder",attrs:{url:"/vipgrade/order","no-selection":"","fixed-row-action":!0,setting:t.setting,hooks:{beforeSearch:t.beforeSearch}}},[e("template",{slot:"tableTop"},[t.vipGradeIsOpen?e("div",{staticClass:"action-container"},[t._l(t.userVipGrade,function(a,s){return e("div",{staticClass:"vip-item"},[t._v(" "+t._s(a.grade_name)+t._s(a.is_had_vip?`${a.end_time}${$t("jqv23e5","到期，延期","lang")}`:$t("bs9txpd","未购买过该会员卡，当天延期","lang"))+" "),e("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right"},model:{value:t.formData[a.lv_type].day,callback:function(e){t.$set(t.formData[a.lv_type],"day",e)},expression:"formData[item.lv_type].day"}}),t._v($t("idl2"," 天","lang")),s<t.userVipGrade.length-1?e("span",[t._v("，")]):t._e()],1)}),e("el-button",{on:{click:t.addStoreValue}},[t._v($t("e32z2","保存","lang"))])],2):t._e()])],2)],1)},[],!1,null,null,null).exports,x={data(){return{setting:(0,$.createSetting)({columns:[{name:$t("i5z22","时间","lang"),key:"created",formatter:(t,e,a)=>k()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},{name:$t("fq2rk74","积分变动","lang"),key:"curPayFee",render:(t,{row:e})=>t("el-tag",{props:{type:e.income>0?"danger":e.outcome>0?"success":""}},e.income>0?`+${e.income}`:e.outcome>0?`-${e.outcome}`:0)},{name:$t("ax7u294","变动原因","lang"),key:"point_desc"},{name:$t("kuwys3","订单号","lang"),key:"order_id"}]}),pointDialog:!1,pointForm:{adjustment_type:"plus",point:""},dmcrmIsOpen:!1,pointFormList:[{label:$t("i33f2f4","调整方式","lang"),key:"adjustment_type",type:"select",options:[{title:$t("gbk1","加","lang"),value:"plus"},{title:$t("g5r1","减","lang"),value:"reduce"}]},{label:$t("l6uv2","积分","lang"),key:"point",min:1,max:9999999,type:"number"}]}},created(){this.$api.third.getDmcrmSetting().then(t=>{this.dmcrmIsOpen=t.is_open})},methods:{beforeSearch(t){const{user_id:e}=this.$route.query;return t={...t,user_id:e,page:t.page,pageSize:t.pageSize}},updatePoint(){this.pointForm.money=0,this.pointDialog=!0},async onChuZhiFormSubmit(){const{user_id:t}=this.$route.query;await this.$api.point.adjustmentPoint({user_id:t,adjustment_type:this.pointForm.adjustment_type,point:this.pointForm.point}),this.$message.success($t("bawdbd6","积分调整成功","lang")),this.pointDialog=!1,this.$refs.finder.refresh(!0)}}},z=(0,l.A)(x,function(){var t=this,e=t._self._c;return e("div",[e("SpFinder",{ref:"finder",attrs:{url:"/point/member","fixed-row-action":!0,setting:t.setting,"no-selection":"",hooks:{beforeSearch:t.beforeSearch}}},[t.dmcrmIsOpen?t._e():e("template",{slot:"tableTop"},[e("div",{staticClass:"action-container"},[e("el-button",{on:{click:t.updatePoint}},[t._v($t("fqcf7s4","积分调整","lang"))])],1)])],2),e("SpDialog",{ref:"pointDialogRef",attrs:{title:$t("fqcf7s4","积分调整","lang"),form:t.pointForm,"form-list":t.pointFormList},on:{onSubmit:t.onChuZhiFormSubmit},model:{value:t.pointDialog,callback:function(e){t.pointDialog=e},expression:"pointDialog"}})],1)},[],!1,null,null,null).exports,I={data(){return{setting:(0,$.createSetting)({columns:[{name:$t("al9qqd4","充值时间","lang"),key:"timeStart",formatter:(t,e,a)=>k()(1e3*t).format("YYYY-MM-DD HH:mm:ss")},{name:$t("alh7sz4","充值金额","lang"),key:"curPayFee",formatter:(t,e,a)=>(t/100).toFixed(2)},{name:$t("albm5e4","充值状态","lang"),key:"tradeStatus",render:(t,{row:e})=>t("el-tag",{props:{type:"SUCCESS"==e.tradeStatus?"success":"danger"}},"SUCCESS"==e.tradeStatus?$t("al8pk64","充值成功","lang"):$t("al7isr4","充值失败","lang"))},{name:$t("hrlt2","描述","lang"),key:"detail"}]}),chuzhiDialog:!1,chuzhiForm:{money:0},chuzhiFormList:[{label:$t("alh7sz4","充值金额","lang"),key:"money",type:"number",precision:2,setp:.1}]}},created(){},methods:{beforeSearch(t){const{user_id:e}=this.$route.query;return t={...t,user_id:e,page:t.page,pageSize:t.pageSize}},addStoreValue(){this.chuzhiForm.money=0,this.chuzhiDialog=!0},async onChuZhiFormSubmit(){const{user_id:t}=this.$route.query;await this.$api.deposit.rechargeDeposit({user_id:t,money:parseInt(100*this.chuzhiForm.money)}),this.$message.success($t("e7ygyc4","添加成功","lang")),this.chuzhiDialog=!1,this.$refs.finder.refresh(!0)}}},D=(0,l.A)(I,function(){var t=this,e=t._self._c;return e("div",[e("SpFinder",{ref:"finder",attrs:{url:"/deposit/trades","no-selection":"","fixed-row-action":!0,setting:t.setting,hooks:{beforeSearch:t.beforeSearch}}},[e("template",{slot:"tableTop"},[e("div",{staticClass:"action-container"},[e("el-button",{on:{click:t.addStoreValue}},[t._v($t("e9hz2","充值","lang"))])],1)])],2),e("SpDialog",{ref:"chuzhiDialogRef",attrs:{title:$t("e9hz2","充值","lang"),form:t.chuzhiForm,"form-list":t.chuzhiFormList},on:{onSubmit:t.onChuZhiFormSubmit},model:{value:t.chuzhiDialog,callback:function(e){t.chuzhiDialog=e},expression:"chuzhiDialog"}})],1)},[],!1,null,null,null).exports,q={props:["userInfo","isLoad","registerSetting"],data(){return{setting:[],member:{user_id:"",company_id:"",grade_id:"",mobile:"",user_card_code:"",username:"",sex:1,birthday:"",address:"",email:"",industry:"",income:"",habbit:[],cardInfo:{company_id:"1",brand_name:"",logo_url:"",title:"",color:"#ff5000",code_type:"",background_pic_url:""},gradeInfo:{background_pic_url:"",company_id:"",default_grade:!0,grade_name:$t("i7os2","普通","lang"),privileges:{discount:"",discount_desc:""}},wechatUserInfo:{company_id:"1",authorizer_appid:"",open_id:"",unionid:"",nickname:"",sex:0,city:"",country:"",province:"",language:"",headimgurl:"",user_id:""},deposit:0}}},watch:{registerSetting(t,e){this.isLoad&&(this.setting=t)},userInfo(t,e){this.isLoad&&(this.member=t)}},mounted(){this.member=this.userInfo,this.setting=this.registerSetting},methods:{}},R=(0,l.A)(q,function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"section section-white content-padded"},[e("div",{staticClass:"clearfix"},[e("div",{staticClass:"f_l member-info"},[t._l(t.setting,function(a,s){return["habbit"==s?e("div",{key:s,staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v(t._s(a.name))]),t.member.requestFields&&t.member.requestFields.habbit?e("span",t._l(t.member.requestFields.habbit,function(a,s){return e("span",{key:s},[t._v(t._s(a.ischecked?a.name+",":""))])}),0):e("span",[t._v("--")])]):"select"===a.element_type?e("div",{key:s,staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v(t._s(a.name))]),a.items[t.member[s]]?e("span",[t._v(t._s(a.items[t.member[s]]))]):e("span",[t._v("--")])]):e("div",{key:s,staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v(t._s(a.name))]),t.member[s]?e("span",[t._v(t._s(t.member[s]))]):e("span",[t._v("--")])])]}),t.member.salesperson_info?.employee_number?e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("gdp4re4","绑定导购","lang"))]),e("span",[t._v(t._s(t.member.salesperson_info?.employee_number))])]):t._e(),t.member.salesperson_info?.store_name?e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("gdyq8o4","绑定门店","lang"))]),e("span",[t._v(t._s(t.member.salesperson_info?.store_name))])]):t._e()],2)])])])},[],!1,null,"f59703d0",null).exports,P=a(26456),N={components:{quanyiList:d,orderList:g,depositList:u,transferList:_,membercardList:w,rightslogList:f,pointList:z,chuZhiList:D,salespersonLogsList:L,memberInfo:R},data(){return{user_id:0,preMobile:"",orderRecords:"",grade_id:"",currentPage:1,member:{user_id:"",company_id:"",grade_id:"",mobile:"",user_card_code:"",username:"",sex:1,birthday:"",address:"",email:"",created:"",industry:"",income:"",habbit:[],cardInfo:{company_id:"1",brand_name:"",logo_url:"",title:"",color:"#ff5000",code_type:"",background_pic_url:""},gradeInfo:{background_pic_url:"",company_id:"",default_grade:!0,grade_name:$t("i7os2","普通","lang"),privileges:{discount:"",discount_desc:""}},wechatUserInfo:{company_id:"1",authorizer_appid:"",open_id:"",unionid:"",nickname:"",sex:0,city:"",country:"",province:"",language:"",headimgurl:"",user_id:""},deposit:0},activeName:"",infoLoad:!0,quanyiLoad:!1,orderLoad:!1,depositLoad:!1,transferLoad:!1,membercardLoad:!1,rightslogLoad:!1,pointLoad:!1,salespersonLoad:!1,registerSetting:""}},computed:{...(0,s.L8)(["isMicorMall"])},mounted(){this.$route.query.resource&&"member"==this.$route.query.resource?(this.activeName="order",this.orderLoad=!0,this.quanyiLoad=this.depositLoad=!1):(this.activeName=(0,P.go)()?"order":"info",this.infoLoad=!0,this.quanyiLoad=this.depositLoad=!1,this.orderLoad=(0,P.go)()),this.$route.query.user_id&&(this.user_id=this.$route.query.user_id),this.$route.query.mobile&&(this.preMobile=this.$route.query.mobile),this.$route.query.grade_id&&(this.grade_id=this.$route.query.grade_id),this.$route.query.orderRecords&&(this.orderRecords=this.$route.query.orderRecords),this.$route.query.currentPage&&(this.currentPage=this.$route.query.currentPage),this.getMember({user_id:this.user_id}),this.getRegisterSetting()},methods:{getMember(t){(0,i.getMember)(t).then(t=>{this.member=t.data.data})},getRegisterSetting(){(0,i.getMemberRegisterSetting)().then(t=>{delete t.data.data.content_agreement,this.registerSetting=t.data.data.setting})},handleClick(){switch(this.activeName){case"info":this.infoLoad=!0,this.salespersonLoad=this.quanyiLoad=this.pointLoad=this.rightslogLoad=this.transferLoad=this.membercardLoad=this.orderLoad=this.depositLoad=!1;break;case"right":this.quanyiLoad=!0,this.salespersonLoad=this.infoLoad=this.pointLoad=this.rightslogLoad=this.transferLoad=this.membercardLoad=this.orderLoad=this.depositLoad=!1;break;case"order":this.orderLoad=!0,this.salespersonLoad=this.infoLoad=this.pointLoad=this.rightslogLoad=this.transferLoad=this.membercardLoad=this.quanyiLoad=this.depositLoad=!1;break;case"deposit":this.depositLoad=!0,this.salespersonLoad=this.infoLoad=this.pointLoad=this.rightslogLoad=this.transferLoad=this.membercardLoad=this.quanyiLoad=this.orderLoad=!1;break;case"transfer":this.transferLoad=!0,this.salespersonLoad=this.infoLoad=this.pointLoad=this.rightslogLoad=this.depositLoad=this.orderLoad=this.membercardLoad=this.quanyiLoad=!1;break;case"membercard":this.membercardLoad=!0,this.salespersonLoad=this.infoLoad=this.pointLoad=this.rightslogLoad=this.transferLoad=this.depositLoad=this.orderLoad=this.quanyiLoad=!1;break;case"rightslog":this.rightslogLoad=!0,this.salespersonLoad=this.infoLoad=this.pointLoad=this.transferLoad=this.depositLoad=this.orderLoad=this.membercardLoad=this.quanyiLoad=!1;break;case"point":this.pointLoad=!0,this.salespersonLoad=this.infoLoad=this.rightslogLoad=this.transferLoad=this.depositLoad=this.orderLoad=this.membercardLoad=this.quanyiLoad=!1;break;case"salespersonlogs":this.salespersonLoad=!0,this.pointLoad=this.infoLoad=this.rightslogLoad=this.transferLoad=this.depositLoad=this.orderLoad=this.membercardLoad=this.quanyiLoad=!1}},goBack(){this.$router.go(-1)}}},Y=(0,l.A)(N,function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"section section-white content-padded"},[e("div",{staticClass:"clearfix heade-box"},[e("div",{staticClass:"f_l member-card-box"},[e("div",{staticClass:"member-card",style:{backgroundColor:t.member.cardInfo.color||"",backgroundImage:"url("+(t.wximageurl+t.member.gradeInfo.background_pic_url)+")",backgroundPosition:"center center"}},[e("img",{staticClass:"member-header",attrs:{src:t.member.wechatUserInfo.headimgurl||t.member.avatar,alt:""}}),e("div",{staticClass:"mobile-txt"},[e("span",[t._v(t._s(t.member.mobile))]),"1"==t.member.sex||"2"==t.member.sex?e("img",{staticClass:"icon",attrs:{src:"1"==t.member.sex?"@/assets/img/male_icon.png":"2"==t.member.sex?"@/assets/img/female_icon.png":""}}):t._e()]),t.member.vipgrade&&t.member.vipgrade.is_vip?e("div",{staticClass:"level-txt"},[t._v(" "+t._s(t.member.vipgrade.grade_name)+" ")]):t._e(),t.member.vipgrade&&t.member.vipgrade.is_vip?e("div",[t._v($t("hy1k3"," 截止","lang")+t._s(t.member.vipgrade.end_time)+$t("ciwwh3","到期 ","lang"))]):e("div",{staticClass:"level-txt"},[t._v(" "+t._s(t.member.gradeInfo.grade_name)+" ")])])]),e("div",{staticClass:"f_l member-info"},[e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("ewbd43","手机号","lang"))]),e("span",[t._v(t._s(t.member.mobile))])]),t.VERSION_SHUYUN()?t._e():e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("abxi9g4","会员卡号","lang"))]),t.member.user_card_code?e("span",[t._v(t._s(t.member.user_card_code))]):e("span",[t._v("--")])]),e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("atvjsv4","出生日期","lang"))]),t.member.birthday?e("span",[t._v(t._s(t.member.birthday))]):e("span",[t._v("--")])]),t.VERSION_SHUYUN()?t._e():e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("crb6xo4","所在城市","lang"))]),t.member.wechatUserInfo.country||t.member.wechatUserInfo.province?e("span",[t._v(t._s(t.member.wechatUserInfo.country)+" "+t._s(t.member.wechatUserInfo.province))]):e("span",[t._v("--")])]),e("div",{staticClass:"info-item"},[t.VERSION_SHUYUN()?t._e():e("span",{staticClass:"txt"},[t._v($t("feqn214","真实姓名","lang"))]),t.member.username?e("span",[t._v(t._s(t.member.username))]):e("span",[t._v("--")])]),e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("cen9u64","微信昵称","lang"))]),t.member.wechatUserInfo.nickname?e("span",[t._v(t._s(t.member.wechatUserInfo.nickname))]):e("span",[t._v("--")])]),t.VERSION_SHUYUN()?t._e():e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("cdea684","常用地址","lang"))]),t.member.address?e("span",[t._v(t._s(t.member.address))]):e("span",[t._v("--")])]),e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("e2y82q4","注册时间","lang"))]),t.member.created?e("span",[t._v(t._s(t._f("datetime")(t.member.created,"YYYY-MM-DD HH:mm:ss")))]):e("span",[t._v("--")])]),t.member.salesperson_info?.employee_number?e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("gdp4re4","绑定导购","lang"))]),t.member.created?e("span",[t._v(t._s(t.member.salesperson_info?.employee_number))]):e("span",[t._v("--")])]):t._e(),t.member.salesperson_info?.store_name?e("div",{staticClass:"info-item"},[e("span",{staticClass:"txt"},[t._v($t("gdyq8o4","绑定门店","lang"))]),t.member.created?e("span",[t._v(t._s(t.member.salesperson_info?.store_name))]):e("span",[t._v("--")])]):t._e()]),t.VERSION_IN_PURCHASE()?t._e():e("div",{staticClass:"f_r member-right"},[e("div",{staticClass:"right-item point-box"},[e("div",{staticClass:"item-title"},[t._v($t("l6uv2","积分","lang"))]),e("div",[t.member.point?e("span",[t._v(t._s(t.member.point))]):e("span",[t._v("0")])]),e("span",{staticClass:"item-footer"})]),e("div",{staticClass:"right-item discount-box"},[e("div",{staticClass:"item-title"},[t._v($t("hb632","折扣","lang"))]),e("div",[t.member.vipgrade&&1==t.member.vipgrade.is_vip?e("span",[t._v(t._s((100-t.member.vipgrade.discount)/10))]):t.member.gradeInfo&&0!=t.member.gradeInfo.privileges.discount_desc?e("span",[t._v(t._s(t.member.gradeInfo.privileges.discount_desc))]):e("span",[t._v("10")]),t._v($t("hfhk3"," 折 ","lang"))])])])])]),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.VERSION_SHUYUN()?t._e():e("el-tab-pane",{attrs:{label:$t("ac76vx4","会员详情","lang"),name:"info"}},[e("member-info",{attrs:{"user-info":t.member,"register-setting":t.registerSetting,"is-load":t.infoLoad}})],1),e("el-tab-pane",{attrs:{label:$t("acp7vm4","交易订单","lang"),name:"order"}},[e("order-list",{attrs:{"user-id":t.user_id,"is-load":t.orderLoad}})],1),t.VERSION_IN_PURCHASE()?t._e():e("el-tab-pane",{attrs:{label:$t("jr8kw77","付费会员卡记录","lang"),name:"membercard"}},[e("membercardList",{attrs:{info:t.member}})],1),t.VERSION_IN_PURCHASE()||t.VERSION_SHUYUN()?t._e():e("el-tab-pane",{attrs:{label:$t("fqcc0s4","积分记录","lang"),name:"point"}},[e("pointList")],1)],1),e("div",{staticClass:"text-center mt-4"},[e("el-button",{attrs:{type:"primary"},on:{click:t.goBack}},[t._v($t("m1m0m4"," 返回 ","lang"))])],1)],1)},[],!1,null,"09f3d248",null).exports}}]);