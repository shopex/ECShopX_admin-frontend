"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[3777],{23777:function(e,t,i){i.r(t),i.d(t,{default:function(){return k}});i(44114),i(18111),i(7588),i(61701),i(18237);var a=i(26456),s=i(17659);var l=i(27671),r=i(72505),n=i.n(r),o=i(51729),d=i.n(o);var c=n().create({adapter:e=>new Promise((t,i)=>{d()(e.url,e.params,(e,a)=>{e?i(e):t(a.result)})})}),h=(i(59467),i(94644)),p={name:"DaoDianZiti",data(){return{distributor_id:"",zitiList:[],finderData:[],finderUrl:"",frontPage:!0,setting:(0,h.createSetting)({actions:[{name:$t("lknd2","移除","lang"),key:"apply",type:"button",buttonType:"text",action:{handler:async([e])=>{if(this.distributor_id)await this.$api.pickuplocation.unbindZitiLocation({id:e.id,rel_distributor_id:this.distributor_id}),this.$refs.finder.refresh();else{const t=this.finderData.findIndex(t=>t.id==e.id);this.finderData.splice(t,1),this.zitiList=this.finderData,this.$nextTick(()=>{this.$refs.finder.refresh()})}}}}],columns:[{name:$t("nsy1p25","自提点名称","lang"),key:"name"},{name:$t("fb4g2","地址","lang"),render:(e,{row:t})=>e("span",{},`${t.province}${t.city}${t.area}${t.address}`)},{name:$t("gpkj3j4","联系电话","lang"),key:"contract_phone",width:"150px"}]})}},created(){const{distributor_id:e}=this.$route.query;e&&(this.finderUrl="/pickuplocation/list",this.finderData=void 0,this.frontPage=!1,this.distributor_id=e)},methods:{beforeSearch(e){return e={...e,rel_distributor_id:this.distributor_id}},afterSearch(e){const{list:t}=e.data.data;this.zitiList=t},async onSelectZiti(){const{data:e}=await this.$picker.zitiList({data:this.zitiList.map(e=>e.id)});if(this.distributor_id){const t=e.map(e=>e.id);await this.$api.pickuplocation.bindZitiLocation({id:t,rel_distributor_id:this.distributor_id}),this.$refs.finder.refresh()}else this.finderData=e,this.zitiList=e,this.$nextTick(()=>{this.$refs.finder.refresh()})}}},u=i(81656),m=(0,u.A)(p,function(){var e=this,t=e._self._c;return t("div",{staticClass:"daodianziti"},[t("el-button",{attrs:{type:"text"},on:{click:e.onSelectZiti}},[e._v($t("7y00ur5","选择自提点","lang"))]),t("SpFinder",{ref:"finder",attrs:{"no-selection":"","front-paging":e.frontPage,data:e.finderData,url:e.finderUrl,setting:e.setting,hooks:{beforeSearch:e.beforeSearch,afterSearch:e.afterSearch}}})],1)},[],!1,null,null,null).exports,f={name:"RefundGoodsAddress",props:["value"],data(){const e=this.$createElement;return{district:l,form:{name:"",regions_id:"",address:"",area_code:"",mobile:"",startTime:"",endTime:""},formList:[{label:$t("d29lkl5","退货点名称","lang"),key:"name",type:"input",className:"refund-name",width:"auto",placeholder:$t("8mpgnlh","请填写退货点名称便于买家理解和管理","lang")},{label:$t("d29xxe5","退货点地址","lang"),width:"auto",component:({key:t},i)=>e("div",{class:"refund-address"},[e("el-cascader",{attrs:{options:l},model:{value:i.regions_id,callback:e=>{this.$set(i,"regions_id",e)}}}),e("el-input",{class:"address",attrs:{placeholder:$t("aod7nb","请填写退货点的具体地址","lang")},model:{value:i.address,callback:e=>{this.$set(i,"address",e)}}})])},{label:$t("gpkj3j4","联系电话","lang"),width:"auto",component:({key:t},i)=>e("div",{class:"concat-mobile"},[e("el-input",{class:"input-area-code",attrs:{placeholder:$t("em7x2","区号","lang")},model:{value:i.area_code,callback:e=>{this.$set(i,"area_code",e)}}}),e("span",{class:"separator"},["~"]),e("el-input",{class:"input-mobile",attrs:{placeholder:$t("i2ho4xt","请填写准确的联系电话，便于买家联系（手机号时，区号可为空）","lang")},model:{value:i.mobile,callback:e=>{this.$set(i,"mobile",e)}}})])},{label:$t("gzyn0z4","营业时间","lang"),width:"auto",component:({key:t},i)=>e("div",{class:"time-block"},[e("el-time-select",{class:"input-start",attrs:{placeholder:$t("i7zt2q4","起始时间","lang"),"picker-options":{start:"00:00",step:"00:30",end:"23:59"}},model:{value:i.startTime,callback:e=>{this.$set(i,"startTime",e)}}}),e("span",{class:"separator"},["~"]),e("el-time-select",{class:"input-end",attrs:{placeholder:$t("gfi7qi4","结束时间","lang"),"picker-options":{start:"00:00",step:"00:30",end:"23:59"}},model:{value:i.endTime,callback:e=>{this.$set(i,"endTime",e)}}})])}]}},watch:{value:{immediate:!0,handler(e){this.form=e}}},created(){},methods:{}},_=(0,u.A)(f,function(){var e=this,t=e._self._c;return t("div",{staticClass:"refund-goods-address"},[t("div",{staticClass:"tip"},[e._v($t("no7yru22"," 退货点信息会在买家选择到店退货时展示，初次使用此功能时本店退货点默认为选中状态（可退货店铺列表内未展示），可在保存店铺信息后再次进入此页面移除。 ","lang"))]),t("SpForm",{ref:"form",attrs:{"show-message":"","label-width":"120px","form-list":e.formList,submit:!1},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)},[],!1,null,null,null).exports,g={name:"RefundGoodsStore",data(){return{finderData:[],setting:(0,h.createSetting)({actions:[{name:$t("lknd2","移除","lang"),key:"apply",type:"button",buttonType:"text",action:{handler:async([e])=>{const t=this.finderData.findIndex(t=>t.id==e.id);this.finderData.splice(t,1),this.$nextTick(()=>{this.$refs.finder.refresh()})}}}],columns:[{name:$t("cjqdxi4","店铺名称","lang"),key:"name",width:"700px"}]})}},created(){},mounted(){const{distributor_id:e}=this.$route.query;e&&this.fetchData()},methods:{async fetchData(){const{distributor_id:e}=this.$route.query,{list:t}=await this.$api.marketing.getAftersales({distributor_id:e,is_selected:1});this.finderData=t,this.$nextTick(()=>{this.$refs.finder.refresh()})},async onSelectShop(){const{distributor_id:e}=this.$route.query,t=this.finderData.map(e=>e.distributor_id),{data:i}=await this.$picker.afterSalesList({data:t,distributor_id:e});this.finderData=i,this.$nextTick(()=>{this.$refs.finder.refresh()})}}},b=(0,u.A)(g,function(){var e=this,t=e._self._c;return t("div",{staticClass:"refund-goods-store"},[t("div",{staticClass:"tip"},[e._v($t("aqr7vuy","本店订单买家发起退货退款申请时可选择此列表店铺的退货点完成到店退货。","lang"))]),t("div",{staticClass:"refund-store"},[t("el-button",{attrs:{type:"text"},on:{click:e.onSelectShop}},[e._v($t("ikyrsz4","选择店铺","lang"))]),t("SpFinder",{ref:"finder",attrs:{"no-selection":"","show-pager":!1,data:e.finderData,setting:e.setting}})],1)])},[],!1,null,null,null).exports,y={data(){const e=this.$createElement;let t=[{title:$t("mtmj2","自营","lang"),value:0}];return this.VERSION_STANDARD()||t.push({title:$t("epfj2","加盟","lang"),value:1}),{form:{distribution_type:0,merchant_id:"",shop_code:"",name:"",contact:"",mobile:"",contract_phone:"",startTime:"",endTime:"",is_delivery:!1,is_audit_goods:!1,auto_sync_goods:!1,is_require_subdistrict:!1,is_require_building:!1,logo:"",banner:"",lng:"121.418211",lat:"31.175317",regions_id:["310000","310100","310104"],address:"",is_dada:!1,is_self_delivery:!0,freight_time:1,business:"",is_ziti:!1,offline_aftersales:!1,offline_aftersales_address:{name:"",regions_id:"",address:"",area_code:"",mobile:"",startTime:"",endTime:""},offline_aftersales_other:!1,is_refund_freight:!1,wdt_shop_no:"",jst_shop_id:"",introduce:""},offline_freight_status:!1,formList:[{label:$t("cjx2pf4","店铺类型","lang"),type:"group",isShow:({key:e},t)=>this.IS_ADMIN()&&0==this.distributor_self},{label:$t("cjx2pf4","店铺类型","lang"),key:"distribution_type",type:"select",clearable:!1,options:t,isShow:({key:e},t)=>this.IS_ADMIN()&&0==this.distributor_self},{label:$t("cs29fz4","所属商户","lang"),key:"merchant_id",type:"select",component:({key:t},i)=>e("el-select",{directives:[{name:"scroll",value:()=>this.pageQuery.nextPage()}],class:[{"is-error":!i[t]}],attrs:{clearable:!0,filterable:!0,loading:this.remoteLoading,remote:!0,"remote-method":e=>this.onRemoteGetMerchant(e),placeholder:$t("fx9k4s8","输入商户名称搜索","lang")},on:{clear:()=>this.onRemoteGetMerchant(),focus:()=>this.onRemoteGetMerchant()},model:{value:i[t],callback:e=>{this.$set(i,t,e)}}},[this.merchantList.map((t,i)=>e("el-option",{key:`option-item__${i}`,attrs:{label:t.merchant_name,value:t.id}}))]),isShow:({key:e},t)=>1==t.distribution_type&&this.IS_ADMIN()&&0==this.distributor_self,validator:(e,t,i)=>{1!=this.form.distribution_type||t?i():i(new Error($t("2ene8o5","请选择商户","lang")))}},{label:$t("blh1h04","基础信息","lang"),type:"group"},{label:$t("ekkk43","店铺号","lang"),key:"shop_code",type:"input",display:"inline",placeholder:$t("cao3n0d","请输入店铺号(字母、数字)","lang"),required:!0,validator:(e,t,i)=>{t?/^[A-Za-z0-9\-]+$/.test(t)?i():i(new Error($t("t7ntiv8","请输入字母、数字","lang"))):i(new Error($t("jey0v07","店铺号不能为空","lang")))}},{label:$t("cjqdxi4","店铺名称","lang"),key:"name",type:"input",display:"inline",placeholder:$t("kzcmxd7","请输入店铺名称","lang"),required:!0,message:$t("3s8ie8","店铺名称不能为空","lang")},{label:$t("kn13rh5","联系人姓名","lang"),key:"contact",type:"input",display:"inline",disabled:()=>1==this.datapass_block,placeholder:$t("oczv5o8","请输入联系人姓名","lang"),required:!0,message:$t("fvkkcj7","联系人不能为空","lang")},{label:$t("gphnfh4","联系方式","lang"),key:"mobile",type:"input",display:"inline",disabled:()=>1==this.datapass_block,placeholder:$t("q6p5ge9","请输入联系人手机号","lang"),required:!0,message:$t("1cmovh8","联系方式不能为空","lang")},{label:$t("bct2dv4","固定座机","lang"),key:"contract_phone",type:"input",display:"inline",placeholder:$t("q65yd69","请输入联系人座机号","lang")},{label:$t("gjndro4","经营时间","lang"),display:"inline",component:({key:t},i)=>e("div",[e("el-time-select",{class:"start-time",attrs:{placeholder:$t("i7zt2q4","起始时间","lang"),"picker-options":{start:"00:00",step:"00:30",end:"23:59"}},model:{value:i.startTime,callback:e=>{this.$set(i,"startTime",e)}}}),e("span",{class:"separator"},["-"]),e("el-time-select",{class:"end-time",attrs:{placeholder:$t("gfi7qi4","结束时间","lang"),"picker-options":{start:"00:00",step:"00:30",end:"23:59",minTime:i.startTime}},model:{value:i.endTime,callback:e=>{this.$set(i,"endTime",e)}}})])},{label:$t("d8rzby4","是否快递","lang"),key:"is_delivery",type:"switch",display:"inline"},{label:$t("bzqdrm4","审核商品","lang"),key:"is_audit_goods",type:"switch",display:"inline",width:"360px",tip:$t("vsopi2s","开启后，店铺添加的自有商品，需要平台审核通过后才可以上架","lang"),isShow:({key:e},t)=>!this.VERSION_STANDARD()&&0==t.distribution_type},{label:$t("b1rr2s4","同步商品","lang"),key:"auto_sync_goods",type:"switch",display:"inline",tip:$t("vlnmn89","自动同步商品至店铺","lang"),isShow:({key:e},t)=>this.VERSION_STANDARD()&&!this.IS_DISTRIBUTOR()&&0==this.distributor_self},{label:$t("hsnmkr4","街道居委","lang"),key:"is_require_subdistrict",type:"switch",display:"inline",tip:$t("ffaur7c","下单是否需要选择街道居委","lang")},{label:$t("dnqms34","楼号房号","lang"),key:"is_require_building",type:"switch",display:"inline",tip:$t("9ltom5c","下单是否需要填写楼号房号","lang")},{label:$t("cjqufg4","店铺图片","lang"),type:"group",tip:$t("2ijpvkm","（只能上传jpg/png文件，且不超过2M）","lang")},{label:$t("rjuohe6","店铺Logo","lang"),key:"logo",display:"inline",component:({key:t},i)=>e("SpImagePicker",{model:{value:i[t],callback:e=>{this.$set(i,t,e)}}})},{label:$t("cjxw2u4","店铺背景","lang"),key:"banner",display:"inline",component:({key:t},i)=>e("SpImagePicker",{model:{value:i[t],callback:e=>{this.$set(i,t,e)}}})},{label:$t("cjplxg4","店铺位置","lang"),type:"group",tip:$t("uaoq3jy","（店铺定位后保存店铺经纬度，才可以开启自提，否则店铺不支持自提功能）","lang")},{label:$t("y0gi925","店铺经纬度","lang"),component:({key:t},i)=>e("div",{class:"lng-lat-block"},[e("el-input",{attrs:{readonly:!0,placeholder:$t("m37b2","经度","lang")},model:{value:i.lng,callback:e=>{this.$set(i,"lng",e)}}}),e("span",{class:"separator"},["-"]),e("el-input",{attrs:{readonly:!0,placeholder:$t("m2d62","纬度","lang")},model:{value:i.lat,callback:e=>{this.$set(i,"lat",e)}}})])},{label:$t("bh9udz4","地理位置","lang"),key:"address",width:"1000px",component:({key:t},i)=>e("div",{class:"address-block"},[e("el-cascader",{class:"regions",attrs:{options:l},model:{value:i.regions_id,callback:e=>{this.$set(i,"regions_id",e)}}}),e("el-input",{class:["address",{"is-error":!i.address}],attrs:{placeholder:$t("m53sppe","请输入详细地址（去除省市县）","lang")},model:{value:i.address,callback:e=>{this.$set(i,"address",e)}}}),e("el-input",{attrs:{placeholder:$t("micr73","门牌号","lang")},model:{value:i.house_number,callback:e=>{this.$set(i,"house_number",e)}}}),e("el-button",{attrs:{type:"primary"},on:{click:this.searchKeyword}},[$t("d5by0p4","搜索定位","lang")])]),validator:(e,t,i)=>{this.form.address?i():i(new Error($t("vt7g3k8","详细地址不能为空","lang")))}},{label:"",component:({key:t},i)=>e("div",{attrs:{id:"qqmap_container"}})},{label:$t("iqxlgk4","送货上门","lang"),type:"group",tip:$t("zgh8cry","（需先选择店铺地理位置，系统根据店铺位置判断该地区是否支持送货上门）","lang"),isShow:this.dadaEnable},{label:$t("iqxlgk4","送货上门","lang"),key:"is_dada",type:"switch",width:"auto",tip:$t("yks1ed13","开启后有店铺订单时需要该店铺人员手动接单，接单后系统会自动在达达/闪送平台下单","lang"),isShow:this.dadaEnable},{label:$t("ir1bng4","送货方式","lang"),key:"is_self_delivery",isShow:({key:e},t)=>t.is_dada,component:({key:t},i)=>e("div",{style:"margin-top: 14px;display:flex"},[e("el-radio",{attrs:{label:!0},model:{value:i[t],callback:e=>{this.$set(i,t,e)}}},[$t("9mdraq5","商家自配送","lang")]),e("el-radio",{attrs:{label:!1,disabled:!this.dadaEnable},model:{value:i[t],callback:e=>{this.$set(i,t,e)}}},[$t("c9k2vf5","达达同城配","lang")])])},{key:"freight_time",isShow:({key:e},t)=>t.is_self_delivery&&t.is_dada,component:({key:t},i)=>e("div",{style:"margin-left: 27px;display:flex"},[$t("nw20997","立即配送，预计","lang"),e("el-input-number",{attrs:{placeholder:$t("2jbrwj5","请输入内容","lang"),step:1,min:1},model:{value:i[t],callback:e=>{this.$set(i,t,e)}}}),$t("6vdboxi","小时后送达（下单时间往后延多少小时）","lang")])},{label:$t("a7c0hj4","业务类型","lang"),key:"business",type:"select",options:[],isShow:({key:e},t)=>!t.is_self_delivery&&t.is_dada,validator:(e,t,i)=>{!this.form.is_self_delivery&&t?.is_dada?t?i():i(new Error($t("3im77h6","业务类型必填","lang"))):i()}},{label:$t("arnyz14","到店自提","lang"),type:"group"},{label:$t("arnyz14","到店自提","lang"),key:"is_ziti",type:"switch",width:"auto",tip:$t("246m0k1n","启用到店自提功能后，买家下单时可选择下方地址自提，下单后你需要尽快将商品配送至指定自提点；下方自提地址共享该店铺库存。","lang")},{label:"",width:"1000px",component:({key:t},i)=>e(m,{ref:"daoDianZiti"}),isShow:({key:e},t)=>t.is_ziti},{label:$t("arqle64","到店退货","lang"),type:"group"},{label:$t("dezori4","本店订单","lang"),key:"offline_aftersales",type:"switch",width:"auto",tip:$t("krk1jl1n","启用后本店订单买家发起退货退款申请时可选择到店退货，关闭时本店订单仅可使用快递退货；商家发起的售后订单不受此规则限制。","lang")},{label:$t("a90iu15","本店退货点","lang"),width:"auto",component:({key:t},i)=>e(_,{model:{value:i.offline_aftersales_address,callback:e=>{this.$set(i,"offline_aftersales_address",e)}}})},{label:$t("8858mf5","可退货店铺","lang"),width:"1000px",component:({key:t},i)=>e(b,{ref:"refundGoodsStore",model:{value:i.offline_aftersales_address,callback:e=>{this.$set(i,"offline_aftersales_address",e)}}})},{label:$t("xtpzze6","其他店铺订单","lang"),key:"offline_aftersales_other",type:"switch",width:"auto",tip:$t("yce88l1l","启用后其他店铺在设置可退货店铺时可选择本店（即本店可接收其他店铺订单到店退货）；商家发起的售后订单不受此规则限制。","lang")},{label:$t("3hif6xc","消费者退货退款时可退运费","lang"),key:"is_refund_freight",type:"switch",disabled:()=>this.offline_freight_status,width:"auto",tip:$t("5svaayl","启用后本店订单买家发起退货退款时可退运费。","lang")},{label:$t("xzufd26","旺店通ERP","lang"),type:"group"},{label:"shopNo",key:"wdt_shop_no",type:"input",display:"inline",placeholder:""},{label:$t("ckptcg6","聚水潭ERP","lang"),type:"group"},{label:$t("cjxhyc4","店铺编号","lang"),key:"jst_shop_id",type:"input",display:"inline",placeholder:""},{label:$t("cjpip14","店铺介绍","lang"),type:"group"},{label:$t("cjpip14","店铺介绍","lang"),key:"introduce",type:"textarea",placeholder:"",width:"1000px"}],merchantList:[],remoteLoading:!1,regions:l,submitLoading:!1,searchService:null,map:null,mapMarker:null,datapass_block:0,distributor_self:0,dadaEnable:!1}},created(){const{distributor_type:e}=this.$route.query;this.pageQuery=new s.A({pageSize:10,fetch:this.getMerchantList}),this.distributor_self="distributor_self"===e?1:0,this.getDadaInfo(),this.getStoreInfo(),this.getOrderSetting()},mounted(){},methods:{async getOrderSetting(){const e=await this.$api.trade.getOrderSetting();this.offline_freight_status=1!=e.is_refund_freight},async getMerchantList({page:e,pageSize:t},i){let s={pageSize:t,page:e};(0,a.Im)(i)||(s={...s,merchant_name:i}),1==e&&(this.remoteLoading=!0);const{list:l,total_count:r}=await this.$api.marketing.getMerchantsList(s);1==e&&(this.remoteLoading=!1),this.pageQuery.setTotal(r),this.merchantList=this.merchantList.concat(l)},onRemoteGetMerchant(e){this.form.merchant_id||(this.merchantList=[],this.pageQuery.reset(e))},async searchKeyword(){const{regions_id:e,address:t}=this.form;if(0==e.length)return void this.$message.error($t("2en5hb5","请选择地区","lang"));if(!t)return void this.$message.error($t("mx64re7","请输入具体位置","lang"));const[i,s,r]=(0,a.SK)(e,l),{location:n}=await c({method:"get",url:`https://apis.map.qq.com/ws/geocoder/v1?address=${i}${s}${r}${t}&key=PSPBZ-KQ5CW-CSGRF-ON2S4-K2HQJ-XEBQG&output=jsonp`});this.form.lng=n.lng,this.form.lat=n.lat;const o=new qq.maps.LatLng(n.lat,n.lng);this.map.setCenter(o),this.mapMarker.setPosition(o)},async getDadaInfo(){const{business_list:e,is_open:t}=await this.$api.dada.getDadaInfo(),i=Object.keys(e).reduce((t,i,a)=>t.concat({value:Number(i),title:e[i]}),[]);this.formList.forEach(e=>{"business"==e.key&&(e.options=i)}),this.dadaEnable="1"===t},async getShansongInfo(){const{business_list:e,is_open:t}=await this.$api.dada.getShansongInfo(),i=Object.keys(e).reduce((t,i,a)=>t.concat({value:Number(i),title:e[i]}),[]);this.formList.forEach(e=>{"business"==e.key&&(e.options=i)}),this.dadaEnable="1"===t},async getStoreInfo(){const{distributor_id:e}=this.$route.query;if(e||this.IS_DISTRIBUTOR()){const t=await this.$api.marketing.getDistributorInfo({distributor_id:e}),[i,s]=t.hour.split("-");let l="",r="",n="",o="";if((0,a.Gv)(t.offline_aftersales_address)){const{hours:e,mobile:i}=t.offline_aftersales_address;let[a,s]=e.split("-");if(l=a,r=s,i.indexOf("-")>-1){let[e,i]=t.offline_aftersales_address.mobile.split("-");n=e,o=i}else o=i}this.datapass_block=t.datapass_block,this.form={distribution_type:t.distribution_type,merchant_id:t.merchant_id,shop_code:t.shop_code,name:t.name,contact:t.contact,mobile:t.mobile,contract_phone:t.contract_phone,startTime:i,endTime:s,is_delivery:t.is_delivery,is_audit_goods:t.is_audit_goods,auto_sync_goods:t.auto_sync_goods,is_require_subdistrict:t.is_require_subdistrict,is_require_building:t.is_require_building,logo:t.logo,banner:t.banner,lng:t.lng,lat:t.lat,regions_id:t.regions_id,address:t.address,house_number:t.house_number,is_dada:1==t.is_dada||t.is_self_delivery,is_self_delivery:t.is_self_delivery,freight_time:t.freight_time,business:t.business,is_ziti:t.is_ziti,offline_aftersales:1===t.offline_aftersales,offline_aftersales_other:1===t.offline_aftersales_other,is_refund_freight:1==t.is_refund_freight,offline_aftersales_address:{name:t.offline_aftersales_address.name,regions_id:t.offline_aftersales_address.regions_id,address:t.offline_aftersales_address.address,area_code:n,mobile:o,startTime:l,endTime:r},wdt_shop_no:t.wdt_shop_no,jst_shop_id:t.jst_shop_id,introduce:t.introduce},t.merchant_name&&this.pageQuery.reset(t.merchant_name)}await new Promise((e,t)=>{window.init=()=>{e()};const i=document.createElement("script");i.type="text/javascript",i.src="//map.qq.com/api/js?v=2.exp&key=PSPBZ-KQ5CW-CSGRF-ON2S4-K2HQJ-XEBQG&callback=init",document.body.appendChild(i)}),this.qqmapinit()},async qqmapinit(){const{lat:e,lng:t}=this.form,i=new qq.maps.LatLng(e,t);this.map=new qq.maps.Map(document.getElementById("qqmap_container"),{center:i,zoom:13}),this.mapMarker=new qq.maps.Marker({position:i,map:this.map})},handleCancel(){this.$router.go(-1)},async onFormSubmit(){try{await this.$refs.form.handleSubmit(),this.onFormSave()}catch(e){}},async onFormSave(){this.submitLoading=!0;const{distributor_id:e,distributor_type:t}=this.$route.query,{offline_aftersales_address:i}=this.form,{regions_id:s,startTime:r,endTime:n}=i,[o,d,c]=(0,a.SK)(s,l),h={...this.form,is_refund_freight:this.form.is_refund_freight?1:0,distributor_self:this.distributor_self,regions:(0,a.SK)(this.form.regions_id,l),hour:`${this.form.startTime}-${this.form.endTime}`,offline_aftersales_address:{...i,regions:[o,d,c],hours:`${r}-${n}`,province:o,city:d,area:c},offline_aftersales_distributor_id:this.$refs.refundGoodsStore.finderData.map(e=>e.distributor_id)};0==this.form.distribution_type?delete h.merchant_id:delete h.is_audit_goods,this.form.is_dada?this.form.is_self_delivery?(h.is_dada=0,h.is_self_delivery=!0):(h.is_dada=1,h.is_self_delivery=!1):(h.is_dada=0,h.is_self_delivery=!1);try{if(e)await this.$api.marketing.updateDistributorInfo(e,h),this.submitLoading=!1,this.$message.success($t("a5s3a56","修改店铺成功","lang"));else{const e=this.$refs.daoDianZiti.finderData.map(e=>e.id);await this.$api.marketing.saveDistributorInfo({...h,pickup_location:e}),this.submitLoading=!1,this.$message.success($t("yikvxp6","保存店铺成功","lang"))}this.IS_DISTRIBUTOR()||this.$router.go(-1)}catch(e){this.submitLoading=!1}}}},$=(0,u.A)(y,function(){var e=this,t=e._self._c;return t("SpPage",{staticClass:"merchant-store"},[t("SpForm",{ref:"form",attrs:{"show-message":"","label-width":"100px","form-list":e.formList,submit:!1},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}}),t("div",{staticClass:"footer-container"},[t("el-button",{nativeOn:{click:function(t){return e.handleCancel.apply(null,arguments)}}},[e._v($t("fiqa3"," 取消","lang"))]),!e.VERSION_STANDARD()||!e.IS_DISTRIBUTOR()&&e.VERSION_STANDARD()?t("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.onFormSubmit}},[e._v(" "+e._s(e.submitLoading?$t("f04493","提交中","lang"):$t("e32z2","保存","lang"))+" ")]):e._e()],1)],1)},[],!1,null,"aae54d5c",null),k=$.exports}}]);