"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8677],{38677:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});a(18111),a(20116);var r=a(95353),l=a(77825),s=a(33318),o={mixins:[l.Ay,l.v8],data(){const e={create_time:"",mobile:void 0,orderId:void 0,receipt_type:void 0};return{initialParams:e,activeName:"all",tabList:[{name:$t("en402","全部","lang"),activeName:"all"},{name:$t("d3fjv14","支付完成","lang"),activeName:"success"},{name:$t("flmib3","未支付","lang"),activeName:"notpay"}],datapass_block:1,loading:!1,params:{...e},downloadView:!1,downloadUrl:"",downloadName:"",distributionType:s.as}},computed:{...(0,r.L8)(["wheight"])},mounted(){this.fetchList()},methods:{fitlerPayType(e,t){return e?s.CV[e]:s.CV[t]},fnPath(){return"merchant"==this.$store.getters.login_type?"/merchant/order/order-manage/order-list/detail":"distributor"==this.$store.getters.login_type?"/shopadmin/order/order-manage/order-list/detail":-1===this.$route.path.indexOf("servicetrade")?"/order/order-manage/order-list/detail":"/order/servicetrade/tradeservice/detail"},dateStrToTimeStamp(e){return Date.parse(new Date(e))/1e3},dateTransfer(e,t){let a,r;return e.length>0&&(a=this.dateStrToTimeStamp(e[0]+" 00:00:00"),r=this.dateStrToTimeStamp(e[1]+" 23:59:59")),t?{date_begin:a,date_end:r}:{time_start_begin:a,time_start_end:r}},onReset(){this.params={...this.initialParams},this.onSearch()},onSearch(){this.page.pageIndex=1,this.$nextTick(()=>{this.fetchList()})},getParams(e){return{...this.dateTransfer(this.params.create_time,e),mobile:this.params.mobile||void 0,orderId:this.params.orderId||void 0,status:this.params.status,receipt_type:this.params.receipt_type}},handleTabClick(e,t){this.activeName=e.name,this.params.status="all"==e.name?"":e.name,this.onSearch()},getDistributionType({receipt_type:e}){const t=s.as.find(t=>t.value==e);if(t)return t.title},async fetchList(){this.loading=!0;const{pageIndex:e,pageSize:t}=this.page;let a={page:e,pageSize:t,...this.getParams()};const{list:r,total_count:l,datapass_block:s}=await this.$api.trade.getTradeList(a);this.tableList=r,this.page.total=l,this.datapass_block=s,this.loading=!1},async exportData(){const{status:e,url:t,filename:a}=await this.$api.trade.tradeExport({...this.getParams(!0)});if(e)return this.$message({type:"success",message:$t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")}),void this.$export_open("tradedata");t?(this.downloadUrl=t,this.downloadName=a,this.downloadView=!0):this.$message({type:"error",message:$t("d17rj2j","无内容可导出 或 执行失败，请检查重试","lang")})}}},n=o,i=(0,a(81656).A)(n,function(){var e=this,t=e._self._c;return t("SpPage",[t("div",{staticClass:"page-body"},[t("SpFilterForm",{attrs:{model:e.params},on:{onSearch:e.onSearch,onReset:e.onReset}},[t("SpFilterFormItem",{attrs:{prop:"create_time",label:$t("e8915d5","日期范围:","lang")}},[t("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy/MM/dd",placeholder:$t("to1gvf6","选择日期范围","lang")},model:{value:e.params.create_time,callback:function(t){e.$set(e.params,"create_time",t)},expression:"params.create_time"}})],1),t("SpFilterFormItem",{attrs:{prop:"mobile",label:$t("clovs3","单号:","lang")}},[t("el-input",{attrs:{placeholder:$t("m9o5ew8","手机号/交易单号","lang")},model:{value:e.params.mobile,callback:function(t){e.$set(e.params,"mobile",t)},expression:"params.mobile"}})],1),t("SpFilterFormItem",{attrs:{prop:"orderId",label:$t("hymdzq4","订单号:","lang")}},[t("el-input",{attrs:{placeholder:$t("kuwys3","订单号","lang")},model:{value:e.params.orderId,callback:function(t){e.$set(e.params,"orderId",t)},expression:"params.orderId"}})],1),t("SpFilterFormItem",{attrs:{prop:"receipt_type",label:$t("igqeuo5","配送方式:","lang")}},[t("el-select",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:e.params.receipt_type,callback:function(t){e.$set(e.params,"receipt_type",t)},expression:"params.receipt_type"}},e._l(e.distributionType,function(e){return t("el-option",{key:e.value,attrs:{size:"mini",label:e.title,value:e.value}})}),1)],1)],1),t("div",{staticClass:"action-container"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.exportData}},[e._v($t("efepu4"," 导出 ","lang"))])],1),t("el-dialog",{attrs:{title:$t("yg3h485","交易单下载","lang"),visible:e.downloadView,"close-on-click-modal":!1},on:{"update:visible":function(t){e.downloadView=t}}},[e.downloadUrl?[t("a",{attrs:{href:e.downloadUrl,download:""}},[e._v(e._s(e.downloadName))])]:e._e()],2),t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabList,function(a,r){return t("el-tab-pane",{key:r,attrs:{label:a.name,name:a.activeName}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableList,border:"",height:e.wheight-140}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[t("el-form-item",{attrs:{label:$t("hynsc64","订单号：","lang")}},["membercard"!=a.row.tradeSourceType?t("router-link",{attrs:{to:{path:e.fnPath(),query:{orderId:a.row.orderId,resource:"/mall/trade/payment"}}}},[e._v(" "+e._s(a.row.orderId)+" ")]):t("span",[e._v(e._s(a.row.orderId))])],1),t("el-form-item",{attrs:{label:$t("k6rohx5","支付方式：","lang")}},[t("span",[e._v(e._s(e.fitlerPayType(a.row.payChannel,a.row.payType)))])]),t("el-form-item",{attrs:{label:$t("cr2aoj4","总金额：","lang")}},[t("span",[e._v(e._s(a.row.curFeeSymbol)+e._s(a.row.totalFee/100))])]),e.VERSION_IN_PURCHASE()?e._e():t("el-form-item",{attrs:{label:$t("x2efx65","优惠金额：","lang")}},[a.row.discountInfo?t("el-popover",{attrs:{trigger:"hover",placement:"top"}},[e._l(a.row.discountInfo,function(r){return t("div",{key:r.orderId},[r.discount_fee?t("div",[r.coupon_code?t("p",[e._v($t("xbvc5z5","优惠券码：","lang")+e._s(r.coupon_code))]):e._e(),r.member_card_code?t("p",[e._v($t("yvo5cq5","会员卡号：","lang")+e._s(r.member_card_code))]):e._e(),t("p",[e._v($t("xbtktr5","优惠原因：","lang")+e._s(r.info))]),t("p",[e._v($t("x9362l5","优惠方案：","lang")+e._s(r.rule))]),t("p",[e._v($t("hwyjay6"," 优惠金额：","lang")+e._s(a.row.curFeeSymbol)+e._s(r.discount_fee/100)+$t("ehct3"," 元 ","lang"))]),t("hr")]):e._e()])}),t("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(a.row.discountFee/100)+$t("dtml2","元 ","lang"))])],2):e._e()],1)],1)]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("c0hmu3","交易单","lang"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"order-num"},[e._v(" "+e._s(a.row.tradeId)+" "),t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.tradeId,expression:"scope.row.tradeId",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})])],1),"0"!==a.row.distributorId?t("div",{staticClass:"order-store"},[t("el-tooltip",{attrs:{effect:"dark",content:$t("ekkkq3","店铺名","lang"),placement:"top-start"}},[t("i",{staticClass:"el-icon-office-building"})]),e._v(" "+e._s(a.row.distributor_name)+" ")],1):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("acj6ct4","交易时间","lang"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("datetime")(t.row.timeStart,"YYYY-MM-DD HH:mm:ss"))+" ")]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("hym7z54","订单信息","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"order-num"},[t("el-tooltip",{attrs:{effect:"dark",content:$t("gphnfh4","联系方式","lang"),placement:"top-start"}},[t("i",{staticClass:"el-icon-mobile"})]),e._v(" "+e._s(a.row.mobile)+" "),0==e.datapass_block?t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.mobile,expression:"scope.row.mobile",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})]):e._e()],1),t("div",{staticClass:"order-time"},[e._v($t("cxglb3","商品：","lang")+e._s(a.row.body))])]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("g0l62","实付","lang"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v($t("eec744"," 实付：","lang")),"point"==a.row.payType?t("span",{staticClass:"mark"},[e._v(e._s(a.row.payFee)+$t("lul33"," 积分","lang"))]):t("span",{staticClass:"mark"},[t("span",{staticClass:"cur"},[e._v(e._s(a.row.curFeeSymbol))]),e._v(e._s(a.row.payFee/100))])])]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("d3h9kv4","支付方式","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e.fitlerPayType(a.row.payChannel,a.row.payType)))])]}}],null,!0)}),t("el-table-column",{attrs:{width:"100",label:$t("hyxqu74","订单金额","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["point"==a.row.payType?[t("span",[e._v(e._s(a.row.payFee)+$t("lul33"," 积分","lang"))])]:[a.row.curPayFee?t("span",[t("span",{staticClass:"cur"},[e._v("￥")]),e._v(e._s(a.row.curPayFee/100))]):t("span",[t("span",{staticClass:"cur"},[e._v(e._s(a.row.curFeeSymbol))]),e._v(e._s(a.row.totalFee/100))])]]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("ixcclm4","配送方式","lang")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDistributionType(t.row))+" ")]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("lzfqd3","配送费","lang")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.self_delivery_fee&&t.row.self_delivery_fee/100+$t("g1v1","元","lang"))+" ")]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("lz4hw3","配送员","lang")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.self_delivery_operator_name)+" ")]}}],null,!0)}),t("el-table-column",{attrs:{prop:"mobile",label:$t("bucfl3","业务员","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(a.row.salesman_mobile)+" "),0==e.datapass_block?t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.salesman_mobile,expression:"scope.row.salesman_mobile",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})]):e._e()]}}],null,!0)}),"merchant"==e.$store.getters.login_type||e.VERSION_IN_PURCHASE()?e._e():t("el-table-column",{attrs:{width:"60",label:$t("j1uo2","汇率","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.curFeeRate))])]}}],null,!0)}),t("el-table-column",{attrs:{width:"100",label:$t("d3jhas4","支付状态","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["SUCCESS"==a.row.tradeState?t("el-tag",{attrs:{type:"success",size:"mini"}},[e._v($t("51yl7c6"," 支付成功 ","lang"))]):e._e(),"NOTPAY"==a.row.tradeState?t("el-tag",{attrs:{size:"mini"}},[e._v($t("dx7srx5"," 未支付 ","lang"))]):e._e(),"CLOSED"==a.row.tradeState?t("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v($t("coswvo5"," 已关闭 ","lang"))]):e._e(),"REVOKED"==a.row.tradeState?t("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v($t("crly9e5"," 已撤销 ","lang"))]):e._e(),"PAYERROR"==a.row.tradeState?t("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v($t("52zet96"," 支付失败 ","lang"))]):e._e(),"REFUND_PROCESS"==a.row.tradeState?t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v($t("svi31v7"," 退款处理中 ","lang"))]):e._e(),"REFUND_SUCCESS"==a.row.tradeState?t("el-tag",{attrs:{type:"info",size:"mini"}},[e._v($t("nvk9cj6"," 退款成功 ","lang"))]):e._e(),"REFUND_FAIL"==a.row.tradeState?t("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v($t("nujfqm6"," 退款失败 ","lang"))]):e._e()]}}],null,!0)})],1),t("div",{staticClass:"content-center content-padded"},[t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":e.page.pageIndex,"page-sizes":[20,30,50],total:e.page.total,"page-size":e.params.pageSize},on:{"update:currentPage":function(t){return e.$set(e.page,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.page,"pageIndex",t)},"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)],1)}),1)],1)])},[],!1,null,"47c5193b",null).exports}}]);