"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[3131],{63131:function(e,t,a){a.r(t),a.d(t,{default:function(){return r}});var n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tip-info"},[t("p",[e._v($t("flzk9x1f"," 上传文件如果有处理失败的行数后将会生成错误文件，请及时查看错误信息修改后重新下载，错误描述文件只保留","lang")),t("strong",[e._v($t("1j7p3","15天","lang"))]),e._v("。 ")]),t("p",[e._v($t("ouzm2","超过","lang")),t("strong",[e._v($t("1j7p3","15天","lang"))]),e._v($t("84meojk","的错误描述文件将会删除，不再提供下载查看","lang"))])])}],i=a(22541),l=a(26456),o=a(59025),s={data(){return{finderSetting:(0,i.createSetting)({columns:[{name:$t("a6fdb94","上传文件","lang"),key:"file_name"},{name:$t("a6ftzo4","上传时间","lang"),key:"created_date",formatterType:"dateTime",width:180},{name:$t("d4zx3r4","文件大小","lang"),key:"file_size_format",width:100},{name:$t("bpqivh4","处理状态","lang"),key:"handle_status",width:120,formatter:(e,t,a)=>({wait:$t("fy7x7i4","等待处理","lang"),processing:$t("dljhn3","处理中","lang"),finish:$t("bpmlfq4","处理完成","lang")}[e])},{name:$t("w8vqkk6","处理完成时间","lang"),key:"finish_date",width:180},{name:$t("bpnma94","处理成功","lang"),key:"handle_message",width:80,formatter:(e,t,a)=>e.successLine>0?`${e.successLine}${$t("qx81","行","lang")}`:""},{name:$t("bpmfiu4","处理失败","lang"),key:"handle_message",render:(e,t)=>e("div",{style:{color:"#f56c6c"}},t.row.handle_message.errorLine>0?[e("span",{style:{color:"#f56c6c"}},`${t.row.handle_message.errorLine}${$t("qx81","行","lang")}`),e("el-button",{attrs:{class:"ml-2"},props:{type:"text"},on:{click:async()=>{const e=await this.$api.common.exportUploadErrorFile(t.row.id,{file_type:t.row.file_type});e.file?(0,l.PE)(e.file,e.name):this.$message.error($t("yndnt89","没有相关数据可导出","lang"))}}},$t("ols2cn6","下载错误详情","lang"))]:[])}]}),loading:!1,uploadList:[]}},methods:{beforeSearch(e){return e={...e,file_type:"community_chief"}},async uploadHandleChange(e,t){const a={isUploadFile:!0,file_type:"community_chief",file:e.raw};await this.$api.common.handleUploadFile(a),this.$message.success($t("dn5eu39","上传成功，等待处理","lang")),this.$refs.finder.refresh(!0)},async onDownLoadTemplate(){const e=await this.$api.common.exportUploadTemplate({file_type:"community_chief",file_name:$t("m90zfj6","上传团长信息","lang")});e.file?(0,l.PE)(e.file,e.name):this.$message.error($t("yndnt89","没有相关数据可导出","lang"))},getUploadList(){this.loading=!0;let e={file_type:this.activeName,page:this.page,pageSize:this.pageSize};(0,o.getUploadLists)(e).then(e=>{this.uploadList=e.data.data.list,this.total_count=e.data.data.total_count,this.loading=!1})}}},r=(0,a(81656).A)(s,function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("div",{staticClass:"action-container"},[t("el-upload",{attrs:{action:"","on-change":e.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}},[t("el-button",{attrs:{type:"primary"}},[e._v($t("unjubc6"," 点击上传 ","lang"))])],1),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onDownLoadTemplate()}}},[e._v($t("gb8vax6"," 下载模版 ","lang"))])],1),t("SpFinder",{ref:"finder",attrs:{"no-selection":"",url:"/espier/upload_files","row-actions-align":"left","row-actions-fixed-align":"left","row-actions-width":"120px","other-config":{height:400},"fixed-row-action":!0,setting:e.finderSetting,hooks:{beforeSearch:e.beforeSearch}}})],1)},n,!1,null,null,null).exports}}]);