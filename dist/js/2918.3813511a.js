"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2918],{12918:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});var i=a(95353),s=a(87378),r=a(5748),n=a(77825),l={components:{sideBar:a(71196).A,imgPicker:s.default},mixins:[n.v8],data(){return{form:{attribute_type:"brand",attribute_id:"",attribute_name:"",image_url:""},params:{attribute_type:"brand",attribute_name:""},list:[],loading:!1,imgDialog:!1,isGetImage:!1,imgIndex:0,brand_name:"",total_count:0,show_sideBar:!1}},mounted(){this.fetchList()},methods:{handleDelete(t){this.$confirm($t("hb55yv8","确认删除该品牌？","lang")).then(e=>{(0,r.deleteGoodsAttr)(t.row.attribute_id).then(e=>{this.list.splice(t.$index,1),this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")})})}).catch(t=>{})},handleNew(){this.show_sideBar=!0,this.resetData()},resetData(){this.form={attribute_id:"",attribute_type:"brand",attribute_name:"",image_url:""}},handleEdit(t){this.show_sideBar=!0,this.form={attribute_id:t.attribute_id,attribute_type:t.attribute_type,attribute_name:t.attribute_name,image_url:t.image_url}},save(){this.form.attribute_id?(0,r.updateGoodsAttr)(this.form.attribute_id,this.form).then(t=>{this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")}),this.fetchList()}):(0,r.addGoodsAttr)(this.form).then(t=>{this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")}),this.page.pageIndex=1,this.resetData(),this.fetchList()})},fetchList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let a={page:t,pageSize:e,...this.params};(0,r.getGoodsAttr)(a).then(t=>{this.list=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})},handleImgChange(t){this.imgDialog=!0,this.isGetImage=!0,this.imgIndex=t.$index},handleImgPicker(){this.imgDialog=!0,this.isGetImage=!0},pickImg(t){this.form.image_url=t.url,this.imgDialog=!1},closeImgDialog(){this.imgDialog=!1,this.isGetImage=!1},syncBrand(){(0,r.syncBrand)().then(t=>{1==t.data.data.status?this.$message({type:"success",message:$t("lgxi507","已加入执行队列","lang")}):this.$message({type:"error",message:$t("b1sq7h4","同步失败","lang")})})}},computed:{...(0,i.L8)(["wheight"])}},o=(0,a(81656).A)(l,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"attribute_name",label:$t("8zt1mc5","品牌名称:","lang")}},[e("el-input",{attrs:{placeholder:$t("md3b1l7","请输入品牌名称","lang")},model:{value:t.params.attribute_name,callback:function(e){t.$set(t.params,"attribute_name",e)},expression:"params.attribute_name"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleNew}},[t._v($t("1wgbuh6"," 新增品牌 ","lang"))])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{border:"",data:t.list,height:t.wheight-170,"element-loading-text":$t("go5gpa5","数据加载中","lang"),"default-sort":{prop:"bind_date",order:"descending"}}},[e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleDelete(a)}}},[t._v($t("db22k4"," 删除 ","lang"))])]}}])}),e("el-table-column",{attrs:{label:$t("b606b84","品牌图片","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{staticStyle:{width:"70px",height:"70px"},attrs:{src:t.row.image_url,fit:"cover"}})]}}])}),e("el-table-column",{attrs:{prop:"attribute_name",label:$t("b5zpta4","品牌名称","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.attribute_id?e("div",[t._v(" "+t._s(a.row.attribute_name)+" ")]):e("div",[e("el-input",{attrs:{placeholder:$t("md3b1l7","请输入品牌名称","lang")},model:{value:a.row.attribute_name,callback:function(e){t.$set(a.row,"attribute_name",e)},expression:"scope.row.attribute_name"}})],1)]}}])})],1),e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.total_count,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1),e("imgPicker",{attrs:{"dialog-visible":t.imgDialog,"sc-status":t.isGetImage},on:{chooseImg:t.pickImg,closeImgDialog:t.closeImgDialog}}),e("sideBar",{attrs:{visible:t.show_sideBar,title:$t("d74e1l4","新增品牌","lang")},on:{"update:visible":function(e){t.show_sideBar=e}}},[e("el-form",[e("el-form-item",{attrs:{label:$t("cyt363","品牌名","lang")}},[e("el-input",{model:{value:t.form.attribute_name,callback:function(e){t.$set(t.form,"attribute_name",e)},expression:"form.attribute_name"}})],1),e("el-form-item",{attrs:{label:$t("5r302y6","品牌logo","lang")}},[e("div",{staticClass:"frm-tips"},[t._v($t("ykj36e15","只能上传jpg/png文件，且不超过2M （建议尺寸：200px * 200px）","lang"))]),e("div",{staticClass:"upload-box",on:{click:t.handleImgPicker}},[t.form.image_url?e("img",{staticClass:"avatar",attrs:{src:t.form.image_url,width:"100%"}}):e("SpIcon",{staticClass:"avatar-uploader-icon",attrs:{name:"camera",size:28}})],1)])],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v($t("fk4a44"," 提交 ","lang"))])],1)],1)],1)},[],!1,null,"9a005126",null).exports}}]);