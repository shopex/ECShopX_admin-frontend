"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8874],{8874:function(e,t,a){a.r(t),a.d(t,{default:function(){return s}});a(44114);var l=a(95353),i=a(6919),n={mixins:[a(77825).v8],provide(){return{refresh:this.fetchList}},data(){const e={tem_name:void 0,tem_type:void 0,is_valid:"1"};return{initialParams:e,params:{...e},isEdit:!1,tabList:[{name:$t("df71994","有效模板","lang"),activeName:"1"},{name:$t("ch37pf4","弃用模板","lang"),activeName:"2"}],ItemsDetailVisible:!1,itemsDetailData:{},loading:!1,dialogVisible:!1,dialogContent:[],headerTitle:"",bottomTitle:"",dialogTitle:""}},computed:{...(0,l.L8)(["wheight"])},watch:{getStatus(e){e&&this.fetchList()}},mounted(){this.fetchList()},methods:{onSearch(){this.page.pageIndex=1,this.$nextTick(()=>{this.fetchList()})},onReset(){this.params={...this.initialParams},this.onSearch()},getParams(){return{...this.params}},addTemplate(){this.$router.push({path:this.matchRoutePath("editor")})},editTemplateAction(e,t){this.$router.push({path:"/member/selfservice/formtemplateadd/"+t.id})},preview(e,t){this.dialogVisible=!0,this.dialogTitle=t.tem_name+$t("8l3lbh8","( 预览模式 )","lang"),this.dialogContent=t.content,this.headerTitle=t.header_title,this.bottomTitle=t.bottom_title},async fetchList(){this.loading=!0;const{pageIndex:e,pageSize:t}=this.page;let a={page:e,pageSize:t,...this.getParams()};const{list:l,total_count:i}=await this.$api.selfhelpform.getTemplateList(a);this.tableList=l,this.page.total=i,this.loading=!1},deleteAction(e,t){this.$confirm($t("jmadxag","此操作将废弃该模板, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,i.deleteTemplate)(t.id).then(t=>{this.tableList.splice(e,1),this.$message({message:$t("cc13v74","废弃成功","lang"),type:"success",duration:5e3})}).catch(()=>{this.$message({type:"error",message:$t("cbzx3s4","废弃失败","lang")})})}).catch(()=>{this.$message({type:"info",message:$t("e68dg3","已取消","lang")})})},getTaskTime(e){let t=new Date(e),a=t.getFullYear(),l=t.getMonth()+1;l=l<10?"0"+l:l;let i=t.getDate();return i=i<10?"0"+i:i,a+"-"+l+"-"+i},getTimeStr(e){return this.getTaskTime(new Date(1e3*parseInt(e)))},handleTabClick(e,t){this.onSearch()}}},s=(0,a(81656).A)(n,function(){var e=this,t=e._self._c;return t("SpPage",[-1===e.$route.path.indexOf("detail")&&-1===e.$route.path.indexOf("editor")?[t("SpFilterForm",{attrs:{model:e.params},on:{onSearch:e.onSearch,onReset:e.onReset}},[t("SpFilterFormItem",{attrs:{prop:"tem_name",label:$t("26rkk95","模板名称:","lang")}},[t("el-input",{attrs:{placeholder:$t("dtgrr54","模板名称","lang")},model:{value:e.params.tem_name,callback:function(t){e.$set(e.params,"tem_name",t)},expression:"params.tem_name"}})],1),t("SpFilterFormItem",{attrs:{prop:"tem_type",label:$t("2ciwlo5","模板类型:","lang")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:$t("dtngj24","模板类型","lang")},model:{value:e.params.tem_type,callback:function(t){e.$set(e.params,"tem_type",t)},expression:"params.tem_type"}},[t("el-option",{key:"basic_entry",attrs:{label:$t("bljl4m4","基础录入","lang"),value:"basic_entry"}}),t("el-option",{key:"ask_answer_paper",attrs:{label:$t("j9ocaz4","问卷调查","lang"),value:"ask_answer_paper"}})],1)],1)],1),t("div",{staticClass:"action-container"},[t("el-button",{attrs:{type:"primary",icon:"iconfont icon-xinzengcaozuo-01"},on:{click:e.addTemplate}},[e._v($t("tuq9el6"," 添加模板 ","lang"))])],1),t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.params.is_valid,callback:function(t){e.$set(e.params,"is_valid",t)},expression:"params.is_valid"}},e._l(e.tabList,function(a,l){return t("el-tab-pane",{key:l,attrs:{label:a.name,name:a.activeName}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.tableList,height:e.wheight-280}},[t("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("router-link",{staticClass:"el-icon-edit",attrs:{to:{path:e.matchRoutePath("editor"),query:{id:a.row.id}}}}),t("i",{staticClass:"el-icon-zoom-in",staticStyle:{margin:"0px 10px"},on:{click:function(t){return e.preview(a.$index,a.row)}}}),1==a.row.status?t("i",{staticClass:"mark el-icon-delete",staticStyle:{color:"#ff5000"},on:{click:function(t){return e.deleteAction(a.$index,a.row)}}}):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"}}),t("el-table-column",{attrs:{prop:"tem_name",label:$t("dtgrr54","模板名称","lang"),width:"300"}}),t("el-table-column",{attrs:{prop:"tem_type",label:$t("dtngj24","模板类型","lang"),width:"300"}}),t("el-table-column",{attrs:{prop:"status",label:$t("k1e32","状态","lang"),width:"100"}})],1),t("div",{staticClass:"content-center content-top-padded"},[t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.page.pageIndex,"page-sizes":[10,20,50],total:e.page.total,"page-size":e.page.pageSize},on:{"update:currentPage":function(t){return e.$set(e.page,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.page,"pageIndex",t)},"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)],1)}),1),t("el-dialog",{attrs:{visible:e.dialogVisible,title:e.dialogTitle,width:"50"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.headerTitle?t("el-alert",{attrs:{title:e.headerTitle,type:"info",closable:!1}}):e._e(),t("br"),e._l(e.dialogContent,function(a,l){return t("el-card",{key:l},[t("div",{attrs:{slot:"header"},slot:"header"},[e._v(" "+e._s(a.title)+" ")]),t("el-form",{ref:"carditem.formdata",refInFor:!0,staticClass:"demo-ruleForm",attrs:{"label-width":"100px","label-position":"right"}},e._l(a.formdata,function(a,l){return t("el-form-item",{key:l,attrs:{label:a.field_title}},["text"==a.form_element?t("el-col",{attrs:{span:12}},[t("el-input",{attrs:{placeholder:$t("eheyq76","text预览","lang"),disabled:""}})],1):e._e(),"number"==a.form_element?t("el-col",{attrs:{span:12}},[t("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"1",size:"mini",disabled:""}}),t("span",{staticClass:"frm-tips"},[e._v($t("j21wgi8"," (只能是数字)","lang"))])],1):e._e(),"textarea"==a.form_element?t("el-col",{attrs:{span:12}},[t("el-input",{attrs:{type:"textarea",placeholder:$t("xsiv0ia","textarea预览","lang"),disabled:"",rows:5}})],1):e._e(),"radio"==a.form_element?t("el-col",{attrs:{span:12}},[t("el-radio-group",{attrs:{disabled:""}},e._l(a.options,function(a,l){return t("el-radio",{key:l,attrs:{label:3}},[e._v(" "+e._s(a.value)+" ")])}),1)],1):e._e(),"checkbox"==a.form_element?t("el-col",{attrs:{span:12}},[t("el-checkbox-group",{attrs:{disabled:""}},e._l(a.options,function(a,l){return t("el-checkbox",{key:l,attrs:{label:"item.value"}},[e._v(" "+e._s(a.value)+" ")])}),1)],1):e._e(),"select"==a.form_element?t("el-col",{attrs:{span:12}},[t("el-select",{attrs:{placeholder:$t("l72nr3","请选择","lang")}},e._l(a.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.value,value:e.value,disabled:""}})}),1)],1):e._e()],1)}),1)],1)}),e.bottomTitle?t("el-alert",{attrs:{title:e.bottomTitle,type:"info",closable:!1}}):e._e(),t("el-button",{attrs:{type:"primary",disabled:""}},[e._v($t("6ua7zq6"," 确认提交 ","lang"))])],2)]:e._e(),t("router-view")],2)},[],!1,null,"b6ab823c",null).exports}}]);