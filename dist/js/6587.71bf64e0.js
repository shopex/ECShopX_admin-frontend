"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[6587],{6587:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=a(33318),r=a(22541),i=a(95093),s=a.n(i),o=a(26456),l={name:"",data(){const e=this.$createElement;return{formQuery:{distributor_id:"",merchant_id:"",statement_status:"",cycleTime:[],order_id:""},id:"",defaultTime:["00:00:00","23:59:59"],pickerOptions:n.Dv,merchantLoading:!1,merchantList:[],setting:(0,r.createSetting)({actions:[{name:$t("g3ge2","导出","lang"),key:"action",type:"button",slot:"header",buttonType:"primary is-plain",action:{handler:async e=>{const t=JSON.parse(JSON.stringify(this.formQuery));t.cycleTime.length>0&&(t.start_time=s()(t.cycleTime[0]).unix(),t.end_time=s()(t.cycleTime[1]).unix(),delete t.cycleTime);const{status:a,url:n,filename:r}=await this.$api.financial.exportDetialData({statement_id:this.id,start_time:t.start_time,end_time:t.end_time});if(a)return this.$message({type:"success",message:$t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")}),void this.$export_open("statement_details");this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})}}}],columns:[{name:$t("kuwys3","订单号","lang"),key:"order_id",width:160},{name:$t("c4b9p3","供应商","lang"),key:"supplier_name",width:160},{name:$t("gwn72","店铺","lang"),key:"distributor_name",width:160,visible:!(0,o.WZ)()},{name:$t("i50kg24","购买数量","lang"),key:"num",width:160},{name:$t("wriojj8","实付总金额（¥）","lang"),key:"total_fee",width:160,render:(e,{row:t})=>e("span",{},t.point_fee/100+t.total_fee/100),visible:!(0,o.WZ)()},{name:$t("91qscc7","结算金额（¥）","lang"),key:"cost_fee",width:160,render:(e,{row:t})=>e("span",{},t.cost_fee/100),visible:(0,o.WZ)()},{name:$t("d2orsf7","现金实付（¥）","lang"),key:"total_fee",width:160,render:(e,{row:t})=>e("span",{},t.total_fee/100),visible:!(0,o.WZ)()},{name:$t("fq5dol4","积分抵扣","lang"),key:"point_fee",width:160,render:(e,{row:t})=>e("span",{},t.point_fee/100),visible:!(0,o.WZ)()},{name:$t("cx45rh5","运费（总）","lang"),key:"freight_fee",width:160,render:(e,{row:t})=>e("span",{},t.freight_fee/100)},{name:$t("ir0wxy4","退货数量","lang"),key:"refund_num",width:160,visible:(0,o.WZ)()},{name:$t("cvf9i67","退款金额（¥）","lang"),key:"refund_fee",width:160,render:(e,{row:t})=>e("span",{},t.refund_fee/100)},{name:$t("im58s54","退款积分","lang"),key:"refund_point",width:160,render:(e,{row:t})=>e("span",{},t.refund_point/100),visible:!(0,o.WZ)()},{name:$t("6z0sw08","退货结算价（¥）","lang"),key:"refund_cost_fee",width:160,render:(e,{row:t})=>e("span",{},t.refund_cost_fee/100)},{name:$t("x32267","结算实付（¥）","lang"),key:"statement_fee",width:160,render:(e,{row:t})=>e("span",{},t.statement_fee/100)},{name:$t("ar84e54","创建时间","lang"),key:"alert_required_message",width:160,formatter:(t,a)=>e("div",[e("div",[s()(1e3*a.created).format("YYYY-MM-DD HH:mm:ss")])])},{name:$t("22jm0l6","订单完成时间","lang"),key:"end_time",width:160},{name:$t("gigtsy4","结算时间","lang"),key:"statement_time",width:160,formatter:(t,a)=>{if(a.statement_time)return e("div",[s()(1e3*a.statement_time).format("YYYY-MM-DD HH:mm:ss")])}},{name:$t("d3h9kv4","支付方式","lang"),key:"statement_status",render:(e,{row:t})=>e("span",{},this.getPayment(t.pay_channel,t.pay_type))}]})}},created(){this.id=this.$route.query.id},methods:{onSearch(){this.$refs.finder.refresh(!0)},beforeSearch(e){const t=JSON.parse(JSON.stringify(this.formQuery));return t.cycleTime.length>0&&(t.start_time=s()(t.cycleTime[0]).unix(),t.end_time=s()(t.cycleTime[1]).unix(),delete t.cycleTime),{...e,...t}},afterSearch(e){const{total_statement_fee_done:t,total_statement_fee_ready:a}=e.data.data.count;this.feeDone=t,this.feeReady=a},getPayment(e,t){return e?n.CV[e]:n.CV[t]},remoteMerchantList:async function(e){this.merchantLoading=!0;const t=await this.$api.marketing.getMerchantsList({pageSize:10,page:1});return this.merchantLoading=!1,t}}},m=(0,a(81656).A)(l,function(){var e=this,t=e._self._c;return t("SpPage",{staticClass:"sp-page--financial-detailed"},[t("SpFilterForm",{attrs:{model:e.formQuery},on:{onSearch:e.onSearch,onReset:e.onSearch}},[t("SpFilterFormItem",{attrs:{prop:"cycleTime",label:$t("lpkhnn5","创建时间:","lang"),size:"max"}},[t("el-date-picker",{attrs:{clearable:"",type:"datetimerange",align:"right",format:"yyyy-MM-dd HH:mm:ss","range-separator":$t("po31","至","lang"),"start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"prefix-icon":"null","default-time":e.defaultTime,"picker-options":e.pickerOptions},model:{value:e.formQuery.cycleTime,callback:function(t){e.$set(e.formQuery,"cycleTime",t)},expression:"formQuery.cycleTime"}})],1),t("SpFilterFormItem",{attrs:{prop:"order_id",label:$t("hymdzq4","订单号:","lang")}},[t("el-input",{attrs:{placeholder:$t("kuwys3","订单号","lang")},model:{value:e.formQuery.order_id,callback:function(t){e.$set(e.formQuery,"order_id",t)},expression:"formQuery.order_id"}})],1)],1),t("SpFinder",{ref:"finder",attrs:{"no-selection":"",setting:e.setting,hooks:{beforeSearch:e.beforeSearch},url:`/statement/detail/${e.id}`}})],1)},[],!1,null,"d8673aae",null).exports}}]);