"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[3017],{83017:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});a(44114);var i=a(95353),s=a(5748),r=a(71196),l=a(77825),n={components:{sideBar:r.A},mixins:[l.v8],data(){return{currentIndex:"",form:{attribute_type:"item_params",attribute_id:"",attribute_name:"",attribute_memo:"",is_show:!0,attribute_values:[]},params:{attribute_type:"item_params",attribute_name:""},list:[],loading:!1,imgDialog:!1,isGetImage:!1,imgIndex:0,brand_name:"",total_count:0,show_sideBar:!1}},mounted(){this.fetchList()},methods:{handleDelete(t){this.$confirm($t("hbclsq8","确认删除该参数？","lang")).then(e=>{(0,s.deleteGoodsAttr)(t.row.attribute_id).then(e=>{this.list.splice(t.$index,1),this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")})})}).catch(t=>{})},handleNew(){this.show_sideBar=!0,this.resetData()},resetData(){this.form={is_image:!1,attribute_type:"item_params",attribute_id:"",attribute_name:"",attribute_memo:"",is_show:!0,attribute_values:[]}},handleEdit(t){this.show_sideBar=!0,this.form={attribute_id:t.attribute_id,attribute_type:t.attribute_type,attribute_name:t.attribute_name,attribute_memo:t.attribute_memo,is_show:JSON.parse(t.is_show),attribute_values:t.attribute_values.list}},addItem(){if(this.form.attribute_values.length>50)return void this.$message({type:"warning",message:$t("8ml6m97","最多添加50项","lang")});this.form.attribute_values.push({attribute_value:""})},removeItem(t){this.$confirm($t("my1gjt8","确认删除当前值？","lang")).then(e=>{this.form.attribute_values.splice(t,1)}).catch(t=>{})},save(){let t=JSON.parse(JSON.stringify(this.form));0!==t.attribute_values.length||1!=t.is_show?(t.attribute_values=JSON.stringify(t.attribute_values),this.form.attribute_id?(0,s.updateGoodsAttr)(t.attribute_id,t).then(t=>{this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")}),this.fetchList()}):(0,s.addGoodsAttr)(t).then(t=>{this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")}),this.page.pageIndex=1,this.resetData(),this.fetchList()})):this.$message({type:"error",message:$t("hwd6grj","参数类型为高级筛选类型，参数值不能为空","lang")})},fetchList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let a={page:t,pageSize:e,...this.params};(0,s.getGoodsAttr)(a).then(t=>{this.list=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})}},computed:{...(0,i.L8)(["wheight"])}},o=n,u=(0,a(81656).A)(o,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"attribute_name",label:$t("eielqv5","参数名称:","lang")}},[e("el-input",{attrs:{placeholder:$t("mjhxra7","请输入参数名称","lang")},model:{value:t.params.attribute_name,callback:function(e){t.$set(t.params,"attribute_name",e)},expression:"params.attribute_name"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleNew}},[t._v($t("1wnroc6"," 新增参数 ","lang"))])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{border:"",data:t.list,height:t.wheight-170,"element-loading-text":$t("go5gpa5","数据加载中","lang"),"default-sort":{prop:"bind_date",order:"descending"}}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.attribute_values.list,function(a,i){return e("span",{key:i,staticClass:"sku-value"},[t._v(t._s(a.attribute_value))])})}}])}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleDelete(a)}}},[t._v($t("db22k4"," 删除 ","lang"))])]}}])}),e("el-table-column",{attrs:{label:$t("azrrvi4","参数类型","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("true"==e.row.is_show?$t("k28pwd4","高级筛选","lang"):$t("j220b3","纯显示","lang"))+" ")]}}])}),e("el-table-column",{attrs:{prop:"attribute_name",label:$t("azl33l4","参数名称","lang"),width:"200"}}),e("el-table-column",{attrs:{prop:"attribute_memo",label:$t("azluzz4","参数备注","lang")}})],1),e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.total_count,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1),e("sideBar",{attrs:{visible:t.show_sideBar,title:t.form.attribute_id?$t("gmhkyx4","编辑参数","lang"):$t("d745ek4","新增参数","lang")},on:{"update:visible":function(e){t.show_sideBar=e}}},[e("el-form",[e("el-form-item",{attrs:{label:$t("azl33l4","参数名称","lang")}},[e("el-input",{model:{value:t.form.attribute_name,callback:function(e){t.$set(t.form,"attribute_name",e)},expression:"form.attribute_name"}})],1),e("el-form-item",{attrs:{label:$t("azluzz4","参数备注","lang")}},[e("el-input",{model:{value:t.form.attribute_memo,callback:function(e){t.$set(t.form,"attribute_memo",e)},expression:"form.attribute_memo"}})],1),e("el-form-item",{attrs:{label:$t("azrrvi4","参数类型","lang")}},[e("el-radio-group",{model:{value:t.form.is_show,callback:function(e){t.$set(t.form,"is_show",e)},expression:"form.is_show"}},[e("el-radio",{attrs:{label:!0}},[t._v($t("x7o896a"," 支持商品高级筛选 ","lang"))]),e("el-radio",{attrs:{label:!1}},[t._v($t("4a7quub"," 仅用于商品详情展示 ","lang"))])],1)],1),e("el-form-item",{attrs:{label:$t("crci63","参数值","lang")}}),t._l(t.form.attribute_values,function(a,i){return e("div",{key:i,staticClass:"key-item"},[e("div",{staticClass:"key-item-input"},[e("el-input",{attrs:{placeholder:$t("ej4i5r5","参数值名称","lang")},model:{value:a.attribute_value,callback:function(e){t.$set(a,"attribute_value",e)},expression:"item.attribute_value"}})],1),e("div",{on:{click:function(e){return t.removeItem(i)}}},[e("SpIcon",{attrs:{name:"delete",size:22}})],1)])}),e("el-button",{attrs:{type:"default",size:"small"},on:{click:t.addItem}},[t._v($t("rco7d7"," 添加参数值 ","lang"))])],2),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v($t("fk4a44"," 提交 ","lang"))])],1)],1)],1)},[],!1,null,"5a0c3a9e",null).exports}}]);