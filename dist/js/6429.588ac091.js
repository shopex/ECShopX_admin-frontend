"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[6429],{96429:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});var i=a(79296),n={name:"ExtMiniLinkDetail",data(){return{params:{page:1,page_size:10,route_name:"",wx_external_config_id:""},rules:{route_name:[{required:!0,message:$t("do8uh37","请输入页面名称","lang"),trigger:"blur"}],route_info:[{required:!0,message:$t("dnz5917","请输入页面路径","lang"),trigger:"blur"}]},list:[],total_count:0,modalTitle:$t("e883ma4","添加页面","lang"),showModal:!1,isHttping:!1,tableLoading:!1,editInfo:{route_name:"",route_info:"",route_desc:""}}},mounted(){this.init()},methods:{init(){const{id:t}=this.$route.query;this.params.wx_external_config_id=Number(t),this.getList()},reset(){this.params.route_name="",this.getList()},handleCurrentChange(t){this.params.page=t,this.getList(!1)},showEditModal(t={}){t&&t.wx_external_config_id?(this.modalTitle=$t("aihzvc4","修改页面","lang"),this.editInfo={route_name:t.route_name,route_info:t.route_info,route_desc:t.route_desc,wx_external_routes_id:t.wx_external_routes_id,wx_external_config_id:t.wx_external_config_id}):this.editInfo.wx_external_config_id=this.params.wx_external_config_id,this.modalTitle=$t("e883ma4","添加页面","lang"),this.showModal=!0},closeModal(){this.editInfo={route_name:"",route_info:"",route_desc:""},this.$refs.editForm.resetFields(),this.showModal=!1},removeCurrent(t){const e=this;this.$confirm($t("njv7sx9","删除当前页面路径？","lang")).then(a=>{(0,i.removeWxLink)({id:t.wx_external_routes_id}).then(t=>{this.$message({message:$t("azeh8z4","删除成功","lang"),type:"success",onClose(){e.total_count%e.params.page_size==1&&e.params.page>1?(e.params.page-=1,e.getList(!0)):e.getList(!1)}})})}).catch(t=>{})},async editWxConfig(){if(this.isHttping)return!1;this.isHttping=!0;const t=this.editInfo;let e=i.createWxLink;t.wx_external_routes_id&&(e=i.updateWxLink);try{await e(t),this.closeModal(),this.getList(!1)}catch(t){}this.isHttping=!1},async getList(t=!0){this.tableLoading=!0,t&&(this.params.page=1);const e=await(0,i.getWxLinkList)(this.params),{total_count:a,list:n}=e.data.data;this.list=n,this.total_count=a,this.tableLoading=!1}}},s=(0,a(81656).A)(n,function(){var t=this,e=t._self._c;return e("div",{staticClass:"extMiniLinkDetail"},[e("el-card",{staticClass:"elCard"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",[t._v($t("wnsjl87","源源客会员服务","lang"))]),e("h5",[t._v($t("o6ouzio","配置外部小程序页面路径，供跳转到外部小程序使用。","lang"))])]),e("div",{staticClass:"search"},[e("div",{staticClass:"left"},[e("el-input",{staticClass:"appName",attrs:{placeholder:$t("do8uh37","请输入页面名称","lang")},model:{value:t.params.route_name,callback:function(e){t.$set(t.params,"route_name",e)},expression:"params.route_name"}}),e("el-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.getList}},[t._v($t("gg26b4"," 查询 ","lang"))]),e("el-button",{staticClass:"button",attrs:{type:"default"},on:{click:t.reset}},[t._v($t("miwv34"," 重置 ","lang"))])],1),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showEditModal()}}},[t._v($t("fvpaq4"," 新增 ","lang"))])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{stripe:"",border:"",data:t.list}},[e("el-table-column",{attrs:{prop:"created_at",label:$t("ar7uqh4","创建日期","lang")}}),e("el-table-column",{attrs:{prop:"route_name",label:$t("juu6ds4","页面名称","lang")}}),e("el-table-column",{attrs:{prop:"route_info",label:$t("jv3vlu4","页面路径","lang")}}),e("el-table-column",{attrs:{prop:"route_desc",label:$t("hrlt2","描述","lang")}}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{staticClass:"actBtn",attrs:{type:"text"},on:{click:function(e){return t.showEditModal(a.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),e("el-button",{staticClass:"actBtn",attrs:{type:"text"},on:{click:function(e){return t.removeCurrent(a.row)}}},[t._v($t("db22k4"," 删除 ","lang"))])]}}])})],1),e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total_count>0,expression:"total_count > 0"}],staticClass:"pagination",attrs:{layout:"total, prev, pager, next, jumper",background:"",total:t.total_count,"page-size":t.params.page_size},on:{"current-change":t.handleCurrentChange}},[t._v(" > ")])],1),e("el-dialog",{staticClass:"modal",attrs:{width:"30%",title:t.modalTitle,visible:t.showModal},on:{close:t.closeModal}},[e("el-form",{ref:"editForm",staticClass:"form",attrs:{"label-suffix":":","label-width":"120px",rules:t.rules,model:t.editInfo}},[e("el-form-item",{attrs:{label:$t("juu6ds4","页面名称","lang"),prop:"route_name"}},[e("el-input",{model:{value:t.editInfo.route_name,callback:function(e){t.$set(t.editInfo,"route_name",e)},expression:"editInfo.route_name"}})],1),e("el-form-item",{attrs:{label:$t("jv3vlu4","页面路径","lang"),prop:"route_info"}},[e("el-input",{model:{value:t.editInfo.route_info,callback:function(e){t.$set(t.editInfo,"route_info",e)},expression:"editInfo.route_info"}})],1),e("el-form-item",{attrs:{label:$t("hrlt2","描述","lang")}},[e("el-input",{attrs:{type:"textarea",placeholder:$t("niv1qoa","请输入内容（非必填）","lang"),resize:"none",maxlength:"30","show-word-limit":"",rows:3},model:{value:t.editInfo.route_desc,callback:function(e){t.$set(t.editInfo,"route_desc",e)},expression:"editInfo.route_desc"}})],1)],1),e("div",{staticClass:"btns"},[e("el-button",{staticClass:"btn",on:{click:t.closeModal}},[t._v($t("b2spxe5"," 取 消 ","lang"))]),e("el-button",{staticClass:"btn",attrs:{type:"primary",loading:t.isHttping},on:{click:function(e){return e.stopPropagation(),t.editWxConfig.apply(null,arguments)}}},[t._v($t("fovd945"," 确 定 ","lang"))])],1)],1)],1)},[],!1,null,"22ac29d4",null),o=s.exports}}]);