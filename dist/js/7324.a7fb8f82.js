"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[7324],{37324:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});a(44114),a(18111),a(7588);var i=a(5134),n=a(65124),r=a(98818),l={provide(){return{refresh:this.refresh}},data(){return{activity:[],history:[],activeName:"valid",validLoading:!1,invalidLoading:!1,gradeList:[],validPage:{currentPage:1,pageSize:12,total:0},tabList:[{name:$t("btppq95","活动监控室","lang"),activeName:"valid"},{name:$t("aw2ltl4","历史活动","lang"),activeName:"invalid"}],invalidPage:{currentPage:1,pageSize:12,total:0}}},mounted(){this.refresh(),this.$activated=()=>{this.refresh()}},methods:{handleClick(t,e){this.getList(t.name)},add(){this.$router.push({path:this.matchRoutePath("templ")})},getList(t){let e,a;"valid"===t?(this.validLoading=!0,e=this.validPage.currentPage,a=this.validPage.pageSize):(this.invalidLoading=!0,e=this.invalidPage.currentPage,a=this.invalidPage.pageSize);var n={page:e,pageSize:a,activity_status:t};(0,i.getActivity)(n).then(e=>{"valid"===t?(this.validLoading=!1,this.activity=e.data.data.list,this.validPage.total=e.data.data.total_count):(this.invalidLoading=!1,this.history=e.data.data.list,this.invalidPage.total=e.data.data.total_count)})},changeValidPage(t){this.validPage.currentPage=t,this.getList("valid")},changeInvalidPage(t){this.invalidPage.currentPage=t,this.getList("invalid")},invalidActivity(t){var e={activity_id:t};this.$confirm($t("swowzn8","确认终止该活动？","lang")).then(t=>{(0,i.invalidActivity)(e).then(t=>{this.getList("valid")})}).catch(t=>{})},refresh(){(0,n.getGradeList)().then(t=>{t.data.data.forEach(t=>{this.gradeList[t.grade_id]=t.grade_name})}),(0,r.listVipGrade)().then(t=>{t.data.data.forEach(t=>{this.gradeList[t.lv_type]=t.grade_name})}),this.getList("valid")}}},s=(0,a(81656).A)(l,function(){var t=this,e=t._self._c;return e("SpRouterView",[e("SpPage",[t.VERSION_SHUYUN()?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",pc:"",alipay:""}}),-1===t.$route.path.indexOf("templ")&&-1===t.$route.path.indexOf("editor")?e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabList,function(a,i){return e("el-tab-pane",{key:i,attrs:{label:a.name,name:a.activeName}},["valid"===t.activeName?[e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v($t("tv32jy6"," 添加活动 ","lang"))])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.activity,border:""}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e("el-form-item",{attrs:{label:$t("hqx6744","触发条件","lang")}},["member_birthday"==a.row.activity_type?e("span",["birthday_month"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("x74gt9a","生日当月1日统一发放","lang"))]):t._e(),"birthday_week"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("5elaoqa","生日当周周日统一发放","lang"))]):t._e(),"birthday_day"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("ai5hly8","生日当日统一发放","lang"))]):t._e()]):t._e(),"member_upgrade"==a.row.activity_type?e("span",[t._v($t("h0bjgy9","会员升级成功后发放","lang"))]):t._e(),"member_vip_upgrade"==a.row.activity_type?e("span",[t._v($t("65wmmrb","付费会员升级成功后发放","lang"))]):t._e(),"member_anniversary"==a.row.activity_type?e("span",["anniversary_month"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("oc4w60c","周年入会当月1日统一发放","lang"))]):t._e(),"anniversary_week"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("e9kvbzc","周年入会当周周日统一发放","lang"))]):t._e(),"anniversary_day"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("dtm0bja","周年入会当日统一发放","lang"))]):t._e()]):t._e(),"member_day"==a.row.activity_type?e("span",["every_year"==a.row.trigger_condition.trigger_time.type?e("span",[t._v($t("gtmdb4"," 每年的","lang")+t._s(a.row.trigger_condition.trigger_time.month)+$t("hixk2","月 ","lang"))]):t._e(),"every_month"==a.row.trigger_condition.trigger_time.type?e("span",[t._v($t("gv2wb4"," 每月的","lang")+t._s(a.row.trigger_condition.trigger_time.day)+$t("ea6h2","号 ","lang"))]):t._e(),"every_week"==a.row.trigger_condition.trigger_time.type?e("span",[t._v($t("lmxgrv6"," 每周的星期","lang")+t._s(a.row.trigger_condition.trigger_time.week)+" ")]):t._e()]):t._e()]),e("el-row",{attrs:{gutter:20}},[a.row.discount_config.coupons?e("el-col",[e("el-card",{staticClass:"box-card"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("el-button",{attrs:{type:"text"}},[t._v($t("4tu6mn7"," 赠送优惠券 ","lang"))])],1),t._l(a.row.discount_config.coupons,function(a,i){return e("div",{key:i,staticClass:"text item"},[a.name?e("div",[t._v($t("phvl3"," 赠送","lang")+t._s(a.count)+$t("gfzk2","张【","lang")+t._s(a.name)+$t("dlrfl6"," 】优惠券 ","lang"))]):t._l(a,function(a,n){return e("div",{key:n,staticClass:"text item"},[t._v($t("lynov4"," 赠送【","lang")+t._s(t.gradeList[i])+"】"+t._s(a.count)+$t("gfzk2","张【","lang")+t._s(a.name)+$t("f3l8jl7"," 】 优惠券 ","lang"))])})],2)})],2)],1):t._e(),a.row.discount_config.goods?e("el-col",[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("el-button",{attrs:{type:"text"}},[t._v($t("ay3j6p9"," 赠送服务类商品 ","lang"))])],1),t._l(a.row.discount_config.goods,function(a,i){return e("div",{key:i,staticClass:"text item"},[a.name?e("div",[t._v($t("phvl3"," 赠送","lang")+t._s(a.count)+$t("dp0a2","件【","lang")+t._s(a.name)+$t("kkovv38"," 】服务类商品 ","lang"))]):t._l(a,function(a,n){return e("div",{key:n,staticClass:"text item"},[t._v($t("lynov4"," 赠送【","lang")+t._s(t.gradeList[i])+"】"+t._s(a.count)+$t("dp0a2","件【","lang")+t._s(a.name)+$t("kkovv38"," 】服务类商品 ","lang"))])})],2)})],2)],1):t._e()],1)],1)]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("e4hvdc4","活动名称","lang"),prop:"title"}}),e("el-table-column",{attrs:{label:$t("cd0k3t4","开始时间","lang"),prop:"begin_time"}}),e("el-table-column",{attrs:{label:$t("gfi7qi4","结束时间","lang"),prop:"end_time"}}),e("el-table-column",{attrs:{label:$t("hafz1n4","营销类型","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["member_anniversary"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("abxqmi4","会员周年","lang"))]):"member_birthday"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("ac3cf84","会员生日","lang"))]):"member_upgrade"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("abxq2m4","会员升级","lang"))]):"member_vip_upgrade"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("wprjtr6","付费会员升级","lang"))]):e("span",{staticClass:"list-item-obj"},[t._v($t("c00873","会员日","lang"))])]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("k1e32","状态","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("processing"===e.row.status?$t("lq5q43","进行中","lang"):$t("cerf03","准备中","lang"))+" ")]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("b68zj84","发送短信","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("false"===e.row.sms_isopen?$t("lb5z2","禁用","lang"):$t("eymx2","启用","lang"))+" ")]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("k1e32","状态","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.invalidActivity(a.row.activity_id)}}},[t._v($t("rn93i16"," 终止活动 ","lang"))])]}}],null,!0)})],1),t.validPage.total>t.validPage.pageSize?e("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.validPage.currentPage,"page-size":t.validPage.pageSize,total:t.validPage.total},on:{"current-change":t.changeValidPage}}):t._e()]:t._e(),"invalid"===t.activeName?[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.history,border:""}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e("el-form-item",{attrs:{label:$t("hqx6744","触发条件","lang")}},["member_birthday"==a.row.activity_type?e("span",["birthday_month"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("x74gt9a","生日当月1日统一发放","lang"))]):t._e(),"birthday_week"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("5elaoqa","生日当周周日统一发放","lang"))]):t._e(),"birthday_day"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("ai5hly8","生日当日统一发放","lang"))]):t._e()]):t._e(),"member_upgrade"==a.row.activity_type?e("span",[t._v($t("h0bjgy9","会员升级成功后发放","lang"))]):t._e(),"member_vip_upgrade"==a.row.activity_type?e("span",[t._v($t("65wmmrb","付费会员升级成功后发放","lang"))]):t._e(),"member_anniversary"==a.row.activity_type?e("span",["anniversary_month"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("oc4w60c","周年入会当月1日统一发放","lang"))]):t._e(),"anniversary_week"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("e9kvbzc","周年入会当周周日统一发放","lang"))]):t._e(),"anniversary_day"==a.row.trigger_condition.trigger_time?e("span",[t._v($t("dtm0bja","周年入会当日统一发放","lang"))]):t._e()]):t._e(),"member_day"==a.row.activity_type?e("span",["every_year"==a.row.trigger_condition.trigger_time.type?e("span",[t._v($t("gtmdb4"," 每年的","lang")+t._s(a.row.trigger_condition.trigger_time.month)+$t("hixk2","月 ","lang"))]):t._e(),"every_month"==a.row.trigger_condition.trigger_time.type?e("span",[t._v($t("gv2wb4"," 每月的","lang")+t._s(a.row.trigger_condition.trigger_time.day)+$t("ea6h2","号 ","lang"))]):t._e(),"every_week"==a.row.trigger_condition.trigger_time.type?e("span",[t._v($t("lmxgrv6"," 每周的星期","lang")+t._s(a.row.trigger_condition.trigger_time.week)+" ")]):t._e()]):t._e()]),e("el-row",{attrs:{gutter:20}},[a.row.discount_config.coupons?e("el-col",[e("el-card",{staticClass:"box-card"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("el-button",{attrs:{type:"text"}},[t._v($t("4tu6mn7"," 赠送优惠券 ","lang"))])],1),t._l(a.row.discount_config.coupons,function(a,i){return e("div",{key:i,staticClass:"text item"},[a.name?e("div",[t._v($t("phvl3"," 赠送","lang")+t._s(a.count)+$t("gfzk2","张【","lang")+t._s(a.name)+$t("dlrfl6"," 】优惠券 ","lang"))]):t._l(a,function(a,n){return e("div",{key:n,staticClass:"text item"},[t._v($t("lynov4"," 赠送【","lang")+t._s(t.gradeList[i])+"】"+t._s(a.count)+$t("gfzk2","张【","lang")+t._s(a.name)+$t("f3l8jl7"," 】 优惠券 ","lang"))])})],2)})],2)],1):t._e(),a.row.discount_config.goods?e("el-col",[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("el-button",{attrs:{type:"text"}},[t._v($t("ay3j6p9"," 赠送服务类商品 ","lang"))])],1),t._l(a.row.discount_config.goods,function(a,i){return e("div",{key:i,staticClass:"text item"},[a.name?e("div",[t._v($t("phvl3"," 赠送","lang")+t._s(a.count)+$t("dp0a2","件【","lang")+t._s(a.name)+$t("kkovv38"," 】服务类商品 ","lang"))]):t._l(a,function(a,n){return e("div",{key:n,staticClass:"text item"},[t._v($t("lynov4"," 赠送【","lang")+t._s(t.gradeList[i])+"】"+t._s(a.count)+$t("dp0a2","件【","lang")+t._s(a.name)+$t("kkovv38"," 】服务类商品 ","lang"))])})],2)})],2)],1):t._e()],1)],1)]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("e4hvdc4","活动名称","lang"),prop:"title"}}),e("el-table-column",{attrs:{label:$t("cd0k3t4","开始时间","lang"),prop:"begin_time"}}),e("el-table-column",{attrs:{label:$t("gfi7qi4","结束时间","lang"),prop:"end_time"}}),e("el-table-column",{attrs:{label:$t("hafz1n4","营销类型","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["member_anniversary"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("abxqmi4","会员周年","lang"))]):"member_birthday"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("ac3cf84","会员生日","lang"))]):"member_upgrade"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("abxq2m4","会员升级","lang"))]):"member_vip_upgrade"===a.row.activity_type?e("span",{staticClass:"list-item-obj"},[t._v($t("wprjtr6","付费会员升级","lang"))]):e("span",{staticClass:"list-item-obj"},[t._v($t("c00873","会员日","lang"))])]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("b68zj84","发送短信","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("false"===e.row.sms_isopen?$t("lb5z2","禁用","lang"):$t("eymx2","启用","lang"))+" ")]}}],null,!0)})],1),e("div",{staticClass:"content-center"},[e("el-pagination",{attrs:{layout:"total, prev, pager, next","current-page":t.invalidPage.currentPage,"page-size":t.invalidPage.pageSize,total:t.invalidPage.total},on:{"current-change":t.changeInvalidPage}})],1)]:t._e()],2)}),1):t._e()],1)],1)},[],!1,null,"7efc3cbe",null).exports}}]);