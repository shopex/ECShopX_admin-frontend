"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[3671],{63671:function(t,a,e){e.r(a),e.d(a,{default:function(){return i}});e(44114);var r=e(18306),n=(e(62477),e(82997)),s=e(2038),l={components:{templateCpn:e(24866).A},data(){return{vdate:"",loading:!0,activeName:"merchant"!==this.$store.getters.login_type?"member":"order",params:{start:"",end:"",distributor:"",vdate:""},is_distributor:!1,distributorOption:[],allListData:[],userTimeArr:[],list:{memberData:[],aftersalesData:[],refundedData:[],amountPayedData:[],orderData:[],orderPayedData:[],gmvData:[]},tab:{name:"merchant"!==this.$store.getters.login_type?"member":"order",label:"merchant"!==this.$store.getters.login_type?$t("h2uku45","新增会员数","lang"):$t("kv0f13","订单数","lang")},chartColors:{red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"},pickerOptions:{shortcuts:[{text:$t("dl4oop4","最近一周","lang"),onClick(t){const a=new Date,e=new Date;a.setTime(a.getTime()-6048e5),e.setTime(e.getTime()-864e5);const r=t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`;t.$emit("pick",[r(a),r(e)])}},{text:$t("4znkgj5","最近一个月","lang"),onClick(t){const a=new Date,e=new Date;a.setTime(a.getTime()-2592e6),e.setTime(e.getTime()-864e5);const r=t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`;t.$emit("pick",[r(a),r(e)])}},{text:$t("4zndsa5","最近三个月","lang"),onClick(t){const a=new Date,e=new Date;a.setTime(a.getTime()-7776e6),e.setTime(e.getTime()-864e5);const r=t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`;t.$emit("pick",[r(a),r(e)])}}]}}},mounted(){"distributor"===r.A.getters.login_type&&(this.is_distributor=!0),!1===this.is_distributor&&this.$nextTick(()=>{this.getDistributorData()}),this.onReset()},methods:{onReset(){var t=new Date,a=new Date;t.setTime(t.getTime()-6048e5),a.setTime(a.getTime()-864e5);const e=t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`;this.params.vdate=[e(t),e(a)],this.params.start=this.params.vdate[0],this.params.end=this.params.vdate[1],this.activeName="merchant"!==this.$store.getters.login_type?"member":"order",this.allListData=[],this.list={memberData:[],aftersalesData:[],refundedData:[],amountPayedData:[],orderData:[],orderPayedData:[],gmvData:[]}},handleClick(t,a){let e={id:"canvas_"+t.name,label:t.label,dataName:this.list[t.name+"Data"]};this.chartInit(e),this.tab={name:t.name,label:t.label}},dateChange(t){this.params.start=t[0],this.params.end=t[1]},DistributorChange(t){this.params.distributor=t},getDistributorData(){(0,s.getDistributorList)({is_valid:!0}).then(t=>{this.distributorOption=t.data.data.list})},getDistributorDataList(){if(this.userTimeArr=[],this.list.memberData=[],this.list.aftersalesData=[],this.list.refundedData=[],this.list.amountPayedData=[],this.list.orderData=[],this.list.orderPayedData=[],this.list.gmvData=[],!1===this.is_distributor&&""===this.params.distributor)return this.$message({type:"error",message:$t("5mjith6","必须选择门店","lang")}),!1;let t={start:this.params.start,end:this.params.end,distributor_id:this.params.distributor};(0,n.getDistributorData)(t).then(t=>{this.allListData=t.data.data.list;let a=t.data.data.list;for(var e in a)this.userTimeArr.push(a[e].count_date),this.list.memberData.push(a[e].member_count),this.list.aftersalesData.push(a[e].aftersales_count),this.list.refundedData.push(a[e].refunded_count/100),this.list.amountPayedData.push(a[e].amount_payed_count/100),this.list.orderData.push(a[e].order_count),this.list.orderPayedData.push(a[e].order_payed_count),this.list.gmvData.push(a[e].gmv_count/100);this.loading=!1;const r=this.tab.name;this.$nextTick(()=>{let t={id:"canvas_"+r,label:this.tab.label,dataName:this.list[r+"Data"]};this.chartInit(t)})}).catch(t=>{this.$message({type:"error",message:$t("mpokya8","获取统计信息出错","lang")})})},chartInit(t){var a={type:"line",data:{labels:this.userTimeArr,datasets:[{label:t.label,backgroundColor:this.chartColors.grey,borderColor:this.chartColors.red,data:t.dataName,fill:!1}]},options:{responsive:!0,tooltips:{mode:"index",intersect:!0},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:""}}],yAxes:[{display:!0,scaleLabel:{display:!1}}]}}},e=document.getElementById(t.id).getContext("2d");window.myLine=new Chart(e,a)}}},i=(0,e(81656).A)(l,function(){var t=this,a=t._self._c;return a("SpPage",[a("SpFilterForm",{attrs:{model:t.params},on:{onSearch:function(a){return t.getDistributorDataList(!0)},onReset:t.onReset}},[a("SpFilterFormItem",{attrs:{prop:"vdate",label:$t("e8915d5","日期范围:","lang")}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","alue-format":"yyyy-MM-dd",align:"right","unlink-panels":"","range-separator":$t("po31","至","lang"),"start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd"},on:{change:t.dateChange},model:{value:t.params.vdate,callback:function(a){t.$set(t.params,"vdate",a)},expression:"params.vdate"}})],1),a("SpFilterFormItem",{attrs:{prop:"distributor",label:$t("80vxpn5","选择门店:","lang")}},[a("el-select",{attrs:{placeholder:$t("2ecf6i5","请选择门店","lang")},on:{change:t.DistributorChange},model:{value:t.params.distributor,callback:function(a){t.$set(t.params,"distributor",a)},expression:"params.distributor"}},["merchant"==t.$store.getters.login_type?a("el-option",{key:"2",attrs:{label:$t("en402","全部","lang"),value:"all"}},[t._v($t("d6c1s4"," 全部 ","lang"))]):t._e(),"merchant"!=t.$store.getters.login_type?a("el-option",{key:"0",attrs:{label:$t("gvy42","总店","lang"),value:"0"}},[t._v($t("f3xz84"," 总店 ","lang"))]):t._e(),t._l(t.distributorOption,function(t){return a("el-option",{key:t.distributor_id,attrs:{label:t.name,size:"mini",value:t.distributor_id}})})],2)],1)],1),-1===t.$route.path.indexOf("editor")?a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},["merchant"==t.$store.getters.login_type?[a("el-tab-pane",{attrs:{label:$t("kv0f13","订单数","lang"),name:"order"}},[a("section",[a("canvas",{attrs:{id:"canvas_order",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("b3hm574","售后单数","lang"),name:"aftersales"}},[a("section",[a("canvas",{attrs:{id:"canvas_aftersales",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("lmdy73","退款额","lang"),name:"refunded"}},[a("section",[a("canvas",{attrs:{id:"canvas_refunded",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("c0vbi3","交易额","lang"),name:"amountPayed"}},[a("section",[a("canvas",{attrs:{id:"canvas_amountPayed",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("wrrv495","付款订单数","lang"),name:"orderPayed"}},[a("section",[a("canvas",{attrs:{id:"canvas_orderPayed",height:"120"}})])]),a("el-tab-pane",{attrs:{label:"GMV",name:"gmv"}},[a("section",[a("canvas",{attrs:{id:"canvas_gmv",height:"120"}})])])]:[a("el-tab-pane",{attrs:{label:$t("c004y3","会员数","lang"),name:"member"}},[a("section",[a("canvas",{attrs:{id:"canvas_member",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("b3hm574","售后单数","lang"),name:"aftersales"}},[a("section",[a("canvas",{attrs:{id:"canvas_aftersales",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("lmdy73","退款额","lang"),name:"refunded"}},[a("section",[a("canvas",{attrs:{id:"canvas_refunded",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("c0vbi3","交易额","lang"),name:"amountPayed"}},[a("section",[a("canvas",{attrs:{id:"canvas_amountPayed",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("qf6u147","交易额(积分)","lang"),name:"amountPointPayed"}},[a("section",[a("canvas",{attrs:{id:"canvas_amountPointPayed",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("kv0f13","订单数","lang"),name:"order"}},[a("section",[a("canvas",{attrs:{id:"canvas_order",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("jk0r477","订单数(积分)","lang"),name:"orderPoint"}},[a("section",[a("canvas",{attrs:{id:"canvas_orderPoint",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("wrrv495","付款订单数","lang"),name:"orderPayed"}},[a("section",[a("canvas",{attrs:{id:"canvas_orderPayed",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("zf86an9","付款订单数(积分)","lang"),name:"orderPointPayed"}},[a("section",[a("canvas",{attrs:{id:"canvas_orderPointPayed",height:"120"}})])]),a("el-tab-pane",{attrs:{label:"GMV",name:"gmv"}},[a("section",[a("canvas",{attrs:{id:"canvas_gmv",height:"120"}})])]),a("el-tab-pane",{attrs:{label:$t("ey6zoa7","GMV(积分)","lang"),name:"gmvPoint"}},[a("section",[a("canvas",{attrs:{id:"canvas_gmvPoint",height:"120"}})])])]],2):t._e(),[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.allListData,stripe:"",border:""}},["merchant"==t.$store.getters.login_type?[a("el-table-column",{attrs:{prop:"count_date",label:$t("hwbe2","日期","lang"),fixed:""}}),a("el-table-column",{attrs:{prop:"order_count",label:$t("kv0f13","订单数","lang")}}),a("el-table-column",{attrs:{prop:"aftersales_count",label:$t("b3hm574","售后单数","lang")}}),a("el-table-column",{attrs:{label:$t("lmdy73","退款额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.refunded_count/100)+" ")]}}],null,!1,3449099669)}),a("el-table-column",{attrs:{prop:"amount_payed_count",label:$t("c0vbi3","交易额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.amount_payed_count/100)+" ")]}}],null,!1,1156081632)}),a("el-table-column",{attrs:{prop:"order_payed_count",label:$t("wrrv495","付款订单数","lang")}}),a("el-table-column",{attrs:{prop:"gmv_count",label:"GMV"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.gmv_count/100)+" ")]}}],null,!1,1841179142)})]:[a("el-table-column",{attrs:{prop:"count_date",label:$t("hwbe2","日期","lang"),fixed:""}}),a("el-table-column",{attrs:{prop:"member_count",label:$t("c004y3","会员数","lang")}}),a("el-table-column",{attrs:{prop:"aftersales_count",label:$t("b3hm574","售后单数","lang")}}),a("el-table-column",{attrs:{label:$t("lmdy73","退款额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.refunded_count/100)+" ")]}}])}),a("el-table-column",{attrs:{prop:"amount_payed_count",label:$t("c0vbi3","交易额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.amount_payed_count/100)+" ")]}}])}),a("el-table-column",{attrs:{prop:"amount_point_payed_count",label:$t("qf6u147","交易额(积分)","lang")}}),a("el-table-column",{attrs:{prop:"order_count",label:$t("kv0f13","订单数","lang")}}),a("el-table-column",{attrs:{prop:"order_point_count",label:$t("jk0r477","订单数(积分)","lang")}}),a("el-table-column",{attrs:{prop:"order_payed_count",label:$t("wrrv495","付款订单数","lang")}}),a("el-table-column",{attrs:{prop:"order_point_payed_count",label:$t("zf86an9","付款订单数(积分)","lang")}}),a("el-table-column",{attrs:{prop:"gmv_count",label:"GMV"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.gmv_count/100)+" ")]}}])}),a("el-table-column",{attrs:{prop:"gmv_point_count",label:$t("ey6zoa7","GMV(积分)","lang")}})]],2)]],2)},[],!1,null,null,null).exports}}]);