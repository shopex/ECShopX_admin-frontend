"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8448],{48448:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});a(44114),a(18111),a(7588);var i=a(77825),s=a(9108),l=[function(){var t=this._self._c;return t("div",{staticClass:"placeholder-content"},[t("i",{staticClass:"iconfont icon-route"}),t("div",[this._v($t("dcv57g4","暂无数据","lang"))])])}],n={props:{visible:{type:Boolean,default:!1},height:{type:String,default:""}},data(){return{placeholderVisible:!1}},watch:{visible(t){t&&this.setData(t)}},methods:{setData(t){this.placeholderVisible=t}}},o=a(81656),r={components:{dataPlaceholder:(0,o.A)(n,function(){var t=this;return(0,t._self._c)("div",{staticClass:"data-placeholder",style:"height:"+t.height},[t._m(0)])},l,!1,null,"3888f3c1",null).exports},mixins:[i.Ay,i.v8],provide(){return{refresh:this.fetchList}},data(){return{loading:!1,showPlaceholder:!1,params:{title:""}}},mounted(){this.fetchList(),this.$activated=()=>{this.fetchList()}},methods:{articleAdd(t){this.$router.push({path:this.matchRoutePath("editor")})},articleDelete(t){const e=this;this.$confirm($t("syatfva","确认删除当前文章吗？","lang")).then(a=>{(0,s.deleteArticle)(t).then(t=>{t.data.data.status&&this.$message({message:$t("azeh8z4","删除成功","lang"),type:"success",onClose(){e.fetchList()}})})})},handleSort(t){const e=this;let a=this.tableList.findIndex(e=>e.article_id===t);this.tableList[a].visible=!1;let i={inputdata:[{article_id:t,sort:this.tableList[a].sort}]};(0,s.updateArticleSortOrStatus)(i).then(t=>{e.fetchList()})},handlePublish(t,e){let a="";a=e?$t("lwsk7ya","确定撤回本篇文章吗？","lang"):$t("4aj5qea","确定发布本篇文章吗？","lang");const i=this;this.$confirm(a).then(a=>{let l={inputdata:[{article_id:t,release_status:!e}]};(0,s.updateArticleSortOrStatus)(l).then(t=>{i.fetchList()})}).catch(()=>{})},async fetchList(){this.loading=!0;const{total_count:t,list:e}=await this.$api.article.getArticleList(this.params);0===t&&(this.showPlaceholder=!0),e.forEach(t=>{t.link=`pages/article/index?id=${t.article_id}`}),this.tableList=e,this.total_count=t,this.loading=!1}}},c=(0,o.A)(r,function(){var t=this,e=t._self._c;return e("SpRouterView",[e("SpPage",[t.VERSION_SHUYUN()?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",alipay:""}}),e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"title",label:$t("d9vsog5","文章标题:","lang")}},[e("el-input",{attrs:{placeholder:$t("k7koml7","请输入文章标题","lang")},model:{value:t.params.title,callback:function(e){t.$set(t.params,"title",e)},expression:"params.title"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.articleAdd}},[t._v($t("tu5aki6"," 添加文章 ","lang"))])],1),e("section",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"articles"},[e("el-row",{attrs:{gutter:10}},t._l(t.tableList,function(a,i){return e("el-col",{key:i,attrs:{xs:12,sm:8,md:6,lg:4}},[e("div",{staticClass:"article-item"},[e("router-link",{attrs:{to:{path:t.matchRoutePath("editor"),query:{id:a.article_id}}}},[e("div",{staticClass:"thumbnail",style:"background: url("+(a.image_url||"https://fakeimg.pl/200x180/EFEFEF/CCC/?text=image&font=lobster")+") 0% 0% / cover no-repeat;"}),e("div",{staticClass:"caption"},[e("div",{staticClass:"title"},[t._v(" "+t._s(a.title)+" ")]),e("div",{staticClass:"update-time"},[t._v(" "+t._s(t._f("datetime")(a.updated,"YYYY-MM-DD HH:mm:ss"))+" ")])])]),e("div",{staticClass:"footer"},[e("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.link,expression:"item.link",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"footer-item copy-btn"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.link,expression:"item.link"}],staticClass:"copy-link",attrs:{type:"text"},domProps:{value:a.link},on:{input:function(e){e.target.composing||t.$set(a,"link",e.target.value)}}}),e("i",{staticClass:"iconfont icon-copy"}),t._v($t("d3trih8"," 复制文章链接 ","lang"))])]),e("div",{staticClass:"footer"},[e("div",{staticClass:"footer-item",on:{click:function(e){return t.handlePublish(a.article_id,a.release_status)}}},[a.release_status?[e("i",{staticClass:"iconfont icon-undo-alt"}),t._v($t("fpvuu4"," 撤回 ","lang"))]:[e("i",{staticClass:"iconfont icon-broadcast-tower"}),t._v($t("dadwu4"," 发布 ","lang"))]],2),e("el-popover",{staticClass:"footer-item",attrs:{placement:"top",width:"160"},model:{value:a.visible,callback:function(e){t.$set(a,"visible",e)},expression:"item.visible"}},[e("div",{staticClass:"content-bottom-padded"},[e("el-input",{attrs:{size:"mini",placeholder:$t("2j8ot65","请输入排序","lang")},model:{value:a.sort,callback:function(e){t.$set(a,"sort",e)},expression:"item.sort"}})],1),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){a.visible=!1}}},[t._v($t("dd4ni4"," 取消 ","lang"))]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleSort(a.article_id)}}},[t._v($t("in1ck4"," 确定 ","lang"))])],1),e("div",{attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-sort-amount-up"}),t._v($t("i44d3"," 排序","lang"))])]),e("div",{staticClass:"footer-item",on:{click:function(e){return t.articleDelete(a.article_id)}}},[e("i",{staticClass:"iconfont icon-trash-alt"}),t._v($t("db22k4"," 删除 ","lang"))])],1)],1)])}),1),e("dataPlaceholder",{attrs:{visible:t.showPlaceholder,height:"100%"},on:{"update:visible":function(e){t.showPlaceholder=e}}}),t.page.total>t.page.pageSize?e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1):t._e()],1)],1)],1)},[],!1,null,"5af48bb7",null).exports}}]);