"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[5937],{35937:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});a(44114),a(18111),a(22489),a(20116),a(61701);const i={"运动服饰":$t("fbtok0d","面料、透气性、款式、舒适性","lang"),"护肤":$t("769asfm","原料、质地、主要功能、解决肌肤问题、使用效果","lang")};var l={provide(){return{refresh:()=>this.$refs.paginationRef.refresh()}},data(){const t=this.$createElement;return{activeTab:"all",articleList:[],aiArticleForm:{channel:"",goods:[],author_type:$t("ihsn844","运动达人","lang"),author_type_customer:"",industry:"",industry_presets:"",topic_type:$t("aa2yc34","产品测评","lang"),topic_type_customer:""},aiArticleFormList:[{label:$t("ywj4626","选择软文频道","lang"),key:"channel",type:"select",required:!0,placeholder:$t("wpm6wf7","请选择软文频道","lang"),options:[]},{label:$t("nm1a2","行业","lang"),key:"industry",type:"select",required:!0,placeholder:$t("wpm6wf7","请选择软文频道","lang"),options:[{title:$t("ihm4t74","运动服饰","lang"),value:$t("ihm4t74","运动服饰","lang")},{title:$t("hhfk2","护肤","lang"),value:$t("hhfk2","护肤","lang")}]},{label:$t("cyra6q4","推广商品","lang"),key:"goods",component:({key:e},a)=>t("div",[t("el-button",{attrs:{disabled:a[e].length>=3},on:{click:this.onSelectGoods}},[$t("ikwu2j4","选择商品","lang")]),t("SpGoodsGroup",{style:"margin-top: 10px;",model:{value:a[e],callback:t=>{this.$set(a,e,t)}}})]),tip:$t("gzag358","最多添加3个商品","lang")},{label:$t("ajhgrx4","作者人设","lang"),key:"author_type",type:"select",options:[{title:$t("ihsn844","运动达人","lang"),value:$t("ihsn844","运动达人","lang")},{title:$t("eieqcf4","潮流小主","lang"),value:$t("eieqcf4","潮流小主","lang")},{title:$t("jh1ll3","自定义","lang"),value:$t("jh1ll3","自定义","lang")}]},{label:"",key:"author_type_customer",type:"input",placeholder:$t("l6wdl3","请输入","lang"),isShow:({key:t},e)=>e.author_type===$t("jh1ll3","自定义","lang")},{label:$t("qqnhpd6","创作主题描述","lang"),key:"topic_type",type:"select",options:[{title:$t("aa2yc34","产品测评","lang"),value:$t("aa2yc34","产品测评","lang")},{title:$t("j1484w5","季节性推荐","lang"),value:$t("j1484w5","季节性推荐","lang")},{title:$t("jh1ll3","自定义","lang"),value:$t("jh1ll3","自定义","lang")}]},{label:"",key:"topic_type_customer",type:"textarea",placeholder:$t("l6wdl3","请输入","lang"),isShow:({key:t},e)=>e.topic_type===$t("jh1ll3","自定义","lang")}],channelOptions:[],drawerShow:!1,searchForm:{title:""}}},mounted(){this.getArticleCategory(),this.$activated=(t,e)=>{"edit"==e.meta.name?this.$refs.paginationRef.refresh():"create"==e.meta.name&&this.$refs.paginationRef.refresh(!0)}},methods:{onSearch(){this.$refs.paginationRef.refresh(!0)},async getArticleCategory(){const t=await this.$api.article.getArticleCategoryList({category_type:"bring"});this.channelOptions=t.map(t=>({title:t.category_name,value:t.category_id}))},handleCreateArticle(){this.$router.push({path:this.matchRoutePath("editor")})},async handleDeleteArticle({article_id:t}){try{await this.$confirm($t("nr5aj0a","确认删除当前软文吗？","lang"),$t("hn562","提示","lang")),await this.$api.article.deleteArticle(t),this.$message.success($t("azeh8z4","删除成功","lang")),this.$refs.paginationRef.refresh()}catch(t){}},async handleSort({article_id:t,sort:e}){await this.$api.article.updateArticleSortOrStatus({inputdata:[{article_id:t,sort:e}]}),this.$refs.paginationRef.refresh()},async handlePublishOrWithdraw({article_id:t,release_status:e}){try{await this.$confirm(e?$t("gpn1b3a","确定撤回本篇软文吗？","lang"):$t("wmd6ha","确定发布本篇软文吗？","lang"),$t("hn562","提示","lang")),await this.$api.article.updateArticleSortOrStatus({inputdata:[{article_id:t,release_status:!e}]}),this.$message.success(e?$t("d264ll4","撤回成功","lang"):$t("aytobl4","发布成功","lang")),this.$refs.paginationRef.refresh()}catch(t){}},handleClick(t){this.$router.push({path:this.matchRoutePath("editor"),query:{id:t.article_id}})},onTabChange(){this.$refs.paginationRef.refresh()},async fetchList({page:t,pageSize:e}){const a={page:t,pageSize:e,article_type:"bring",title:this.searchForm.title,release_status:{all:"2",wait:"0",published:"1"}[this.activeTab]},{list:i,total_count:l}=await this.$api.article.getArticleList(a);return this.articleList=i,{total:l,list:this.articleList}},createArticleByAI(){this.drawerShow=!0,this.$nextTick(()=>{this.$refs.aiArticleForm.setField(this.aiArticleFormList,"channel",{options:this.channelOptions})})},async onSelectGoods(){const{data:t}=await this.$picker.goodsitem(),e=t.filter(t=>!this.aiArticleForm.goods.find(e=>e.item_id===t.item_id));this.aiArticleForm.goods.concat(e).length>3?this.$message.error($t("gzag358","最多添加3个商品","lang")):this.aiArticleForm.goods=this.aiArticleForm.goods.concat(e)},async onSubmitCreateArticle(){const t={product:this.aiArticleForm.goods.map(t=>({item_id:t.item_id,name:t.item_name,price:t.price/100,category:t.itemCatName.toString(),item_image_url:t.pics?.[0],sales:t.sales})),is_image:!0,is_article:!0,category_id:this.aiArticleForm.channel,author_persona:this.aiArticleForm.author_type==$t("jh1ll3","自定义","lang")?this.aiArticleForm.author_type_customer:this.aiArticleForm.author_type,industry:this.aiArticleForm.industry,industry_presets:i[this.aiArticleForm.industry],subject_desc:this.aiArticleForm.topic_type==$t("jh1ll3","自定义","lang")?this.aiArticleForm.topic_type_customer:this.aiArticleForm.topic_type};await this.$api.article.createArticleByAI(t),this.drawerShow=!1,this.$message.success($t("9vrvfiu","提交成功，AI生成软文预计需要3分钟，请稍后在待发布中查看。","lang")),this.$refs.paginationRef.refresh(!0)}}},r=(0,a(81656).A)(l,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpRouterView",[t.VERSION_SHUYUN()?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",alipay:""}}),e("SpFilterForm",{attrs:{model:t.searchForm},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"title",label:$t("5tndo15","软文标题:","lang")}},[e("el-input",{attrs:{placeholder:$t("f0f5pq7","请输入软文标题","lang")},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{icon:"plus",type:"primary"},on:{click:t.handleCreateArticle}},[t._v($t("u06msj6"," 添加软文 ","lang"))]),e("el-button",{attrs:{icon:"plus",type:"primary"},on:{click:t.createArticleByAI}},[t._v($t("givl1z6"," AI创作 ","lang"))])],1),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:$t("en402","全部","lang"),name:"all"}}),e("el-tab-pane",{attrs:{label:$t("eeg0n3","待发布","lang"),name:"wait"}}),e("el-tab-pane",{attrs:{label:$t("e656s3","已发布","lang"),name:"published"}})],1),e("SpPagination",{ref:"paginationRef",attrs:{"auto-fetch":"",fetch:t.fetchList}},[e("div",{staticClass:"grid grid-cols-5 gap-4"},t._l(t.articleList,function(a,i){return e("SpContentCard",{key:i,attrs:{data:a},on:{onDelete:t.handleDeleteArticle,onChange:t.handlePublishOrWithdraw,onSort:t.handleSort,onClick:t.handleClick}},[e("template",{slot:"head-slot"},[e("div",{staticClass:"flex justify-between"},[a.is_ai?e("div",{staticClass:"ai-tag"},[t._v("AI")]):t._e(),a.is_ai&&!a.release_status?e("div",{staticClass:"ai-publish"}):t._e()])])],2)}),1)]),e("SpDrawer",{attrs:{title:$t("1leq14","AI创作","lang"),width:650},on:{confirm:()=>{t.$refs.aiArticleForm.handleSubmit()}},model:{value:t.drawerShow,callback:function(e){t.drawerShow=e},expression:"drawerShow"}},[e("SpForm",{ref:"aiArticleForm",attrs:{"label-width":"120px","form-list":t.aiArticleFormList,submit:!1},on:{onSubmit:t.onSubmitCreateArticle},model:{value:t.aiArticleForm,callback:function(e){t.aiArticleForm=e},expression:"aiArticleForm"}})],1)],1)],1)},[],!1,null,"ea93b5e8",null).exports}}]);