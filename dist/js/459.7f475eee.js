"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[459],{90459:function(t,a,e){e.r(a),e.d(a,{default:function(){return d}});e(44114),e(18111),e(7588),e(57270);var i=e(21255),s={props:{tmpData:Array,handleType:String,loading:Boolean},data(){return{}},computed:{resetText(){return t=>{var a=$t("g5o72","审核","lang");return"1"==t.status?a=$t("hi6j2","拒绝","lang"):"2"==t.status&&(a=$t("past2","通过","lang")),a}}},mounted(){},methods:{whereDisable(t){return!0},handleEdit(t,a){this.$emit("handleEdit",!0,t)},auditNote(t){var a={id_set:[t.topic_id],auditdiff:!1,aloneAuditType:"1"==t.status?"refuse":"pass"};this.$refs.topictable.clearSelection(),this.$refs.topictable.toggleRowSelection(t),this.$emit("selectNotes",a)},checkChange(t){var a=[],e=!1,i=null;t.forEach(t=>{a.push(t.topic_id),null==i?i=t.status:i!=t.status&&(e=!0)});var s={id_set:a,auditdiff:e};this.$emit("selectNotes",s)}}},l=e(81656),o=(0,l.A)(s,function(){var t=this,a=t._self._c;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"topictable",attrs:{data:t.tmpData},on:{"selection-change":t.checkChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"topic_id",label:"id",width:"100"}}),a("el-table-column",{attrs:{label:$t("i9tyji4","话题名称","lang"),prop:"topic_name"}}),a("el-table-column",{attrs:{label:$t("ia1i7a4","话题置项","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.is_top?a("el-tag",{attrs:{type:"danger",size:"mini",effect:"dark"}},[t._v($t("jyavp4"," 置项 ","lang"))]):t._e()]}}])}),a("el-table-column",{attrs:{label:$t("i9z15y4","话题状态","lang"),prop:"status_text"}}),a("el-table-column",{attrs:{label:$t("chizf3","创建人","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return["2"==e.row.source?a("div",[t._v($t("io38z3","管理员","lang"))]):a("div",[t._v(t._s(e.row.userInfo.nickname)),a("br"),t._v(t._s(e.row.userInfo.mobile))])]}}])}),a("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.auditNote(e.row)}}},[t._v(" "+t._s(t.resetText(e.row))+" ")]),"2"==e.row.source?a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]):t._e()]}}])})],1)],1)},[],!1,null,"5c0aa0c4",null).exports,n=e(37505),r=e(9130),c={provide(){return{refresh:this.getDataList}},components:{topiclist:o,auditNote:n.A,topicModal:r.A},data(){return{activeName:"first",loading:!1,params:{page:1,pageSize:10,status:null,type:null},pagers:{total:0},topicList:[],id_set:[],exitsNew:!1,searchkey:"",searchtype:"nickname",searPlace:$t("2j83985","请输入昵称","lang"),auditdiff:!1,dufStatus:null,auditDialogShow:!1,topicModalShow:!1,topicForm:{topic_name:null},topicFormRules:{topic_name:[{required:!0,message:$t("f992bd7","请输入话题名称","lang"),trigger:"blur"}]},editShow:!1}},mounted(){this.$route.query;this.getDataList()},methods:{handleCurrentChange(t){this.params.page=t,this.getDataList()},handleSizeChange(t){this.params.page=1,this.params.pageSize=t,this.getDataList()},handleClick(t,a){var{activeName:e,params:i}=this.$data;"first"===this.activeName?i.status=null:"second"===this.activeName?i.status="0":"third"===this.activeName?i.status="1":"fourth"===this.activeName&&(i.status="4"),this.searchData()},researchMsg(t){var a=$t("2j83985","请输入昵称","lang");return"topic_name"==t?a=$t("7lr2i56","请输入关键字","lang"):"mobile"==t&&(a=$t("7ji3y96","请输入手机号","lang")),this.params.nickname=null,this.params.topic_name=null,this.params.mobile=null,a},searchData(t){const{searchkey:a,searchtype:e}=this.$data;if("searchkey"==t&&""==a){var i=this.researchMsg(e);return this.$message({type:"error",message:i,duration:1500}),!1}this.$data.pagers={total:0},this.params.page=1,this.clearAudioData(),this.getDataList()},clearAudioData(){this.$data.id_set=[],this.$data.topicForm={topic_name:null},this.$data.auditdiff=!1},changeName(){const{searchtype:t}=this.$data;var a=this.researchMsg(t);this.$data.searPlace=a},getDataList(){const t=this;var{activeName:a,params:e,searchkey:s,searchtype:l}=this.$data;e[l]=""!=s?s:null,t.$data.loading=!0,(0,i.getTopics)(e).then(a=>{var{list:e,total_count:i}=a.data.data;t.$data.topicList=e,t.$data.pagers={total:i},t.$data.loading=!1},a=>{t.$data.loading=!1})},cancelAuditDialog(t){this.$data.auditDialogShow=t},selectNotes(t){this.$data.id_set=t.id_set,this.$data.auditdiff=t.auditdiff,t.aloneAuditType?(this.$data.dufStatus=t.aloneAuditType,this.auditHandle()):this.$data.dufStatus="pass"},auditHandle(){const{id_set:t,dufStatus:a}=this.$data;t.length?this.cancelAuditDialog(!0):this.$message({type:"error",message:$t("2edt7y5","请选择话题","lang")})},auditNote(t){const{id_set:a,aloneForm:e}=this.$data;e&&(t={...t,...e}),t.topic_id=a,(0,i.topicVerify)(t).then(t=>{var a=t.data.data.message;this.cancelAuditDialog(!1),this.clearAudioData(),this.getDataList(),this.$message({type:"success",message:a})})},topicModalHide(t,a){this.$data.topicModalShow="boolean"==typeof t&&t},topicModalHandle(t){var a=[];t.forEach(t=>{a.push(t.topic_id)}),(0,i.topicSettop)({topic_id:a}).then(t=>{var{message:a}=t.data.data;this.$message({type:"success",message:a}),this.topicModalHide(!1),this.getDataList()})},editTocicShow(t,a){const{topicForm:e}=this.$data;this.$data.editShow="boolean"==typeof t&&t,a&&(this.$data.topicForm=a),e.topic_id&&this.clearAudioData()},updataFalg(){const t=this,{topicForm:a}=this.$data;this.$refs.topicForm.validate(e=>{if(!e)return!1;(0,i.createTopics)(a).then(a=>{var{message:e}=a.data.data;this.$message({type:"success",duration:1500,message:e,onClose(){t.editTocicShow(),t.getDataList()}})})})},delTopic(){const{id_set:t}=this.$data;var a={topic_id:t};if(t.length<1)return this.$message({type:"error",message:$t("2edt7y5","请选择话题","lang")}),!1;this.$confirm($t("210ipai","此操作将永久删除该话题, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,i.topicDelete)(a).then(t=>{var a=t.data.data.message;this.cancelAuditDialog(!1),this.clearAudioData(),this.getDataList(),this.$message({type:"success",message:a})})})}}},d=(0,l.A)(c,function(){var t=this,a=t._self._c;return a("SpPage",[a("el-row",{staticClass:"action-container",attrs:{gutter:20}},[a("el-col",{attrs:{span:18}},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.editTocicShow(!0)}}},[t._v($t("vbpfp6"," 新建话题 ","lang"))]),a("el-button",{on:{click:t.auditHandle}},[t._v($t("vzwvla6"," 审核话题 ","lang"))]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){return t.topicModalHide(!0)}}},[t._v($t("oh08ct8"," 话题置顶设置 ","lang"))]),a("span",{staticClass:"marbor"}),a("el-select",{staticClass:"searSelect",attrs:{placeholder:$t("avjkd74","全部话题","lang")},on:{change:t.searchData},model:{value:t.params.source,callback:function(a){t.$set(t.params,"source",a)},expression:"params.source"}},[a("el-option",{attrs:{label:$t("avjkd74","全部话题","lang"),value:null}}),a("el-option",{attrs:{label:$t("bz6zog4","官方创建","lang"),value:"2"}}),a("el-option",{attrs:{label:$t("f6qzym4","用户创建","lang"),value:"1"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:t.searPlace},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.searchData("searchkey")}},model:{value:t.searchkey,callback:function(a){t.searchkey=a},expression:"searchkey"}},[a("el-select",{staticClass:"barSelect",attrs:{slot:"prepend",placeholder:$t("l72nr3","请选择","lang")},on:{change:t.changeName},slot:"prepend",model:{value:t.searchtype,callback:function(a){t.searchtype=a},expression:"searchtype"}},[a("el-option",{attrs:{label:$t("f6ukdm4","用户昵称","lang"),value:"nickname"}}),a("el-option",{attrs:{label:$t("qc473b5","用户手机号","lang"),value:"mobile"}}),a("el-option",{attrs:{label:$t("1sc9zz5","话题关键字","lang"),value:"topic_name"}})],1),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(a){return t.searchData("searchkey")}},slot:"append"})],1)],1)],1),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:$t("avez634","全部状态","lang"),name:"first"}},[a("topiclist",{ref:"topictable",attrs:{"tmp-data":t.topicList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes,handleEdit:t.editTocicShow}})],1),a("el-tab-pane",{attrs:{label:$t("eftvg3","待审核","lang"),name:"second"}},[a("topiclist",{attrs:{"tmp-data":t.topicList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes}})],1),a("el-tab-pane",{attrs:{label:$t("ego673","已通过","lang"),name:"third"}},[a("topiclist",{attrs:{"tmp-data":t.topicList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes}})],1),a("el-tab-pane",{attrs:{label:$t("e8vjx3","已拒绝","lang"),name:"fourth"}},[a("topiclist",{attrs:{"tmp-data":t.topicList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes}})],1)],1),a("div",{staticClass:"mt-4 text-right"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper",total:t.pagers.total,"page-size":t.params.pageSize},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),a("auditNote",{attrs:{"audit-type":"topic","dialog-is-show":t.auditDialogShow,auditdiff:t.auditdiff,"duf-status":t.dufStatus},on:{notesAuditHandle:t.auditNote,cancelLabelsDialog:t.cancelAuditDialog}}),t.topicModalShow?a("topicModal",{attrs:{"topic-type":"sort","dialog-is-show":t.topicModalShow},on:{cancelLabelsDialog:t.topicModalHide,modalHandle:t.topicModalHandle}}):t._e(),a("el-dialog",{attrs:{"before-close":t.editTocicShow,visible:t.editShow,"show-close":!1,title:t.topicForm.topic_id?$t("gmremu4","编辑话题","lang"):$t("d8bi914","新建话题","lang"),width:"30%"},on:{"update:visible":function(a){t.editShow=a}}},[a("div",{staticClass:"dialog-tips"},[t._v($t("u0usnfe","确认后新建的话题将需要审核，","lang")),a("br"),t._v($t("pefbcuc","已经通过的话题依旧展示。","lang"))]),a("el-form",{ref:"topicForm",attrs:{model:t.topicForm,rules:t.topicFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{prop:"topic_name",label:$t("i9tyji4","话题名称","lang")}},[a("el-input",{attrs:{placeholder:$t("i9tyji4","话题名称","lang"),maxlength:"32","show-word-limit":!0},model:{value:t.topicForm.topic_name,callback:function(a){t.$set(t.topicForm,"topic_name",a)},expression:"topicForm.topic_name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.updataFalg}},[t._v($t("iv7ii4"," 确认 ","lang"))]),a("el-button",{on:{click:function(a){return t.editTocicShow(!1)}}},[t._v($t("dd4ni4"," 取消 ","lang"))])],1)],1)],1)],1)},[],!1,null,"b603d8f4",null).exports}}]);