"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[5590],{85590:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});a(44114);var i=a(95353),s=(a(57270),a(5134)),n={provide(){return{refresh:this.refresh}},props:["getStatus"],data(){return{create_time:"",activeName:"first",activityLists:[],loading:!1,total_count:0,params:{page:1,pageSize:20,status:"",activity_name:"",time_start_begin:"",time_start_end:""},communityVisible:!1,couponVisible:!1,goodsVisible:!1,goodsList:[],goodsCount:0,goodsPageSize:10,goodsPage:1,nowActivity:""}},computed:{...(0,i.L8)(["wheight"])},watch:{getStatus(t){t&&this.getList(this.params)}},mounted(){this.$route.query.status&&(this.params.status=this.$route.query.status),this.getList(this.params)},methods:{handleCurrentChange(t){this.params.page=t,this.getList(this.params)},addActivityData(){this.$router.push({path:this.matchRoutePath("templ")})},editCommunityAction(t,e){this.$router.push({path:this.matchRoutePath("editor/")+e.activity_id})},dataSearch(){this.params.begin_time="",this.params.end_time="",this.create_time="",this.params.page=1,this.getList(this.params)},getList(t){this.loading=!0,(0,s.getExtrapointList)(t).then(t=>{this.activityLists=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})},updateStatusCommunityAction(t){var e=$t("3pkh9yi","此操作将永久终止该活动, 是否继续?","lang");this.$confirm(e,$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(e,a,i)=>{"confirm"===e&&(0,s.extrapointUpdateStatus)({activity_id:t.activity_id}).then(t=>{this.getList(),this.$message({message:$t("c6bhfy8","修改活动状态成功","lang"),type:"success",duration:5e3})}),i()}})},viewDetail(t){this.$router.push({path:this.matchRoutePath("editor/")+t.activity_id,query:{isnodata:!0}})},dateChange(t){this.params.status="",t&&t.length>0?(this.params.begin_time=this.dateStrToTimeStamp(t[0]+" 00:00:00"),this.params.end_time=this.dateStrToTimeStamp(t[1]+" 23:59:59")):(this.params.begin_time="",this.params.end_time=""),this.params.page=1,this.getList(this.params)},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3},viewCouponList(t){this.couponVisible=!0},handleCancel(){this.communityVisible=!1,this.couponVisible=!1,this.goodsVisible=!1},updateActivityData(t){updateActivityItemData(t).then(t=>{})},editItemPrice(t){let e={id:t.id,item_id:t.item_id,activity_price:t.activity_price,vip_price:t.vip_price,svip_price:t.svip_price,activity_store:t.activity_store,points:t.points};this.updateActivityData(e)},refresh(){this.getList(this.params)}}},r=(0,a(81656).A)(n,function(){var t=this,e=t._self._c;return e("SpRouterView",[e("SpPage",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:4}},[e("el-input",{attrs:{placeholder:$t("e4hvdc4","活动名称","lang")},model:{value:t.params.title,callback:function(e){t.$set(t.params,"title",e)},expression:"params.title"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.dataSearch},slot:"append"})],1)],1),e("el-col",{attrs:{span:4}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","value-format":"yyyy/MM/dd",placeholder:$t("t9q3f56","添加时间筛选","lang")},on:{change:t.dateChange},model:{value:t.create_time,callback:function(e){t.create_time=e},expression:"create_time"}})],1),e("el-col",{attrs:{span:4}},[e("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addActivityData}},[t._v($t("tv32jy6"," 添加活动 ","lang"))])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.activityLists,height:t.wheight-150}},[e("el-table-column",{attrs:{prop:"activity_id",label:"ID",width:"50"}}),e("el-table-column",{attrs:{label:$t("e4hvdc4","活动名称","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.title)),e("br")]}}])}),e("el-table-column",{attrs:{label:$t("e4l2kr4","活动时间","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.begin_time)+" "),e("span",{staticClass:"text-muted"},[t._v("~")]),t._v(" "+t._s(a.row.end_time)+" "),e("span",{staticClass:"text-muted"})]}}])}),e("el-table-column",{attrs:{prop:"status",label:$t("e4mxzs4","活动状态","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return["ready"==a.row.activity_status?e("span",[t._v($t("egbo03","待开始","lang"))]):"processing"==a.row.activity_status?e("span",[t._v($t("lq5q43","进行中","lang"))]):"end"==a.row.activity_status?e("span",[t._v($t("edie63","已结束","lang"))]):t._e()]}}])}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return["end"!==a.row.activity_status&&"invalid"!=a.row.activity_status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.editCommunityAction(a.$index,a.row)}}},[t._v($t("xefpa06"," 编辑活动 ","lang"))]):t._e(),"processing"==a.row.activity_status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.updateStatusCommunityAction(a.row)}}},[t._v($t("rn93i16"," 终止活动 ","lang"))]):t._e(),"end"==a.row.activity_status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.viewDetail(a.row)}}},[t._v($t("anskst6"," 查看活动 ","lang"))]):t._e()]}}])})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"content-center content-top-padded"},[e("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e()],1)],1)},[],!1,null,null,null).exports}}]);