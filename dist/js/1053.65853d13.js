"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[1053],{11053:function(t,e,s){s.r(e),s.d(e,{default:function(){return _}});s(44114);var a=s(95353),i=s(26456),n={name:"",data(){const t=this.$createElement;return{form:{rate_status:!1,whitelist_status:!1,pickupcode_status:!1,minus_shop_gift_store:!1,check_gift_store:!1,ziti_send_oms:!1,nostores_status:!1,recharge_status:!1,repeat_cancel:!1,item_store_status:!1,item_sales_status:!1,invoice_status:!1,distributor_param_status:!1,dianwu_show_status:!1,item_page:[0],cart_page:[0],order_page:[0],is_pharma_industry:!1,use_third_party_system:!1,use_third_party_system_value:"kuaizhen580",clientId:"",clientSecret:"",storeId:"",stores_isolate:!1,stores_isolate_template:"",stores_isolate_type:1},formList:[{label:$t("io5ef24","通用设置","lang"),type:"group"},{label:$t("mmdbuq7","分享带门店参数","lang"),key:"distributor_param_status",type:"switch",isShow:(0,i.bz)(),tip:`${$t("bpmt6gk5","<div><p>\n              已开启：\n            </p>\n            <p>\n              1. 从小程序分享出去的 太阳码和小程序链接\n              带店铺参，其他消费者通过此链接或者太阳码进入商城会切换成参数对应的店铺，同时本地缓存也会切换成参数对应的新店铺。\n            </p>\n            <p>\n              2.\n              顾客通过「管理后台-店铺-店铺商品」生成的商品二维码或其他带店铺参数的二维码进入商城时，其所在店铺将切换为二维码所带参数对应的店铺，同时本地缓存也会切换成参数对应的新店铺。\n            </p>\n            <p>\n              已关闭：\n            </p>\n            <p>\n              1. 从小程序分享出去的 太阳码和小程序链接\n              不带店铺参，其他消费者通过此链接或者太阳码进入商城不会切换成参数对应的店铺，本地缓存也不会切换成参数对应的新店铺，即按照商城原本的进店逻辑进入店铺。\n            </p>\n            <p>\n              2.\n              顾客通过「管理后台-店铺-店铺商品」生成的商品二维码或其他带店铺参数的二维码进入商城时，其所在店铺将切换为二维码所带参数对应的店铺，同时本地缓存也会切换成参数对应的新店铺。\n            </p></div>","lang")}`,onChange:async t=>{const{distributor_param_status:e}=this.form;await this.$api.system.saveShareParams({distributor_param_status:e})}},{label:$t("i7rnfq4","评论设置","lang"),key:"rate_status",type:"switch",onChange:async t=>{const{rate_status:e}=this.form;await this.$api.company.setRateSetting({rate_status:e})}},{label:$t("hlz2bq5","提货码设置","lang"),key:"pickupcode_status",type:"switch",isShow:!this.VERSION_SHUYUN()&&!this.VERSION_B2C()&&!this.isMicorMall,onChange:async t=>{const{pickupcode_status:e}=this.form;await this.$api.company.setPickupcodeSetting({pickupcode_status:e})}},{label:$t("yqjy1l5","会员白名单","lang"),key:"whitelist_status",type:"switch",onChange:async t=>{const{whitelist_status:e}=this.form;await this.$api.company.setWhitelistSetting({whitelist_status:e})}},{label:$t("i70uq94","赠品设置","lang"),key:"check_gift_store",type:"switch",tip:$t("cdwlbsb","赠品缺货是否能继续下单","lang"),isShow:!(0,i.hd)(),onChange:async t=>{const{check_gift_store:e}=this.form;await this.$api.company.setGiftSetting({check_gift_store:e})}},{label:$t("cxdwwt4","推单设置","lang"),key:"ziti_send_oms",type:"switch",tip:$t("xlfnpi8","自提订单推oms","lang"),isShow:!this.VERSION_SHUYUN()&&!(0,i.hd)(),onChange:async t=>{const{ziti_send_oms:e}=this.form;await this.$api.company.setSendOmsSetting({ziti_send_oms:e})}},{label:$t("obo6j96","取消订单设置","lang"),key:"repeat_cancel",type:"switch",tip:$t("jm6c0xc","拒绝后是否能再次发起申请","lang"),onChange:async t=>{const{repeat_cancel:e}=this.form;await this.$api.company.setRepeatCancelSetting({repeat_cancel:e})}},{label:$t("b42heo4","商品库存","lang"),key:"item_store_status",type:"switch",tip:$t("jcnqzxb","商品详情页是否显示库存","lang"),onChange:async t=>{const{item_store_status:e}=this.form;await this.$api.company.setItemStoreSetting({item_store_status:e})}},{label:$t("w309dy6","商品销量显示","lang"),key:"item_sales_status",type:"switch",onChange:async t=>{const{item_sales_status:e}=this.form;await this.$api.company.setItemSalesSetting({item_sales_status:e})}},{label:$t("b31gmf4","发票设置","lang"),key:"invoice_status",type:"switch",tip:$t("tj4sm39","结算页是否显示发票","lang"),isShow:!(0,i.hd)(),onChange:async t=>{const{invoice_status:e}=this.form;await this.$api.company.setInvoiceStatus({invoice_status:e})}},{label:$t("caa1ga4","店务设置","lang"),key:"dianwu_show_status",type:"switch",tip:$t("1kmjgxg","移动端会员中心是否展示店务端入口","lang"),onChange:async t=>{const{dianwu_show_status:e}=this.form;await this.$api.company.setDianwuShowStatus({dianwu_show_status:e})}},{label:$t("b1tp7m4","医药行业","lang"),key:"is_pharma_industry",type:"switch",tip:$t("1mpozfg","用于开启医药行业商品与处方药业务","lang"),onChange:this.primarySetting},{label:$t("pu7miz7","第三方处方系统","lang"),key:"use_third_party_system",type:"switch",isShow:()=>this.form.is_pharma_industry,onChange:this.primarySetting},{label:"",key:"use_third_party_system_value",type:"radio",isShow:()=>this.form.use_third_party_system&&this.form.is_pharma_industry,options:[{label:"kuaizhen580",name:$t("1e7r4d9","580处方业务集成","lang")}],onChange:async t=>{const{dianwu_show_status:e}=this.form;await this.$api.company.setDianwuShowStatus({dianwu_show_status:e})}},{label:"clientId",key:"clientId",type:"input",isShow:()=>this.form.use_third_party_system&&this.form.is_pharma_industry},{label:"clientSecret",key:"clientSecret",type:"input",isShow:()=>this.form.use_third_party_system&&this.form.is_pharma_industry},{label:$t("jaiu4q4","门店ID","lang"),key:"storeId",type:"input",isShow:()=>this.form.use_third_party_system&&this.form.is_pharma_industry},{label:"",component:()=>t("elButton",{attrs:{type:"primary"},on:{click:()=>this.primarySetting("button")}},[$t("e32z2","保存","lang")]),isShow:()=>this.form.use_third_party_system&&this.form.is_pharma_industry},{label:$t("n2v8yt6","商品价格展示","lang"),type:"group"},{label:$t("disape8","商品列表/商详页","lang"),key:"item_page",type:"checkbox",options:(0,i.hd)()?[{label:0,name:$t("m8lft3","销售价","lang"),disabled:!0},{label:1,name:$t("ennc2","原价","lang")}]:[{label:0,name:$t("m8lft3","销售价","lang"),disabled:!0},{label:1,name:$t("ennc2","原价","lang")},{label:2,name:$t("ypnfgl5","会员等级价","lang")},{label:3,name:$t("sqcgy05","付费会员价","lang")}],onChange:async t=>{this.saveItemPriceSetting()}},{label:$t("l8nwq3","购物车","lang"),key:"cart_page",type:"checkbox",options:(0,i.hd)()?[{label:1,name:$t("ennc2","原价","lang")}]:[{label:0,name:$t("upwguf","销售价/会员等级价/付费会员价","lang"),disabled:!0},{label:1,name:$t("ennc2","原价","lang")}],onChange:async t=>{this.saveItemPriceSetting()}},{label:$t("hywfki4","订单详情","lang"),key:"order_page",type:"checkbox",options:(0,i.hd)()?[{label:1,name:$t("ennc2","原价","lang")}]:[{label:0,name:$t("upwguf","销售价/会员等级价/付费会员价","lang"),disabled:!0},{label:1,name:$t("ennc2","原价","lang")}],onChange:async t=>{this.saveItemPriceSetting()}}]}},created(){this.fetch()},computed:{...(0,a.L8)(["isMicorMall"])},methods:{async fetch(){const t=await this.$api.company.getGlobalSetting();this.form={...this.form,rate_status:t.traderate_setting.rate_status,whitelist_status:t.whitelist_setting.whitelist_status,pickupcode_status:t.pickupcode_setting.pickupcode_status,minus_shop_gift_store:t.gift_setting.minus_shop_gift_store,check_gift_store:t.gift_setting.check_gift_store,ziti_send_oms:t.sendoms_setting.ziti_send_oms,nostores_status:!t.nostores_setting.nostores_status,recharge_status:t.recharge_setting.recharge_status,repeat_cancel:t.cancel_setting.repeat_cancel,item_store_status:t.item_store_setting.item_store_status,item_sales_status:t.item_sales_setting.item_sales_status,invoice_status:t.invoice_setting.invoice_status,distributor_param_status:t.share_parameters_setting.distributor_param_status,dianwu_show_status:t.dianwu_setting.dianwu_show_status,is_pharma_industry:"1"==t.medicine_setting.is_pharma_industry,use_third_party_system:!!t.medicine_setting.use_third_party_system,clientId:t.medicine_setting.kuaizhen580_config?.client_id,clientSecret:t.medicine_setting.kuaizhen580_config?.client_secret,storeId:t.medicine_setting.kuaizhen580_config?.kuaizhen_store_id,stores_isolate:t.open_distributor_divided?.status||!1,stores_isolate_template:t.open_distributor_divided?.template||"",stores_isolate_type:t.open_distributor_divided?.type||1};const{cart_page:e,order_page:s,item_page:a}=t.item_price_setting;e.market_price&&(this.form.cart_page=[0,1]),s.market_price&&(this.form.order_page=[0,1]),a.market_price&&(this.form.item_page=[0,1]),a.member_price&&this.form.item_page.push(2),a.svip_price&&this.form.item_page.push(3)},async saveItemPriceSetting(){const{cart_page:t,order_page:e,item_page:s}=this.form,a={cart_page:{market_price:t.indexOf(1)>-1},order_page:{market_price:e.indexOf(1)>-1},item_page:{market_price:s.indexOf(1)>-1,member_price:s.indexOf(2)>-1,svip_price:s.indexOf(3)>-1}};await this.$api.company.saveItemPriceSetting(a)},async primarySetting(t){const{is_pharma_industry:e,use_third_party_system:s,clientId:a,clientSecret:i,storeId:n}=this.form;try{await this.$api.company.setPharmaIndustry({is_pharma_industry:e?"1":"0",use_third_party_system:s?"kuaizhen580":"",kuaizhen580_config:{clientId:a,clientSecret:i,storeId:n}}),"button"==t&&this.$message.success($t("aghf564","保存成功","lang"))}catch(t){this.fetch()}},async onClickStoresIsolate(){const{data:t}=await this.$picker.pages({multiple:!1,data:[Number(this.form?.stores_isolate_template)]});t&&(this.form.stores_isolate_template=t[0].id),this.saveOpenDividedSetting()},async onClickClear(){this.form.stores_isolate_template="",this.saveOpenDividedSetting()},async saveOpenDividedSetting(){const{stores_isolate:t,stores_isolate_template:e,stores_isolate_type:s}=this.form,a={open_distributor_divided:{status:t,template:e,type:t?s:""}};await this.$api.company.saveOpenDividedSetting(a)}}},_=(0,s(81656).A)(n,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpForm",{attrs:{size:"min","form-list":t.formList,submit:!1},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1)},[],!1,null,"88bebfe2",null).exports}}]);