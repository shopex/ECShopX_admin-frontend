"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2781],{32781:function(t,e,i){i.r(e),i.d(e,{default:function(){return b}});i(44114),i(18111),i(7588),i(61701);var a=i(18979),s=i.n(a),r=i(5134),n=i(65124),l=i(98818),o=(i(81193),i(99502)),d=i(54573),c=i(21837),m=i(5748),u=i(59025),g=i(18306),h=i(26456),_=i(95353),f={components:{GoodsSelect:d.default,StoreSelect:o.default,SkuSelector:c.A,Treeselect:s()},inject:["refresh"],computed:{...(0,_.L8)(["shopId"])},data(){return{is_distributor:!1,cursymbol:"￥",storeVisible:!1,relItems:[],relStores:[],setStatus:!1,addNum:"",form:{marketing_id:"",marketing_type:"full_gift",marketing_name:"",marketing_desc:"",start_time:"",end_time:"",used_platform:0,use_bound:"goods",use_shop:0,shop_ids:[],item_ids:[],item_type:"normal",valid_grade:[],condition_type:"totalfee",condition_value:[],join_limit:0,promotion_tag:$t("jmvz2","满赠","lang"),canjoin_repeat:!1,status:"waiting",item_category:[],tag_ids:[],brand_ids:[],in_proportion:!1},vipGrade:[],memberGrade:[],conditionValue:[{full:"",relGifts:[]}],validGrade:[],activity_date:"",selectItemType:"normal",itemVisible:!1,setItemStatus:!1,imgDialog:!1,isGetImage:!1,isIndeterminate:!0,checkAll:!1,relGifts:[],setGiftStatus:!1,giftVisible:!1,hasSaveButton:!0,zdItemHidden:!1,categoryHidden:!0,categoryList:[],tagHidden:!0,tag:{list:[],form:{tag_ids:[]},currentTags:[],tags:[]},brandHidden:!0,brand:{list:[],form:{brand_ids:[]},currentBrands:[],brands:[]},ItemsList:[],invalidItemsList:[],params:{page:1,pageSize:-1,item_type:"normal",templates_id:"",keywords:"",category:0,is_warning:!1,tag_id:"",is_gift:"all",type:0,is_sku:"true",item_id:""}}},watch:{"form.item_ids":{handler:function(t){}},"form.shop_ids":{handler:function(t){t&&(this.form.use_shop=t.length>0?1:0)}}},mounted(){"distributor"===g.A.getters.login_type&&(this.is_distributor=!0),this.$route.params.marketing_id&&this.getActivityDetail(this.$route.params.marketing_id),this.$route.query.isnodata&&(this.hasSaveButton=!1),(0,l.listVipGrade)().then(t=>{null!=t&&t.data.data&&t.data.data.length>0&&(this.vipGrade=t.data.data)}),(0,n.getGradeList)().then(t=>{if(null!=t&&t.data.data&&t.data.data.length>0){var e=t.data.data;e&&(this.memberGrade=e)}}),this.fetchMainCate(),this.getAllTagLists(),this.getBrandList("",!0)},methods:{getItems(t){let e=[];t.forEach(t=>{e.push(t.itemId)}),this.form.item_ids=e},addRules(){this.conditionValue.push({full:"",relGifts:[]})},delRules(t){this.conditionValue.splice(t,1)},relStoresClick(){this.storeVisible=!0,this.setStatus=!0},chooseStoreAction(t){this.storeVisible=!1,this.form.shop_ids=[],null===t||t.length<=0||(this.relStores=t)},closeStoreDialogAction(){this.storeVisible=!1},deleteStoreRow(t){this.setStatus=!1,this.relStores.splice(t,1)},submitActivityAction(){const t=this;let e=JSON.stringify(this.form);e=JSON.parse(e),this.activity_date.length>0&&(e.start_time=this.activity_date[0],e.end_time=this.activity_date[1]),this.conditionValue.length>0&&(e.condition_value=JSON.stringify(this.conditionValue)),this.validGrade.length>0&&(e.valid_grade=this.validGrade),this.form.shop_ids=[],this.relStores&&this.relStores.length>0&&this.relStores.forEach(t=>{this.form.shop_ids.push(t.distributor_id)});for(let t=0;t<this.conditionValue.length;t++){if(""==this.conditionValue[t].full)return void this.$message.error($t("5t73hb","请选择促销件数或金额!","lang"));if(this.conditionValue[t].relGifts.length<=0)return void this.$message.error($t("3cvoaf6","请选择赠品!","lang"))}let i=[],a=[];if(this.conditionValue.forEach(t=>{t.relGifts.forEach(e=>{e.filter_full=t.full})}),this.conditionValue.forEach(t=>{i=[...i,...t.relGifts]}),i.forEach(t=>{let e={item_id:t.item_id,item_name:t.item_name,item_type:t.item_type,price:0,without_return:t.without_return,gift_num:t.gift_num,pics:t.pics,filter_full:t.filter_full};a.push(e)}),e.gifts=JSON.stringify(a),this.use_bound=0,"goods"==e.use_bound){if(e.item_ids&&e.item_ids.length<=0)return this.$message.error($t("7x440pa","参加活动的商品必填!","lang")),!1;this.use_bound=1}e.tag_list=null,e.brand_list=null,e.brand_ids=JSON.stringify(e.brand_ids),e.tag_ids=JSON.stringify(e.tag_ids),e.item_ids=JSON.stringify(e.item_ids),e.shop_ids=JSON.stringify(this.form.shop_ids),this.form.marketing_id?(0,r.updateMarketingActivity)(e).then(e=>{if(!e.data.data.marketing_id)return this.$message.error($t("uzl20e5","保存失败!","lang")),!1;this.loading=!1,this.$message({message:$t("deua4r4","更新成功","lang"),type:"success",duration:500,onClose(){t.refresh(),t.$router.go(-1)}})}):(0,r.addMarketingActivity)(e).then(e=>{if(!e.data.data.marketing_id)return this.$message.error($t("uzl20e5","保存失败!","lang")),!1;this.loading=!1,this.$message({message:$t("e7ygyc4","添加成功","lang"),type:"success",duration:500,onClose(){t.refresh(),t.$router.go(-1)}})})},getActivityDetail(t){(0,r.getMarketingActivityInfo)({marketing_id:t}).then(t=>{let e=t.data.data,i=e.condition_value;i.length>1?i.forEach(t=>{t.relGifts=[],e.gifts.forEach(e=>{t.full==e.filter_full.split(".")[0]&&t.relGifts.push(e)})}):i=[{full:e.condition_value[0].full,relGifts:e.gifts}];let a={marketing_type:"full_gift",promotion_tag:$t("jmvz2","满赠","lang"),marketing_id:e.marketing_id,marketing_name:e.marketing_name,marketing_desc:e.marketing_desc,start_time:e.start_time,end_time:e.end_time,used_platform:e.used_platform,use_bound:e.use_bound,use_shop:e.use_shop,valid_grade:e.valid_grade,condition_type:e.condition_type,condition_value:e.condition_value,join_limit:e.join_limit,item_type:e.item_type,canjoin_repeat:e.canjoin_repeat,status:e.status,item_category:e.item_category,tag_ids:e.tag_ids,tag_list:e.tag_list,brand_ids:e.brand_ids,brand_list:e.brand_list,rel_brand_ids:e.rel_brand_ids,rel_category_ids:e.rel_category_ids,rel_tag_ids:e.rel_tag_ids,in_proportion:e.in_proportion};Object.assign(this.form,a),this.conditionValue=i,this.validGrade=e.valid_grade,this.activity_date=[e.start_time,e.end_time],this.relItems=e.itemTreeLists||[],this.relStores=e.storeLists||[],this.zdItemHidden=!0,this.categoryHidden=!0,this.tagHidden=!0,this.brandHidden=!0,0==e.use_bound&&(this.form.use_bound="all"),1==e.use_bound&&(this.form.use_bound="goods",this.zdItemHidden=!1),2==e.use_bound&&(this.form.use_bound="category",this.categoryHidden=!1,this.generateSku()),3==e.use_bound&&(this.form.use_bound="tag",this.tagHidden=!1,this.tag.currentTags=e.tag_list||[],this.showTags(),this.generateSku()),4==e.use_bound&&(this.form.use_bound="brand",this.brandHidden=!1,this.brand.currentBrands=e.brand_list||[],this.showBrands(),this.generateSku())})},handleCancel:function(){this.$router.back(-1)},async relGiftsClick(t){this.relGifts=[],this.addNum=t;this.conditionValue[t].relGifts.map(({item_id:t})=>t);const{data:e}=await this.$picker.goods({queryParams:{distributor_id:this.shopId}});let i=[...this.conditionValue[t].relGifts,...e];const a={},s=[];i.forEach(t=>{a[t.item_id]||(s.push(t),a[t.item_id]=!0)}),this.chooseGiftsAction(s)},chooseGiftsAction(t){if(null===t||t.length<=0)return;if(t.length>4)return this.$message.error($t("n9jujt9","赠品最多4件商品!","lang")),!1;let e=JSON.parse(JSON.stringify(t));e.forEach((t,e)=>{t.gift_num=1,t.without_return=!1}),e.forEach(t=>{t.filter_full=this.conditionValue[this.addNum].full}),this.conditionValue[this.addNum].relGifts=e},closeGiftsDialogAction(){this.giftVisible=!1},deleteGiftRow:function(t,e){this.setGiftStatus=!1,this.conditionValue[e].relGifts.splice(t,1)},itemTypeChange:function(t){this.params.main_cat_id="",this.params.tag_id="",this.params.brand_id="",this.zdItemHidden=!0,this.categoryHidden=!0,this.tagHidden=!0,this.brandHidden=!0,this.form.items=[],this.invalidItemsList=[],this.form.rel_item_ids=[],this.form.itemTreeLists=[],this.form.item_category=[],this.form.item_category=[],this.tag.currentTags=[],"goods"===t?this.zdItemHidden=!1:"category"===t?(this.form.rel_item_ids=[],this.form.itemTreeLists=[],this.categoryHidden=!1,this.form.item_category=[]):"tag"===t?(this.tagHidden=!1,this.tag.currentTags=[],this.showTags()):"brand"===t&&(this.brandHidden=!1,this.brand.currentBrands=[],this.showBrands())},fetchMainCate:function(){(0,m.getCategory)({is_main_category:!0,ignore_none:!0}).then(t=>{this.categoryList=(0,h.IO)(t.data.data,{id:"category_id",label:"category_name",children:"children"})})},addItemTag:function(){this.tag.currentTags=[],this.item_id.length?(this.showTags(),this.tag.form.item_ids=this.item_id):this.$message({type:"error",message:$t("eajgmxa","请选择至少一个商品!","lang")})},showTags:function(){let t=[];this.tag.tags=[...this.tag.list],this.tag.tags.forEach((e,i)=>{-1==this.tag.currentTags.findIndex(t=>t.tag_id==e.tag_id)&&t.push(e)}),this.tag.tags=t},tagRemove:function(t){this.tag.tags.unshift(this.tag.currentTags[t]),this.tag.currentTags.splice(t,1),this.form.tag_ids=[];let e=[],i=[];this.tag.currentTags.forEach(t=>{this.form.tag_ids.push(t.tag_id);let a=[];this.ItemsList.forEach(e=>{-1!=e.tag_ids.indexOf(t.tag_id)&&a.push(e)}),e=a;let s=[];this.invalidItemsList.forEach(e=>{-1!=e.tag_ids.indexOf(t.tag_id)&&s.push(e)}),i=s}),this.ItemsList=e,this.invalidItemsList=i,this.getItems(this.ItemsList)},tagAdd:function(t,e){if(this.activity_date.length<=0)return this.$message({type:"error",message:$t("dvs78h8","请选择活动时间!","lang")}),!1;-1==this.tag.currentTags.findIndex(e=>e.tag_id==t.tag_id)&&(this.tag.currentTags.push(t),this.tag.tags.splice(e,1)),this.form.tag_ids=[],this.tag.currentTags.forEach(t=>{this.form.tag_ids.push(t.tag_id)}),this.params.tag_id=t.tag_id},getAllTagLists:function(){(0,m.getTagList)({page:1,pageSize:500}).then(t=>{this.tag.list=t.data.data.list,this.showTags()})},getBrandList:function(t="",e=!1){const i=[];(0,m.getGoodsAttr)({page:1,pageSize:1e3,attribute_type:"brand",attribute_name:t,attribute_ids:e?this.form.brand_id:""}).then(t=>{for(let e of t.data.data.list)i.push({attribute_name:e.attribute_name,attribute_id:e.attribute_id});this.brand.list=i,this.showBrands()})},showBrands:function(){let t=[];this.brand.brands=[...this.brand.list],this.brand.brands.forEach((e,i)=>{-1==this.brand.currentBrands.findIndex(t=>t.attribute_id==e.attribute_id)&&t.push(e)}),this.brand.brands=t},brandAdd:function(t,e){if(this.activity_date.length<=0)return this.$message({type:"error",message:$t("dvs78h8","请选择活动时间!","lang")}),!1;-1==this.brand.currentBrands.findIndex(e=>e.attribute_id==t.attribute_id)&&(this.brand.currentBrands.push(t),this.brand.brands.splice(e,1)),this.form.brand_ids=[],this.brand.currentBrands.forEach(t=>{this.form.brand_ids.push(t.attribute_id)}),this.params.brand_id=t.attribute_id},brandRemove:function(t){let e=[];this.ItemsList.forEach(i=>{this.brand.currentBrands[t].attribute_id!=i.brand_id&&e.push(i)});let i=[];this.invalidItemsList.forEach(e=>{this.brand.currentBrands[t].attribute_id!=e.brand_id&&i.push(e)}),this.invalidItemsList=i,this.ItemsList=e,this.getItems(this.ItemsList),this.brand.brands.unshift(this.brand.currentBrands[t]),this.brand.currentBrands.splice(t,1),this.form.brand_ids=[],this.brand.currentBrands.forEach(t=>{this.form.brand_ids.push(t.attribute_id)})},getGoodsList:function(){let t=JSON.parse(JSON.stringify(this.params));this.$route.params.marketing_id&&(t.activity_id=this.$route.params.marketing_id),t.marketing_type=this.form.marketing_type,t.activity_release_time=t.activity_start_time=this.activity_date[0],t.activity_end_time=this.activity_date[1],"all"==t.is_gift&&this.$delete(t,"is_gift"),(0,r.seckillActivityGetItemsList)(t).then(t=>{let e=t.data.data.list.validItems.concat(this.ItemsList),i=t.data.data.list.invalidItems.concat(this.invalidItemsList),a=[],s=[],r={},n={};e.forEach(t=>{let e=[];t.tagList.forEach(t=>{e.push(t.tag_id)}),t.tag_ids=e,r[t.item_id]||(a.push(t),r[t.item_id]=!0)}),i.forEach(t=>{let e=[];t.tagList.forEach(t=>{e.push(t.tag_id)}),t.tag_ids=e,n[t.item_id]||(s.push(t),n[t.item_id]=!0)}),this.ItemsList=a,this.invalidItemsList=s,this.getItems(this.ItemsList)})},categorySelect:function(t,e){this.params.main_cat_id=t.category_id,this.getGoodsList()},categoryDeselect:function(t,e){let i;i=[],this.ItemsList.forEach((e,a)=>{t.category_id!=e.item_main_cat_id&&i.push(e)});let a=[];this.invalidItemsList.forEach(e=>{t.category_id!=e.item_main_cat_id&&a.push(e)}),this.invalidItemsList=a,this.ItemsList=i,this.getItems(this.ItemsList)},generateSku(){let t;t=[];let e=[],i=JSON.parse(JSON.stringify(this.relItems));if(i.forEach(e=>{e.nospec||0!==e.spec_items.length||t.push(e.default_item_id)}),t.length>0){this.params.item_id=t,(0,m.getItemsList)(this.params).then(t=>{i.forEach(e=>{e.nospec||t.data.data.list.forEach(t=>{e.item_id===t.default_item_id&&e.spec_items.push(t)})}),i.forEach(t=>{e=t.nospec?[...e,t]:[...e,...t.spec_items]}),this.ItemsList=e,this.getItems(e)})}else i.forEach(t=>{e=t.nospec?[...e,t]:[...e,...t.spec_items]}),this.ItemsList=e,this.getItems(e)},uploadHandleTemplate(){let t={file_type:"marketing_goods",file_name:$t("b44ik94","商品模板","lang")};(0,u.exportUploadTemplate)(t).then(t=>{let{data:e}=t.data;if(e.file){var i=document.createElement("a");i.href=e.file,i.download=e.name,document.body.appendChild(i),i.click(),i.remove()}else this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})})},uploadHandleChange(t,e){let i={isUploadFile:!0,file_type:"marketing_goods",file:t.raw};(0,u.handleUploadFile)(i).then(t=>{this.$message({type:"success",message:$t("a6esth4","上传成功","lang")});let{data:e}=t.data;if(e.fail.length>0){let t=e.fail.map(t=>t.item_bn);setTimeout(()=>{this.$message({showClose:!0,message:`${$t("ojz3zza","以下商品编号不存在：","lang")}${t}`,type:"error",duration:5e3})},1500)}if(e.succ.length<=0)return;this.relItems=e.succ;let i=[];e.succ.forEach(t=>{t.nospec?i.push(t):i.push(Object.assign(t,{spec_items:[]}))})})}}},p=(0,i(81656).A)(f,function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",staticClass:"box-set page-fullgift",attrs:{model:t.form,"label-width":"120px"}},[e("el-card",{attrs:{header:$t("blh1h04","基础信息","lang"),shadow:"naver"}},[e("el-form-item",{attrs:{label:$t("eyrn2","名称","lang"),prop:"marketing_name",rules:{required:!0,message:$t("750pjq6","活动名称必填","lang"),trigger:"blur"}}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{disabled:"waiting"!=t.form.status,maxlength:30,placeholder:$t("nm4xng6","最多30个字","lang")},model:{value:t.form.marketing_name,callback:function(e){t.$set(t.form,"marketing_name",e)},expression:"form.marketing_name"}})],1)],1),e("el-form-item",{attrs:{label:$t("aonl824","促销规则","lang")}},[e("el-row",{attrs:{gutter:1}},[e("el-col",{attrs:{span:9}},[e("el-radio",{attrs:{disabled:"waiting"!=t.form.status,label:"quantity"},model:{value:t.form.condition_type,callback:function(e){t.$set(t.form,"condition_type",e)},expression:"form.condition_type"}},[t._v($t("bc4vpo6"," 按总件数 ","lang"))]),e("el-radio",{attrs:{disabled:"waiting"!=t.form.status,label:"totalfee"},model:{value:t.form.condition_type,callback:function(e){t.$set(t.form,"condition_type",e)},expression:"form.condition_type"}},[t._v($t("b23ncu6"," 按总金额 ","lang"))])],1),e("el-col",{staticClass:"add-gift"},[t._l(t.conditionValue,function(i,a){return e("div",{key:a},[e("span",[t._v($t("eejr2o4","消费满 ","lang")),e("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"waiting"!=t.form.status,type:"input",placeholder:"0.00",size:"mini"},model:{value:i.full,callback:function(e){t.$set(i,"full",e)},expression:"item.full"}}),t._v(" "+t._s("quantity"==t.form.condition_type?$t("fli1","件","lang"):$t("g1v1","元","lang"))+$t("sl7d3q6","，送赠品  ","lang")),0!=a?e("i",{staticClass:"iconfont icon-trash-alt",on:{click:function(e){return t.delRules(a)}}}):t._e()],1),e("el-button",{staticClass:"el-icon-plus rel-gift",attrs:{type:"primary",size:"mini",round:""},on:{click:function(e){return t.relGiftsClick(a)}}},[t._v($t("tzsxay6"," 添加赠品 ","lang"))]),e("div",[i.relGifts.length>0?e("el-table",{staticStyle:{"line-height":"normal"},attrs:{data:i.relGifts}},[e("el-table-column",{attrs:{label:"ID",prop:"item_id",width:"60"}}),e("el-table-column",{attrs:{label:$t("eyrn2","名称","lang"),prop:"item_name"}}),e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc"}}),e("el-table-column",{attrs:{label:$t("i6ufsw4","赠品数量","lang"),width:"90"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{attrs:{width:"90",size:"mini",disabled:"waiting"!=t.form.status},model:{value:i.row.gift_num,callback:function(e){t.$set(i.row,"gift_num",e)},expression:"scope.row.gift_num"}})]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"50"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"iconfont icon-trash-alt",on:{click:function(e){return t.deleteGiftRow(i.$index,a)}}})]}}],null,!0)})],1):t._e(),e("GoodsSelect",{attrs:{"unwanted-gift":!t.VERSION_SHUYUN(),"items-visible":t.giftVisible,"get-status":t.setGiftStatus,"rel-items-ids":t.relGifts,"is-spec":"","item-type":t.form.item_type},on:{chooseStore:t.chooseGiftsAction,closeStoreDialog:t.closeGiftsDialogAction}})],1)],1)}),e("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",disabled:"waiting"!=t.form.status,size:"mini",round:""},on:{click:t.addRules}},[t._v($t("h2eu34"," 添加 ","lang"))])],2),e("el-col",[e("el-checkbox",{attrs:{disabled:"waiting"!=t.form.status},model:{value:t.form.in_proportion,callback:function(e){t.$set(t.form,"in_proportion",e)},expression:"form.in_proportion"}},[t._v($t("lq3q697"," 按比例赠送 ","lang"))])],1)],1)],1),e("el-form-item",{attrs:{label:$t("hq25cm4","规则描述","lang")}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{disabled:"waiting"!=t.form.status,type:"textarea",rows:3,placeholder:$t("hq25cm4","规则描述","lang")},model:{value:t.form.marketing_desc,callback:function(e){t.$set(t.form,"marketing_desc",e)},expression:"form.marketing_desc"}})],1)],1),e("el-form-item",{attrs:{label:$t("g2vel25","可参与次数","lang")}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{disabled:"waiting"!=t.form.status,type:"input",placeholder:$t("d80e3n4","整数数字","lang")},model:{value:t.form.join_limit,callback:function(e){t.$set(t.form,"join_limit",e)},expression:"form.join_limit"}})],1)],1),e("el-form-item",{attrs:{label:$t("infiw44","适用会员","lang")}},[e("el-checkbox-group",{attrs:{disabled:"waiting"!=t.form.status},model:{value:t.validGrade,callback:function(e){t.validGrade=e},expression:"validGrade"}},[t._l(t.memberGrade,function(i){return e("el-checkbox",{key:i.grade_id,attrs:{label:i.grade_id}},[t._v(" "+t._s(i.grade_name)+" ")])}),t._l(t.vipGrade,function(i){return e("el-checkbox",{key:i.lv_type,attrs:{label:i.lv_type}},[t._v($t("euf53"," 付费","lang")+t._s(i.grade_name)+" ")])})],2)],1),e("el-form-item",{attrs:{label:$t("ini4sj4","适用平台","lang")}},[e("el-radio-group",{model:{value:t.form.used_platform,callback:function(e){t.$set(t.form,"used_platform",e)},expression:"form.used_platform"}},[e("el-radio",{attrs:{label:0}},[t._v($t("acj85n6"," 全场可用 ","lang"))])],1)],1),e("el-form-item",{attrs:{label:$t("fl3fk3","有效期","lang")}},[e("el-col",{attrs:{span:20}},[e("el-date-picker",{attrs:{disabled:"waiting"!=t.form.status,type:"datetimerange","range-separator":$t("po31","至","lang"),"start-placeholder":$t("f753lz4","生效时间","lang"),"end-placeholder":$t("ikg3cm4","过期时间","lang"),"value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:t.activity_date,callback:function(e){t.activity_date=e},expression:"activity_date"}})],1)],1)],1),e("el-card",{attrs:{header:$t("ikwu2j4","选择商品","lang"),shadow:"naver"}},[e("el-form-item",{attrs:{label:$t("ingkrl4","适用商品","lang")}},[e("el-radio-group",{on:{change:t.itemTypeChange},model:{value:t.form.use_bound,callback:function(e){t.$set(t.form,"use_bound",e)},expression:"form.use_bound"}},[e("el-radio",{attrs:{label:"all"}},[t._v($t("vrwg5b8"," 全部商品适用 ","lang"))]),e("el-radio",{attrs:{label:"goods"}},[t._v($t("q7xfmc8"," 指定商品适用 ","lang"))]),e("el-radio",{attrs:{label:"category"}},[t._v($t("xx0gpa8"," 指定分类适用 ","lang"))]),e("el-radio",{attrs:{label:"tag"}},[t._v($t("5ghnxxa"," 指定商品标签适用 ","lang"))]),e("el-radio",{attrs:{label:"brand"}},[t._v($t("oiwwqs8"," 指定品牌适用 ","lang"))])],1)],1),t.zdItemHidden?t._e():e("div",{staticStyle:{position:"relative"}},[e("SkuSelector",{attrs:{data:t.relItems},on:{change:t.getItems}}),e("div",{staticStyle:{position:"absolute",bottom:"0px",left:"112px"}},[e("el-upload",{staticStyle:{display:"inline-block",height:"0"},attrs:{action:"","on-change":t.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}},[e("el-button",{attrs:{type:"primary"}},[t._v($t("7afr9o6"," 批量上传 ","lang"))])],1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.uploadHandleTemplate()}}},[t._v($t("gbapcg6"," 下载模板 ","lang"))])],1)],1),e("el-col",{attrs:{xs:12,sm:12,md:12}},[t.categoryHidden?t._e():e("div",{staticStyle:{height:"350px"}},[e("treeselect",{attrs:{options:t.categoryList,"show-count":!0,multiple:!0,"disable-branch-nodes":!0,clearable:!1},on:{select:t.categorySelect,deselect:t.categoryDeselect},model:{value:t.form.item_category,callback:function(e){t.$set(t.form,"item_category",e)},expression:"form.item_category"}})],1)]),t.tagHidden?t._e():[e("div",{staticClass:"selected-tags view-flex"},[e("div",{staticClass:"label"},[t._v($t("rbsw8d6","已选中标签：","lang"))]),e("div",{staticClass:"view-flex-item"},t._l(t.tag.currentTags,function(i,a){return e("el-tag",{key:a,attrs:{closable:"",size:"small","disable-transitions":!1},on:{close:function(e){return t.tagRemove(a)}}},[t._v(" "+t._s(i.tag_name)+" ")])}),1)]),e("div",t._l(t.tag.tags,function(i,a){return e("el-tag",{key:a,staticClass:"tag-item",attrs:{size:"medium",color:"#ffffff","disable-transitions":!1},nativeOn:{click:function(e){return t.tagAdd(i,a)}}},[t._v(" "+t._s(i.tag_name)+" ")])}),1)],t.brandHidden?t._e():[e("div",{staticClass:"selected-tags view-flex"},[e("div",{staticClass:"label"},[t._v($t("r8xpax6","已选中品牌：","lang"))]),e("div",{staticClass:"view-flex-item"},t._l(t.brand.currentBrands,function(i,a){return e("el-tag",{key:a,attrs:{closable:"",size:"small","disable-transitions":!1},on:{close:function(e){return t.brandRemove(a)}}},[t._v(" "+t._s(i.attribute_name)+" ")])}),1)]),e("div",t._l(t.brand.brands,function(i,a){return e("el-tag",{key:a,staticClass:"tag-item",attrs:{size:"medium",color:"#ffffff","disable-transitions":!1},nativeOn:{click:function(e){return t.brandAdd(i,a)}}},[t._v(" "+t._s(i.attribute_name)+" ")])}),1)]],2),t.VERSION_STANDARD()&&!t.is_distributor?e("el-card",{attrs:{header:$t("gdpm984","绑定店铺","lang"),shadow:"naver"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.relStoresClick}},[t._v($t("j25ub85"," 选店铺 ","lang"))]),t.relStores.length>0?e("el-table",{staticStyle:{"line-height":"normal"},attrs:{data:t.relStores}},[e("el-table-column",{attrs:{label:"ID",prop:"distributor_id",width:"60"}}),e("el-table-column",{attrs:{label:$t("eyrn2","名称","lang"),prop:"name"}}),e("el-table-column",{attrs:{prop:"address",label:$t("fb4g2","地址","lang"),"show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"50"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"iconfont icon-trash-alt",on:{click:function(e){return t.deleteStoreRow(i.$index,t.form.items)}}})]}}],null,!1,3604158687)})],1):t._e(),e("StoreSelect",{attrs:{"store-visible":t.storeVisible,"is-valid":!0,"rel-data-ids":t.relStores,"get-status":t.setStatus},on:{chooseStore:t.chooseStoreAction,closeStoreDialog:t.closeStoreDialogAction}})],1):t._e(),e("div",{staticClass:"content-center"},[t.hasSaveButton?e("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.submitActivityAction,expression:"submitActivityAction"}],attrs:{type:"primary"}},[t._v($t("cp35x4"," 保存 ","lang"))]):t._e(),e("el-button",{nativeOn:{click:function(e){return t.handleCancel.apply(null,arguments)}}},[t._v($t("m1m0m4"," 返回 ","lang"))])],1)],1)},[],!1,null,"12f92fbe",null),b=p.exports}}]);