"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[3596],{83596:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});a(18111),a(61701);var i={data(){const t=this.$createElement;return{articleForm:{title:"",summary:"",author:"",head_portrait:"",category_id:"",region_id:[],region_name:[],image_url:"",share_image_url:""},articleFormList:[{label:$t("ij5d2","标题","lang"),key:"title",type:"input"},{label:$t("cl7a83","副标题","lang"),key:"summary",type:"input"},{label:$t("aji9v04","作者名称","lang"),key:"author",type:"input"},{label:$t("ajixac4","作者头像","lang"),key:"head_portrait",component:({key:e},a)=>t("SpImagePicker",{model:{value:a[e],callback:t=>{this.$set(a,e,t)}}})},{label:$t("h4xfws6","文章类目选择","lang"),key:"category_id",type:"select",options:[]},{label:$t("bcrrey4","地区选择","lang"),key:"region_id",component:({key:e},a)=>t("div",{class:"flex gap-2"},[t("SpRegionSelect",{on:{change:this.handleRegionChange},style:"width: 260px;",model:{value:a[e],callback:t=>{this.$set(a,e,t)}}}),t("el-button",{attrs:{type:"default"},on:{click:this.asyncToArticleTitle}},[$t("nf05iy7","点击同步到标题","lang")])])},{label:$t("c8ctvu4","封面图片","lang"),key:"image_url",component:({key:e},a)=>t("SpImagePicker",{model:{value:a[e],callback:t=>{this.$set(a,e,t)}}}),tip:$t("jvk7goi","建议尺寸：200像素 * 200像素","lang")},{label:$t("aodz5a4","分享图片","lang"),key:"share_image_url",component:({key:e},a)=>t("SpImagePicker",{model:{value:a[e],callback:t=>{this.$set(a,e,t)}}}),tip:$t("jvk7goi","建议尺寸：200像素 * 200像素","lang")}],content:[]}},computed:{pageTitle(){return this.$route.query.id?$t("gmrqer4","编辑软文","lang"):$t("arews74","创建软文","lang")}},mounted(){this.$route.query.id&&this.getArticle(),this.$route.meta.name=this.$route.query.id?"edit":"create",this.getArticleCategory()},methods:{async getArticle(){const t=await this.$api.article.getArticleInfo(this.$route.query.id);t&&(this.articleForm={title:t.title,summary:t.summary,author:t.author,head_portrait:t.head_portrait,category_id:t.category_id,region_id:t.regions_id,region_name:t.regions,image_url:t.image_url,share_image_url:t.share_image_url},this.content=t.content)},async getArticleCategory(){const t=(await this.$api.article.getArticleCategoryList({category_type:"bring"})).map(t=>({title:t.category_name,value:t.category_id}));this.$refs.articleForm.setField(this.articleFormList,"category_id",{options:t})},asyncToArticleTitle(){const t=this.articleForm.title.replace(/^\[(.+?)\]/g,"");this.articleForm.title=`[${this.articleForm.region_name.join("")}]${t}`},handleRegionChange({region_name:t}){this.articleForm.region_name=t},async onSubmitTabList(){const t={...this.articleForm,article_type:"bring",content:this.content};this.$route.query.id?(await this.$api.article.updateArticle(this.$route.query.id,t),this.$message.success($t("axgh776","修改文章成功","lang")),this.$parent.onActivated(),this.$router.go(-1)):(await this.$api.article.createArticle(t),this.$message.success($t("t3nsp96","添加文章成功","lang")),this.$parent.onActivated(),this.$router.go(-1))}}},r=(0,a(81656).A)(i,function(){var t=this,e=t._self._c;return e("div",[e("SpPageHeader",{attrs:{title:t.pageTitle}}),e("div",{staticClass:"flex gap-5"},[e("div",{staticClass:"px-5"},[e("SpIphone",[e("SpDecorate",{ref:"decorateRef",attrs:{scene:"1005",title:$t("iit1a94","软文装修","lang")},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1),e("div",{staticClass:"flex-1"},[e("SpForm",{ref:"articleForm",attrs:{submit:"","label-width":"120px","form-list":t.articleFormList},on:{onSubmit:t.onSubmitTabList},model:{value:t.articleForm,callback:function(e){t.articleForm=e},expression:"articleForm"}})],1)])],1)},[],!1,null,"2cdc9d20",null).exports}}]);