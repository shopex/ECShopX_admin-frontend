"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[1497],{11497:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});a(44114);var n=a(94644),s=(a(57270),a(85135)),i=a(88160),l=a(24866),r={components:{smsMassLogEdit:i.default,Template:l.A},data(){return{visible:!1,info:{},search_options:[{label:$t("iir813","等待中","lang"),value:"1"},{label:$t("ggbit84","群发成功","lang"),value:"2"},{label:$t("ggac1t4","群发失败","lang"),value:"3"},{label:$t("e9b2m3","已撤销","lang"),value:"4"}]}},computed:{setting(){return(t=>{const e=t=>{var e=new Date(1e3*t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())};return(0,n.createSetting)({search:[{key:"time_start",name:$t("b66bda4","发送时间","lang"),type:"date-range",defaultTime:["00:00:00","23:59:59"],startPlaceholder:$t("cd0ag54","开始日期","lang"),endPlaceholder:$t("gfhy2u4","结束日期","lang")},{key:"status",name:$t("aba2dt4","任务状态","lang"),type:"select",options:t.search_options},{key:"task_name",name:$t("ab4zrd4","任务名称","lang")},{key:"template_name",name:$t("fgr5si4","短信模板","lang")}],columns:[{name:$t("ab4zrd4","任务名称","lang"),key:"task_name",width:"140px"},{name:$t("ar84e54","创建时间","lang"),key:"created",formatter:e,width:"170px"},{name:$t("bza31o4","定时发送","lang"),key:"send_at",formatter:e,width:"170px"},{name:$t("fgr5si4","短信模板","lang"),key:"template_name"},{name:$t("aba2dt4","任务状态","lang"),key:"status",width:"100px",render:(t,{row:e})=>t("div",{class:"yahh"},[t("span",{},"1"==e.status&&$t("iir813","等待中","lang")||"2"==e.status&&$t("ggbit84","群发成功","lang")||"3"==e.status&&$t("ct3zr35","群发失败 ","lang")||"4"==e.status&&$t("ca0j9u4","已撤销 ","lang")),2==e.status&&e.reason&&t("el-tooltip",{class:"tips",props:{effect:"dark",content:e.reason,placement:"top"}},[t("i",{class:"el-icon-warning-outline"},"")])])},{name:$t("b3bwzt4","号码数量","lang"),key:"total_num",render:(e,{row:a})=>e("span",{type:"text",class:"e-button--text",style:{color:"#409EFF",cursor:"pointer"},on:{click:()=>{t.$router.push({path:"/systemsetting/datamessage/ali_sms/sms_sendLog",query:{task_name:a.task_name}})}}},a.total_num),align:"center"},{name:$t("8uhpst6","失败号码数量","lang"),key:"failed_num",align:"center"}],actions:[{name:$t("ibpi2","查看","lang"),key:"detail",type:"button",buttonType:"text",action:{type:"link",handler:async e=>{t.visible=!0,t.info={type:"detail",id:e[0].id}}},visible:t=>"4"!=t.status},{name:$t("hxp82","撤销","lang"),key:"delete",type:"button",buttonType:"text",action:{type:"link",handler:async e=>{t.deleteSMS(e[0].id)}},visible:t=>"1"==t.status},{name:$t("mekb2","编辑","lang"),key:"edit",type:"button",buttonType:"text",action:{type:"link",handler:async e=>{t.visible=!0,t.info={type:"edit",id:e[0].id}}},visible:t=>"4"==t.status}]})})(this)}},methods:{addTemplate(){this.$router.push({path:this.matchRoutePath("edit")})},beforeSearch(t){return{...t}},afterSearch(){},async deleteSMS(t){const e=$t("w8qd53h","选择确定后，群发定时任务将会撤销。","lang");this.$confirm(e,"",{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(async()=>{await(0,s.deleteTaskSms)({id:t});this.$message.success($t("db9r3f4","撤销成功","lang")),this.$refs.finder.refresh(!0)})},smsMassLogEditHandler(){this.visible=!1},updateFinder(){this.$refs.finder.refresh(!0)}}},o=(0,a(81656).A)(r,function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"sms_signatures"},[e("SpFinder",{ref:"finder",attrs:{"split-count":4,"search-row-count":4,"fixed-row-action":!0,setting:t.setting,"no-selection":"",hooks:{beforeSearch:t.beforeSearch,afterSearch:t.afterSearch},url:"/aliyunsms/task/list"}})],1),t.visible?[e("smsMassLogEdit",{attrs:{visible:t.visible,info:t.info},on:{smsMassLogEditHandler:t.smsMassLogEditHandler,updateFinder:t.updateFinder}})]:t._e()],2)},[],!1,null,null,null).exports}}]);