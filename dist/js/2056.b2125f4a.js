"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2056],{12056:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var i=a(47499),s=a.n(i),r=(a(44114),a(18111),a(22489),a(20116),a(7588),a(61701),a(95093)),o=a.n(r),l=(a(5748),a(26456)),n=a(2038),c=(a(33318),{data(){const e=this.$createElement,t=this.$store.getters.login_type;let a,i=[{title:$t("meu01y5","前台可销售","lang"),value:"onsale"},{title:$t("mfygnl5","前台不展示","lang"),value:"offline_sale"},{title:$t("mfuo7t5","前台仅展示","lang"),value:"only_show"},{title:$t("a7er004","不可销售","lang"),value:"instock"}];a="distributor"==t?[{title:$t("en402","全部","lang"),value:""},{title:$t("c025s24","审核驳回","lang"),value:"rejected"},{title:$t("fy8avn4","等待审核","lang"),value:"processing"},{title:$t("meu01y5","前台可销售","lang"),value:"onsale"},{title:$t("mfygnl5","前台不展示","lang"),value:"offline_sale"},{title:$t("mfuo7t5","前台仅展示","lang"),value:"only_show"},{title:$t("a7er004","不可销售","lang"),value:"instock"}]:[{title:$t("en402","全部","lang"),value:""},...i];let r=[];return r=(0,l.WZ)()?[{name:$t("av9wor4","全部商品","lang"),value:"all",activeName:"first"},{name:$t("eh2xl3","待提交","lang"),value:"submitting",activeName:"submitting"},{name:$t("eftvg3","待审核","lang"),value:"processing",activeName:"processing"},{name:$t("ego673","已通过","lang"),value:"approved",activeName:"approved"},{name:$t("e8vjx3","已拒绝","lang"),value:"rejected",activeName:"rejected"},{name:$t("lx3u4e6","库存预警商品","lang"),value:"true",activeName:"second"}]:[{name:$t("av9wor4","全部商品","lang"),value:"all",activeName:"first"},{name:$t("lx3u4e6","库存预警商品","lang"),value:"true",activeName:"second"}],{formLoading:!1,commissionDialog:!1,commissionForm:{goods_id:0,commission_ratio:""},show_profit_sideBar:!1,select_tags_value:[],current:"",currentId:"",currentPrice:"",tabList:r,activeName:"first",goodsName:"",isEdit:!1,ItemsList:[],item_id:[],goods_id:[],templates_new_id:"",category_id:[],show_sideBar:!1,loading:!1,submitLoading:!1,total_count:0,warning_store:5,templatesParams:{page:1,pageSize:1e3},goodsBranchList:[],appID:"",sunCode:!1,sunCodeTitle:"",appCodeUrl:"",curPageUrl:"",goodsBranchParams:{page:1,pageSize:1e3,attribute_type:"brand",attribute_name:""},page:{pageIndex:1,pageSize:20,total:0},searchParams:{item_type:"normal",templates_id:"",keywords:"",item_bn:"",supplier_goods_bn:"",supplier_name:"",approve_status:"",category:0,item_category:0,is_warning:!1,audit_status:"",delivery_data_type:"",tag_id:"",tax_rate_code:"",is_gift:void 0,type:0,barcode:"",distributor_id:0,regions_id:[],brand_id:"",goods_bn:"",operator_name:"",cat_id:""},start_date:"",end_date:"",addCategorydialogVisible:!1,form:{},isGiftsData:{},exportData:{},exportTagData:{},tagList:[],grade:[],vipGrade:[],statusOption:a,itemstore:0,distributorVisible:!1,setDistributorStatus:!1,relDistributorIds:"",selections:[],xpGoodsVisible:!1,batchChangeStateDialog:!1,batchChangeStateFormList:[{label:$t("b45xmu4","商品状态","lang"),key:"status",type:"select",message:$t("adohlc4","不能为空","lang"),options:i}],batchChangeStateForm:{status:""},categoryList:[],templatesList:[],templatesListavailable:[],itemCategoryList:[],regions:[],showMemberPriceDrawer:!1,showItemStoreDrawer:!1,specItems:[],storeItemsList:[],skuLoading:!1,showItemSkuDrawer:!1,itemSkuDrawerTitle:"",itemSkuList:[],labelDialog:!1,labelForm:{item_id:[]},labelFormList:[{label:$t("cg6dpq4","已选标签","lang"),key:"",component:({key:t},a)=>e("div",[this.tagList.filter(e=>!!e.selected).map(t=>e("el-tag",{attrs:{closable:!0},on:{close:()=>t.selected=!1},style:"margin: 0 10px 10px 0;"},[t.tag_name]))])},{label:$t("ctpucg4","所有标签","lang"),key:"",component:({key:t},a)=>e("div",[this.tagList.filter(e=>!e.selected).map(t=>e("el-button",{attrs:{plain:!0,size:"mini"},class:"tag-item",on:{click:()=>{t.selected=!0}}},[t.tag_name]))])}],selectionItems:[],saleCategoryDialog:!1,saleCategoryForm:{item_id:[],category_id:""},saleCategoryFormList:[{label:$t("j5fnxf4","销售分类","lang"),key:"category_id",component:({key:t},a)=>e("el-cascader",s()([{},{props:{props:{value:"category_id",label:"category_name",multiple:!0,checkStrictly:!0,children:"children"}}},{attrs:{options:this.categoryList},model:{value:a[t],callback:e=>{this.$set(a,t,e)}}}]))}],freightTemplateDialog:!1,freightTemplateForm:{item_id:[],templates_id:""},freightTemplateFormList:[{label:$t("iq77af4","运费模板","lang"),key:"templates_id",component:({key:t},a)=>e("el-select",{model:{value:a[t],callback:e=>{this.$set(a,t,e)}}},[this.templatesListavailable.map(t=>e("el-option",{attrs:{label:t.name,value:t.template_id}}))])}],storeItemDialog:!1,storeItemForm:{item_id:[],storeNum:void 0},storeItemFormList:[{label:$t("gl5x2","库存","lang"),key:"storeNum",component:({key:t},a)=>e("el-input-number",{attrs:{"controls-position":"right",min:0},style:"width: 120px",model:{value:a[t],callback:e=>{this.$set(a,t,e)}}})}],changePriceDialog:!1,changePriceForm:{},changePriceFormList:[],tableList:{actions:[{name:$t("mekb2","编辑","lang"),key:"edit",type:"button",buttonType:"text",visible:e=>(0,l.WZ)()||"0"==e.supplier_id,action:{type:"link",handler:([e])=>{this.$router.push({path:`${this.$route.path}/editor/${e.item_id}`,query:{some_param:"true"}})}}},{name:$t("ibpi2","查看","lang"),key:"edit",type:"button",buttonType:"text",visible:e=>(0,l.WZ)()||(0,l.Hr)(),action:{type:"link",handler:([e])=>{this.$router.push({path:`${this.$route.path}/editor/${e.item_id}`,query:{some_param:"true",detail:!0,isSupplierGoods:!0,islist:1}})}}},{name:$t("eslg2","删除","lang"),key:"delete",type:"button",buttonType:"text",visible:e=>(0,l.WZ)()&&("submitting"==e.audit_status||"rejected"==e.audit_status||"instock"==e.approve_status),action:{type:"link",handler:async([e])=>{await this.$confirm($t("13qc9xg","此操作将删除该商品, 是否继续?","lang"),$t("hn562","提示","lang")),await this.$api.goods.deleteItems(e.item_id),this.$message.success($t("u5jv766","删除商品成功","lang")),setTimeout(()=>{this.$refs.finder.refresh(!0)},200)}}},{name:$t("bkswqs4","复制商品","lang"),key:"copy",type:"button",buttonType:"text",visible:e=>(0,l.WZ)(),action:{type:"link",handler:async([e])=>{this.$router.push({path:`${this.$route.path}/editor/${e.item_id}`,query:{some_param:"true",is_new:!0}})}}},{name:$t("i5kihh4","设置价格","lang"),key:"setup_price",type:"button",buttonType:"text",visible:e=>!(0,l.WZ)(),action:{type:"link",handler:async([e])=>{this.getMemberPriceByGoods(e.item_id)}}},{name:$t("idef2","标签","lang"),key:"label",type:"button",buttonType:"text",visible:e=>(0,l.Hr)(),action:{type:"link",handler:async([e])=>{this.tagList.forEach(t=>{e.tagList.map(e=>e.tag_id).includes(t.tag_id)?t.selected=!0:t.selected=!1}),this.labelForm.item_id=e.item_id,this.labelDialog=!0}}},{name:$t("dera964","更改库存","lang"),key:"change_store",type:"button",buttonType:"text",visible:e=>(0,l.WZ)(),action:{type:"link",handler:async([e])=>{this.getSkuStoreByGoods(e.item_id)}}},{name:$t("bl3tv44","复制链接","lang"),key:"link",type:"button",buttonType:"text",action:{type:"link",handler:async([e])=>{this.$copyText(`${{VUE_APP_IS_SAAS:"false",VUE_APP_SYSTEM_NAME:"Shopex Admin",VUE_APP_PUBLIC_PATH:"/",VUE_APP_WXIMG_URL:"",VUE_APP_WXAUTHCALL_Url:"https://demo-ecshopx.ishopex.cn",VUE_APP_PREFIXES:"",VUE_APP_QIANKUN_ENTRY:"/newpc",VUE_APP_OSS_CDN:"false",VUE_APP_FREE:"false",VUE_APP_ALIOSS_REGION:"",VUE_APP_ALIOSS_ACCESS_KEY_ID:"",VUE_APP_ALIOSS_ACCESS_KEY_SECRET:"",VUE_APP_ALIOSS_BUCKET:"",VUE_APP_LOCAL_DELIVERY_DIRVER:"dada",VUE_APP_CHUZHI:"true",NODE_ENV:"production",VUE_APP_BASE_API:"htts://ecshopx82.shopex123.com/api",VUE_APP_MAP_KEY:"PSPBZ-KQ5CW-CSGRF-ON2S4-K2HQJ-XEBQG",VUE_APP_DEFAULT_LANG:"zhcn",BASE_URL:"/",VUE_APP_PLATFORM:"yd"}.VUE_APP_H5_HOST}/pages/item/espier-detail?id=${e.item_id}`).then(()=>{this.$message.success($t("bkv2mw4","复制成功","lang"))})}}},{name:$t("hbnt2","投放","lang"),key:"put",type:"button",buttonType:"text",action:{type:"link",handler:async([e])=>{this.handleShow(e)}}},{name:$t("dudn2","下架","lang"),key:"offline",type:"button",buttonType:"text",visible:e=>"onsale"==e.approve_status&&!(0,l.WZ)(),action:{type:"link",handler:async([e])=>{await this.$api.goods.updateItemsStatus({items:[{goods_id:e.item_id}],status:"instock",operate_source:(0,l.WZ)()?"supplier":"platform"}),this.$message.success($t("d1spvi4","操作成功","lang")),this.$refs.finder.refresh()}}},{name:$t("ducs2","上架","lang"),key:"online",type:"button",buttonType:"text",visible:e=>"instock"==e.approve_status&&!(0,l.WZ)()&&!(0,l.Hr)(),action:{type:"link",handler:async([e])=>{await this.$api.goods.updateItemsStatus({items:[{goods_id:e.item_id}],status:"onsale",operate_source:(0,l.WZ)()?"supplier":"platform"}),this.$message.success($t("d1spvi4","操作成功","lang")),this.$refs.finder.refresh()}}}],columns:[{name:$t("egovan6","供应商品ID","lang"),key:"supplier_item_id",width:120},{name:$t("3po83x6","平台商品ID","lang"),key:"goods_id",width:120},{name:$t("eywr2","商品","lang"),key:"itemName",width:280,render:(e,t)=>e("div",[e("div",{style:"white-space: normal;"},[t.row.itemName,!t.row.nospec&&e("el-tag",{attrs:{size:"mini",effect:"plain",type:"primary"},style:"margin-left: 4px; cursor: default;",on:{click:()=>{this.handleViewSkuInfo(t.row)}}},[$t("hlm1","多","lang"),e("i",{class:"ecx-icon icon-sousuo",style:"font-size: 12px; margin-left: 2px;"})]),1==t.row.is_gift&&e("el-tag",{attrs:{size:"mini",effect:"plain",type:"primary"},style:"margin-left: 4px; cursor: default;"},[$t("rxc1","赠","lang")])]),e("div",{style:"color: #666;"},[`${$t("txnoax6","SPU编码：","lang")}${t.row.goods_bn}`,e("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[e("i",{on:{click:()=>{this.$copyText(t.row.goods_bn).then(()=>{this.$message.success($t("bkv2mw4","复制成功","lang"))})}},class:"el-icon-document-copy",style:"margin-left: 4px;"})])])])},{name:$t("idef2","标签","lang"),width:120,key:"tagList",render:(e,t)=>e("div",{style:"white-space: normal;"},[t.row.tagList?.map(t=>e("span",{style:{color:t.font_color,"background-color":t.tag_color,"font-size":"12px",padding:"2px 5px","border-radius":"2px",margin:"0 8px 8px 0"}},[t.tag_name]))])},{name:$t("gl5x2","库存","lang"),key:"store",align:"right",headerAlign:"center"},{name:$t("1ttci05","sku编码","lang"),key:"item_bn",width:150,align:"right",headerAlign:"center"},{name:$t("cyko7y4","排序编号","lang"),key:"sort",width:120,showType:"editable",componentProps:{icon:"el-icon-plus",change:async(e,t)=>{await this.$api.goods.setItemsSort({sort:e,item_id:t.itemId}),this.$refs.finder.refresh()}}},{name:$t("qknewd6","市场价（¥）","lang"),key:"market_price",width:100,formatter:(e,t,a)=>(e/100).toFixed(2),align:"right",headerAlign:"center"},{name:$t("789h436","销售价（¥）","lang"),key:"price",width:100,formatter:(e,t,a)=>(e/100).toFixed(2),align:"right",headerAlign:"center"},{name:$t("c4yuhd6","成本价（¥）","lang"),key:"cost_price",width:100,formatter:(e,t,a)=>(e/100).toFixed(2),align:"right",headerAlign:"center"},{name:$t("ewhqj16","毛利率（%)","lang"),key:"gross_profit_rate",width:100,align:"right",headerAlign:"center"},{name:$t("7msy3i5","来源供应商","lang"),key:"supplier_name",width:100},{name:$t("b45xmu4","商品状态","lang"),width:120,key:"approve_status",formatter:(e,t,a)=>this.statusOption.find(t=>t.value===e)?.title},{name:$t("j5fnxf4","销售分类","lang"),key:"itemCatName",minWidth:120},{name:$t("ar84e54","创建时间","lang"),key:"created",width:160,formatter:(e,t,a)=>o()(1e3*e).format("YYYY-MM-DD HH:mm:ss")},{name:$t("bztktx4","审核时间","lang"),key:"audit_date",width:160,formatter:(e,t,a)=>e?o()(1e3*e).format("YYYY-MM-DD HH:mm:ss"):""},{name:$t("devbay4","更新时间","lang"),key:"updated",width:160,formatter:(e,t,a)=>o()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}]}}},mounted(){this.init(),this.getAddress(),this.getShippingTemplatesList(),this.fetchWechatList(),this.searchParams.operator_name=this.$route.query.operator_name,this.$activated=()=>{this.$refs.finder.refresh()}},methods:{async fetchWechatList(){const{list:e}=await this.$api.minimanage.gettemplateweapplist();e.forEach((e,t)=>{"yykweishop"==e.key_name&&(this.appID=e.authorizer.authorizer_appid)})},beforeSearch(e){return e={...e,item_type:"normal",operate_source:(0,l.WZ)()?"supplier":"platform",...this.searchParams,item_source:"supplier"}},onSearch(){this.$refs.finder.refresh(!0)},async getShippingTemplatesList(){const{list:e}=await this.$api.shipping.getShippingTemplatesList({page:1,pageSize:1e3});this.templatesList=e,this.templatesListavailable=e.filter(e=>e.status)},async getCategory(){const e=await this.$api.goods.getCategory({is_show:!1});this.categoryList=e;const t=await this.$api.goods.getCategory({is_main_category:!0});this.itemCategoryList=t},async onBatchChangeStateSubmit(){let e=[];this.selectionItems.map(t=>{e.push({goods_id:t.goods_id})}),await this.$api.goods.updateItemsStatus({distributor_id:this.shopId,items:JSON.stringify(e),status:this.batchChangeStateForm.status}),this.$message.success($t("ai8d7e4","修改成功","lang")),this.$refs.finder.refresh(),this.batchChangeStateDialog=!1},async getMemberPriceByGoods(e){this.currentId=e,this.skuLoading=!0,this.showMemberPriceDrawer=!0;const t=[],{list:a}=await this.$api.goods.getGoodsPrice(e);a.forEach(e=>{t.push({item_id:e.item_id,item_spec_desc:e.item_spec_desc||e.itemName,is_edit:!1,price:e.price/100,market_price:e.market_price/100,cost_price:e.cost_price/100,grade:this.generatePrice(e.memberGrade.grade),vipGrade:this.generatePrice(e.memberGrade.vipGrade)})}),this.grade=this.generatePrice(a[0].memberGrade.grade),this.vipGrade=this.generatePrice(a[0].memberGrade.vipGrade),this.specItems=t,this.skuLoading=!1},handleShow({goods_id:e,itemName:t}){const a="pages/item/espier-detail";this.curPageUrl=`${a}?id=${e}`;let i={wxaAppId:this.appID,page:a,id:e};(0,n.getPageCode)(i).then(e=>{this.appCodeUrl=e.data.data.base64Image,this.sunCodeTitle=t+$t("kp3kxc8","---商品太阳码","lang"),this.sunCode=!0})},async getSkuStoreByGoods(e){this.skuLoading=!0;const{list:t}=await this.$api.goods.getItemsList({item_type:"normal",operate_source:(0,l.WZ)()?"supplier":"platform",item_id:e,is_sku:!0,page:1,pageSize:1e3});this.showItemStoreDrawer=!0,this.storeItemsList=t.map(e=>({item_id:e.item_id,store:e.store,item_spec_desc:e.item_spec_desc?e.item_spec_desc:e.item_name})),this.skuLoading=!1},async getAllTagLists(){const{list:e}=await this.$api.goods.getTagList({page:1,pageSize:500});this.tagList=e.map(e=>({...e,selected:!1}))},async onSaveMemberPrice(){const e={item_id:this.currentId,mprice:""};let t={};this.specItems.forEach(e=>{let a={};e.grade.forEach(e=>{Object.assign(a,{[e.vip_grade_id]:e.mprice>0?e.mprice:""})});let i={};e.vipGrade.forEach(e=>{Object.assign(i,{[e.vip_grade_id]:e.mprice>0?e.mprice:""})}),t[e.item_id]={grade:a,vipGrade:i}}),e.mprice=JSON.stringify(t),this.showMemberPriceDrawer=!1,await this.$api.goods.updateGoodsPrice(e),this.$message.success($t("deua4r4","更新成功","lang")),this.$refs.finder.refresh()},async onSaveItemStore(){const e={items:JSON.stringify(this.storeItemsList),operate_source:(0,l.WZ)()?"supplier":"platform"};await this.$api.goods.updateItemsStore(e),this.$message.success($t("ai8d7e4","修改成功","lang")),this.$refs.finder.refresh(),this.showItemStoreDrawer=!1},handleTabClick(){"first"==this.activeName?(this.searchParams.is_warning=!1,this.searchParams.audit_status=""):"second"==this.activeName?(this.searchParams.is_warning=!0,this.searchParams.audit_status=""):(this.searchParams.is_warning=!1,this.searchParams.audit_status=this.activeName),this.$refs.finder.refresh()},onSelectionChange(e){this.selectionItems=e},changeCategory(){this.selectionItems.length>0?(this.saleCategoryForm.item_id=this.selectionItems.map(e=>e.item_id),this.saleCategoryDialog=!0):this.$message.error($t("gi0dra9","请选择至少一个商品","lang"))},async onSaleCategorySubmit(){const{item_id:e,category_id:t}=this.saleCategoryForm,a=t.map(e=>e[e.length-1]);await this.$api.goods.setItemsCategory({item_id:e,category_id:a}),this.$message.success($t("d1spvi4","操作成功","lang")),this.saleCategoryDialog=!1,this.$refs.finder.refresh()},batchChangeStore(){if(0===this.selectionItems.length)return this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")}),!1;this.batchChangeStateDialog=!0},changeFreightTemplate(){this.selectionItems.length>0?(this.freightTemplateForm.item_id=this.selectionItems.map(e=>e.item_id),this.freightTemplateDialog=!0):this.$message.error($t("gi0dra9","请选择至少一个商品","lang"))},async onFreightTemplateSubmit(){const{item_id:e,templates_id:t}=this.freightTemplateForm;await this.$api.goods.setItemsTemplate({templates_id:t,item_id:e}),this.$message.success($t("d1spvi4","操作成功","lang")),this.freightTemplateDialog=!1,this.$refs.finder.refresh()},changeItemsStore(){this.selectionItems.length>0?(this.storeItemForm.item_id=this.selectionItems.map(e=>e.item_id),this.storeItemDialog=!0):this.$message.error($t("gi0dra9","请选择至少一个商品","lang"))},async onStoreItemSubmit(){const{item_id:e,storeNum:t}=this.storeItemForm,a=[];e.forEach(e=>{a.push({item_id:e,store:t,is_default:!0})}),await this.$api.goods.updateItemsStore({items:JSON.stringify(a),operate_source:(0,l.WZ)()?"supplier":"platform"}),this.$message.success($t("d1spvi4","操作成功","lang")),this.storeItemDialog=!1,this.$refs.finder.refresh()},async changeHaltTheSales(e){if(this.selectionItems.length>0){await this.$confirm(`${"stop"==e?$t("e4wi2","停售","lang"):$t("gmjy2","开售","lang")}${$t("hy2dm9b","选中商品, 是否继续?","lang")}`,$t("hn562","提示","lang"));const t={goods_id:this.selectionItems.map(e=>e.goods_id),is_market:"stop"==e?"0":"1",operate_source:(0,l.WZ)()?"supplier":"platform"};await this.$api.goods.updateGoodsInfo(t),this.$message.success($t("d1spvi4","操作成功","lang")),this.$refs.finder.refresh()}else{await this.$confirm(`${"stop"==e?$t("e4wi2","停售","lang"):$t("gmjy2","开售","lang")}${$t("wr7kx6b","所有商品, 是否继续?","lang")}`,$t("hn562","提示","lang"));const t={is_market:"stop"==e?"0":"1",operate_source:(0,l.WZ)()?"supplier":"platform"};await this.$api.goods.updateGoodsInfo(t),this.$message.success($t("d1spvi4","操作成功","lang")),this.$refs.finder.refresh()}},changeGoodsPrice(){this.selectionItems.length>0?this.changePriceDialog=!0:this.$message.error($t("gi0dra9","请选择至少一个商品","lang"))},async onChangePriceSubmit(){},changeGoodsLabel(){this.selectionItems.length>0?(this.labelForm.item_id=this.selectionItems.map(e=>e.item_id),this.tagList.forEach(e=>{e.selected=!1}),this.labelDialog=!0):this.$message.error($t("gi0dra9","请选择至少一个商品","lang"))},async commissionSubmit(){this.formLoading=!0;try{await this.$api.goods.setCommissionRatio(this.commissionForm),this.commissionDialog=!1,this.$refs.finder.refresh(),this.$message.success($t("d1spvi4","操作成功","lang"))}catch(e){}this.formLoading=!1},async onLabelFormSubmit(){const{item_id:e}=this.labelForm,t=this.tagList.filter(e=>!!e.selected).map(e=>e.tag_id);await this.$api.goods.itemsRelTags({item_ids:e,tag_ids:t}),this.labelDialog=!1,this.$message.success($t("d1spvi4","操作成功","lang")),this.$refs.finder.refresh()},async getAddress(){const e=await this.$api.common.getAddress();this.regions=e},async syncToShop(e){let t="_all";if(!e){const{data:e}=await this.$picker.shop();t=e.map(e=>e.distributor_id)}0==this.selectionItems.length?(await this.$confirm($t("eb1gfif","是否将所有商品的都同步至店铺?","lang"),$t("hn562","提示","lang")),await this.$api.marketing.saveDistributorItems({distributor_ids:t,item_ids:"_all",is_can_sale:!1})):await this.$api.marketing.saveDistributorItems({distributor_ids:t,item_ids:this.selectionItems.map(e=>e.item_id),is_can_sale:!1}),this.$message.success($t("d1spvi4","操作成功","lang"))},async onBatchSubmitItems(){0!=this.selectionItems.length?(await this.$confirm($t("mu2fzc9","确认是否批量提交？","lang"),$t("d0ythm4","批量提交","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang")}),await this.$api.goods.updateGoodsInfo({goods_id:this.selectionItems.map(e=>e.item_id),operate_source:(0,l.WZ)()?"supplier":"platform",audit_status:"processing"}),this.$message.success($t("d1spvi4","操作成功","lang"))):this.$message.error($t("gi0dra9","请选择至少一个商品","lang"))},handleDownload(e){var t=document.createElement("a"),a=e;this.appCodeUrl&&(t.href=this.appCodeUrl,t.download=a+".png",t.click())},handleImport(e){this.$router.push({path:`${this.$route.path}/${e}`})},async init(){const{category:e,item_category:t,main_cat_id:a,tab:i}=this.$route.query;e&&(this.searchParams.category=e.split(",")),t&&(this.searchParams.item_category=t.split(",")),this.searchParams.main_cat_id=this.$route.query.main_cat_id,i&&(this.activeName=this.$route.query.tab,this.searchParams.is_warning=!0),this.getCategory(),this.getAllTagLists(),this.getGoodsBranchList()},async exportItemsData(){const e={...this.searchParams,item_source:"supplier"};this.selectionItems.length>0&&(e.item_id=this.selectionItems.map(e=>e.item_id));const{status:t}=await this.$api.goods.exportItemsData(e);t?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("items")):this.$message.error($t("by46j64","导出失败","lang"))},async exportItemsTagData(){const e={...this.searchParams};this.selectionItems.length>0&&(e.item_id=this.selectionItems.map(e=>e.item_id));const{status:t}=await this.$api.goods.exportItemsTagData(e);t?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("normal_items_tag")):this.$message.error($t("by46j64","导出失败","lang"))},async exportItemsWxappCode(e){const t={...this.searchParams};this.selectionItems.length>0&&(t.item_id=this.selectionItems.map(e=>e.item_id));const{status:a}=await this.$api.goods.exportGoodsCode({...t,source:"item",export_type:e});a?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("itemcode")):this.$message.error($t("by46j64","导出失败","lang"))},handleExport(e){"exportItemsData"===e?this.exportItemsData():"exportItemsTagData"===e?this.exportItemsTagData():"wxa"===e?this.exportItemsWxappCode("wxa"):"h5"===e&&this.exportItemsWxappCode("h5")},async updateGoodsSkuPrice({item_id:e,price:t,cost_price:a,market_price:i},s){const r={price:t,cost_price:a,market_price:i};await this.$api.goods.updateGoodsInfo({item_id:e,[s]:r[s],operate_source:(0,l.WZ)()?"supplier":"platform"}),this.$message.success($t("d1spvi4","操作成功","lang"))},async setWarningStore(){await this.$api.goods.getItemWarningStore({store:this.warning_store}),this.$refs.finder.refresh()},addItems(){this.$router.push({path:`${this.$route.path}/editor`})},generatePrice(e){let t=[];for(let a in e)t.push({vip_grade_id:e[a].vip_grade_id,grade_name:e[a].grade_name,mprice:e[a].mprice/100||void 0});return t},async getGoodsBranchList(e=""){this.goodsBranchParams.attribute_name=e;const{list:t}=await this.$api.goods.getGoodsAttr(this.goodsBranchParams);this.goodsBranchList=t},async handleViewSkuInfo(e){this.skuLoading=!0;const{list:t}=await this.$api.goods.getItemsList({item_type:"normal",operate_source:(0,l.WZ)()?"supplier":"platform",item_id:e.item_id,is_sku:!0,page:1,pageSize:1e3});this.itemSkuDrawerTitle=`${$t("cwbp13","商品【","lang")}${e.item_name}】`,this.itemSkuList=t||[],this.showItemSkuDrawer=!0,this.itemSkuList=t,this.skuLoading=!1}}}),m=(0,a(81656).A)(c,function(){var e=this,t=e._self._c;return t("SpPage",{staticClass:"page-body"},[t("SpRouterView",[t("SpFilterForm",{attrs:{model:e.searchParams},on:{onSearch:e.onSearch,onReset:e.onSearch}},[t("SpFilterFormItem",{attrs:{prop:"keywords",label:$t("alr0oi5","商品标题:","lang")}},[t("el-input",{attrs:{placeholder:$t("zdpct8b","商品标题或副标题关键词","lang")},model:{value:e.searchParams.keywords,callback:function(t){e.$set(e.searchParams,"keywords",t)},expression:"searchParams.keywords"}})],1),t("SpFilterFormItem",{attrs:{prop:"approve_status",label:$t("akgb645","商品状态:","lang")}},[t("el-select",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:e.searchParams.approve_status,callback:function(t){e.$set(e.searchParams,"approve_status",t)},expression:"searchParams.approve_status"}},e._l(e.statusOption,function(e){return t("el-option",{key:e.value,attrs:{label:e.title,size:"mini",value:e.value}})}),1)],1),t("SpFilterFormItem",{attrs:{prop:"main_cat_id",label:$t("15jaio5","管理分类:","lang")}},[t("el-cascader",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:"",options:e.itemCategoryList,props:{value:"category_id",label:"category_name",checkStrictly:!0}},model:{value:e.searchParams.main_cat_id,callback:function(t){e.$set(e.searchParams,"main_cat_id",t)},expression:"searchParams.main_cat_id"}})],1),t("SpFilterFormItem",{attrs:{prop:"cat_id",label:$t("pfl60n5","销售分类:","lang")}},[t("el-cascader",{attrs:{options:e.categoryList,props:{checkStrictly:!0,label:"category_name",value:"category_id"},clearable:""},model:{value:e.searchParams.cat_id,callback:function(t){e.$set(e.searchParams,"cat_id",t)},expression:"searchParams.cat_id"}})],1),t("SpFilterFormItem",{attrs:{prop:"templates_id",label:$t("cbau7n5","运费模板:","lang")}},[t("el-select",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:""},model:{value:e.searchParams.templates_id,callback:function(t){e.$set(e.searchParams,"templates_id",t)},expression:"searchParams.templates_id"}},e._l(e.templatesList,function(e){return t("el-option",{key:e.template_id,attrs:{label:e.name,value:e.template_id}})}),1)],1),t("SpFilterFormItem",{attrs:{prop:"brand_id",label:$t("cycj33","品牌:","lang")}},[t("el-select",{attrs:{placeholder:$t("eqebqb8","商品/商标关键词","lang"),remote:"",filterable:"",clearable:"","remote-method":e.getGoodsBranchList},model:{value:e.searchParams.brand_id,callback:function(t){e.$set(e.searchParams,"brand_id",t)},expression:"searchParams.brand_id"}},e._l(e.goodsBranchList,function(e){return t("el-option",{key:e.attribute_id,attrs:{label:e.attribute_name,value:e.attribute_id}})}),1)],1),t("SpFilterFormItem",{attrs:{prop:"goods_bn",label:$t("txp2nd6","SPU编码:","lang")}},[t("el-input",{attrs:{placeholder:$t("rct46y8","请输入SPU编码","lang")},model:{value:e.searchParams.goods_bn,callback:function(t){e.$set(e.searchParams,"goods_bn",t)},expression:"searchParams.goods_bn"}})],1),t("SpFilterFormItem",{attrs:{prop:"item_bn",label:$t("u0g1m66","SKU编码:","lang")}},[t("el-input",{attrs:{placeholder:$t("rcpx9b8","请输入SKU编码","lang")},model:{value:e.searchParams.item_bn,callback:function(t){e.$set(e.searchParams,"item_bn",t)},expression:"searchParams.item_bn"}})],1),t("SpFilterFormItem",{attrs:{prop:"item_bn",label:$t("alvyvs5","商品标签:","lang")}},[t("el-cascader",{attrs:{size:"small",placeholder:$t("il08k74","选择标签","lang"),options:e.tagList,props:{value:"tag_id",label:"tag_name"},clearable:""},model:{value:e.searchParams.tag_id,callback:function(t){e.$set(e.searchParams,"tag_id",t)},expression:"searchParams.tag_id"}})],1),t("SpFilterFormItem",{attrs:{prop:"regions_id",label:$t("apry225","商品产地:","lang")}},[t("el-cascader",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:"",options:e.regions},model:{value:e.searchParams.regions_id,callback:function(t){e.$set(e.searchParams,"regions_id",t)},expression:"searchParams.regions_id"}})],1),t("SpFilterFormItem",{attrs:{prop:"supplier_name",label:$t("7xykgl6","所属供应商:","lang")}},[t("el-input",{attrs:{placeholder:$t("40h5ei8","请输入所属供应商","lang")},model:{value:e.searchParams.supplier_name,callback:function(t){e.$set(e.searchParams,"supplier_name",t)},expression:"searchParams.supplier_name"}})],1)],1),t("div",{staticClass:"action-container"},[e.IS_SUPPLIER()?e._e():t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.changeCategory}},[e._v($t("fz87h48"," 更改销售分类 ","lang"))]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.changeGoodsLabel}},[e._v($t("gdz0p4"," 标签 ","lang"))]),e.IS_SUPPLIER()?t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.changeFreightTemplate}},[e._v($t("2uxvo48"," 更改运费模板 ","lang"))]):e._e(),e.IS_ADMIN()?e._e():t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.onBatchSubmitItems}},[e._v($t("77911m6"," 批量提交 ","lang"))]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.changeItemsStore}},[e._v($t("o8dkuy6"," 统一库存 ","lang"))]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.batchChangeStore}},[e._v($t("4r8dps6"," 更改状态 ","lang"))]),t("el-dropdown",{on:{command:e.handleExport}},[t("el-button",{attrs:{type:"primary",plain:"",icon:"iconfont icon-daorucaozuo-01"}},[e._v($t("gr6m3"," 导出","lang")),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"exportItemsData"}},[e._v($t("apjwmh5","商品信息 ","lang"))]),"supplier"!=e.$store.getters.login_type?t("el-dropdown-item",{attrs:{command:"exportItemsTagData"}},[e._v($t("4jjxpq6"," 商品标签 ","lang"))]):e._e(),e.IS_SUPPLIER()?e._e():t("el-dropdown-item",{attrs:{command:"wxa"}},[e._v($t("zaknla6"," 小程序码 ","lang"))]),t("el-dropdown-item",{attrs:{command:"h5"}},[e._v($t("ht3vec7"," H5二维码 ","lang"))])],1)],1),e.VERSION_STANDARD()&&e.IS_ADMIN()?t("el-dropdown",[t("el-button",{attrs:{type:"primary",plain:"",icon:"iconfont icon-daorucaozuo-01"}},[e._v($t("bjd62c5"," 同步商品","lang")),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("span",{on:{click:()=>e.syncToShop()}},[e._v($t("cg1w5f5","同步至店铺","lang"))])]),t("el-dropdown-item",[t("span",{on:{click:function(t){return e.syncToShop("all")}}},[e._v($t("iukbnq9"," 同步至所有店铺 ","lang"))])])],1)],1):e._e()],1),t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabList,function(a,i){return t("el-tab-pane",{key:i,attrs:{label:a.name,name:a.activeName}},["second"==e.activeName?t("div",{staticClass:"tab-tools"},[t("div",{staticClass:"warn-input"},[t("label",{staticClass:"label"},[e._v($t("oxjc2v5","预警数量:","lang"))]),t("el-input",{attrs:{size:"small",value:"warning_store"},model:{value:e.warning_store,callback:function(t){e.warning_store=t},expression:"warning_store"}}),t("el-button",{attrs:{type:"text"},on:{click:e.setWarningStore}},[e._v($t("cp35x4"," 保存 ","lang"))])],1)]):e._e()])}),1),t("SpFinder",{ref:"finder",attrs:{url:e.IS_DISTRIBUTOR()?"/distributor/items":"/goods/items","fixed-row-action":"","row-actions-width":"200px","other-config":{},setting:e.tableList,hooks:{beforeSearch:e.beforeSearch},"row-actions-fixed-align":"left"},on:{"selection-change":e.onSelectionChange}}),t("SpDrawer",{attrs:{title:$t("i5kihh4","设置价格","lang"),width:800,"confirm-text":$t("e32z2","保存","lang")},on:{confirm:e.onSaveMemberPrice},model:{value:e.showMemberPriceDrawer,callback:function(t){e.showMemberPriceDrawer=t},expression:"showMemberPriceDrawer"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.skuLoading,expression:"skuLoading"}],attrs:{border:"",data:e.specItems,height:"100%"}},[t("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),t("el-table-column",{attrs:{label:$t("e6yyn3","市场价","lang"),prop:"market_price",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:0,precision:2},on:{change:function(t){return e.updateGoodsSkuPrice(a.row,"market_price")}},model:{value:a.row.market_price,callback:function(t){e.$set(a.row,"market_price",t)},expression:"scope.row.market_price"}})]}}])}),t("el-table-column",{attrs:{label:$t("m8lft3","销售价","lang"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:0,precision:2},on:{change:function(t){return e.updateGoodsSkuPrice(a.row,"price")}},model:{value:a.row.price,callback:function(t){e.$set(a.row,"price",t)},expression:"scope.row.price"}})]}}])}),t("el-table-column",{attrs:{label:$t("ev2aj3","成本价","lang"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:0,precision:2},on:{change:function(t){return e.updateGoodsSkuPrice(a.row,"cost_price")}},model:{value:a.row.cost_price,callback:function(t){e.$set(a.row,"cost_price",t)},expression:"scope.row.cost_price"}})]}}])}),t("el-table-column",{attrs:{label:$t("dx1a2","会员","lang")}},e._l(e.grade,function(a,i){return t("el-table-column",{key:i,attrs:{label:a.grade_name},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:0,precision:2},model:{value:a.row.grade[i].mprice,callback:function(t){e.$set(a.row.grade[i],"mprice",t)},expression:"scope.row.grade[index].mprice"}})]}}],null,!0)})}),1),t("el-table-column",{attrs:{label:$t("aj2k674","付费会员","lang")}},e._l(e.vipGrade,function(a,i){return t("el-table-column",{key:i,attrs:{label:a.grade_name},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:0,precision:2},model:{value:a.row.vipGrade[i].mprice,callback:function(t){e.$set(a.row.vipGrade[i],"mprice",t)},expression:"scope.row.vipGrade[index].mprice"}})]}}],null,!0)})}),1)],1)],1),t("SpDrawer",{attrs:{title:$t("q6uygg6","设置商品库存","lang"),width:800},on:{confirm:e.onSaveItemStore},model:{value:e.showItemStoreDrawer,callback:function(t){e.showItemStoreDrawer=t},expression:"showItemStoreDrawer"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.skuLoading,expression:"skuLoading"}],attrs:{border:"",data:e.storeItemsList,height:"100%"}},[t("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),t("el-table-column",{attrs:{label:$t("gl5x2","库存","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",size:"small",min:0},model:{value:a.row.store,callback:function(t){e.$set(a.row,"store",t)},expression:"scope.row.store"}})]}}])})],1)],1),t("SpDialog",{ref:"saleCategoryDialogRef",attrs:{title:$t("xtijtk6","更改销售分类","lang"),form:e.saleCategoryForm,"form-list":e.saleCategoryFormList},on:{onSubmit:e.onSaleCategorySubmit},model:{value:e.saleCategoryDialog,callback:function(t){e.saleCategoryDialog=t},expression:"saleCategoryDialog"}}),t("SpDialog",{ref:"freightTemplateDialogRef",attrs:{title:$t("y8r0gk6","更改运费模板","lang"),form:e.freightTemplateForm,"form-list":e.freightTemplateFormList},on:{onSubmit:e.onFreightTemplateSubmit},model:{value:e.freightTemplateDialog,callback:function(t){e.freightTemplateDialog=t},expression:"freightTemplateDialog"}}),t("SpDialog",{ref:"sendNumDialogRef",attrs:{title:$t("t6bruz6","更改商品状态","lang"),width:"500px",form:e.batchChangeStateForm,"form-list":e.batchChangeStateFormList},on:{onSubmit:e.onBatchChangeStateSubmit},model:{value:e.batchChangeStateDialog,callback:function(t){e.batchChangeStateDialog=t},expression:"batchChangeStateDialog"}}),t("SpDialog",{ref:"storeItemDialogRef",attrs:{title:$t("ez542u6","批量修改库存","lang"),form:e.storeItemForm,"form-list":e.storeItemFormList},on:{onSubmit:e.onStoreItemSubmit},model:{value:e.storeItemDialog,callback:function(t){e.storeItemDialog=t},expression:"storeItemDialog"}}),t("SpDialog",{ref:"labelDialogRef",attrs:{title:$t("idef2","标签","lang"),modal:!1,form:e.labelForm,"form-list":e.labelFormList},on:{onSubmit:e.onLabelFormSubmit},model:{value:e.labelDialog,callback:function(t){e.labelDialog=t},expression:"labelDialog"}}),t("el-dialog",{attrs:{title:$t("q6x8p36","设置商品佣金","lang"),width:"600px",visible:e.commissionDialog},on:{"update:visible":function(t){e.commissionDialog=t}}},[t("el-form",{ref:"form",attrs:{model:e.commissionForm,"label-width":"150px"}},[t("el-form-item",{attrs:{label:$t("c355eg7","平台佣金比例:","lang")}},[t("el-input",{staticStyle:{width:"160px"},attrs:{maxlength:"5"},model:{value:e.commissionForm.commission_ratio,callback:function(t){e.$set(e.commissionForm,"commission_ratio",t)},expression:"commissionForm.commission_ratio"}},[t("template",{slot:"append"},[e._v("%")])],2),t("div",{staticClass:"frm-tips"},[e._v($t("m1q513g","* 0-100之间，最多两位小数","lang"))])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.formLoading},on:{click:e.commissionSubmit}},[e._v($t("fmsxgr6"," 保存设置 ","lang"))]),t("el-button",{on:{click:function(t){e.commissionDialog=!1}}},[e._v($t("ev022","取消","lang"))])],1)],1)],1),t("SpDrawer",{attrs:{title:e.itemSkuDrawerTitle,width:800},on:{confirm:()=>{e.showItemSkuDrawer=!1}},model:{value:e.showItemSkuDrawer,callback:function(t){e.showItemSkuDrawer=t},expression:"showItemSkuDrawer"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.skuLoading,expression:"skuLoading"}],attrs:{border:"",data:e.itemSkuList,height:"100%"}},[t("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),t("el-table-column",{attrs:{label:$t("vlqz5v5","供应商货号","lang"),prop:"supplier_goods_bn","min-width":"120"}}),t("el-table-column",{attrs:{label:$t("1ttci05","sku编码","lang"),prop:"item_bn","min-width":"120"}}),t("el-table-column",{attrs:{label:$t("fvqs9w4","税率编码","lang"),prop:"tax_rate_code","min-width":"120"}}),t("el-table-column",{attrs:{label:$t("le7t2","税率","lang"),prop:"tax_rate","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(`${a.row.tax_rate}%`))])]}}])}),t("el-table-column",{attrs:{label:$t("gl5x2","库存","lang"),prop:"store","min-width":"120"}})],1)],1),t("el-dialog",{attrs:{title:e.sunCodeTitle,visible:e.sunCode,width:"360px"},on:{"update:visible":function(t){e.sunCode=t}}},[t("div",{staticClass:"page-code"},[t("img",{staticClass:"page-code-img",attrs:{src:e.appCodeUrl}}),t("div",{staticClass:"page-btns"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleDownload(e.sunCodeTitle)}}},[e._v($t("axjir55"," 下载码 ","lang"))]),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.curPageUrl,expression:"curPageUrl",arg:"copy"}],attrs:{type:"primary",plain:""}},[e._v($t("j66ck06"," 复制链接 ","lang"))])],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sunCode=!1}}},[e._v($t("hnjoo3","确 定","lang"))])],1)])],1)],1)},[],!1,null,"7c4952b0",null).exports}}]);