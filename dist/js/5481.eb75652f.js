"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[5481],{65481:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});a(44114),a(62477);var n=a(82997),i={data(){return{loading:!0,activeName:"member_count",params:{start:"",end:"",vdate:""},allListData:[],dataTimeArr:[],dataInfo:{member_count:{label:$t("c004y3","会员数","lang"),data_list:[],total_num:0}},chartColors:{red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"},pickerOptions:{shortcuts:[{text:$t("dl4oop4","最近一周","lang"),onClick(t){const e=new Date,a=new Date;e.setTime(e.getTime()-6048e5),a.setTime(a.getTime()-864e5),t.$emit("pick",[e,a])}},{text:$t("4znkgj5","最近一个月","lang"),onClick(t){const e=new Date,a=new Date;e.setTime(e.getTime()-2592e6),a.setTime(a.getTime()-864e5),t.$emit("pick",[e,a])}},{text:$t("4zndsa5","最近三个月","lang"),onClick(t){const e=new Date,a=new Date;e.setTime(e.getTime()-7776e6),a.setTime(a.getTime()-864e5),t.$emit("pick",[e,a])}}]}}},mounted(){this.onReset()},methods:{onReset(){var t=new Date,e=new Date;t.setTime(t.getTime()-6048e5),e.setTime(e.getTime()-864e5);const a=t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`;this.params.vdate=[a(t),a(e)],this.getCompanyDataList(this.activeName)},handleClick(t,e){this.chartInit(t.name)},dateChange(t){this.params.start=t[0],this.params.end=t[1]},getCompanyDataList(t){this.dataTimeArr=[],this.dataInfo.member_count.data_list=[],this.dataInfo.member_count.total_num=0;let e={start:this.params.vdate[0],end:this.params.vdate[1]};(0,n.getCompanyData)(e).then(e=>{this.allListData=e.data.data.list;let a=e.data.data.list;for(var n in a)this.dataTimeArr.push(a[n].count_date),this.dataInfo.member_count.data_list.push(a[n].member_count),this.dataInfo.member_count.total_num+=Number(a[n].member_count);this.loading=!1,t&&this.$nextTick(()=>{this.chartInit(t)})}).catch(t=>{this.$message({type:"error",message:$t("mpokya8","获取统计信息出错","lang")})})},chartInit(t){var e={type:"line",data:{labels:this.dataTimeArr,datasets:[{label:this.dataInfo[t].label,backgroundColor:this.chartColors.grey,borderColor:this.chartColors.red,data:this.dataInfo[t].data_list,fill:!1}]},options:{responsive:!0,title:{display:!0,text:$t("cyugf3","合计(","lang")+this.dataInfo[t].total_num+")"},tooltips:{mode:"index",intersect:!0},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:""}}],yAxes:[{display:!0,scaleLabel:{display:!1}}]}}},a=document.getElementById(t).getContext("2d");window.myLine=new Chart(a,e)}}},s=(0,a(81656).A)(i,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:function(e){return t.getCompanyDataList(t.activeName)},onReset:t.onReset}},[e("SpFilterFormItem",{attrs:{prop:"vdate",label:$t("7tw80w5","选择日期:","lang")}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","alue-format":"yyyy-MM-dd",align:"right","unlink-panels":"","range-separator":$t("po31","至","lang"),"start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd"},on:{change:t.dateChange},model:{value:t.params.vdate,callback:function(e){t.$set(t.params,"vdate",e)},expression:"params.vdate"}})],1)],1),-1===t.$route.path.indexOf("editor")?e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:$t("c004y3","会员数","lang"),name:"member_count"}},[e("section",[e("canvas",{attrs:{id:"member_count",height:"120"}})])])],1):t._e(),[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.allListData,stripe:"",border:""}},[e("el-table-column",{attrs:{prop:"count_date",label:$t("hwbe2","日期","lang"),fixed:""}}),e("el-table-column",{attrs:{prop:"member_count",label:$t("c004y3","会员数","lang")}})],1)]],2)},[],!1,null,null,null).exports}}]);