"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8265],{28265:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});a(18111),a(7588);var s=a(95353),l=a(41776),i={mixins:[a(77825).v8],data(){return{loading:!1,create_time:"",form:{rate_id:"",content:""},params:{order_type:"normal",create_time:"",item_id:"",order_id:"",rate_status:""},rateStatusList:[{name:$t("fj8ux3","未回复","lang"),value:"0"},{name:$t("e6mw13","已回复","lang"),value:"1"}],total_count:0,list:[],Dialogpic:"",details:{rateInfo:[],itemInfo:[],userReply:[]},replyDialogVisible:!1,imgVisible:!1,detailsDialogVisible:!1}},computed:{...(0,s.L8)(["wheight"])},mounted(){this.fetchList()},methods:{onCopy(){this.$notify({message:$t("bkv2mw4","复制成功","lang"),type:"success"})},rateDelete(t){const e=this;this.$confirm($t("ob3u6pa","确认删除当前评价吗？","lang")).then(a=>{(0,l.deleteRate)(t).then(t=>{t.data.data.status&&(this.$message({message:$t("azeh8z4","删除成功","lang"),type:"success"}),e.fetchList())})})},showImg(t){this.imgVisible=!0,this.Dialogpic=t},handleClose(){this.replyDialogVisible=!1,this.detailsDialogVisible=!1},replyDialog(t){this.form.rate_id=t.rate_id,this.replyDialogVisible=!0},replySubmit(){(0,l.replyTradeRate)(this.form).then(t=>{this.$message({type:"success",message:$t("bby7cu4","回复成功","lang")}),this.replyDialogVisible=!1,this.fetchList()})},detailsDialog(t){(0,l.getTradeRateDetails)(t.rate_id).then(t=>{this.details=t.data.data}),this.detailsDialogVisible=!0},onReset(){this.dateChange(),this.onSearch()},dateChange(t){if(!t)return this.params.time_start_begin="",void(this.params.time_start_end="");t.length>0?(this.params.time_start_begin=this.dateStrToTimeStamp(t[0]+" 00:00:00"),this.params.time_start_end=this.dateStrToTimeStamp(t[1]+" 23:59:59")):(this.params.time_start_begin="",this.params.time_start_end="")},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3},fetchList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let a={page:t,pageSize:e,...this.params};(0,l.getTradeRateList)(a).then(t=>{this.list=t.data.data.list,this.list.forEach(t=>{t.star=Number(t.star)}),this.total_count=Number(t.data.data.total_count),this.loading=!1})}}},r=(0,a(81656).A)(i,function(){var t=this,e=t._self._c;return e("SpPage",[t.VERSION_SHUYUN()?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",pc:"",alipay:""}}),e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onReset}},[e("SpFilterFormItem",{attrs:{prop:"create_time",label:$t("e8915d5","日期范围:","lang")}},[e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy/MM/dd","start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang")},on:{change:t.dateChange},model:{value:t.params.create_time,callback:function(e){t.$set(t.params,"create_time",e)},expression:"params.create_time"}})],1),e("SpFilterFormItem",{attrs:{prop:"item_id",label:$t("b1nyjg5","商品ID:","lang")}},[e("el-input",{attrs:{placeholder:$t("mfh2td7","请输入商品ID","lang")},model:{value:t.params.item_id,callback:function(e){t.$set(t.params,"item_id",e)},expression:"params.item_id"}})],1),e("SpFilterFormItem",{attrs:{prop:"order_id",label:$t("hymdzq4","订单号:","lang")}},[e("el-input",{attrs:{placeholder:$t("7djicl6","请输入订单号","lang")},model:{value:t.params.order_id,callback:function(e){t.$set(t.params,"order_id",e)},expression:"params.order_id"}})],1),e("SpFilterFormItem",{attrs:{prop:"rate_status",label:$t("fggrps5","是否评价:","lang")}},[e("el-select",{attrs:{clearable:"",placeholder:$t("x1kvb57","请选择是否评价","lang")},model:{value:t.params.rate_status,callback:function(e){t.$set(t.params,"rate_status",e)},expression:"params.rate_status"}},t._l(t.rateStatusList,function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.value}})}),1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"",data:t.list,height:t.wheight-140,"element-loading-text":$t("go5gpa5","数据加载中","lang")}},[e("el-table-column",{attrs:{prop:"star","min-width":"250",label:$t("o7g32","评价","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-rate",{attrs:{disabled:""},model:{value:a.row.star,callback:function(e){t.$set(a.row,"star",e)},expression:"scope.row.star"}}),e("div",{staticClass:"order-time",staticStyle:{padding:"8px 0 2px 0"}},[e("span",{staticClass:"content-right-margin"},[e("el-tooltip",{attrs:{effect:"dark",content:$t("kuuef3","评价人","lang"),placement:"top-start"}},[e("i",{staticClass:"el-icon-user"})]),e("router-link",{attrs:{target:"_blank",to:{path:t.matchInternalRoute("member_detail"),query:{user_id:a.row.user_id}}}},[t._v(t._s(a.row.username))])],1),e("el-tooltip",{attrs:{effect:"dark",content:$t("hyoyb54","评价时间","lang"),placement:"top-start"}},[e("i",{staticClass:"el-icon-time"})]),t._v(" "+t._s(t._f("datetime")(a.row.created,"YYYY-MM-DD HH:mm:ss"))+" ")],1),e("div",{staticClass:"view-flex"},[e("div",{staticClass:"order-time"},[e("el-tooltip",{attrs:{effect:"dark",content:$t("hyl5mv4","评价内容","lang"),placement:"top-start"}},[e("i",{staticClass:"el-icon-chat-line-square"})])],1),e("div",{staticClass:"view-flex-item",staticStyle:{"padding-left":"4px"}},[t._v(" "+t._s(a.row.content)+" ")])])]}}])}),e("el-table-column",{attrs:{prop:"order_id",width:"220",label:$t("o7hv2","订单","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"order-num"},[e("router-link",{attrs:{target:"_blank",to:{path:"/order/order-manage/order-list/detail",query:{orderId:a.row.order_id}}}},[t._v(" "+t._s(a.row.order_id)+" ")]),e("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.order_id,expression:"scope.row.order_id",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"}],staticClass:"el-icon-document-copy"})])],1),e("div",{staticClass:"order-time"},[t._v($t("cxglb3","商品：","lang")+t._s(a.row.item_name))])]}}])}),e("el-table-column",{attrs:{prop:"is_reply",width:"160",label:$t("hyqtq64","评价状态","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",["1"==a.row.is_reply?e("el-tag",{attrs:{type:"success",size:"mini"}},[t._v($t("e6mw13","已回复","lang"))]):e("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v($t("fj8ux3","未回复","lang"))])],1),"1"==a.row.disabled?e("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v($t("cowk0a5"," 已删除 ","lang"))]):t._e()]}}])}),e("el-table-column",{attrs:{width:"140",label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.detailsDialog(a.row)}}},[t._v($t("likox4"," 详情 ","lang"))]),"0"==a.row.is_reply?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.replyDialog(a.row)}}},[t._v($t("dpmnl4"," 回复 ","lang"))]):t._e(),"0"==a.row.disabled?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.rateDelete(a.row.rate_id)}}},[t._v($t("db22k4"," 删除 ","lang"))]):t._e()]}}])})],1),e("el-pagination",{staticClass:"mt-4 text-right",attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.total_count,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}}),e("el-dialog",{attrs:{title:$t("hym1uq4","评价回复","lang"),visible:t.replyDialogVisible,width:"35%","before-close":t.handleClose},on:{"update:visible":function(e){t.replyDialogVisible=e}}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:$t("2jbrwj5","请输入内容","lang")},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.replyDialogVisible=!1}}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.replySubmit}},[t._v($t("hnjoo3","确 定","lang"))])],1)],1),e("el-dialog",{attrs:{title:$t("hyv4424","评价详情","lang"),width:"45%",visible:t.detailsDialogVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.detailsDialogVisible=e}}},[e("el-dialog",{attrs:{width:"45%",visible:t.imgVisible,"append-to-body":""},on:{"update:visible":function(e){t.imgVisible=e}}},[e("img",{attrs:{width:"100%",src:t.Dialogpic}})]),e("div",{staticClass:"section-white"},[e("div",{staticClass:"section-header with-border"},[e("h3",[t._v($t("8t2zg6","评价商品信息","lang"))])]),e("div",{staticClass:"section-body"},[e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.details.itemInfo}},[e("el-table-column",{staticClass:"goods-img",attrs:{prop:"pic",label:$t("b41bic4","商品图片","lang")},scopedSlots:t._u([{key:"default",fn:function(t){return[e("img",{attrs:{src:t.row.pics[0],alt:t.row.item_name,width:"100"}})]}}])}),e("el-table-column",{attrs:{prop:"item_name",label:$t("b40v0e4","商品名称","lang"),width:"180"}}),e("el-table-column",{attrs:{label:$t("bylzit7","成交价格(元)","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v("￥"+t._s(a.row.total_fee/100))])]}}])})],1)],1)],1),e("div",{staticClass:"section-header with-border"},[e("h3",[t._v($t("hykwip4","评价信息","lang"))])]),e("div",{staticClass:"section-body"},[e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("oyu1vj7"," 评价星级： ","lang"))]),e("el-col",{attrs:{span:20}},[e("el-rate",{attrs:{disabled:""},model:{value:t.details.rateInfo.star,callback:function(e){t.$set(t.details.rateInfo,"star",e)},expression:"details.rateInfo.star"}})],1)],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("rphtar7"," 评价内容： ","lang"))]),e("el-col",{attrs:{span:20}},[t._v(" "+t._s(t.details.rateInfo.content)+" ")])],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("3qbytt6"," 评价图： ","lang"))]),t.details.rateInfo.rate_pic?e("el-col",{attrs:{span:20}},t._l(t.details.rateInfo.rate_pic,function(a){return e("img",{attrs:{src:a,width:"100px"},on:{click:function(e){return t.showImg(a)}}})}),0):t._e()],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("3p4dsd6"," 评价人： ","lang"))]),e("el-col",{attrs:{span:20}},[e("router-link",{attrs:{target:"_blank",to:{path:t.matchInternalRoute("member_detail"),query:{user_id:t.details.rateInfo.user_id}}}},[t._v(" "+t._s(t.details.rateInfo.username)+" ")])],1)],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("ow5d7t7"," 评价时间： ","lang"))]),e("el-col",{attrs:{span:20}},[t._v(" "+t._s(t._f("datetime")(t.details.rateInfo.created,"YYYY-MM-DD HH:mm:ss"))+" ")])],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("g3953o7"," 是否回复： ","lang"))]),e("el-col",{attrs:{span:20}},[t.details.rateInfo.is_reply?e("el-tag",{attrs:{type:"success",size:"mini"}},[t._v($t("cpb4lb5"," 已回复 ","lang"))]):e("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v($t("dv61mv5"," 未回复 ","lang"))])],1)],1)],1),e("div",{staticClass:"section-header with-border"},[e("h3",[t._v($t("n0l6407","管理员回复信息","lang"))])]),t.details.replyInfo?e("div",{staticClass:"section-body"},[e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("79u2xj7"," 回复内容： ","lang"))]),e("el-col",{attrs:{span:20}},[e("el-tag",{attrs:{type:"success"}},[t._v(" "+t._s(t.details.replyInfo.content)+" ")])],1)],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("b8bci96"," 回复人： ","lang"))]),e("el-col",{attrs:{span:20}},[t._v(" "+t._s(t.details.replyInfo.operator_name)+" ")])],1),e("el-row",[e("el-col",{staticClass:"col-3 content-right",attrs:{span:4}},[t._v($t("4ghmul7"," 回复时间： ","lang"))]),e("el-col",{attrs:{span:20}},[t._v(" "+t._s(t._f("datetime")(t.details.replyInfo.created,"YYYY-MM-DD HH:mm:ss"))+" ")])],1)],1):t._e(),e("div",{staticClass:"section-header with-border"},[e("h3",[t._v($t("aa9pa44","买家评论","lang"))])]),e("div",{staticClass:"section-body"},[e("el-row",[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.details.userReply}},[e("el-table-column",{attrs:{prop:"username",label:$t("l56h03","评论人","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("router-link",{attrs:{target:"_blank",to:{path:t.matchInternalRoute("member_detail"),query:{user_id:a.row.user_id}}}},[t._v(" "+t._s(a.row.username)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"content",label:$t("i7hjuy4","评论内容","lang")}}),e("el-table-column",{attrs:{prop:"created",label:$t("i7lcj84","评论时间","lang"),width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.created,"YYYY-MM-DD HH:mm:ss")))])]}}])})],1)],1)],1)])],1)],1)},[],!1,null,"669b006c",null).exports}}]);