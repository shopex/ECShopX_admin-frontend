"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[221],{60221:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var o=[function(){var e=this._self._c;return e("div",[e("img",{attrs:{src:"/images/logo.png",alt:"logo",width:"220"}}),e("div",{staticClass:"text-[28px] font-helvca mt-8 text-[#333]"},[this._v($t("l2pgx3","请登录","lang"))])])}],a=(n(64979),n(81125)),i=n(56510),s=n(26456);const[l,r]=(0,a.mN)({formItems:[{label:$t("hmxge3","用户名","lang"),component:"Input",componentProps:{placeholder:$t("7grhuz6","请输入用户名","lang")},fieldName:"account",rules:[{required:!0,message:$t("7grhuz6","请输入用户名","lang")}]},{label:$t("g9ob2","密码","lang"),component:"Input",componentProps:{type:"password",placeholder:$t("g9ob2","密码","lang")},fieldName:"pwd",rules:[{required:!0,message:$t("2j9vj05","请输入密码","lang")}]},{label:$t("o5pc2","角色","lang"),component:"Select",componentProps:{placeholder:$t("7grhuz6","请输入用户名","lang"),options:[{label:$t("io38z3","管理员","lang"),value:"admin"},{label:$t("ev0t2","员工","lang"),value:"staff"}]},fieldName:"loginType",value:"admin"}],hideFieldRequiredMark:!0,showDefaultActions:!1,labelInline:!0});var c={name:"Login",components:{LoginForm:l},data(){return{formApi:r,loading:!1,recoderNumber:i.A.recoder_number}},computed:{systemTitle:()=>(0,s.KY)()},async mounted(){const{level:e}=await this.$api.login.getAuthorizeLeve();"img_code"===e&&await this.$api.login.getImageCode({type:"login"})},methods:{async handleLogin(){await this.formApi.validate();const e=this.formApi.getFieldsValue();this.loading=!0;try{const{token:t}=await this.$api.auth.login({username:e.account,password:e.pwd,logintype:e.loginType});if(t){const n=t.split("."),{menu_type:o}=JSON.parse(atob(n[1]));this.$store.commit("system/setVersionMode",{versionMode:o}),this.$store.commit("user/setToken",{token:t}),this.$store.commit("user/setLoginType",{login_type:e.loginType}),this.$message.success($t("fcewjt4","登录成功","lang"));const a=await this.$store.dispatch("user/fetchAccessMenus");await this.$store.dispatch("user/fetchAccountInfo"),setTimeout(()=>{1==a.length&&"/activelicense"==a[0].url?window.location.href="/activelicense":window.location.href="/"},700)}}catch(e){}finally{this.loading=!1}},handleError(e){this.$message.error($t("x6g2vcc","表单验证失败，请检查输入","lang"))},handleReset(){this.$message.info($t("nzmd0a5","表单已重置","lang"))}}},g=(0,n(81656).A)(c,function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-login bg-white relative flex flex-col justify-center"},[e._m(0),t("div",{staticClass:"mt-8"},[t("LoginForm",{ref:"formRef"})],1),t("div",{staticClass:"mt-8 text-right"},[t("el-button",{staticClass:"h-[50px] !bg-black !text-white",attrs:{round:"",loading:e.loading},on:{click:e.handleLogin}},[e._v($t("ide6e4"," 登录 ","lang"))])],1)])},o,!1,null,"0dd6c187",null).exports}}]);