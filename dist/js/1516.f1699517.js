"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[1516],{91516:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});s(64979);var i={name:"Login",data(){return{code:""}},async mounted(){this.init()},methods:{init(){let{code:e}=this.$route.query;this.code=e,this.code?this.handleLogin():this.$message.error($t("855bkxc","登录失败，缺失code！","lang"))},async handleLogin(){try{const{token:e}=await this.$api.auth.shunyunLogin({code:this.code});if(e){const t=e.split("."),{menu_type:s}=JSON.parse(atob(t[1]));this.$store.commit("system/setVersionMode",{versionMode:s}),this.$store.commit("user/setToken",{token:e}),this.$store.commit("user/setLoginType",{login_type:"admin"}),this.$message.success($t("fcewjt4","登录成功","lang")),await this.$store.dispatch("user/fetchAccessMenus"),await this.$store.dispatch("user/fetchAccountInfo"),setTimeout(()=>{window.location.href="/"},700)}}catch(e){}}}},n=(0,s(81656).A)(i,function(){var e=this._self._c;return e("div",{staticClass:"bg-white h-full px-10 py-10 relative flex flex-col justify-center"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}]})])},[],!1,null,"2db97416",null).exports}}]);