"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[9796],{69796:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});r(44114),r(18111),r(22489),r(20116),r(61701);var i=r(95353),a=r(77825),s=r(26456),o=r(41776),l=r(5006),n=r(89435),c=r(95093),d=r.n(c),m=r(33318),p={mixins:[a.Ay,a.v8],data(){const e=this.$createElement;return{loading:!1,defaultTime:["00:00:00","23:59:59"],params:{mobile:"",order_id:"",order_date:[],original_order_id:"",supplier_name:"",order_class_exclude:"drug,pointsmall,community",salesman_mobile:"",receipt_type:"",source:"",order_status:"",order_class:"",is_invoiced:"",time_start_begin:"",time_start_end:"",distributor_type:"",distributor_id:"",subDistrict:[]},payTypeList:{wxpay:$t("cemv244","微信支付","lang"),point:$t("fq5ozk4","积分支付","lang"),deposit:$t("aigyzh4","储值支付","lang")},datapass_block:1,subDistrictList:[],distributionType:m.as,orderStatus:(0,s.L3)()?m.i8:(0,s.hd)()?m.dj:m.w8,orderType:m.W4,invoiceStatus:m.jY,orderCategory:m.In,pickerOptions:m.Dv,orderSourceList:[],remarkDialog:!1,remarkFormList:[{label:$t("70idij5","备注信息:","lang"),key:"remark",type:"textarea",maxlength:150,placeholder:$t("4dr4fe","请输入对此订单需要备注的内容","lang"),required:!0,message:$t("adohlc4","不能为空","lang")}],remarkForm:{orderId:"",is_distribution:1,remark:""},cancelOrderDialog:!1,cancelOrderFormList:[{component:()=>e("div",{class:"tip-bar"},[$t("a2n8qw13","订单取消后，消费者在商城中看到的订单状态将变更为已取消，无法对其进行支付操作。","lang")])},{label:"",component:()=>e(n.A,{attrs:{orderId:this.cancelOrderForm.order_id},on:{onLoad:this.onLoadCancelOrderRef}})},{label:$t("d6vxbt5","取消原因:","lang"),key:"cancel_reason",placeholder:$t("amt70d9","请选择取消订单原因","lang"),type:"select",options:[{title:$t("pz0w3u8","客户现在不想购买","lang"),value:1},{title:$t("s2wbp58","客户商品价格较贵","lang"),value:2},{title:$t("5ub2dc6","客户价格波动","lang"),value:3},{title:$t("54f4lf6","客户商品缺货","lang"),value:4},{title:$t("2iss7z6","客户重复下单","lang"),value:5},{title:$t("s1oguha","客户订单商品选择有误","lang"),value:6},{title:$t("yfg8h2a","客户支付方式选择有误","lang"),value:7},{title:$t("9z46tka","客户收货信息填写有误","lang"),value:8},{title:$t("ozd78ya","客户发票信息填写有误","lang"),value:9},{title:$t("l4oqme8","客户无法支付订单","lang"),value:10},{title:$t("j4es208","客户长时间未付款","lang"),value:11},{title:$t("5mt8x66","客户其他原因","lang"),value:12}],required:!0,message:$t("adohlc4","不能为空","lang"),onChange:e=>{this.cancelOrderFormList[3].isShow=12==e}},{label:$t("qckd0n5","其他原因:","lang"),key:"other_reason",type:"input",placeholder:$t("bf9qgl9","请填写取消订单原因","lang"),isShow:!1,validator:(e,t,r)=>{12!=this.cancelOrderForm.cancel_reason||t?r():r(new Error($t("adohlc4","不能为空","lang")))}}],cancelOrderForm:{order_id:"",buy_member:"",buy_mobile:"",receive_name:"",receive_mobile:"",receive_address:"",loading:!1,cancel_reason:"",other_reason:""},deliverGoodsDialog:!1,deliverGoodsFormList:[{label:$t("b5urmu4","发货类型","lang"),key:"delivery_type",type:"radio",disabled:!1,options:[{label:"batch",name:$t("d5a74n4","整单发货","lang")},{label:"sep",name:$t("csx9py4","拆分发货","lang")}],onChange:e=>{this.deliverGoodsFormList[1].options[3].isShow="sep"==e}},{label:"",key:"items",type:"table",options:[{title:$t("cwisy3","商品名","lang"),key:"item_name"},{title:$t("i1y72","数量","lang"),key:"num",width:60},{title:$t("nbuukn5","已发货数量","lang"),key:"delivery_item_num",width:100},{title:$t("b5r61h4","发货数量","lang"),key:"item_num",width:160,render:(t,r,i)=>t.delivery_item_num&&t.num<=t.delivery_item_num?$t("e7hbq3","已完成","lang"):e("el-input-number",{attrs:{size:"mini",min:1,max:t.num-t.delivery_item_num},model:{value:t.delivery_num,callback:e=>{this.$set(t,"delivery_num",e)}}}),isShow:!1}]},{label:$t("cp0yj74","快递公司","lang"),key:"delivery_corp",placeholder:$t("whmqve7","请选择快递公司","lang"),type:"select",options:[],required:!0,message:$t("adohlc4","不能为空","lang")},{label:$t("evwh164","物流单号","lang"),key:"delivery_code",type:"input",placeholder:$t("s5y24m6","物流公司单号","lang"),required:!0,message:$t("adohlc4","不能为空","lang")}],deliverGoodsForm:{order_id:"",ship_mobile:"",delivery_type:"batch",delivery_corp:"",delivery_code:"",type:"",items:[]},writeOffDialog:!1,writeOffFormList:[{label:"",key:"items",type:"table",options:[{title:$t("cwisy3","商品名","lang"),key:"item_name"},{title:$t("i1y72","数量","lang"),key:"num",width:60},{title:$t("nbuukn5","已发货数量","lang"),key:"delivery_item_num",width:100}]}],writeOffForm:{order_id:"",pickupcode:"",items:[]},refundDialog:!1,refundFormList:[{label:$t("d3vmqr5","取消来源:","lang"),key:"source",type:"text"},{label:$t("kvr2w85","申请时间:","lang"),key:"applyTime",type:"text"},{label:$t("8smf0x5","退款状态:","lang"),key:"refundStatus",type:"text"},{label:$t("84jfe55","处理进度:","lang"),key:"process",type:"text"},{label:$t("8xg2c05","退款金额:","lang"),key:"refundPrice",type:"text"},{label:$t("k6t2ud5","支付方式:","lang"),key:"payType",type:"text"},{label:$t("d6vxbt5","取消原因:","lang"),key:"reason",type:"text"},{label:$t("82359r5","处理结果:","lang"),key:"check_cancel",type:"radio",options:[{label:"0",name:$t("budzk3","不同意","lang")},{label:"1",name:$t("ettv2","同意","lang")}],onChange:e=>{this.refundFormList[8].isShow="0"==e}},{label:$t("ng42cy5","拒绝原因:","lang"),key:"shop_reject_reason",type:"input",placeholder:$t("kjdze37","请输入拒绝原因","lang"),isShow:!1,validator:(e,t,r)=>{"0"!=this.refundFormList.check_cancel||t?r():r(new Error($t("adohlc4","不能为空","lang")))}}],refundForm:{order_id:"",source:"",applyTime:"",refundStatus:"",process:"",refundPrice:"",payType:"",reason:"",check_cancel:"1",shop_reject_reason:""},changePriceDialog:!1,changePriceFormList:[{component:()=>e("div",{class:"tip-bar"},[$t("bb8alp10","仅未支付订单可修改价格，改价后请联系买家刷新订单并核实订单金额后再支付。","lang")])},{component:()=>e("div",{class:"receive-info"},[e("div",{class:"receive-item"},[e("label",{class:"item-label"},[$t("byljo3","买家：","lang")]),`${this.changePriceForm.buy_member} | ${this.changePriceForm.buy_mobile}`]),e("div",{class:"receive-item"},[e("label",{class:"item-label"},[`${this.changePriceForm.isZiti?$t("d6anuf4","提货人：","lang"):$t("dcn95d4","收货人：","lang")}`]),`${this.changePriceForm.receive_name} | ${this.changePriceForm.receive_mobile}`]),e("div",{class:"receive-item"},[e("label",{class:"item-label"},[`${this.changePriceForm.isZiti?$t("np8obo5","自提地址：","lang"):$t("ca5zk75","收货地址：","lang")}`]),this.changePriceForm.receive_address])])},{component:()=>e(l.A,{attrs:{value:this.changePriceForm.items,orderId:this.changePriceForm.order_id,itemTotalFee:this.changePriceForm.itemTotalFee,pointFreightFee:this.changePriceForm.pointFreightFee,receiptType:this.changePriceForm.receipt_type,freightFee:this.changePriceForm.freightFee,orderFee:this.changePriceForm.orderFee},on:{onChange:this.onChangeTableView}})}],changePriceForm:{order_id:"",buy_member:"",buy_mobile:"",receive_name:"",receive_mobile:"",receive_address:"",loading:!1,isZiti:!1,items:[],receipt_type:"",itemTotalFee:0,freightFee:0,orderFee:0,pointFreightFee:0},origin:"",isBindOMS:!1}},computed:{...(0,i.L8)(["login_type","isMicorMall"])},async created(){const{result:e}=await this.$api.trade.isBindOMS();this.isBindOMS=e},mounted(){this.origin=window.location.origin;const{tab:e}=this.$route.query;e&&(this.params.order_status=e),this.fetchList(),this.getOrderSourceList(),this.getLogisticsList(),this.getSubDistrictList(),this.getPickupcodeSetting(),this.$EventBus.$on("event.tradelist.refresh",()=>{this.fetchList()})},methods:{async fetchList(){this.loading=!0;const{pageIndex:e,pageSize:t}=this.page;let r={page:e,pageSize:t,order_type:"normal",...this.params};(0,s.cy)(this.params.create_time)&&this.params.create_time.length>=2&&(r.time_start_begin=d()(this.params.create_time[0]).unix(),r.time_start_end=d()(this.params.create_time[1]).unix()),(0,s.cy)(this.params.delivery_time)&&this.params.delivery_time.length>=2&&(r.delivery_time_begin=d()(this.params.delivery_time[0]).unix(),r.delivery_time_end=d()(this.params.delivery_time[1]).unix()),delete r.create_time,delete r.delivery_time;const{list:i,total_count:a,datapass_block:o}=await this.$api.supplier.getOrderList(r);this.tableList=i.map(e=>{const t=[],{distributor_id:r,receipt_type:i,cancel_status:a,is_logistics:o,is_invoiced:l,invoice:n,order_status:c,order_status_des:d,ziti_status:m,dada:p,delivery_status:g,pay_status:h,can_apply_aftersales:u,items:_}=e,f="dada"==i,y="logistics"==i;return((0,s.bz)()||0==r||"distributor"==this.login_type)&&(!f&&"NO_APPLY_CANCEL"==a&&["PAYED"].includes(c)&&"DONE"!=m&&(!f||f&&["0","1"].includes(p.data_status))&&t.push({name:$t("b1drz94","取消订单","lang"),key:"cancel"}),"PAYED"==c&&"ziti"==i&&"PENDING"==m&&t.push({name:$t("ijm02","核销","lang"),key:"writeOff"}),f&&["NO_APPLY_CANCEL","FAILS"].includes(a)&&"PAYED"==c&&"DONE"!=g&&"0"==p.dada_status&&t.push({name:$t("hemo2","接单","lang"),key:"takeOrder"}),f&&"PAYED"==h&&"9"==p.dada_status&&t.push({name:$t("frz0444","确认退回","lang"),key:"orderSendBack"}),!y&&!o||f||"PAYED"!=c||"DONE"==g||"ziti"==i||"supplier"!=this.login_type||t.push({name:$t("f14m2","发货","lang"),key:"deliverGoods"}),"WAIT_PROCESS"==a&&"PAYED"==c&&t.push({name:$t("p2ym2","退款","lang"),key:"refund"}),"0"==l&&n&&t.push({name:$t("eghwt3","待开票","lang"),key:"waitInvoice"})),"WAIT_PAID_CONFIRM"==c&&t.push({name:$t("frru4e4","确认收款","lang"),key:"paidConfirm"}),1==u&&((0,s.fE)()?(this.IS_ADMIN()&&0==r||this.IS_DISTRIBUTOR())&&t.push({name:$t("fd2mro4","申请售后","lang"),key:"salesAfter"}):(0,s.hd)()||t.push({name:$t("fd2mro4","申请售后","lang"),key:"salesAfter"})),{...e,actionBtns:t}}),this.page.total=a||0,this.datapass_block=o,this.loading=!1},async getSubDistrictList(){const e=await this.$api.subdistrict.getSubDistrictList();this.subDistrictList=e},getOrderType({order_class:e,type:t}){if("normal"==e)return"1"==t?$t("i9z8we4","跨境订单","lang"):$t("divfxb4","普通订单","lang");const r=m.W4.find(t=>t.value==e);return r?r.title:void 0},getDistributionType({receipt_type:e}){const t=m.as.find(t=>t.value==e);if(t)return t.title},async getOrderSourceList(){const{list:e}=await this.$api.datacube.getSourcesList({page:1,pageSize:1e3});this.orderSourceList=e.map(({sourceName:e,sourceId:t})=>({title:e,value:t}))},async getLogisticsList(){const{list:e}=await this.$api.trade.getLogisticsList();this.deliverGoodsFormList[2].options=e.map(e=>({title:e.name,value:e.value}))},async handleAction({order_id:e,order_status:t,distributor_remark:r,receiver_mobile:i,items:a,delivery_type:o,delivery_status:l,receipt_type:n},{key:c}){if("remark"==c)this.$refs.remarkDialogRef.resetForm(),this.remarkForm.orderId=e,this.remarkForm.remark=r,this.remarkDialog=!0;else if("cancel"==c)this.$refs.cancelOrderDialogRef.resetForm(),this.cancelOrderFormList[0].isShow="PAYED"!=t,this.cancelOrderForm.order_id=e,this.cancelOrderForm.loading=!0,this.cancelOrderDialog=!0;else if("deliverGoods"==c){if(this.isBindOMS&&this.IS_ADMIN())return this.$message.warning($t("tckdokb","请至OMS处理订单发货","lang"));this.$refs.deliverGoodsDialogRef.resetForm(),this.deliverGoodsForm.order_id=e,this.deliverGoodsForm.ship_mobile=i,this.deliverGoodsForm.items=a.map(e=>({...e,price:e.price/100})),this.deliverGoodsForm.type=o,"PARTAIL"==l?(this.deliverGoodsForm.delivery_type="sep",this.deliverGoodsFormList[0].disabled=!0,this.deliverGoodsFormList[1].options[3].isShow=!0):(this.deliverGoodsFormList[0].disabled=!1,this.deliverGoodsFormList[1].options[3].isShow=!1),this.deliverGoodsDialog=!0}else if("writeOff"==c)this.$refs.writeOffDialogRef.resetForm(),this.writeOffForm.order_id=e,this.writeOffForm.items=a.map(e=>({...e,price:e.price/100})),this.writeOffDialog=!0;else if("takeOrder"==c)this.$confirm($t("8zir98d","请在接单前确认商品当前库存","lang"),$t("cx567u4","接单提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(async()=>{await this.$api.trade.doBusinessReceipt(e),this.$message.success($t("cx4nvj4","接单成功","lang"))});else if("paidConfirm"==c)this.$confirm($t("4e59vkf","确定已经收到用户的线下转账吗？","lang"),$t("d7rar64","收款提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(async()=>{await this.$api.supplier.orderPaidConfirm({order_id:e}),this.fetchList(),this.$message.success($t("qtkj7x6","确认收款成功","lang"))});else if("orderSendBack"==c)this.$confirm($t("frz0444","确认退回","lang"),$t("w4w05a6","确认退回提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(async()=>{await this.$api.trade.confirmBack(e),this.$message.success($t("ij1qzx4","退回成功","lang"))});else if("refund"==c){this.$refs.refundRef.resetForm(),this.refundDialog=!0;const{cancel_from:t,create_time:r,refund_status:i,progress:a,fee_symbol:s,total_fee:o,pay_type:l,pay_channel:n,cancel_reason:c}=await this.$api.trade.getCancelOrderInfo(e,{order_type:"normal"});this.refundForm={...this.refundForm,order_id:e,source:"buyer"==t?$t("kff1qw5","消费者申请","lang"):$t("ysidro6","系统自动取消","lang"),applyTime:d()(1e3*r).format("YYYY-MM-DD HH:mm:ss"),refundStatus:m.ks[i],process:m.hi[a],refundPrice:`${s}${o/100}`,payType:n?m.CV[n]:m.CV[l],reason:c}}else if("waitInvoice"==c)this.$confirm($t("ektlr8c","确定更新该订单开票状态？","lang"),$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning"}).then(async()=>{const{success:t}=await this.$api.trade.isInvoiced({order_id:e,status:1});this.fetchList(),t?this.$message.success($t("75zb4x7","已更新开票状态","lang")):this.$message.error($t("4q13i58","更新开票状态失败","lang"))});else if("changePrice"==c){this.changePriceDialog=!0,this.changePriceForm.loading=!0;const{orderInfo:t,distributor:r,profit:i,tradeInfo:a}=await this.$api.trade.getOrderDetail(e),{store_address:s,store_name:o}=r,{items:l=[],user_id:n,receiver_name:c,receiver_mobile:d,receiver_state:m,receiver_city:p,receiver_district:g,receiver_address:h,order_class:u,total_fee:_,freight_fee:f,item_fee_new:y,item_total_fee:$,receipt_type:b,point_freight_fee:v}=t,{username:k,mobile:F}=await this.$api.member.getMember({user_id:n});this.changePriceForm.loading=!1,this.changePriceForm.order_id=e,this.changePriceForm.buy_member=k,this.changePriceForm.buy_mobile=F,"excard"==u||"shopadmin"==u||"normal"==u&&"ziti"==b?(this.changePriceForm.receive_name=k,this.changePriceForm.receive_mobile=F,this.changePriceForm.receive_address=`${s}（${o}）`,this.changePriceForm.isZiti=!0):(this.changePriceForm.receive_name=c,this.changePriceForm.receive_mobile=d,this.changePriceForm.receive_address=`${m}${p}${g}${h}`,this.changePriceForm.isZiti=!1),this.changePriceForm.receipt_type=b,this.changePriceForm.freightFee=f/100,this.changePriceForm.orderFee=_/100,this.changePriceForm.itemTotalFee=$/100,this.changePriceForm.pointFreightFee=v/100,this.changePriceForm.items=l.map(e=>({...e,change_discount:"",change_price:"",total:$/100}))}else"salesAfter"==c&&((0,s.JR)()?this.$router.push({path:`/shopadmin/order/tradenormalorders/after-sale/${e}`}):"supplier"==this.$store.getters.login_type?this.$router.push({path:`/supplier/order/tradenormalorders/after-sale/${e}`}):this.$router.push({path:`/order/entitytrade/tradenormalorders/after-sale/${e}`}))},onLoadCancelOrderRef(){this.cancelOrderForm.loading=!1},async onRemarkSubmit(){await this.$api.order.remarks(this.remarkForm),this.$message.success($t("rzycyb9","订单备注修改成功!","lang")),this.remarkDialog=!1,this.fetchList()},async onCancelOrderSubmit(){const{order_id:e}=this.cancelOrderForm;await this.$api.trade.cancelOrderConfirm(e,this.cancelOrderForm),this.cancelOrderDialog=!1,this.$message.success($t("zgosdp7","订单取消成功!","lang")),this.fetchList()},async deliverGoodsSubmit(){const{order_id:e,delivery_type:t,delivery_corp:r,delivery_code:i,ship_mobile:a,type:s,items:o}=this.deliverGoodsForm;let l={order_id:e,ship_mobile:a,delivery_type:t,delivery_corp:r,delivery_code:i,type:s};"sep"==t&&(l.sepInfo=JSON.stringify(o.filter(e=>e.delivery_num)));const{delivery_status:n}=await this.$api.trade.delivery(l);this.deliverGoodsDialog=!1,this.fetchList(),n&&"PENDING"!=n?this.$message.success($t("97ym6c5","发货成功!","lang")):this.$message.error($t("98zfs95","发货失败!","lang"))},async writeOffSubmit(){const{order_id:e}=this.writeOffForm,{ziti_status:t}=await this.$api.trade.doWriteoff(e,this.writeOffForm);"DONE"==t?this.$message.success($t("cza3sh9","自提订单核销成功!","lang")):this.$message.error($t("cy9a6k9","自提订单核销失败!","lang")),this.writeOffDialog=!1},async refundSubmit(){const{order_id:e,check_cancel:t,shop_reject_reason:r}=this.refundForm,{refund_status:i}=await this.$api.trade.cancelConfirm(e,{order_id:e,check_cancel:t,shop_reject_reason:r});"AUDIT_SUCCESS"==i?this.$message.success($t("gv1tj15","审核通过!","lang")):"SHOP_CHECK_FAILS"==i?this.$message.success($t("j11vzv6","审核已拒绝!","lang")):this.$message.error($t("gmztyu5","审核失败!","lang")),this.refundDialog=!1},async changePriceSubmit(){const{items:e,freightFee:t,order_id:r,pointFreightFee:i}=this.changePriceForm;let a={order_id:r,down_type:"items"};t>=0&&(a.freight_fee=100*(t-i)),e.length>0&&(a.items=e.map(e=>({item_id:e.item_id,total_fee:e.total_fee}))),await this.$api.trade.changePriceConfirm(a),this.changePriceDialog=!1,this.fetchList()},async salesAfterSubmit(){},exportInvoice(){let e="normal";this.$emit("onChangeData","params",{type:e}),(0,o.exportInvoice)({...this.params,type:e,order_type:"supplier_order"}).then(e=>{const{status:t,url:r,filename:i}=e.data.data;if(t)return this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),void this.$export_open("invoice");r?window.open(r):this.$message.error($t("thm90yh","无内容可导出或执行失败，请检查重试","lang"))})},exportOrderItems(){this.exportData("normal_order")},exportSupplierOrders(){this.exportData("supplier_order")},handleExport(e){"exportInvoice"===e?this.exportInvoice():"exportSupplierOrders"===e?this.exportSupplierOrders():"exportOrderItems"===e&&this.exportOrderItems()},exportData(e){let t={...this.params,order_type:"normal",type:e,page:this.page.pageIndex};(0,s.cy)(this.params.create_time)&&this.params.create_time.length>=2&&(t.time_start_begin=d()(this.params.create_time[0]).unix(),t.time_start_end=d()(this.params.create_time[1]).unix()),(0,s.cy)(this.params.delivery_time)&&this.params.delivery_time.length>=2&&(t.delivery_time_begin=d()(this.params.delivery_time[0]).unix(),t.delivery_time_end=d()(this.params.delivery_time[1]).unix()),delete t.create_time,delete t.delivery_time,(0,o.orderExport)(t).then(t=>{const{status:r,url:i,filename:a}=t.data.data;if(r)return this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),void this.$export_open(e);i?window.open(i):this.$message.error($t("thm90yh","无内容可导出或执行失败，请检查重试","lang"))})},async uploadHandleChange(e){const t={isUploadFile:!0,file_type:"normal_orders",file:e.raw};await this.$api.common.handleUploadFile(t),this.$message.success($t("dn5eu39","上传成功，等待处理","lang")),this.fetchList()},async uploadHandlePatchCancel(e){const t={isUploadFile:!0,file_type:"normal_orders_cancel",file:e.raw};await this.$api.common.handleUploadFile(t),this.$message.success($t("dn5eu39","上传成功，等待处理","lang")),this.fetchList()},async getPickupcodeSetting(){const{pickupcode_status:e}=await this.$api.company.getPickupcodeSetting();e&&this.writeOffFormList.push({label:$t("d6ga9c4","提货码:","lang"),key:"pickupcode",type:"input",placeholder:$t("7j3g5b6","请输入提货码","lang"),required:!0,message:$t("adohlc4","不能为空","lang")})},onChangeTableView({items:e,item_fee_new:t,freight_fee:r,total_fee:i,item_total_fee:a}){this.changePriceForm.freightFee=r/100,this.changePriceForm.orderFee=i/100,this.changePriceForm.itemTotalFee=a/100,this.changePriceForm.items=e.map(e=>({...e,change_discount:"",change_price:"",total:a/100}))},async downloadtemplate(){const{name:e,file:t}=await this.$api.common.download();if(t){var r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),r.remove()}}}},g=(0,r(81656).A)(p,function(){var e=this,t=e._self._c;return t("SpPage",[t("SpRouterView",[t("SpFilterForm",{attrs:{model:e.params},on:{onSearch:e.onSearch,onReset:e.onSearch}},[t("SpFilterFormItem",{attrs:{prop:"mobile",label:$t("cttsc24","手机号:","lang")}},[t("el-input",{attrs:{placeholder:$t("11oiag9","请输入收货人手机号","lang")},model:{value:e.params.mobile,callback:function(t){e.$set(e.params,"mobile",t)},expression:"params.mobile"}})],1),t("SpFilterFormItem",{attrs:{prop:"order_id",label:$t("hymdzq4","订单号:","lang")}},[t("el-input",{attrs:{placeholder:$t("7djicl6","请输入订单号","lang")},model:{value:e.params.order_id,callback:function(t){e.$set(e.params,"order_id",t)},expression:"params.order_id"}})],1),t("SpFilterFormItem",{attrs:{prop:"order_date",label:$t("vyu3bm5","下单时间:","lang")}},[t("el-date-picker",{attrs:{clearable:"",type:"daterange",align:"right",format:"yyyy-MM-dd","range-separator":$t("po31","至","lang"),"start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"prefix-icon":"null","default-time":e.defaultTime,"picker-options":e.pickerOptions},model:{value:e.params.order_date,callback:function(t){e.$set(e.params,"order_date",t)},expression:"params.order_date"}})],1),e.isMicorMall&&"distributor"==e.login_type||e.VERSION_B2C()||e.VERSION_IN_PURCHASE()?e._e():t("SpFilterFormItem",{attrs:{prop:"distributor_id",label:$t("7kd5ck5","来源店铺:","lang")}},[t("SpSelectShop",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:e.params.distributor_id,callback:function(t){e.$set(e.params,"distributor_id",t)},expression:"params.distributor_id"}})],1)],1),t("div",{staticClass:"action-container"},[t("el-dropdown",{on:{command:e.handleExport}},[t("el-button",{attrs:{type:"primary",plain:""}},[e._v($t("gr6m3"," 导出","lang")),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"exportInvoice"}},[e._v($t("z6sz0b6","未开票订单 ","lang"))]),t("el-dropdown-item",{attrs:{command:"exportSupplierOrders"}},[e._v($t("ag26pe4","主订单 ","lang"))]),t("el-dropdown-item",{attrs:{command:"exportOrderItems"}},[e._v($t("c3glrx4","子订单 ","lang"))])],1)],1)],1),t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.onSearch},model:{value:e.params.order_status,callback:function(t){e.$set(e.params,"order_status",t)},expression:"params.order_status"}},[e._l(e.orderStatus,function(e){return t("el-tab-pane",{key:e.value,attrs:{label:e.title,name:e.value}})}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.tableList}},[t("el-table-column",{attrs:{width:"180",prop:"order_id",label:$t("kuwys3","订单号","lang")},scopedSlots:e._u([{key:"default",fn:function(r){return[t("div",{staticClass:"order-num"},[e._v(" "+e._s(r.row.order_id)+" "),t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:r.row.order_id,expression:"scope.row.order_id",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})])],1),t("div",{staticClass:"order-time"},[t("el-tooltip",{attrs:{effect:"dark",content:$t("a72nl44","下单时间","lang"),placement:"top-start"}},[t("i",{staticClass:"el-icon-time"})]),e._v(" "+e._s(e._f("datetime")(r.row.create_time,"YYYY-MM-DD HH:mm:ss"))+" ")],1)]}}])}),t("el-table-column",{attrs:{prop:"cost_fee",width:"120",label:$t("qm3ye16","结算价（¥）","lang"),align:"right","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((t.row.cost_fee/100).toFixed(2))+" ")]}}])}),t("el-table-column",{attrs:{prop:"cost_fee",width:"120",label:$t("atq5kr7","商品金额（¥）","lang"),align:"right","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((t.row.item_fee/100).toFixed(2))+" ")]}}])}),t("el-table-column",{attrs:{width:"100",label:$t("cwnwg35","运费（¥）","lang"),align:"right","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((t.row.freight_fee||0)/100)+" ")]}}])}),t("el-table-column",{attrs:{prop:"receiver_mobile",width:"130",label:$t("qn3j9d6","收货人手机号","lang")},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",[e._v(e._s(r.row.receiver_mobile))]),0==e.datapass_block?t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:r.row.receiver_mobile,expression:"scope.row.receiver_mobile",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"receiver_name",label:$t("fi4h53","收货人","lang")}}),t("el-table-column",{attrs:{prop:"shop_name",label:$t("izbj3p4","采购门店","lang")}}),t("el-table-column",{attrs:{prop:"distributor_name",label:$t("di507i4","来源店铺","lang"),width:"150"}}),t("el-table-column",{attrs:{prop:"order_status",label:$t("hys56m4","订单状态","lang")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.order_status_msg)+" ")]}}])}),t("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{staticStyle:{"margin-right":"8px"},attrs:{type:"text"}},[t("router-link",{attrs:{to:`${e.$route.path}/detail?orderId=${r.row.order_id}&resource=${e.$route.path}`}},[e._v($t("likox4"," 详情 ","lang"))])],1),t("el-popover",{attrs:{placement:"right",trigger:"hover"}},[t("div",{staticClass:"operating-icons"},[t("el-button",{attrs:{type:"text"}},[t("router-link",{attrs:{to:`${e.$route.path}/process?orderId=${r.row.order_id}&resource=${e.$route.path}`}},[e._v($t("fy0tq4"," 日志 ","lang"))])],1),e._l(r.row.actionBtns,function(i,a){return[t("el-button",{key:`btn-item__${a}`,attrs:{type:"text"},on:{click:function(t){return e.handleAction(r.row,i)}}},[e._v(" "+e._s(i.name)+" ")])]})],2),t("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v($t("inra3"," 更多","lang")),t("i",{staticClass:"iconfont icon-angle-double-right"})])],1)]}}])})],1),t("div",{staticClass:"mt-4 text-right"},[t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.page.pageIndex,"page-sizes":[10,20,50],total:e.page.total,"page-size":e.page.pageSize},on:{"update:currentPage":function(t){return e.$set(e.page,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.page,"pageIndex",t)},"current-change":e.onCurrentChange,"size-change":e.onSizeChange}})],1)],2),t("SpDialog",{ref:"remarkDialogRef",attrs:{title:`${$t("mk0yu58","修改备注【订单:","lang")}${e.remarkForm.orderId}】`,form:e.remarkForm,"form-list":e.remarkFormList},on:{onSubmit:e.onRemarkSubmit},model:{value:e.remarkDialog,callback:function(t){e.remarkDialog=t},expression:"remarkDialog"}}),t("SpDialog",{ref:"cancelOrderDialogRef",staticClass:"dialog-cancelorder",attrs:{title:`${$t("53n9c48","取消订单【订单:","lang")}${e.cancelOrderForm.order_id}】`,loading:e.cancelOrderForm.loading,form:e.cancelOrderForm,"form-list":e.cancelOrderFormList},on:{onSubmit:e.onCancelOrderSubmit},model:{value:e.cancelOrderDialog,callback:function(t){e.cancelOrderDialog=t},expression:"cancelOrderDialog"}}),t("SpDialog",{ref:"deliverGoodsDialogRef",attrs:{width:"1000px",title:`${$t("7sn7qr6","发货【订单:","lang")}${e.deliverGoodsForm.order_id}】`,form:e.deliverGoodsForm,"form-list":e.deliverGoodsFormList},on:{onSubmit:e.deliverGoodsSubmit},model:{value:e.deliverGoodsDialog,callback:function(t){e.deliverGoodsDialog=t},expression:"deliverGoodsDialog"}}),t("SpDialog",{ref:"writeOffDialogRef",attrs:{title:`${$t("9rdkkf6","核销【订单:","lang")}${e.writeOffForm.order_id}】`,form:e.writeOffForm,"form-list":e.writeOffFormList},on:{onSubmit:e.writeOffSubmit},model:{value:e.writeOffDialog,callback:function(t){e.writeOffDialog=t},expression:"writeOffDialog"}}),t("SpDialog",{ref:"refundRef",attrs:{title:`${$t("jozlez6","退款【订单:","lang")}${e.refundForm.order_id}】`,form:e.refundForm,"form-list":e.refundFormList},on:{onSubmit:e.refundSubmit},model:{value:e.refundDialog,callback:function(t){e.refundDialog=t},expression:"refundDialog"}})],1)],1)},[],!1,null,null,null).exports}}]);