"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[1536],{51536:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});a(44114);var n=a(5134),i={mixins:[a(77825).v8],provide(){return{refresh:this.fetchList}},data(){return{loading:!1,params:{status:"all"},list:[],tabList:[{name:$t("en402","全部","lang"),activeName:"all"},{name:$t("egbo03","待开始","lang"),activeName:"waiting"},{name:$t("lq5q43","进行中","lang"),activeName:"ongoing"},{name:$t("edie63","已结束","lang"),activeName:"end"}]}},mounted(){this.fetchList()},methods:{cancelActionVisible({status:t,source_id:e}){if("ongoing"==t){if(this.IS_ADMIN()&&"0"==e)return!0;if(this.IS_DISTRIBUTOR())return!0}return!1},editlActionVisible({status:t,source_id:e}){if("waiting"==t){if(this.IS_ADMIN()&&"0"==e)return!0;if(this.IS_DISTRIBUTOR())return!0}return!1},onSearch(){this.page.pageIndex=1,this.$nextTick(()=>{this.fetchList()})},async fetchList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let a={page:t,pageSize:e,...this.params};const{list:n,total_count:i}=await this.$api.promotions.getPackagePromotions(a);this.tableList=n,this.page.total=Number(i),this.loading=!1},handleTabClick(t,e){this.onSearch()},addPackagePromotion(){this.$router.push({path:this.matchRoutePath("editor")})},updatePackagePromotion(t){this.$router.push({path:this.matchRoutePath("editor/")+t.package_id})},showPackagePromotion(t){this.$router.push({path:this.matchRoutePath("editor/")+t.package_id,query:{isshow:!0}})},closePackagePromotion(t){let e=this;var a=$t("3pkh9yi","此操作将永久终止该活动, 是否继续?","lang");this.$confirm(a,$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(a,i,o)=>{"confirm"===a&&(0,n.cancelPackagePromotions)(t.package_id).then(t=>{this.$message({message:$t("b16pa94","取消成功","lang"),type:"success",duration:2e3,onClose(){e.fetchList()}})}),o()}})}}},o=i,s=(0,a(81656).A)(o,function(){var t=this,e=t._self._c;return e("SpPage",[-1===t.$route.path.indexOf("editor")?[t.VERSION_SHUYUN?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",pc:"",alipay:""}}),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary",icon:"iconfont icon-xinzengcaozuo-01"},on:{click:t.addPackagePromotion}},[t._v($t("d7f168"," 添加组合促销 ","lang"))])],1),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleTabClick},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.tabList,function(a,n){return e("el-tab-pane",{key:n,attrs:{label:a.name,name:a.activeName}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableList,border:"","element-loading-text":$t("go5gpa5","数据加载中","lang")}},[e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"operating-icons"},[t.cancelActionVisible(a.row)?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.closePackagePromotion(a.row)}}},[t._v($t("dd4ni4"," 取消 ","lang"))]):t._e(),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showPackagePromotion(a.row)}}},[t._v($t("gcika4"," 查看 ","lang"))]),t.editlActionVisible(a.row)?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.updatePackagePromotion(a.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]):t._e()],1)]}}],null,!0)}),e("el-table-column",{attrs:{prop:"package_id",width:"60",label:$t("m2sh2","编号","lang")}}),e("el-table-column",{attrs:{prop:"package_name",label:$t("6kvvl06","组合促销名称","lang")}}),e("el-table-column",{attrs:{prop:"source_name",label:$t("gwn72","店铺","lang")}}),e("el-table-column",{attrs:{label:$t("cd0k3t4","开始时间","lang"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.start_time,"YYYY-MM-DD HH:mm:ss")))])]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("gfi7qi4","结束时间","lang"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("datetime")(a.row.end_time,"YYYY-MM-DD HH:mm:ss")))])]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("lnjk2","类型","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return["waiting"==a.row.status?e("span",[t._v($t("egbo03","待开始","lang"))]):t._e(),"ongoing"==a.row.status?e("span",[t._v($t("lq5q43","进行中","lang"))]):t._e(),"end"==a.row.status?e("span",[t._v($t("edie63","已结束","lang"))]):t._e()]}}],null,!0)})],1),t.page.total>t.page.pageSize?e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1):t._e()],1)}),1)]:t._e(),e("router-view")],2)},[],!1,null,null,null).exports}}]);