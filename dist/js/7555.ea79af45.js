"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[7555],{27555:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});a(44114);const l=[{name:$t("cemv244","微信支付","lang"),label:"wx_lite"},{name:$t("n9vwrm7","微信公众号支付","lang"),label:"wx_pub"},{name:$t("aoniq66","微信扫码支付","lang"),label:"wx_qr"},{name:$t("k88wub5","支付宝支付","lang"),label:"alipay_wap"},{name:$t("m4wy0j7","支付宝扫码支付","lang"),label:"alipay_qr"}],s=l.reduce((t,e)=>(t[e.label]=e.name,t),{}),n=l.map(t=>({label:t.name,value:t.label}));var o={data(){return{form:{order_id:"",trade_id:"",pay_channel:"",status:"",bspay_div_status:"",can_div:"",distributor_name:"",bspay_fee_mode:"",time:""},params:{page:1,pageSize:10},loading:!0,total_count:0,total:{totalFee:"",payFee:"",divFee:"",bspayFee:""},list:[],time:{time_start_begin:"",time_start_end:""}}},computed:{bspayPaymentOptions(){return n},paymentDisplayNames(){return s}},mounted(){this.getSub_account()},methods:{getDistributorId(){return{distributor_id:this.$store.getters.shopId||0}},async uploadHandleChange(t,e){let a={isUploadFile:!0,file_type:"bspay_tradedata",file:t.raw,...this.getDistributorId()};await this.$api.common.handleUploadFile(a),this.$message({type:"success",message:$t("dn5eu39","上传成功，等待处理","lang")}),this.getSub_account()},goDetail(t){this.$router.push({path:`${this.$route.path}/detail/${t}`})},async getSub_account(){this.loading=!0;const{list:t,total:e,total_count:a}=await this.$api.bspay.subAccount({...this.form,...this.params,...this.time});this.total=e,this.list=t,this.total_count=a,this.loading=!1},handleCurrentChange(t){this.params.page=t,this.getSub_account()},handleSizeChange(t){this.params.pageSize=t,this.getSub_account()},timeHandle(t){this.time.time_start_begin=t[0],this.time.time_start_end=t[1]},queryHandle(){this.params={page:1,pageSize:10},this.getSub_account()},resetForm(t){this.$refs[t].resetFields(),this.form.pay_channel="",this.form.status="",this.time.time_start_begin="",this.time.time_start_end=""},async exportFile(){const{status:t}=await this.$api.bspay.exportFileList({...this.form,...this.params,...this.time});t?this.$message.success(`${$t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")}`):this.$message.error(`${$t("by46j64","导出失败","lang")}`)}}},r=(0,a(81656).A)(o,function(){var t=this,e=t._self._c;return e("SpRouterView",[e("SpPage",[e("div",{staticClass:"zyk_bspay_account"},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.form,"label-width":"100px"}},[e("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v($t("c0hmu3","交易单","lang"))])]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("kuwys3","订单号","lang"),prop:"order_id"}},[e("el-input",{model:{value:t.form.order_id,callback:function(e){t.$set(t.form,"order_id",e)},expression:"form.order_id"}})],1)],1),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("yc5zij5","交易流水号","lang"),prop:"trade_id"}},[e("el-input",{model:{value:t.form.trade_id,callback:function(e){t.$set(t.form,"trade_id",e)},expression:"form.trade_id"}})],1)],1),"distributor"!=t.$store.getters.login_type?e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("cjqdxi4","店铺名称","lang"),prop:"distributor_name"}},[e("el-input",{model:{value:t.form.distributor_name,callback:function(e){t.$set(t.form,"distributor_name",e)},expression:"form.distributor_name"}})],1)],1):t._e(),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("d3h9kv4","支付方式","lang"),prop:"pay_channel"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.form.pay_channel,callback:function(e){t.$set(t.form,"pay_channel",e)},expression:"form.pay_channel"}},t._l(t.bspayPaymentOptions,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("acl1ru4","交易状态","lang"),prop:"status"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[e("el-option",{attrs:{label:$t("d3fjv14","支付完成","lang"),value:"SUCCESS"}}),e("el-option",{attrs:{label:$t("imoan04","部分退款","lang"),value:"PARTIAL_REFUND"}}),e("el-option",{attrs:{label:$t("awonqr4","全额退款","lang"),value:"FULL_REFUND"}})],1)],1)],1),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("d8plo74","是否分账","lang"),prop:"bspay_div_status"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.form.bspay_div_status,callback:function(e){t.$set(t.form,"bspay_div_status",e)},expression:"form.bspay_div_status"}},[e("el-option",{attrs:{label:$t("fiphm3","未分账","lang"),value:"NOTDIV"}}),e("el-option",{attrs:{label:$t("e63iq3","已分账","lang"),value:"DIVED"}})],1)],1)],1),"admin"==t.$store.getters.login_type?e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("csikv77","手续费扣费方式","lang"),prop:"bspay_fee_mode"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.form.bspay_fee_mode,callback:function(e){t.$set(t.form,"bspay_fee_mode",e)},expression:"form.bspay_fee_mode"}},[e("el-option",{attrs:{label:$t("foy52","外扣","lang"),value:"1"}}),e("el-option",{attrs:{label:$t("eem62","内扣","lang"),value:"2"}})],1)],1)],1):t._e(),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("dhk87j4","时间范围","lang"),prop:"time"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"timestamp",type:"daterange","default-time":["00:00:00","23:59:59"],"range-separator":"-","start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang")},on:{change:t.timeHandle},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1)],1),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:$t("axo1rf4","分账状态","lang"),prop:"can_div"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.form.can_div,callback:function(e){t.$set(t.form,"can_div",e)},expression:"form.can_div"}},[e("el-option",{attrs:{label:$t("cpb0v3","可分账","lang"),value:"true"}}),e("el-option",{attrs:{label:$t("a73nxe4","不可分账","lang"),value:"false"}})],1)],1)],1)],1),e("el-form-item",{staticStyle:{"text-align":"right"}},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.queryHandle}},[t._v($t("gg26b4"," 查询 ","lang"))]),e("el-button",{attrs:{type:"info",size:"medium"},on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v($t("h9ea34"," 清空 ","lang"))])],1),e("el-row",{staticClass:"group",attrs:{gutter:20}},["distributor"!=t.$store.getters.login_type?e("el-col",{staticClass:"item",attrs:{span:6}},[e("p",{staticClass:"title"},[t._v($t("hypb794","订单总额","lang"))]),e("p",{staticClass:"money"},[t._v("￥ "+t._s(t._f("formatNumMoney")(t.total.totalFee/100)))])]):t._e(),e("el-col",{staticClass:"item",attrs:{span:6}},[e("p",{staticClass:"title"},[t._v($t("aci7sh4","交易总额","lang"))]),e("p",{staticClass:"money"},[t._v("￥ "+t._s(t._f("formatNumMoney")(t.total.payFee/100)))])]),"distributor"==t.$store.getters.login_type?e("el-col",{staticClass:"item",attrs:{span:6}},[e("p",{staticClass:"title"},[t._v($t("d3gnbf4","支付总额","lang"))]),e("p",{staticClass:"money"},[t._v("￥ "+t._s(t._f("formatNumMoney")(t.total.totalFee/100)))])]):t._e(),e("el-col",{staticClass:"item",attrs:{span:6}},[e("p",{staticClass:"title"},[t._v($t("axl7s24","分账总额","lang"))]),e("p",{staticClass:"money"},[t._v("￥ "+t._s(t._f("formatNumMoney")(t.total.divFee/100)))])]),"admin"==t.$store.getters.login_type?e("el-col",{staticClass:"item",attrs:{span:6}},[e("p",{staticClass:"title"},[t._v($t("p9jwxz5","手续费总额","lang"))]),e("p",{staticClass:"money"},[t._v("￥ "+t._s(t._f("formatNumMoney")(t.total.bspayFee/100)))])]):t._e()],1),e("div",{staticClass:"tablelist"},[e("el-row",{staticStyle:{"text-align":"right"}},[e("el-upload",{staticStyle:{"margin-right":"10px",display:"inline-block"},attrs:{action:"","on-change":t.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}}),e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.exportFile}},[t._v($t("uezq6r6"," 导出文件 ","lang"))])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list}},[e("el-table-column",{attrs:{label:$t("kuwys3","订单号","lang"),prop:"orderId"}}),"distributor"!=t.$store.getters.login_type?[e("el-table-column",{attrs:{label:$t("bdfi7r4","商铺名称","lang"),prop:"distributor_name"}})]:t._e(),[e("el-table-column",{attrs:{label:$t("yc5zij5","交易流水号","lang"),prop:"tradeId"}}),e("el-table-column",{attrs:{label:$t("d3h9kv4","支付方式","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["pos"==a.row.payType?e("span",[t._v($t("f5b6xs8","POS银行卡支付","lang"))]):"bspay"==a.row.payType&&a.row.payChannel?e("span",[t._v(" "+t._s(t.paymentDisplayNames[a.row.payChannel]||a.row.payChannel)+" ")]):e("span",[t._v(t._s(a.row.payType||"-"))])]}}])})],"distributor"!=t.$store.getters.login_type?e("el-table-column",{attrs:{label:$t("hyxqu74","订单金额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatNumMoney")(a.row.totalFee/100)))])]}}],null,!1,728680641)}):t._e(),"distributor"==t.$store.getters.login_type?e("el-table-column",{attrs:{label:$t("acqnff4","交易金额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatNumMoney")(a.row.totalFee/100)))])]}}],null,!1,728680641)}):t._e(),e("el-table-column",{attrs:{label:$t("acl1ru4","交易状态","lang"),prop:"tradeState"},scopedSlots:t._u([{key:"default",fn:function(a){return["SUCCESS"==a.row.tradeState?e("span",[t._v($t("d3fjv14","支付完成","lang"))]):"PARTIAL_REFUND"==a.row.tradeState?e("span",[t._v($t("imoan04","部分退款","lang"))]):"FULL_REFUND"==a.row.tradeState?e("span",[t._v($t("awonqr4","全额退款","lang"))]):t._e()]}}])}),e("el-table-column",{attrs:{label:$t("im9oyy4","退款金额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatNumMoney")(a.row.refundedFee/100)))])]}}])}),e("el-table-column",{attrs:{label:$t("axpnww4","分账类型","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["bspay"==a.row.payType?e("span",[t._v($t("lzjf2","线上","lang"))]):e("span",[t._v($t("lzjg2","线下","lang"))])]}}])}),e("el-table-column",{attrs:{label:$t("axo1rf4","分账状态","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[!0===a.row.canDiv?e("span",[t._v($t("cpb0v3","可分账","lang"))]):e("span",[t._v($t("a73nxe4","不可分账","lang"))])]}}])}),e("el-table-column",{attrs:{label:$t("d8plo74","是否分账","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["NOTDIV"==a.row.bspayDivStatus?e("span",[t._v($t("fiphm3","未分账","lang"))]):"DIVED"==a.row.bspayDivStatus?e("span",[t._v($t("e63iq3","已分账","lang"))]):t._e()]}}])}),"admin"==t.$store.getters.login_type?[e("el-table-column",{attrs:{label:$t("csikv77","手续费扣费方式","lang"),prop:"bspayFeeMode"},scopedSlots:t._u([{key:"default",fn:function(a){return["2"==a.row.bspayFeeMode?e("span",[t._v($t("eem62","内扣","lang"))]):"1"==a.row.bspayFeeMode?e("span",[t._v($t("foy52","外扣","lang"))]):e("span",[t._v("-")])]}}],null,!1,2726282774)}),e("el-table-column",{attrs:{label:$t("f0nsn3","手续费","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatNumMoney")(a.row.bspayFee/100)))])]}}],null,!1,350153786)})]:t._e(),e("el-table-column",{attrs:{label:$t("axtnf04","分账金额","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatNumMoney")(a.row.divFee/100)))])]}}])}),e("el-table-column",{attrs:{label:$t("ar7uqh4","创建日期","lang"),prop:"timeStart"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("formatTimestamp")(a.row.timeStart)))])]}}])}),e("el-table-column",{attrs:{fixed:"right",label:$t("hkxb2","操作","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.goDetail(a.row.tradeId)}}},[t._v($t("gcika4"," 查看 ","lang"))])]}}])})],2),e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{background:"","current-page":t.params.page,"page-sizes":[10,20,30],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:t.total_count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)],1)],1)])],1)},[],!1,null,"87256ec8",null).exports}}]);