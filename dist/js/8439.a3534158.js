"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8439],{8439:function(t,a,e){e.r(a),e.d(a,{default:function(){return g}});e(44114);var i=e(95353),n=e(87378),s=e(5134),l=(e(47003),e(79296)),r={components:{imgPicker:n.default},provide(){return{refresh:this.refresh}},data(){return{isGetImage:!1,imgDialog:!1,loading:!1,ad_pic:"",total_count:0,activeName:"list",tempatePageKanJiaParamId:0,submit:!1,params:{page:1,pageSize:20},dataList:[]}},computed:{...(0,i.L8)(["wheight"])},mounted(){this.getBargainsList()},methods:{saveAdPic(){if(this.tempatePageKanJiaParamId){let t={params:{ad_pic:this.ad_pic},template_name:"yykcutdown",name:"banner",page_name:"pages/kanjia",id:this.tempatePageKanJiaParamId};(0,l.updateParamsById)(t).then(t=>{this.$message({message:$t("aghf564","保存成功","lang"),type:"success",duration:5e3})})}else if(!this.submit){this.submit=!0;let t={params:{ad_pic:this.ad_pic},template_name:"yykcutdown",name:"banner",page_name:"pages/kanjia"};(0,l.setPageParams)(t).then(t=>{this.submit=!1,this.$message({message:$t("aghf564","保存成功","lang"),type:"success",duration:5e3})})}},handleImgChange(){this.imgDialog=!0,this.isGetImage=!0},pickImg(t){this.ad_pic=t.url,this.imgDialog=!1},closeImgDialog(){this.imgDialog=!1},addBargains(){this.$router.push({path:this.matchRoutePath("editor")})},editBargains(t,a){this.$router.push({path:this.matchRoutePath("editor/")+a.bargain_id})},getAdPic(){(0,l.getParamByTempName)({template_name:"yykcutdown",name:"banner",page_name:"pages/kanjia"}).then(t=>{t.data.data&&(this.ad_pic=t.data.data[0].params.ad_pic,this.tempatePageKanJiaParamId=t.data.data[0].id)})},deleteBargainsAction(t,a){this.$confirm($t("1z67i7i","此操作将删除该助力活动, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,s.deleteBargains)(a.bargain_id).then(t=>{this.$message({message:$t("xttoc28","删除助力活动成功","lang"),type:"success",duration:5e3}),this.getBargainsList()})}).catch(()=>{this.$message({type:"info",message:$t("e68dg3","已取消","lang")})})},terminateBargainsAction(t,a){this.$confirm($t("tsbjhei","此操作将废除该助力活动, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,s.terminateBargains)(a.bargain_id).then(t=>{this.$message({message:$t("uvfjl98","废除助力活动成功","lang"),type:"success",duration:5e3}),this.getBargainsList()})}).catch(()=>{this.$message({type:"info",message:$t("e68dg3","已取消","lang")})})},getBargainsList(){this.loading=!0;let t={page:this.params.page,pageSize:this.params.pageSize};(0,s.listBargins)(t).then(t=>{this.loading=!1,this.dataList=t.data.data.list,this.total_count=t.data.data.total_count}).catch(t=>{this.$message({type:"error",message:$t("vt4xuk8","获取活动列表出错","lang")})})},handleCurrentChange(t){this.params.page=t,this.getBargainsList()},refresh(){this.getBargainsList()}}},g=(0,e(81656).A)(r,function(){var t=this,a=t._self._c;return a("SpPage",[t.VERSION_SHUYUN()?t._e():a("SpPlatformTip"),-1===t.$route.path.indexOf("editor")?a("el-tabs",{attrs:{type:"card"},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:$t("e7tqe46","助力活动管理","lang"),name:"list"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.dataList,height:t.wheight-230}},[a("el-table-column",{attrs:{prop:"title",label:$t("e4hvdc4","活动名称","lang")}}),a("el-table-column",{attrs:{label:$t("e4l2kr4","活动时间","lang"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("datetime")(e.row.begin_time,"YYYY-MM-DD HH:mm:ss"))+" "),a("br"),t._v(" "+t._s(t._f("datetime")(e.row.end_time,"YYYY-MM-DD HH:mm:ss"))+" ")]}}],null,!1,3644145949)}),a("el-table-column",{attrs:{prop:"item_name",label:$t("a9yk8t4","产品名称","lang")}}),a("el-table-column",{attrs:{label:$t("a9y94i4","产品原价","lang"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.mkt_price/100)+" ")]}}],null,!1,4211350726)}),a("el-table-column",{attrs:{label:$t("aa048s4","产品底价","lang"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ￥"+t._s(a.row.price/100)+" ")]}}],null,!1,3118597451)}),a("el-table-column",{attrs:{label:$t("artcaw4","助力人数","lang"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.people_range.min)+" ~ "+t._s(a.row.people_range.max)+" ")]}}],null,!1,550756592)}),a("el-table-column",{attrs:{prop:"limit_num",label:$t("aa1nfd4","产品数量","lang"),align:"center"}}),a("el-table-column",{attrs:{prop:"order_num",label:$t("cfqzh64","已购数量","lang"),align:"center"}}),a("el-table-column",{attrs:{label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.is_expired?t._e():a("i",{staticClass:"el-icon-edit",on:{click:function(a){return t.editBargains(e.$index,e.row)}}}),e.row.is_expired?t._e():a("i",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"10px"},on:{click:function(a){return t.terminateBargainsAction(e.$index,e.row)}}},[t._v($t("gx452","废除","lang"))]),a("i",{staticClass:"mark el-icon-delete",staticStyle:{"margin-left":"10px",color:"#ff5000"},on:{click:function(a){return t.deleteBargainsAction(e.$index,e.row)}}})]}}],null,!1,4089537397)})],1),t.total_count>t.params.pageSize?a("div",{staticClass:"content-center content-padded"},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total_count,"page-size":t.params.pageSize},on:{"current-change":t.handleCurrentChange}})],1):t._e()],1),a("el-tab-pane",{attrs:{label:$t("l51yu75","助力广告图","lang"),name:"image"}},[a("el-form",{ref:"form",attrs:{"label-position":"left"}},[a("el-form-item",[a("div",{staticClass:"frm-tips"},[t._v($t("d4i01p15","只能上传jpg/png文件，且不超过2M （建议尺寸：617px * 214px）","lang"))]),a("div",[a("div",{staticClass:"upload-box",on:{click:t.handleImgChange}},[t.ad_pic?a("img",{staticClass:"setting_pic",attrs:{src:t.wximageurl+t.ad_pic}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])]),a("imgPicker",{attrs:{"dialog-visible":t.imgDialog,"sc-status":t.isGetImage},on:{chooseImg:t.pickImg,closeImgDialog:t.closeImgDialog}})],1)],1),a("div",{staticClass:"section-footer with-border content-center",staticStyle:{width:"100%"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveAdPic}},[t._v($t("ako8wb5"," 保 存 ","lang"))])],1)],1)],1):t._e(),a("router-view")],1)},[],!1,null,"6ecbf192",null).exports}}]);