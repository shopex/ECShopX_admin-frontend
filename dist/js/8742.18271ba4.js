"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8742],{48742:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var a=i(95353),n=i(94644),o={name:"InvitationCode",props:{info:String},data(){return{}},created(){},methods:{handleDownload(){window.open(this.info)}}},l=i(81656),s=(0,l.A)(o,function(){var e=this,t=e._self._c;return t("div",{staticClass:"invitation-code"},[t("SpImage",{attrs:{src:e.info,width:120}}),t("a",{staticClass:"download-link text-blue-400",attrs:{download:"invitation_code.jpg",href:e.info}},[e._v($t("vaxf3c5","下载邀请码","lang"))])],1)},[],!1,null,"0c0dad5c",null).exports,r={components:{invitationCode:s},data(){const e=this.$createElement;return{form:{condition_type:"num",condition_money:"",chief_desc:"",rebate_ratio:0,aggrement:"",explanation:""},formList:[{label:$t("cqho1z4","成团条件","lang"),key:"condition_type",type:"radio",options:[{label:"num",name:$t("rugi3h5","按商品数量","lang")},{label:"money",name:$t("q7v5tl5","按成团金额","lang")}],tip:$t("jutf8wm","说明：按活动商品设置的起订量成团，0为不限制","lang"),onChange:e=>{"num"==e?(this.formList[0].tip=$t("jutf8wm","说明：按活动商品设置的起订量成团，0为不限制","lang"),this.formList[1].isShow=!1):(this.formList[0].tip=$t("aat447h","说明：整团成团最低金额，0为不限制","lang"),this.formList[1].isShow=!0)}},{label:$t("ncl9cu9","最低成团金额(元)","lang"),key:"condition_money",type:"input",placeholder:$t("ksdqe17","请输入成团金额","lang"),required:!0,message:$t("adohlc4","不能为空","lang"),isShow:!1},{label:$t("40n1il5","团长邀请码","lang"),key:"invitation_code",component:()=>e(s,{attrs:{info:this.wxCode}})},{label:$t("3wn9hw5","团长申请页","lang"),key:"chief_desc",type:"text"},{label:$t("ami37i4","佣金设置","lang"),key:"rebate_ratio",type:"input",append:"%",placeholder:$t("amcett4","佣金比列","lang"),tip:$t("p9gtwht","团长根据成团金额按百分比例获取佣金，设置为0时则不计算佣金","lang")},{label:$t("m8pjuo6","团长注册协议","lang"),key:"aggrement",type:"richText",required:!0,message:$t("adohlc4","不能为空","lang")},{label:$t("kodyhh5","申请页说明","lang"),key:"explanation",type:"richText",required:!0,message:$t("adohlc4","不能为空","lang")}],tableData:[],setting:(0,n.createSetting)({actions:[{name:$t("d7ere74","新增配置","lang"),key:"detail",type:"button",slot:"header",buttonType:"primary is-plain",action:{handler:async e=>{this.registerForm={id:"",label:"",field_type:1,alert_required_message:""},this.$refs.registerDialogRef.resetForm(),this.registerDialog=!0}}},{name:$t("mekb2","编辑","lang"),key:"detail",type:"button",buttonType:"text",action:{handler:async([e])=>{this.registerForm.id=e.id,this.registerForm.label=e.label,this.registerForm.field_type=e.field_type,this.registerForm.alert_required_message=e.alert_required_message,this.registerDialog=!0}}},{name:$t("eslg2","删除","lang"),key:"detail",type:"button",buttonType:"text",action:{handler:async([e])=>{await this.$confirm($t("d8po4b4","是否删除","lang"),$t("hn562","提示","lang")),await this.$api.community.deleteCommunityField(e.id),this.$refs.finder.refresh()}}}],columns:[{name:$t("e46m2","信息","lang"),key:"label"},{name:$t("d8pu5s4","是否启用","lang"),key:"is_open",render:(e,{row:t})=>e("el-switch",{props:{value:t.is_open,"active-value":1,"inactive-value":0},on:{change:async e=>{await this.$api.community.modifyFieldSwitch(t.id,{type:1,switch:e}),t.is_open=e}}})},{name:$t("grwm2","必填","lang"),key:"is_required",render:(e,{row:t})=>e("el-switch",{props:{value:t.is_required,"active-value":1,"inactive-value":0},on:{change:async e=>{await this.$api.community.modifyFieldSwitch(t.id,{type:2,switch:e}),t.is_required=e}}})},{name:$t("coqbe3","可修改","lang"),key:"is_edit",render:(e,{row:t})=>e("el-switch",{props:{value:t.is_edit,"active-value":1,"inactive-value":0},on:{change:async e=>{await this.$api.community.modifyFieldSwitch(t.id,{type:3,switch:e}),t.is_edit=e}}})},{name:$t("ahbxj54","信息格式","lang"),key:"field_type_desc"},{name:$t("d3gn7v4","提示文案","lang"),key:"alert_required_message"}]}),registerDialog:!1,registerForm:{id:"",label:"",field_type:1,alert_required_message:""},registerFormList:[{label:$t("iuxnua4","配置标题","lang"),key:"label",type:"input",placeholder:$t("2j7m1y5","请输入标题","lang"),required:!0,message:$t("adohlc4","不能为空","lang")},{label:$t("ahbxj54","信息格式","lang"),key:"field_type",placeholder:$t("u9xpvc7","请选择信息格式","lang"),type:"select",options:[{title:$t("hu2t2","文本","lang"),value:1},{title:$t("hwbe2","日期","lang"),value:3},{title:$t("ewbd43","手机号","lang"),value:6},{title:$t("ff9l2","图片","lang"),value:7}],required:!0,message:$t("adohlc4","不能为空","lang"),onChange:e=>{this.cancelOrderFormList[1].isShow=12==e}},{label:$t("d3gn7v4","提示文案","lang"),key:"alert_required_message",type:"input",placeholder:$t("kfmdn07","请输入提示文案","lang"),required:!0,message:$t("adohlc4","不能为空","lang")}],wxCode:""}},computed:{...(0,a.L8)(["shopId"])},created(){},mounted(){this.getActivitySetting(),this.getCommunityChiefApplyFields(),this.getChiefWxCode()},methods:{async onSaveConfig(){const{condition_type:e,condition_money:t,rebate_ratio:i,aggrement:a,explanation:n}=this.form;await this.$api.community.modifyActivitySetting({condition_type:e,condition_money:t,rebate_ratio:i,aggrement:a,explanation:n}),this.$message.success($t("ai8d7e4","修改成功","lang"))},async getActivitySetting(){const{condition_money:e,condition_type:t,aggrement:i,explanation:a,rebate_ratio:n}=await this.$api.community.getActivitySetting();this.form={condition_type:t,condition_money:e,chief_desc:$t("6nnhy319","您可在模板编辑-热区图组件-设置路径，选择团长申请页面路径供用户在店铺首页进入团长申请页面","lang"),rebate_ratio:n,aggrement:i,explanation:a},"money"==t&&(this.formList[0].tip=$t("aat447h","说明：整团成团最低金额，0为不限制","lang"),this.formList[1].isShow=!0)},async getCommunityChiefApplyFields(){await this.$api.community.getActivitySetting()},async onResisterSubmit(){const e={...this.registerForm};this.registerForm.id?await this.$api.community.modifyCommunityField(e):await this.$api.community.createCommunityChiefApplyFields(e),this.registerDialog=!1,this.$refs.finder.refresh()},async getChiefWxCode(){const e={distributor_id:this.shopId,path:"subpages/community/apply-chief"},{base64Image:t}=await this.$api.community.getChiefWxCode(e);this.wxCode=t}}},d=(0,l.A)(r,function(){var e=this,t=e._self._c;return t("SpPage",[t("el-tabs",{attrs:{type:"card"}},[t("el-tab-pane",{attrs:{label:$t("cai6u15","社区团配置","lang")}},[t("SpForm",{attrs:{"form-list":e.formList},on:{onSubmit:e.onSaveConfig},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),t("el-tab-pane",{attrs:{label:$t("l3at5l7","团长注册项配置","lang")}},[t("SpFinder",{ref:"finder",attrs:{"no-selection":"",setting:e.setting,url:"/community/chief/apply_fields"}}),t("SpDialog",{ref:"registerDialogRef",attrs:{title:`${e.registerForm.id?$t("gms6yk4","编辑配置","lang"):$t("e86r2e4","添加配置","lang")}`,form:e.registerForm,"form-list":e.registerFormList},on:{onSubmit:e.onResisterSubmit},model:{value:e.registerDialog,callback:function(t){e.registerDialog=t},expression:"registerDialog"}})],1)],1)],1)},[],!1,null,"a7ab06d2",null).exports}}]);