"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[4292],{74292:function(t,a,e){e.r(a),e.d(a,{default:function(){return r}});e(44114);var i=e(95353),s=(e(57270),e(5134)),n={provide(){return{refresh:this.refresh}},props:["getStatus"],data(){return{create_time:"",activeName:"first",activityLists:[],loading:!1,total_count:0,params:{page:1,pageSize:20,status:"",activity_name:"",time_start_begin:"",time_start_end:""},communityVisible:!1,couponVisible:!1,goodsVisible:!1,goodsList:[],goodsCount:0,goodsPageSize:10,goodsPage:1,nowActivity:""}},computed:{...(0,i.L8)(["wheight"])},watch:{getStatus(t){t&&this.getList(this.params)}},mounted(){this.$route.query.status&&(this.params.status=this.$route.query.status),this.getList(this.params)},methods:{handleCurrentChange(t){this.params.page=t,this.getList(this.params)},addActivityData(){this.$router.push({path:this.matchRoutePath("editor")})},editCommunityAction(t,a){this.$router.push({path:this.matchRoutePath("editor/")+a.activity_id})},dataSearch(){this.params.begin_time="",this.params.end_time="",this.create_time="",this.params.page=1,this.getList(this.params)},getList(t){this.loading=!0,(0,s.getPointupvaluationList)(t).then(t=>{this.activityLists=t.data.data.list,this.total_count=t.data.data.total_count,this.loading=!1})},updateStatusCommunityAction(t){var a=$t("3pkh9yi","此操作将永久终止该活动, 是否继续?","lang");this.$confirm(a,$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(a,e,i)=>{"confirm"===a&&(0,s.pointupvaluationUpdateStatus)({activity_id:t.activity_id}).then(t=>{this.getList(),this.$message({message:$t("c6bhfy8","修改活动状态成功","lang"),type:"success",duration:5e3})}),i()}})},dateChange(t){this.params.status="",t&&t.length>0?(this.params.begin_time=this.dateStrToTimeStamp(t[0]+" 00:00:00"),this.params.end_time=this.dateStrToTimeStamp(t[1]+" 23:59:59")):(this.params.begin_time="",this.params.end_time=""),this.params.page=1,this.getList(this.params)},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3},viewCouponList(t){this.couponVisible=!0},handleCancel(){this.communityVisible=!1,this.couponVisible=!1,this.goodsVisible=!1},updateActivityData(t){updateActivityItemData(t).then(t=>{})},editItemPrice(t){let a={id:t.id,item_id:t.item_id,activity_price:t.activity_price,vip_price:t.vip_price,svip_price:t.svip_price,activity_store:t.activity_store,points:t.points};this.updateActivityData(a)},refresh(){this.getList(this.params)}}},r=(0,e(81656).A)(n,function(){var t=this,a=t._self._c;return a("SpRouterView",[a("SpPage",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:$t("e4hvdc4","活动名称","lang")},model:{value:t.params.title,callback:function(a){t.$set(t.params,"title",a)},expression:"params.title"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.dataSearch},slot:"append"})],1)],1),a("el-col",{attrs:{span:4}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:$t("e4mxzs4","活动状态","lang"),clearable:""},on:{change:t.dataSearch},model:{value:t.params.activity_status,callback:function(a){t.$set(t.params,"activity_status",a)},expression:"params.activity_status"}},[a("el-option",{attrs:{label:$t("en402","全部","lang"),value:"0"}}),a("el-option",{attrs:{label:$t("fkmt13","未开始","lang"),value:"waiting"}}),a("el-option",{attrs:{label:$t("lq5q43","进行中","lang"),value:"ongoing"}}),a("el-option",{attrs:{label:$t("edie63","已结束","lang"),value:"it_has_ended"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","value-format":"yyyy/MM/dd",placeholder:$t("t9q3f56","添加时间筛选","lang")},on:{change:t.dateChange},model:{value:t.create_time,callback:function(a){t.create_time=a},expression:"create_time"}})],1),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addActivityData}},[t._v($t("tv32jy6"," 添加活动 ","lang"))])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.activityLists,height:t.wheight-150}},[a("el-table-column",{attrs:{prop:"activity_id",label:"ID",width:"50"}}),a("el-table-column",{attrs:{label:$t("e4hvdc4","活动名称","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.title)),a("br")]}}])}),a("el-table-column",{attrs:{label:$t("e4l2kr4","活动时间","lang"),width:"190"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.begin_date)+" "),a("span",{staticClass:"text-muted"},[t._v("~")]),t._v(" "+t._s(e.row.end_date)+" "),a("span",{staticClass:"text-muted"})]}}])}),a("el-table-column",{attrs:{prop:"activity_status",label:$t("e4mxzs4","活动状态","lang"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["waiting"==e.row.activity_status?a("span",[t._v($t("egbo03","待开始","lang"))]):"ongoing"==e.row.activity_status?a("span",[t._v($t("lq5q43","进行中","lang"))]):"it_has_ended"==e.row.activity_status?a("span",[t._v($t("edie63","已结束","lang"))]):t._e()]}}])}),a("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return["it_has_ended"!==e.row.activity_status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editCommunityAction(e.$index,e.row)}}},[t._v($t("xefpa06"," 编辑活动 ","lang"))]):t._e(),"ongoing"==e.row.activity_status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.updateStatusCommunityAction(e.row)}}},[t._v($t("rn93i16"," 终止活动 ","lang"))]):t._e()]}}])})],1),t.total_count>t.params.pageSize?a("div",{staticClass:"content-center content-top-padded"},[a("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(a){return t.$set(t.params,"page",a)},"update:current-page":function(a){return t.$set(t.params,"page",a)},"current-change":t.handleCurrentChange}})],1):t._e()],1)],1)},[],!1,null,null,null).exports}}]);