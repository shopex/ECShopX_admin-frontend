"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[9303],{19303:function(t,e,a){a.r(e),a.d(e,{default:function(){return i}});var o=a(95093),n=a.n(o),l={data(){return{activeName:"first",logoutConfigData:{title:$t("u5d6u3o","订单完成之前，无法注销会员。如有疑问，请联系客服","lang"),new_rights:"0"},privacyData:{update_date:"",take_effect_date:"",content:""}}},computed:{logoutConfigItems(){return[{fieldName:"title",formItemClass:"w-2/3",label:$t("g4xe3n6","注销提示文案","lang"),component:"input",componentProps:{type:"textarea",placeholder:$t("2jbrwj5","请输入内容","lang"),maxlength:50,showWordLimit:!0,autosize:{minRows:3},style:{width:"500px"}},tip:`${$t("nfpjqfi","有未完成的订单用户点击注销会员时提示","lang")}`},...this.VERSION_IN_PURCHASE()?[]:[{fieldName:"new_rights",formItemClass:"w-2/3",label:$t("2yqq656","享受新人权益","lang"),component:"select",componentProps:{placeholder:$t("l72nr3","请选择","lang"),options:[{label:$t("k6n1","是","lang"),value:"1"},{label:$t("gme1","否","lang"),value:"0"}]},tip:`${$t("idwirgj","用户注销会员后重新注册是否享受新人权益","lang")}`}]]},privacyFormItems(){const t=this.$createElement;return[{formItemClass:"w-2/3",component:()=>t("el-alert",{class:"leading-normal",attrs:{title:$t("uvh7be17","注销协议内容修改后，提交后对线上客户生效；注销协议在客户注销账号时须同意才可继续注销。","lang"),type:"warning","show-icon":!0,closable:!1}})},{fieldName:"update_date",formItemClass:"w-1/3",label:$t("dev1na4","更新日期","lang"),component:"datepicker",componentProps:{format:"yyyy-MM-dd",valueFormat:"yyyy-MM-dd",placeholder:$t("ikzrh64","选择日期","lang")}},{fieldName:"take_effect_date",formItemClass:"w-1/3",label:$t("f74tyb4","生效日期","lang"),component:"datepicker",componentProps:{format:"yyyy-MM-dd",valueFormat:"yyyy-MM-dd",placeholder:$t("ikzrh64","选择日期","lang")}},{fieldName:"content",label:$t("edas2","内容","lang"),component:({h:t,value:e,onInput:a})=>t("SpRichText",{props:{value:e,height:"400px"},on:{input:a}}),rules:[{required:!0,validator:(t,e,a)=>{e&&0!==e.length?a():a(new Error($t("9hqo4n5","请填写内容","lang")))},trigger:"blur"}]}]}},mounted(){this.getLogoutConfig()},methods:{async getLogoutConfig(){try{const{member_logout_config:t,member_logout:e}=await this.$api.members.getShopsProtocol();t?.title&&(this.logoutConfigData={title:t.title,new_rights:t.new_rights||"0"}),e?.content&&(this.privacyData={update_date:e.update_date,take_effect_date:e.take_effect_date,content:e.content})}catch(t){}},async handleSubmitLogoutConfig(){await this.$api.members.updateShopsProtocol({data:[{type:"member_logout_config",...this.logoutConfigData}]}),this.$message.success($t("aghf564","保存成功","lang"))},async handleSubmitPrivacy(){await this.$api.members.updateShopsProtocol({data:[{type:"member_logout",update_date:n()(this.privacyData.update_date).format("YYYY-MM-DD"),take_effect_date:n()(this.privacyData.take_effect_date).format("YYYY-MM-DD"),content:this.privacyData.content}]}),this.$message.success($t("aghf564","保存成功","lang"))},async handleSubmit(t,e,a){try{await this.$refs[t].validate();let o;if("member_logout_config"===e)o={type:e,...this.logoutConfigData},void 0!==a&&(o.status=a);else{if(!this.privacyData.content||0===this.privacyData.content.length)return this.$message.error($t("9hqo4n5","请填写内容","lang"));o={type:e,...this.privacyData}}await this.$api.closeAccount.saveInfo({data:[o]});this.$message.success($t("cx7dr74","提交成功","lang"))}catch(t){}}}},i=(0,a(81656).A)(l,function(){var t=this,e=t._self._c;return e("SpPage",{staticClass:"closeAccount"},[t.VERSION_SHUYUN()?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",alipay:""}}),e("el-tabs",{attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:$t("ed15g94","注销配置","lang"),name:"first"}},[e("SpFormPlus",{ref:"logoutConfigForm",staticClass:"mt-10",attrs:{"form-items":t.logoutConfigItems,"form-type":"form"},on:{submit:t.handleSubmitLogoutConfig},model:{value:t.logoutConfigData,callback:function(e){t.logoutConfigData=e},expression:"logoutConfigData"}})],1),e("el-tab-pane",{attrs:{label:$t("ecqo9j4","注销协议","lang"),name:"second"}},[e("SpFormPlus",{ref:"privacyForm",staticClass:"mt-10",attrs:{"form-items":t.privacyFormItems,"form-type":"form"},on:{submit:t.handleSubmitPrivacy},model:{value:t.privacyData,callback:function(e){t.privacyData=e},expression:"privacyData"}})],1)],1)],1)},[],!1,null,"245202cd",null).exports}}]);