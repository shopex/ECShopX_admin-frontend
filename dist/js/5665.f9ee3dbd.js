"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[5665],{65665:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});a(44114),a(18111),a(61701);var n=a(16519),i=a(77825),l={filters:{formatStatus(t){var e="";switch(t){case"waiting":e=$t("fkmt13","未开始","lang");break;case"ongoing":e=$t("lq5q43","进行中","lang");break;case"it_has_ended":e=$t("edie63","已结束","lang")}return e}},mixins:[i.v8],provide(){return{refresh:this.fetchList}},data(){const t={activity_status:void 0,purchase_name:void 0};return{initialParams:t,params:{...t},loading:!1,loadingbtn:!1,checkedType:{},typeId:-1,multipleSelection:[]}},mounted(){this.fetchList()},methods:{getParams(){return{...this.params}},onSearch(){this.page.pageIndex=1,this.$nextTick(()=>{this.fetchList()})},onReset(){this.params={...this.initialParams},this.onSearch()},async fetchList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let a={page:t,pageSize:e,...this.getParams()};const{list:n,total_count:i}=await this.$api.purchase.getPurchaseList(a);n.length>0?(this.tableList=n.map(t=>(t.dependents_limitfee=(t.dependents_limitfee/100).toFixed(2),t.employee_limitfee=(t.employee_limitfee/100).toFixed(2),t)),this.page.total=i):this.tableList=[],this.loading=!1},addPurchase(){this.$router.push({path:this.matchRoutePath("editor")})},deleteCard(t,e){const a=this;this.$confirm($t("lntbms9","确定要终止该活动？","lang"),$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(e,i,l)=>{"confirm"===e&&((0,n.endPurchase)({purchase_id:t}),this.$message({type:"success",message:$t("gfvb8p4","终止成功","lang"),onClose(){a.fetchList()}})),l()}})},handleSelectionChange(t){this.multipleSelection=t}}},s=(0,a(81656).A)(l,function(){var t=this,e=t._self._c;return e("div",[-1===t.$route.path.indexOf("detail")&&-1===t.$route.path.indexOf("editor")&&-1===t.$route.path.indexOf("dependents")?[e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary",icon:"iconfont icon-xinzengcaozuo-01"},on:{click:t.addPurchase}},[t._v($t("1t0na36"," 新增活动 ","lang"))])],1),e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onReset}},[e("SpFilterFormItem",{attrs:{prop:"activity_status",label:$t("bt2y025","活动状态:","lang")}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:$t("xx8qbz7","请选择活动状态","lang"),clearable:""},model:{value:t.params.activity_status,callback:function(e){t.$set(t.params,"activity_status",e)},expression:"params.activity_status"}},[e("el-option",{attrs:{label:$t("en402","全部","lang"),value:"0"}}),e("el-option",{attrs:{label:$t("fkmt13","未开始","lang"),value:"waiting"}}),e("el-option",{attrs:{label:$t("lq5q43","进行中","lang"),value:"ongoing"}}),e("el-option",{attrs:{label:$t("edie63","已结束","lang"),value:"it_has_ended"}})],1)],1),e("SpFilterFormItem",{attrs:{prop:"activity_status",label:$t("bopooa5","活动名称:","lang")}},[e("el-input",{attrs:{placeholder:$t("jel5hj7","请输入活动名称","lang")},model:{value:t.params.purchase_name,callback:function(e){t.$set(t.params,"purchase_name",e)},expression:"params.purchase_name"}})],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{border:"",data:t.tableList},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{prop:"purchase_id",label:$t("e42yeg4","活动ID","lang")}}),e("el-table-column",{attrs:{prop:"purchase_name",label:$t("e4hvdc4","活动名称","lang")}}),e("el-table-column",{attrs:{prop:"employee_limitfee",label:$t("b1glpy4","员工额度","lang")}}),e("el-table-column",{attrs:{prop:"dependents_limitfee",label:$t("aac14y4","亲友额度","lang")}}),e("el-table-column",{attrs:{prop:"activity_status",label:$t("e4mxzs4","活动状态","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatStatus")(e.row.activity_status))+" ")]}}],null,!1,1757337365)}),e("el-table-column",{attrs:{width:"301",label:$t("breu9f5","活动有效期","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.begin_date)+" "),e.row.end_date?[t._v(" ~ ")]:t._e(),t._v(" "+t._s(e.row.end_date)+" ")]}}],null,!1,2910526043)}),e("el-table-column",{attrs:{width:"150",label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"operating-icons"},[e("el-button",{attrs:{type:"text"}},[e("router-link",{attrs:{to:{path:t.matchRoutePath("detail"),query:{id:a.row.purchase_id}}}},[t._v($t("gcika4"," 查看 ","lang"))])],1),"waiting"==a.row.activity_status?e("el-button",{attrs:{type:"text"}},[e("router-link",{attrs:{to:{path:t.matchRoutePath("editor"),query:{id:a.row.purchase_id}}}},[t._v($t("juz394"," 编辑 ","lang"))])],1):t._e(),"it_has_ended"!=a.row.activity_status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.deleteCard(a.row.purchase_id,a.$index)}}},[e("span",{staticStyle:{color:"#f56c6c"}},[t._v($t("gfx7mv4","终止活动","lang"))])]):t._e(),e("el-button",{attrs:{type:"text"}},[e("router-link",{attrs:{to:{path:t.matchRoutePath("dependents"),query:{id:a.row.purchase_id}}}},[t._v($t("lb8f936"," 亲友数据 ","lang"))])],1)],1)]}}],null,!1,1182673346)})],1),e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1)]:t._e(),e("router-view")],2)},[],!1,null,"4c07ad88",null).exports}}]);