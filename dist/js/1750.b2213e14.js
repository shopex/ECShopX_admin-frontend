"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[1750],{71750:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});a(44114),a(18111),a(7588);var i=a(77825),n=a(26456),l=a(6919),r={components:{EnterpriseDialog:a(51616).A},mixins:[i.Ay,i.v8],provide(){return{refresh:this.fetchList}},data(){const t={field_title:void 0,status:"",create_time:[],distributor_id:""};return{initialParams:t,params:{...t},loading:!1,statusOption:[{name:$t("en402","全部","lang"),value:""},{name:$t("egbo03","待开始","lang"),value:"waiting"},{name:$t("lq5q43","进行中","lang"),value:"ongoing"},{name:$t("edie63","已结束","lang"),value:"end"}],shopList:[],dialogData:{},dialogVisible:!1}},watch:{},mounted(){this.fetchList(),this.getStoreList()},methods:{addElement(){this.$router.push({path:this.matchRoutePath("editor")})},onSearch(){this.page.pageIndex=1,this.$nextTick(()=>{this.fetchList()})},onReset(){this.params={...this.initialParams},this.onSearch()},getParams(){const t={},e=this.params.create_time;return e.length&&(t.start_time=this.dateStrToTimeStamp(e[0]+" 00:00:00"),t.end_time=this.dateStrToTimeStamp(e[1]+" 00:00:00")),{...this.params,create_time:[],...t}},async fetchList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let a={page:t,pageSize:e,...this.getParams()};const{list:i,total_count:n}=await this.$api.selfhelpform.regActivityList(a);this.tableList=i,this.page.total=n,this.loading=!1},dateStrToTimeStamp(t){return Date.parse(new Date(t))/1e3},async getStoreList(){const{list:t}=await this.$api.marketing.getDistributorList({page:1,pageSize:500});t&&t.forEach(t=>{this.shopList.push({value:t.name,distributor_id:t.distributor_id})})},onOperationChange(t,e){"edit"==e?this.$router.push({path:this.matchRoutePath("editor"),query:{id:t.activity_id,type:"edit"}}):"detail"==e?this.$router.push({path:this.matchRoutePath("editor"),query:{id:t.activity_id,type:"detail"}}):"record"==e&&this.$router.push({path:((0,n.JR)()?"/shopadmin":"")+"/marketing/activity-apply/activity-record",query:{id:t.activity_id}})},onStopChange(t){var e=$t("3pkh9yi","此操作将永久终止该活动, 是否继续?","lang");this.$confirm(e,$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(e,a,i)=>{"confirm"===e&&(0,l.regActivityInvalid)({activity_id:t.activity_id}).then(t=>{this.fetchList(),this.$message({message:$t("c6bhfy8","修改活动状态成功","lang"),type:"success",duration:5e3})}),i()}})},onShowChange(t){this.dialogData=t,this.closeDialog(!0)},closeDialog(t){this.dialogVisible=t}}},s=(0,a(81656).A)(r,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpRouterView",[t.VERSION_SHUYUN()?t._e():e("SpPlatformTip",{attrs:{h5:"",app:"",alipay:""}}),e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onReset}},[e("SpFilterFormItem",{attrs:{prop:"field_title",label:$t("bopooa5","活动名称:","lang")}},[e("el-input",{attrs:{placeholder:$t("e4hvdc4","活动名称","lang")},model:{value:t.params.field_title,callback:function(e){t.$set(t.params,"field_title",e)},expression:"params.field_title"}})],1),e("SpFilterFormItem",{attrs:{prop:"status",label:$t("h97673","状态:","lang")}},[e("el-select",{attrs:{placeholder:$t("k1e32","状态","lang")},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.statusOption,function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.value}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"create_time",label:$t("fn58c3","时间:","lang")}},[e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy/MM/dd",placeholder:$t("fcdtwa8","根据添加时间筛选","lang")},model:{value:t.params.create_time,callback:function(e){t.$set(t.params,"create_time",e)},expression:"params.create_time"}})],1),e("SpFilterFormItem",{attrs:{prop:"distributor_id",label:$t("xu5q0k5","店铺名称:","lang")}},[e("SpSelectShop",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:t.params.distributor_id,callback:function(e){t.$set(t.params,"distributor_id",e)},expression:"params.distributor_id"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary",icon:"iconfont icon-xinzengcaozuo-01"},on:{click:t.addElement}},[t._v($t("qxrmpa6"," 活动添加 ","lang"))])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"",data:t.tableList}},[e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),fixed:"left",width:t.IS_DISTRIBUTOR()?150:250},scopedSlots:t._u([{key:"default",fn:function(a){return["ongoing"!==a.row.status&&"waiting"!==a.row.status||t.IS_DISTRIBUTOR()?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onOperationChange(a.row,"edit")}}},[t._v($t("juz394"," 编辑 ","lang"))]),"end"===a.row.status||t.IS_DISTRIBUTOR()?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onOperationChange(a.row,"detail")}}},[t._v($t("gcika4"," 查看 ","lang"))]):t._e(),"waiting"!==a.row.status||t.IS_DISTRIBUTOR()?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onStopChange(a.row)}}},[t._v($t("jn7om4"," 终止 ","lang"))]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onOperationChange(a.row,"record")}}},[t._v($t("e5k1zh6"," 报名记录 ","lang"))])]}}])}),e("el-table-column",{attrs:{prop:"activity_id",label:$t("m2sh2","编号","lang"),width:"100"}}),e("el-table-column",{attrs:{prop:"activity_name",label:$t("e4hvdc4","活动名称","lang"),width:"200"}}),e("el-table-column",{attrs:{label:$t("d8tf4v4","是否核销","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1==e.row.is_offline_verify?$t("k6n1","是","lang"):$t("gme1","否","lang"))+" ")]}}])}),e("el-table-column",{attrs:{prop:"gift_points",label:$t("gyxnw64","获取积分","lang"),width:"120"}}),e("el-table-column",{attrs:{label:$t("imyhd64","进白名单","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1==e.row.is_white_list?$t("k6n1","是","lang"):$t("gme1","否","lang"))+" ")]}}])}),e("el-table-column",{attrs:{label:$t("e4l2kr4","活动时间","lang"),width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.start_date)+" ~ "+t._s(e.row.end_date)+" ")]}}])}),e("el-table-column",{attrs:{label:$t("cslszi4","报名人数","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.total_join_num||0)+" ")]}}])}),e("el-table-column",{attrs:{prop:"status_name",label:$t("k1e32","状态","lang"),width:"120"}}),e("el-table-column",{attrs:{prop:"distributor_name",label:$t("gwn72","店铺","lang"),width:"120"}})],1),e("div",{staticClass:"content-center content-top-padded"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1),e("EnterpriseDialog",{attrs:{visible:t.dialogVisible,data:t.dialogData},on:{"update:visible":function(e){t.dialogVisible=e},closeDialog:t.closeDialog}})],1)],1)},[],!1,null,"6e9cd5c4",null).exports}}]);