"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8259],{68259:function(t,e,i){i.r(e),i.d(e,{default:function(){return $}});i(44114),i(18111),i(22489),i(7588),i(61701);var a=i(95353),s=i(18979),o=i.n(s),r=i(71196),l=i(81193),n=i(27671),c=i(5748),p=i(2038),d=(i(26456),i(77825)),m=i(33318),u=(i(20116),{props:{itemsVisible:{type:Boolean,default:!1}},data(){return{loading:!1,itemsData:[],selectRows:[],total_count:"",params:{page:1,pageSize:10,keywords:"",item_bn:""},hiddenItem:[],cursymbol:"￥"}},computed:{showDialog(){return this.itemsVisible}},watch:{async itemsVisible(t){t&&this.getNewsList()}},mounted(){this.getCurrencyInfo()},methods:{disabledItem(t,e){return!(this.hiddenItem.indexOf(t.itemId)>-1)},getRowKeys(t){return t.itemId},getCurrencyInfo(){(0,l.getDefaultCurrency)().then(t=>{this.currency=t.data.data,this.cursymbol=this.currency.symbol})},handleCurrentChange(t){this.$refs.multipleTable.clearSelection(),this.params.page=t,this.getNewsList()},searchByKey(){this.params.page=1,this.getNewsList()},handleSelectAll(t){if(this.limitNum)return this.$message({message:$t("8l004s9","当前组件不支持全选","lang"),type:"warning"}),this.$refs.multipleTable.clearSelection(),void this.itemsData.forEach(t=>{this.selectRows.find(e=>e.itemId===t.itemId)&&this.$refs.multipleTable.toggleRowSelection(t)});t.length>0?t.forEach(t=>{-1===this.selectRows.findIndex(e=>t.itemId===e.itemId)&&this.selectRows.push(t)}):this.itemsData.forEach((t,e)=>{let i=this.selectRows.findIndex(e=>t.itemId===e.itemId);-1!==i&&this.selectRows.splice(i,1)})},handleSelectChange(t,e){let i=this.selectRows.findIndex(t=>e.itemId===t.itemId);if(-1!==i)this.selectRows.splice(i,1);else{if(this.limitNum&&1==this.limitNum)return this.selectRows=[],this.selectRows.push(e),this.$refs.multipleTable.clearSelection(),void this.selectRows.forEach(t=>{this.$refs.multipleTable.toggleRowSelection(t)});if(this.limitNum&&this.selectRows.length>=this.limitNum)return this.$message({message:`${$t("ddfhju4","最多选择","lang")}${this.limitNum}${$t("bzbu93","件商品","lang")}`,type:"warning"}),this.$refs.multipleTable.clearSelection(),void this.selectRows.forEach(t=>{this.$refs.multipleTable.toggleRowSelection(t)});this.selectRows.push(e)}},cancelAction(){this.selectRows=[],this.$emit("closeGoodsDialog")},saveGoodsAction(){this.$emit("chooseGoods",this.selectRows)},async getNewsList(){this.loading=!0;let t=JSON.parse(JSON.stringify(this.params));try{const e=await(0,c.getSelectItemsList)(t),i=e.data.data.list;this.itemsData=i,this.total_count=e.data.data.total_count}catch(t){}this.loading=!1},priceformatter(t,e){return this.cursymbol+t.price/100}}}),g=i(81656),h=(0,g.A)(u,function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"store-dialog",attrs:{width:"900px",title:$t("ikwu2j4","选择商品","lang"),visible:t.showDialog,"close-on-click-modal":!1,"before-close":t.cancelAction,"append-to-body":""},on:{"update:visible":function(e){t.showDialog=e}}},[e("div",{staticClass:"promotionSearch",staticStyle:{"margin-bottom":"15px"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:6}},[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:$t("pu0wr46","输入商品名称","lang"),clearable:""},model:{value:t.params.keywords,callback:function(e){t.$set(t.params,"keywords",e)},expression:"params.keywords"}})],1),e("el-col",{attrs:{span:6}},[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:$t("pttlm06","输入商品编码","lang"),clearable:""},model:{value:t.params.item_bn,callback:function(e){t.$set(t.params,"item_bn",e)},expression:"params.item_bn"}})],1),e("el-col",{attrs:{span:2}},[e("el-button",{staticClass:"fl",attrs:{type:"primary"},on:{click:t.searchByKey}},[t._v($t("ftlbu4"," 搜索 ","lang"))])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.itemsData,"tooltip-effect":"dark","row-key":t.getRowKeys,"select-on-indeterminate":!1},on:{select:t.handleSelectChange,"select-all":t.handleSelectAll}},[e("el-table-column",{attrs:{type:"selection",selectable:t.disabledItem,"reserve-selection":!0,width:"80"}}),e("el-table-column",{attrs:{prop:"itemId",label:$t("b3ly1i4","商品ID","lang")}}),e("el-table-column",{attrs:{prop:"itemName",label:$t("b40v0e4","商品名称","lang")}}),e("el-table-column",{attrs:{prop:"itemBn",label:$t("b4865i4","商品编码","lang")}}),e("el-table-column",{attrs:{prop:"price",label:$t("e04l2","价格","lang"),width:"80",formatter:t.priceformatter,"show-overflow-tooltip":""}})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"pager"},[e("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total_count,"page-size":t.params.pageSize},on:{"current-change":t.handleCurrentChange}})],1):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cancelAction}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveGoodsAction}},[t._v($t("hnjoo3","确 定","lang"))])],1)],1)},[],!1,null,"3ca6a3b0",null).exports,_=i(94644),f={name:"",props:{itemId:String,distributorId:String,itemShowSkuStore:Boolean,itemShowSkuPrice:Boolean},data(){this.$createElement;return{setting:(0,_.createSetting)({columns:[{name:$t("b4865i4","商品编码","lang"),key:"item_bn",width:160},{name:$t("o06w2","规格","lang"),key:"item_spec_desc"},{name:$t("gl5x2","库存","lang"),key:"store",width:100,render:(t,{row:e})=>e.is_total_store?t("span",[e.store]):t("div",[t("span",[e.store]),this.itemShowSkuStore&&t("el-popover",{attrs:{placement:"top",trigger:"hover"},on:{show:()=>this.onShowPopover(e,"store")}},[t("div",{class:"popover-edit"},[t("el-input",{class:"edit-input",attrs:{placeholder:$t("2j9k1e5","请输入库存","lang")},model:{value:this.skuEditInput,callback:t=>{this.skuEditInput=t}}}),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:this.onModifyItemSku.bind(this,e)}},[$t("kzjg2","确定","lang")])]),t("el-button",{slot:"reference",attrs:{type:"text"}},[t("i",{class:"el-icon-edit"})])])])},{name:$t("5t2yy47","商品价格（¥）","lang"),key:"price",width:160,render:(t,{row:e})=>t("div",[t("span",[e.price/100]),this.itemShowSkuPrice&&t("el-popover",{attrs:{placement:"top",trigger:"hover"},on:{show:()=>this.onShowPopover(e,"price")}},[t("div",{class:"popover-edit"},[t("el-input",{class:"edit-input",attrs:{placeholder:$t("2j0i5n5","请输入金额","lang")},model:{value:this.skuPriceEditInput,callback:t=>{this.skuPriceEditInput=t}}}),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:this.onModifyItemPrice.bind(this,e)}},[$t("kzjg2","确定","lang")])]),t("el-button",{slot:"reference",attrs:{type:"text"}},[t("i",{class:"el-icon-edit"})])])])},{name:$t("k1e32","状态","lang"),key:"is_can_sale",render:(t,{row:e})=>t("span",{},this.getApproveStatus(e.approve_status))}]}),skuEditInput:"",skuPriceEditInput:""}},created(){},methods:{beforeSearch(t){return t={...t,is_sku:!0,item_id:this.itemId,distributor_id:this.distributorId}},getApproveStatus(t){return{onsale:$t("meu01y5","前台可销售","lang"),offline_sale:$t("mfygnl5","前台不展示","lang")}[t]||$t("a7er004","不可销售","lang")},onShowPopover({store:t},e){"store"==e?this.skuEditInput=t:"price"==e&&(this.skuPriceEditInput=price)},async onModifyItemSku({item_id:t}){await this.$api.marketing.updateDistributorItem({distributor_id:this.distributorId,item_id:t,store:this.skuEditInput}),this.$refs.skuFinder.refresh()},async onModifyItemPrice({item_id:t}){await this.$api.marketing.updateDistributorItem({distributor_id:this.distributorId,item_id:t,price:100*this.skuPriceEditInput}),this.$refs.skuFinder.refresh()}}},b=(0,g.A)(f,function(){var t=this;return(0,t._self._c)("SpFinder",{ref:"skuFinder",staticClass:"sku-finder",attrs:{"no-selection":"","fixed-row-action":"",url:"/distributor/items",hooks:{beforeSearch:t.beforeSearch},setting:t.setting}})},[],!1,null,null,null).exports,y={components:{Treeselect:o(),SideBar:r.A,GoodsSelect:h,skuFinder:b},mixins:[d.Ay],provide(){return{refresh:this.getGoodsList}},props:["getStatus"],data(){const t=this.$createElement;this.$store.getters.login_type;let e;return e=this.IS_DISTRIBUTOR()?[{title:$t("aqef1e4","前台可售","lang"),value:!0},{title:$t("mg037b5","前台不可售","lang"),value:!1}]:[{title:$t("meu01y5","前台可销售","lang"),value:"onsale"},{title:$t("mfygnl5","前台不展示","lang"),value:"offline_sale"},{title:$t("mfuo7t5","前台仅展示","lang"),value:"only_show"},{title:$t("a7er004","不可销售","lang"),value:"instock"}],{show_rebate_sideBar:!1,show_profit_sideBar:!1,select_tags_value:[],popularizeSetting:{popularize_ratio:{type:"profit"}},regions:n,current:"",currentId:"",currentPrice:"",tabList:[{name:$t("av9wor4","全部商品","lang"),value:null,activeName:"first"},{name:$t("lx3u4e6","库存预警商品","lang"),value:"true",activeName:"second"}],goodsName:"",isEdit:!1,activeName:"first",ItemsList:[],item_id:[],goods_id:[],templates_new_id:"",templatesList:[],templatesListavailable:[],category_id:[],categoryList:[],itemCategoryList:[],show_sideBar:!1,loading:!1,skuLoading:!1,submitLoading:!1,total_count:0,warning_store:5,templatesParams:{page:1,pageSize:1e3},goodsBranchList:[],appID:"",appCodeUrl:"",curPageUrl:"",goodsBranchParams:{page:1,pageSize:1e3,attribute_type:"brand",attribute_name:""},tag:{dialog:!1,editItem:[],list:[],form:{tag_ids:[],item_ids:[]},currentTags:[],tags:[]},page:{pageIndex:1,pageSize:20,total:0},params:{item_type:"normal",templates_id:"",keywords:"",item_bn:"",supplier_goods_bn:"",category:0,item_category:0,is_warning:!1,audit_status:"",delivery_data_type:"",tag_id:"",tax_rate_code:"",is_gift:void 0,type:0,barcode:"",distributor_id:0,regions_id:[],brand_id:"",goods_bn:"",operator_name:"",is_can_sale:"",supplier_name:"",cat_id:"",item_holder:"",is_gift:""},goodCategoryMap:m.g5,goodCategory:m.DH,start_date:"",end_date:"",addTemplatesdialogVisible:!1,addCategorydialogVisible:!1,currency:{},cursymbol:"￥",form:{},isGiftsData:{},exportData:{},exportTagData:{},specItems:[],rebateSpecItems:[],profitSpecItems:[],grade:[],vipGrade:[],statusOption:e,storeUpdate:!1,storeItemsList:[],show_itemStore:!1,itemstore:0,distributorVisible:!1,setDistributorStatus:!1,relDistributorIds:"",selections:[],xpGoodsVisible:!1,batchChangeStateDialog:!1,batchChangeStateFormList:[{label:$t("b45xmu4","商品状态","lang"),key:"status",type:"select",message:$t("adohlc4","不能为空","lang"),options:e}],batchChangeStateForm:{status:""},isBindWdtErp:!1,isBindJstErp:!1,skuEditInput:"",skuPriceEditInput:"",itemSkuDialog:!1,itemShowSkuStore:!1,itemShowSkuPrice:!1,itemSkuForm:{itemName:"",itemId:""},itemSkuFormList:[{key:"invitation_code",component:()=>t(b,{attrs:{itemId:this.itemSkuForm.itemId,itemShowSkuStore:this.itemShowSkuStore,itemShowSkuPrice:this.itemShowSkuPrice,distributorId:this.shopId}})}],showItemSkuDrawer:!1,itemSkuDrawerTitle:"",itemSkuList:[],goodCategoryMap:m.g5,goodCategory:m.DH.filter(t=>"distributor"!=t.value)}},computed:{...(0,a.L8)(["wheight","login_type","shopId"])},watch:{$route(t,e){this.init()},getStatus(t){t&&this.getGoodsList()}},mounted(){this.init(),this.fetchWechatList(),this.params.operator_name=this.$route.query.operator_name,this.checkWdtErpBind(),this.checkJstErpBind()},destroyed(){},methods:{onItemSkuFormSubmit(){this.itemSkuDialog=!1,this.itemShowSkuStore=!1,this.itemShowSkuPrice=!1,this.getGoodsList()},onShowPopover({store:t,price:e},i){"store"==i?this.skuEditInput=t:"price"==i&&(this.skuPriceEditInput=e)},async onModifyItemSku({item_id:t,nospec:e,itemName:i}){e?(await this.$api.marketing.updateDistributorItem({distributor_id:this.shopId,item_id:t,store:this.skuEditInput}),this.getGoodsList()):(this.itemSkuForm.itemName=i,this.itemSkuForm.itemId=t,this.itemSkuDialog=!0,this.itemShowSkuStore=!0,this.itemShowSkuPrice=!0)},async onModifyItemPrice({item_id:t,nospec:e,itemName:i}){e?(await this.$api.marketing.updateDistributorItem({distributor_id:this.shopId,item_id:t,price:100*this.skuPriceEditInput}),this.getGoodsList()):(this.itemSkuForm.itemName=i,this.itemSkuForm.itemId=t,this.itemSkuDialog=!0,this.itemShowSkuPrice=!0,this.itemShowSkuStore=!1)},async syncToShop(t){if(0==this.item_id.length)return void this.$message.error($t("gi0dra9","请选择至少一个商品","lang"));let e="_all";if(!t){const{data:t}=await this.$picker.shop();e=t.map(t=>t.distributor_id)}await this.$api.marketing.saveDistributorItems({distributor_ids:e,item_ids:this.item_id,is_can_sale:!0}),this.$message.success($t("d1spvi4","操作成功","lang"))},async fetchWechatList(){const{list:t}=await this.$api.minimanage.gettemplateweapplist();t.forEach((t,e)=>{"yykweishop"==t.key_name&&(this.appID=t.authorizer.authorizer_appid)})},handleShow(t){const e="pages/item/espier-detail";this.curPageUrl=`${e}?id=${t}`;let i={wxaAppId:this.appID,page:e,id:t};(0,p.getPageCode)(i).then(t=>{this.appCodeUrl=t.data.data.base64Image})},handleDownload(t){var e=document.createElement("a"),i=t;this.appCodeUrl&&(e.href=this.appCodeUrl,e.download=i+".png",e.click())},handleImport(t){"physicalupload"==t?"distributor"==this.login_type?this.$router.push({path:"/shopadmin/products/product-import"}):this.$router.push({path:"/products/product-manage/self-products/product-import"}):"physicalstoreupload"==t&&("distributor"==this.login_type?this.$router.push({path:"/shopadmin/entity/goodsphysical/physicalstoreupload"}):this.$router.push({path:"/entity/goods/goodsphysical/physicalstoreupload"}))},selectItems(){this.xpGoodsVisible=!0},async chooseGoodsAction(t){this.xpGoodsVisible=!1;let e=JSON.parse(JSON.stringify(t));if(null===e||0===e.length)return;const i=e.map(t=>({goods_id:t.goods_id})),a={items:JSON.stringify(i)};await(0,c.flowItems)(a),this.$message({type:"success",message:$t("iiwcpz4","选品成功","lang")}),this.getGoodsList()},closeGoodsDialogAction(){this.xpGoodsVisible=!1},async init(){"godsphysicalkj"===this.$route.path.split("/")[2]?this.params.type=1:this.params.type=0;const{category:t,main_cat_id:e,tab:i}=this.$route.query;t&&(this.params.category=t.split(",")),this.params.main_cat_id=this.$route.query.main_cat_id,i&&(this.activeName=this.$route.query.tab,this.params.is_warning=!0);const a=await this.$api.promotions.getPopularizeSetting();this.popularizeSetting=a,this.getGoodsList(),this.getShippingTemplatesList(),this.getCategory(),this.getCurrencyInfo(),this.getAllTagLists(),this.getGoodsBranchList()},batchGifts(t){this.item_id.length?(this.isGiftsData.item_id=Object.assign({},this.item_id),this.isGiftsData.status=t,(0,c.saveIsGifts)(this.isGiftsData).then(t=>{1==t.data.data.status?this.$message({type:"success",message:$t("d1spvi4","操作成功","lang"),duration:2e3}):this.$message({type:"error",message:$t("d1rj434","操作失败","lang"),duration:2e3})})):this.$message({type:"error",message:$t("eajgmxa","请选择至少一个商品!","lang"),duration:2e3})},async exportItemsData(){const t={...this.params};this.item_id.length>0&&(t.item_id=this.item_id.map(t=>t));const{status:e}=await this.$api.goods.exportItemsData(t);e?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("items")):this.$message.error($t("by46j64","导出失败","lang"))},async exportItemsTagData(){const t={...this.params};this.item_id.length>0&&(t.item_id=this.item_id.map(t=>t));const{status:e}=await this.$api.goods.exportItemsTagData(t);e?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("normal_items_tag")):this.$message.error($t("by46j64","导出失败","lang"))},async exportItemsWxappCode(t){const e={...this.params};this.item_id.length>0&&(e.item_id=this.item_id.map(t=>t));const{status:i}=await this.$api.goods.exportGoodsCode({...e,source:"item",export_type:t});i?(this.$message.success($t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")),this.$export_open("itemcode")):this.$message.error($t("by46j64","导出失败","lang"))},handleExport(t){"product-info"===t?this.exportItemsData():"product-tag"===t?this.exportItemsTagData():"h5-qrcode"===t&&this.exportItemsWxappCode("h5")},syncItems(){(0,c.syncItems)().then(t=>{1==t.data.data.status?this.$message({type:"success",message:$t("lgxi507","已加入执行队列","lang")}):this.$message({type:"error",message:$t("b1sq7h4","同步失败","lang")})})},editPrice(t,e){this.currentId=t,this.currentPrice=e;let i=this;this.$nextTick(()=>{i.$refs["input_"+t].focus()})},handleBlur(t){if(this.currentPrice===this.specItems[t].price)return this.currentId=-1,void(this.currentPrice="");(0,c.updateGoodsInfo)({item_id:this.currentId,price:this.currentPrice}).then(e=>{this.$message({type:"success",message:$t("d1spvi4","操作成功","lang")}),this.specItems[t].price=this.currentPrice,this.currentId=-1,this.currentPrice=""})},handleClick(t,e){this.page.pageIndex=1,"second"==this.activeName?this.params.is_warning=!0:this.params.is_warning=!1,this.getGoodsList()},async setWarningStore(){await this.$api.goods.getItemWarningStore({store:this.warning_store}),this.page.pageIndex=1,this.getGoodsList()},handleSelectionChange(t){this.selections=t;let e=[];for(let i in t)e.push(t[i].itemId);this.item_id=e;let i=[];for(let e in t)i.push(t[e].goods_id);this.goods_id=i},handleCancelLabelsDialog(){this.tag.dialog=!1},tagUpdate(t){this.tag.editItem=[t.itemName],this.tag.currentTags=t.tagList||[],this.tag.form.item_ids=t.item_id,this.showTags()},addItemTag(){this.tag.currentTags=[],this.item_id.length?(this.showTags(),this.tag.form.item_ids=this.item_id,this.tag.editItem=this.selections.map(t=>t.itemName)):this.$message({type:"error",message:$t("eajgmxa","请选择至少一个商品!","lang")})},showTags(){let t=[];this.tag.list.forEach((e,i)=>{-1===this.tag.currentTags.findIndex(t=>t.tag_id==e.tag_id)&&t.push(e)}),this.tag.tags=t,this.tag.dialog=!0},tagRemove(t){this.tag.tags.unshift(this.tag.currentTags[t]),this.tag.currentTags.splice(t,1)},tagAdd(t,e){-1==this.tag.currentTags.findIndex(e=>e.tag_id==t.tag_id)&&(this.tag.currentTags.push(t),this.tag.tags.splice(e,1))},submitItemTag(){this.tag.form.tag_ids=[],this.tag.currentTags.forEach(t=>{this.tag.form.tag_ids.push(t.tag_id)}),this.tag.dialog=!1,(0,c.itemsRelTags)(this.tag.form).then(t=>{t.data.data.status&&(this.$message({type:"success",message:$t("s3r6he5","打标签完成","lang")}),this.getGoodsList())}).catch(t=>{this.getGoodsList()})},tagSearchUserChange(){this.getParams(),this.getItemsList(this.params),this.loading=!1},getAllTagLists(){(0,c.getTagList)({page:1,pageSize:500}).then(t=>{this.tag.list=t.data.data.list})},changeTemplates(){if(this.item_id.length){if(!this.templates_new_id)return this.$message({type:"error",message:$t("wib2ci7","请选择运费模板","lang")}),!1;this.addTemplatesdialogVisible=!1,(0,c.setItemsTemplate)({templates_id:this.templates_new_id,item_id:this.item_id}).then(t=>{this.getGoodsList()})}else this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")})},editItemsSort(t,e){(0,c.setItemsSort)({sort:e.sort,item_id:e.itemId}).then(t=>{this.getGoodsList()})},changeCategory(){if(this.item_id.length){if(!this.category_id)return this.$message({type:"error",message:$t("w32lpi7","请选择销售分类","lang")}),!1;this.addCategorydialogVisible=!1,(0,c.setItemsCategory)({category_id:this.category_id,item_id:this.item_id}).then(t=>{this.getGoodsList(),this.category_id=[]})}else this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")})},addItems(){this.$router.push({path:this.matchRoutePath("editor")})},addTemplates(){this.item_id.length?this.addTemplatesdialogVisible=!0:this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")})},addCategory(){this.item_id.length?this.addCategorydialogVisible=!0:this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")})},editItemsAction(t,e,i){this.show_rebate_sideBar=!1,this.show_sideBar=!1,this.show_itemStore=!1},saveRebateConf(){var t=[];this.rebateSpecItems.forEach(e=>{var i=e.rebate_conf;i.ratio_type=this.popularizeSetting.popularize_ratio.type,t.push(i)}),(0,c.updateItemRebateConf)({rebateConf:JSON.stringify(t)}).then(t=>{this.$message({message:$t("aghf564","保存成功","lang"),type:"success",duration:2e3})})},saveProfitConf(){var t=[];this.profitSpecItems.forEach(e=>{var i={};i.item_id=e.item_id,i.profit_type=e.profit_type,i.price=100*e.price,1==i.profit_type?(i.profit_conf_profit=e.profit_conf_profit,i.profit_conf_popularize_profit=e.profit_conf_popularize_profit):(i.profit_conf_profit=100*e.profit_conf_profit,i.profit_conf_popularize_profit=100*e.profit_conf_popularize_profit),t.push(i)}),(0,c.saveGoodsProfitPrice)({profit_conf:JSON.stringify(t)}).then(t=>{this.$message({message:$t("aghf564","保存成功","lang"),type:"success",duration:2e3})})},handleRebateConf(t){this.show_rebate_sideBar=!0,this.show_profit_sideBar=!1,this.show_sideBar=!1,this.skuLoading=!0,this.current=t,(0,c.getItemsList)({page:1,pageSize:1e3,is_sku:!0,item_id:t.item_id,item_type:"normal"}).then(t=>{var e=[];t.data.data.list.forEach(t=>{if(0===t.rebate_conf.length){t.rebate_conf={},t.rebate_conf.type="money",t.rebate_conf.value={};for(let e in this.popularizeSetting.popularize_ratio.profit)t.rebate_conf.value[e]=""}else if(this.popularizeSetting.popularize_ratio.type!=t.rebate_conf.ratio_type&&"money"!=t.rebate_conf.type)for(let e in this.popularizeSetting.popularize_ratio.profit)t.rebate_conf.value[e]="";t.rebate_conf.item_id=t.item_id,e.push(t)}),this.rebateSpecItems=e,this.skuLoading=!1})},handlePrice(t){this.show_rebate_sideBar=!1,this.show_sideBar=!0,this.show_profit_sideBar=!1,this.current=t.item_id,this.getGoodsPrice(t.item_id)},handleProfitPrice(t){this.show_rebate_sideBar=!1,this.show_sideBar=!1,this.show_profit_sideBar=!0,this.current=t.item_id,this.getGoodsProfitPrice(t.item_id)},getGoodsPrice(t){this.skuLoading=!0,(0,c.getGoodsPrice)(t).then(t=>{let e=[];t.data.data.list.forEach(t=>{e.push({item_id:t.item_id,item_spec_desc:t.item_spec_desc||t.itemName,price:t.price/100,market_price:t.market_price/100,grade:this.generatePrice(t.memberGrade.grade),vipGrade:this.generatePrice(t.memberGrade.vipGrade)})}),this.grade=this.generatePrice(t.data.data.list[0].memberGrade.grade),this.vipGrade=this.generatePrice(t.data.data.list[0].memberGrade.vipGrade),this.specItems=e,this.skuLoading=!1})},getGoodsProfitPrice(t){this.skuLoading=!0,(0,c.getGoodsProfitPrice)(t).then(t=>{let e=[];t.data.data.list.forEach(t=>{let i={item_id:t.item_id,item_spec_desc:t.item_spec_desc||t.itemName,price:t.price/100,market_price:t.market_price/100,profit_type:t.profit_type,profit_conf_profit:t.profit_conf_profit,profit_conf_popularize_profit:t.profit_conf_popularize_profit};2==t.profit_type&&(i.profit_conf_profit=t.profit_conf_profit/100,i.profit_conf_popularize_profit=t.profit_conf_popularize_profit/100),e.push(i)}),this.profitSpecItems=e,this.skuLoading=!1})},generatePrice(t){let e=[];for(let i in t)e.push({vip_grade_id:t[i].vip_grade_id,grade_name:t[i].grade_name,mprice:t[i].mprice/100||""});return e},savePrice(){let t={item_id:this.current,mprice:""},e={};this.specItems.forEach(t=>{let i={};t.grade.forEach(t=>{Object.assign(i,{[t.vip_grade_id]:t.mprice})});let a={};t.vipGrade.forEach(t=>{Object.assign(a,{[t.vip_grade_id]:t.mprice})}),Object.assign(e,{[t.item_id]:{grade:i,vipGrade:a}})}),t.mprice=JSON.stringify(e),this.submitLoading=!0;const i=this;(0,c.updateGoodsPrice)(t).then(e=>{this.$message({type:"success",message:$t("deua4r4","更新成功","lang"),duration:2e3,onClose(){i.submitLoading=!1,i.getGoodsPrice(t.item_id),i.getGoodsList()}})}).catch(t=>{i.submitLoading=!1})},handleCurrentChange(t){this.page.pageIndex=t,this.getGoodsList()},handleSizeChange(t){this.page.pageIndex=1,this.page.pageSize=t,this.getGoodsList()},onSearch(){this.page.pageIndex=1,this.$nextTick(()=>{this.getGoodsList()})},async getGoodsList(){this.loading=!0;const{pageIndex:t,pageSize:e}=this.page;let i={page:t,pageSize:e,...this.params,distributor_id:this.shopId};i.category.length>0&&(i.category=i.category[i.category.length-1]);const{list:a,total_count:s,warning_store:o}=await this.$api.marketing.getDistributorItems(i);a.forEach(t=>{t.price=t.price/100,t.market_price=t.market_price/100,t.link=`pages/item/espier-detail?gid=${t.goods_id}&id=${t.item_id}`}),this.ItemsList=a,this.page.total=parseInt(s),this.warning_store=o,this.loading=!1},deleteItemsAction(t,e){this.$confirm($t("13qc9xg","此操作将删除该商品, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,c.deleteItems)(e.itemId).then(e=>{this.ItemsList.splice(t,1),this.$message({message:$t("u5jv766","删除商品成功","lang"),type:"success",duration:2e3})})}).catch(()=>{this.$message({type:"info",message:$t("e68dg3","已取消","lang")})})},async getShippingTemplatesList(){const{list:t}=await this.$api.shipping.getShippingTemplatesList({page:1,pageSize:1e3});this.templatesList=t,this.templatesListavailable=t.filter(t=>t.status)},getGoodsBranchList(t=""){this.goodsBranchParams.attribute_name=t,(0,c.getGoodsAttr)(this.goodsBranchParams).then(t=>{this.goodsBranchList=t.data.data.list})},async getCategory(){const t=await this.$api.goods.getCategory({is_show:!1});this.categoryList=t;const e=await this.$api.goods.getCategory({is_main_category:!0});this.itemCategoryList=e},getCurrencyInfo(){(0,l.getDefaultCurrency)().then(t=>{this.currency=t.data.data,this.cursymbol=this.currency.symbol})},batchItemsStore(){this.storeItemsList=[],this.item_id.length?this.storeUpdate=!0:this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")})},batchChangeStore(){if(0===this.goods_id.length)return this.$message({type:"error",message:$t("gi0dra9","请选择至少一个商品","lang")}),!1;this.batchChangeStateDialog=!0},async onBatchChangeStateSubmit(){await this.$api.marketing.updateDistributorItem({distributor_id:this.shopId,goods_id:this.goods_id,is_can_sale:this.batchChangeStateForm.status}),this.$message.success($t("ai8d7e4","修改成功","lang")),this.getGoodsList(),this.batchChangeStateDialog=!1},async updateItemStatus(t){this.loading=!0;let e={};e={goods_id:t.goods_id,is_can_sale:!t.is_can_sale,distributor_id:this.shopId,operate_source:"platform"};try{const{status:t}=await this.$api.marketing.updateDistributorItem(e);t&&(this.$message.success($t("d1spvi4","操作成功","lang")),this.getGoodsList()),this.loading=!1}catch(t){this.loading=!1}},updateItemsStore(t){this.skuLoading=!0,this.item_id=[];let e=JSON.parse(JSON.stringify(this.params));e.item_id=t.item_id,e.is_sku=!0,this.storeItemsList=[],(0,c.getItemsList)({...e,page:this.page.pageIndex,pageSize:this.page.pageSize}).then(t=>{t.data.data.list.forEach(t=>{let e={item_id:t.item_id,store:t.store,item_spec_desc:t.item_spec_desc?t.item_spec_desc:t.item_name};this.storeItemsList.push(e)}),this.skuLoading=!1}),this.show_itemStore=!0},saveItemsStore(){if(this.skuLoading=!0,Number(this.itemstore)<0||this.storeItemsList.length&&Number(this.storeItemsList[0].store)<0)return this.$message({type:"error",message:$t("h9255s7","库存需为正整数","lang"),duration:2e3}),void(this.skuLoading=!1);let t={};if(this.storeItemsList.length>0)t={items:JSON.stringify(this.storeItemsList)};else if(this.item_id.length>0){let e=[];this.item_id.forEach(t=>{e.push({item_id:t,store:this.itemstore,is_default:!0})}),t={items:JSON.stringify(e)}}this.submitLoading=!0;(0,c.updateItemsStore)(t).then(t=>{t.data.data.status&&this.$message({message:$t("ai8d7e4","修改成功","lang"),type:"success",duration:2e3}),this.submitLoading=!1,this.skuLoading=!1,this.storeUpdate=!1,this.getGoodsList()}).catch(t=>{this.submitLoading=!1,this.skuLoading=!1})},async handleViewSkuInfo(t){this.skuLoading=!0;const{list:e}=await this.$api.goods.getDrawItemsList({item_type:"normal",operate_source:"platform",item_id:t.goods_id,is_sku:!0,page:1,pageSize:1e3,distributor_id:0});this.itemSkuDrawerTitle=`${$t("cwbp13","商品【","lang")}${t.item_name}】`,this.itemSkuList=e||[],this.showItemSkuDrawer=!0,this.itemSkuList=e,this.skuLoading=!1},onClickLink(t){this.$copyText(`${{VUE_APP_IS_SAAS:"false",VUE_APP_SYSTEM_NAME:"Shopex Admin",VUE_APP_PUBLIC_PATH:"/",VUE_APP_WXIMG_URL:"",VUE_APP_WXAUTHCALL_Url:"https://demo-ecshopx.ishopex.cn",VUE_APP_PREFIXES:"",VUE_APP_QIANKUN_ENTRY:"/newpc",VUE_APP_OSS_CDN:"false",VUE_APP_FREE:"false",VUE_APP_ALIOSS_REGION:"",VUE_APP_ALIOSS_ACCESS_KEY_ID:"",VUE_APP_ALIOSS_ACCESS_KEY_SECRET:"",VUE_APP_ALIOSS_BUCKET:"",VUE_APP_LOCAL_DELIVERY_DIRVER:"dada",VUE_APP_CHUZHI:"true",NODE_ENV:"production",VUE_APP_BASE_API:"https://ecshopx82.shopex123.com/api",VUE_APP_MAP_KEY:"PSPBZ-KQ5CW-CSGRF-ON2S4-K2HQJ-XEBQG",VUE_APP_DEFAULT_LANG:"zhcn",BASE_URL:"/",VUE_APP_PLATFORM:"yd"}.VUE_APP_H5_HOST}/pages/item/espier-detail?id=${t.item_id}&dtid=${t.distributor_id}`).then(()=>{this.$message.success($t("bkv2mw4","复制成功","lang"))})},checkWdtErpBind(){this.$api.third.getWdtErpSetting().then(t=>{this.isBindWdtErp=t.is_open})},uploadWdtErpItems(){if(0===this.item_id.length)return void this.$message({type:"error",message:$t("kvesema","请选择需要同步的商品","lang")});let t={};t={item_id:this.item_id},this.$api.goods.uploadWdtErpItems(t).then(t=>{1==t.status?this.$message({type:"success",message:$t("lgxi507","已加入执行队列","lang")}):this.$message({type:"error",message:$t("cz7pg94","执行失败","lang")})})},checkJstErpBind(){this.$api.third.getJstErpSetting().then(t=>{this.isBindJstErp=t.is_open})},uploadJstErpItems(){if(0===this.item_id.length)return void this.$message({type:"error",message:$t("kvesema","请选择需要同步的商品","lang")});let t={};t={item_id:this.item_id},this.$api.goods.uploadJstErpItems(t).then(t=>{1==t.status?this.$message({type:"success",message:$t("lgxi507","已加入执行队列","lang")}):this.$message({type:"error",message:$t("cz7pg94","执行失败","lang")})})}}},$=(0,g.A)(y,function(){var t=this,e=t._self._c;return e("SpPage",{staticClass:"page-body"},[-1===t.$route.path.indexOf("editor")&&-1===t.$route.path.indexOf("physicalstoreupload")&&-1===t.$route.path.indexOf("physicalprofitupload")&&-1===t.$route.path.indexOf("physicalupload")?[e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"keywords",label:$t("alr0oi5","商品标题:","lang")}},[e("el-input",{attrs:{placeholder:$t("zdpct8b","商品标题或副标题关键词","lang")},model:{value:t.params.keywords,callback:function(e){t.$set(t.params,"keywords",e)},expression:"params.keywords"}})],1),t.IS_DISTRIBUTOR()?e("SpFilterFormItem",{attrs:{prop:"is_can_sale",label:$t("akgb645","商品状态:","lang")}},[e("el-select",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:t.params.is_can_sale,callback:function(e){t.$set(t.params,"is_can_sale",e)},expression:"params.is_can_sale"}},t._l(t.statusOption,function(t){return e("el-option",{key:t.value,attrs:{label:t.title,size:"mini",value:t.value}})}),1)],1):e("SpFilterFormItem",{attrs:{prop:"approve_status",label:$t("akgb645","商品状态:","lang")}},[e("el-select",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:t.params.approve_status,callback:function(e){t.$set(t.params,"approve_status",e)},expression:"params.approve_status"}},t._l(t.statusOption,function(t){return e("el-option",{key:t.value,attrs:{label:t.title,size:"mini",value:t.value}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"main_cat_id",label:$t("15jaio5","管理分类:","lang")}},[e("el-cascader",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:"",options:t.itemCategoryList,props:{value:"category_id",label:"category_name",checkStrictly:!0}},model:{value:t.params.main_cat_id,callback:function(e){t.$set(t.params,"main_cat_id",e)},expression:"params.main_cat_id"}})],1),e("SpFilterFormItem",{attrs:{prop:"cat_id",label:$t("pfl60n5","销售分类:","lang")}},[e("el-cascader",{attrs:{options:t.categoryList,props:{checkStrictly:!0,label:"category_name",value:"category_id"},clearable:""},model:{value:t.params.cat_id,callback:function(e){t.$set(t.params,"cat_id",e)},expression:"params.cat_id"}})],1),e("SpFilterFormItem",{attrs:{prop:"templates_id",label:$t("cbau7n5","运费模板:","lang")}},[e("el-select",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:""},model:{value:t.params.templates_id,callback:function(e){t.$set(t.params,"templates_id",e)},expression:"params.templates_id"}},t._l(t.templatesList,function(t){return e("el-option",{key:t.template_id,attrs:{label:t.name,value:t.template_id}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"brand_id",label:$t("cycj33","品牌:","lang")}},[e("el-select",{attrs:{placeholder:$t("eqebqb8","商品/商标关键词","lang"),remote:"",filterable:"",clearable:"","remote-method":t.getGoodsBranchList},model:{value:t.params.brand_id,callback:function(e){t.$set(t.params,"brand_id",e)},expression:"params.brand_id"}},t._l(t.goodsBranchList,function(t){return e("el-option",{key:t.attribute_id,attrs:{label:t.attribute_name,value:t.attribute_id}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"regions_id",label:$t("apry225","商品产地:","lang")}},[e("el-cascader",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:"",options:t.regions},model:{value:t.params.regions_id,callback:function(e){t.$set(t.params,"regions_id",e)},expression:"params.regions_id"}})],1),e("SpFilterFormItem",{attrs:{prop:"item_bn",label:$t("u0g1m66","SKU编码:","lang")}},[e("el-input",{attrs:{placeholder:$t("rcpx9b8","请输入SKU编码","lang")},model:{value:t.params.item_bn,callback:function(e){t.$set(t.params,"item_bn",e)},expression:"params.item_bn"}})],1),e("SpFilterFormItem",{attrs:{prop:"goods_bn",label:$t("txp2nd6","SPU编码:","lang")}},[e("el-input",{attrs:{placeholder:$t("rct46y8","请输入SPU编码","lang")},model:{value:t.params.goods_bn,callback:function(e){t.$set(t.params,"goods_bn",e)},expression:"params.goods_bn"}})],1),e("SpFilterFormItem",{attrs:{prop:"supplier_name",label:$t("7xykgl6","所属供应商:","lang")}},[e("el-input",{attrs:{placeholder:$t("40h5ei8","请输入所属供应商","lang")},model:{value:t.params.supplier_name,callback:function(e){t.$set(t.params,"supplier_name",e)},expression:"params.supplier_name"}})],1),e("SpFilterFormItem",{attrs:{prop:"is_gift",label:$t("l3vuh3","赠品:","lang")}},[e("el-select",{model:{value:t.params.is_gift,callback:function(e){t.$set(t.params,"is_gift",e)},expression:"params.is_gift"}},[e("el-option",{attrs:{value:void 0,label:$t("en402","全部","lang")}}),e("el-option",{attrs:{value:!0,label:$t("k6n1","是","lang")}}),e("el-option",{attrs:{value:!1,label:$t("gme1","否","lang")}})],1)],1),e("SpFilterFormItem",{attrs:{prop:"item_holder",label:$t("aj28gh5","商品类型:","lang")}},[e("el-select",{attrs:{placeholder:$t("uwtc4i7","请选择商品类型","lang"),clearable:""},model:{value:t.params.item_holder,callback:function(e){t.$set(t.params,"item_holder",e)},expression:"params.item_holder"}},t._l(t.goodCategory,function(t){return e("el-option",{key:t.value,attrs:{label:t.title,value:t.value}})}),1)],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary",plain:""},on:{click:t.batchChangeStore}},[t._v($t("4r8dps6"," 更改状态 ","lang"))]),e("el-dropdown",{on:{command:t.handleExport}},[e("el-button",{attrs:{type:"primary",plain:"",icon:"iconfont icon-daorucaozuo-01"}},[t._v($t("gr6m3"," 导出","lang")),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"product-info"}},[t._v($t("apjwmh5","商品信息 ","lang"))]),t.IS_SUPPLIER()?t._e():e("el-dropdown-item",{attrs:{command:"product-tag"}},[t._v($t("4jjxpq6"," 商品标签 ","lang"))]),t.VERSION_SHUYUN()||t.IS_SUPPLIER()?t._e():e("el-dropdown-item",{attrs:{command:"h5-qrcode"}},[t._v($t("ht3vec7"," H5二维码 ","lang"))])],1)],1),t.isBindWdtErp?e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.uploadWdtErpItems()}}},[t._v($t("7apsvya"," 上传商品到旺店通 ","lang"))]):t._e(),t.isBindJstErp?e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.uploadJstErpItems()}}},[t._v($t("3x49dga"," 上传商品到聚水潭 ","lang"))]):t._e()],1),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabList,function(i,a){return e("el-tab-pane",{key:a,attrs:{label:i.name,name:i.activeName}},["second"!=t.activeName||t.IS_DISTRIBUTOR()?t._e():e("div",{staticClass:"tab-tools"},[e("div",{staticClass:"warn-input"},[e("label",{staticClass:"label"},[t._v($t("oxjc2v5","预警数量:","lang"))]),e("el-input",{attrs:{size:"small",value:"warning_store"},model:{value:t.warning_store,callback:function(e){t.warning_store=e},expression:"warning_store"}}),e("el-button",{attrs:{type:"text"},on:{click:t.setWarningStore}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{border:"",data:t.ItemsList},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",align:"center",label:$t("emxt2","全选","lang")}}),e("el-table-column",{attrs:{prop:"goods_id",label:$t("b3ly1i4","商品ID","lang"),align:"right","header-align":"center"}}),e("el-table-column",{attrs:{prop:"item_bn",label:$t("1bmn325","SKU编号","lang"),width:"150"}}),e("el-table-column",{attrs:{prop:"itemName",label:$t("eywr2","商品","lang"),width:"300"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"goods-title"},[t._v(" "+t._s(i.row.item_name)+" "),i.row.nospec?t._e():e("el-tag",{staticStyle:{"margin-left":"4px",cursor:"default"},attrs:{size:"mini",effect:"plain",type:"primary"},on:{click:function(e){return t.handleViewSkuInfo(i.row)}}},[t._v($t("ftd23"," 多 ","lang")),e("i",{staticClass:"ecx-icon icon-sousuo",staticStyle:{"font-size":"12px","margin-left":"2px"}})])],1),e("div",{staticClass:"goods-code"},[t._v($t("dkd2zb7"," SPU编码：","lang")+t._s(i.row.goods_bn)+" "),e("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:i.row.goods_bn,expression:"scope.row.goods_bn",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})])],1)]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("d8zdyw4","是否赠品","lang")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("1"==e.row.is_gift?$t("k6n1","是","lang"):$t("gme1","否","lang"))+" ")]}}],null,!0)}),e("el-table-column",{attrs:{prop:"item_holder",label:$t("b47jsb4","商品类型","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"ell3"},[t._v(" "+t._s(t.goodCategoryMap[i.row.item_holder])+" ")])]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("cyko7y4","排序编号","lang"),width:"100",align:"right","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{staticStyle:{width:"60px"},attrs:{size:"mini"},on:{change:function(e){return t.editItemsSort(i.$index,i.row)}},model:{value:i.row.sort,callback:function(e){t.$set(i.row,"sort",e)},expression:"scope.row.sort"}})]}}],null,!0)}),e("el-table-column",{attrs:{prop:"store",label:$t("gl5x2","库存","lang"),width:"120",align:"right","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(i.row.store))]),i.row.nospec&&!i.row.is_total_store?e("el-popover",{attrs:{placement:"top",trigger:"hover"},on:{show:()=>t.onShowPopover(i.row,"store")}},[e("div",{staticClass:"popover-edit"},[e("el-input",{staticClass:"edit-input",attrs:{placeholder:$t("2j9k1e5","请输入库存","lang")},model:{value:t.skuEditInput,callback:function(e){t.skuEditInput=e},expression:"skuEditInput"}}),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.onModifyItemSku(i.row)}}},[t._v($t("in1ck4"," 确定 ","lang"))])],1),e("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e("i",{staticClass:"el-icon-edit"})])],1):t._e(),i.row.nospec||i.row.is_total_store?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onModifyItemSku(i.row)}}},[e("i",{staticClass:"el-icon-edit"})])]}}],null,!0)}),e("el-table-column",{attrs:{prop:"price",label:$t("789h436","销售价（¥）","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(i.row.price))]),"supplier"!=i.row.item_holder?[i.row.nospec?e("el-popover",{attrs:{placement:"top",trigger:"hover"},on:{show:()=>t.onShowPopover(i.row,"price")}},[e("div",{staticClass:"popover-edit"},[e("el-input",{staticClass:"edit-input",attrs:{placeholder:$t("2j0i5n5","请输入金额","lang")},model:{value:t.skuPriceEditInput,callback:function(e){t.skuPriceEditInput=e},expression:"skuPriceEditInput"}}),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.onModifyItemPrice(i.row)}}},[t._v($t("in1ck4"," 确定 ","lang"))])],1),e("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e("i",{staticClass:"el-icon-edit"})])],1):t._e(),i.row.nospec?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onModifyItemPrice(i.row)}}},[e("i",{staticClass:"el-icon-edit"})])]:t._e()]}}],null,!0)}),e("el-table-column",{attrs:{prop:"market_price",label:$t("qknewd6","市场价（¥）","lang"),width:"100"}}),t.IS_DISTRIBUTOR()?e("el-table-column",{attrs:{prop:"gross_profit_rate",label:$t("ewgc6l6","毛利率（%）","lang"),width:"110",align:"right","header-align":"center"}}):t._e(),e("el-table-column",{attrs:{label:$t("8fohvo6","店铺销售状态","lang"),width:"110"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.is_can_sale?e("span",[t._v($t("eqsf2","可售","lang"))]):e("span",[t._v($t("buay43","不可售","lang"))])]}}],null,!0)}),e("el-table-column",{attrs:{label:$t("vadhsw5","上下架状态","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.is_can_sale?e("span",[t._v($t("e57q63","已上架","lang"))]):e("span",[t._v($t("e57r13","已下架","lang"))])]}}],null,!0)}),e("el-table-column",{attrs:{prop:"itemCatName",label:$t("j5fnxf4","销售分类","lang"),width:"150"}}),e("el-table-column",{attrs:{label:$t("u1k8gh5","所属供应商","lang"),prop:"supplier_name",width:"120"}}),e("el-table-column",{attrs:{label:$t("vlqz5v5","供应商货号","lang"),prop:"supplier_goods_bn",width:"100",align:"right","header-align":"center"}}),e("el-table-column",{attrs:{label:$t("afv8kk4","供应状态","lang"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("1"==e.row.is_market?$t("eqsf2","可售","lang"):$t("buay43","不可售","lang"))+" ")]}}],null,!0)}),e("el-table-column",{attrs:{fixed:"left",label:$t("hkxb2","操作","lang"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.editItemsAction(i.$index,i.row,!1)}}},[t._v($t("likox4"," 详情 ","lang"))]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.updateItemStatus(i.row)}}},[t._v(" "+t._s(i.row.is_can_sale?$t("dudn2","下架","lang"):$t("ducs2","上架","lang"))+" ")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onClickLink(i.row)}}},[t._v($t("j66ck06"," 复制链接 ","lang"))])]}}],null,!0)})],1),e("div",{staticClass:"content-center content-top-padded"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)],1)}),1),e("el-dialog",{attrs:{title:$t("y8r0gk6","更改运费模板","lang"),visible:t.addTemplatesdialogVisible,width:"30%"},on:{"update:visible":function(e){t.addTemplatesdialogVisible=e}}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:$t("iq77af4","运费模板","lang")},model:{value:t.templates_new_id,callback:function(e){t.templates_new_id=e},expression:"templates_new_id"}},t._l(t.templatesListavailable,function(t){return e("el-option",{key:t.template_id,attrs:{label:t.name,value:t.template_id}})}),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.addTemplatesdialogVisible=!1}}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.changeTemplates}},[t._v($t("hnjoo3","确 定","lang"))])],1)],1),e("el-dialog",{attrs:{title:$t("xtijtk6","更改销售分类","lang"),visible:t.addCategorydialogVisible,width:"30%"},on:{"update:visible":function(e){t.addCategorydialogVisible=e}}},[e("treeselect",{attrs:{options:t.categoryList,multiple:!0,"show-count":!0,"disable-branch-nodes":!0},model:{value:t.category_id,callback:function(e){t.category_id=e},expression:"category_id"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.addCategorydialogVisible=!1}}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.changeCategory}},[t._v($t("hnjoo3","确 定","lang"))])],1)],1),e("el-dialog",{staticClass:"right-dialog",attrs:{title:$t("o1jh056","为商品打标签","lang"),visible:t.tag.dialog,"before-close":t.handleCancelLabelsDialog},on:{"update:visible":function(e){return t.$set(t.tag,"dialog",e)}}},[e("div",{staticClass:"tag-users view-flex view-flex-middle"},[e("i",{staticClass:"iconfont icon-user-circle1"}),e("div",{staticClass:"view-flex-item"},t._l(t.tag.editItem,function(i,a){return e("span",{key:a},[t._v(" "+t._s(i)+"，")])}),0)]),e("div",{staticClass:"selected-tags view-flex"},[e("div",{staticClass:"label"},[t._v($t("rbsw8d6","已选中标签：","lang"))]),e("div",{staticClass:"view-flex-item"},t._l(t.tag.currentTags,function(i,a){return e("el-tag",{key:a,attrs:{closable:"",size:"small","disable-transitions":!1},on:{close:function(e){return t.tagRemove(a)}}},[t._v(" "+t._s(i.tag_name)+" ")])}),1)]),e("div",t._l(t.tag.tags,function(i,a){return e("el-tag",{key:a,staticClass:"tag-item",attrs:{size:"medium",color:"#ffffff","disable-transitions":!1},nativeOn:{click:function(e){return t.tagAdd(i,a)}}},[t._v(" "+t._s(i.tag_name)+" ")])}),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.tag.dialog=!1}}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitItemTag}},[t._v($t("hnjoo3","确 定","lang"))])],1)]),e("SideBar",{attrs:{visible:t.show_rebate_sideBar,title:$t("nnkb066","商品分销配置","lang"),width:"60"},on:{"update:visible":function(e){t.show_rebate_sideBar=e}}},[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},["profit"==t.popularizeSetting.popularize_ratio.type?e("span",[e("el-alert",{staticClass:"alert-text",attrs:{title:$t("yg51urf","返佣计算类型: 【按利润分佣】","lang"),description:$t("fg3seq2h","计算方式：商品利润 ×  百分比，其中商品利润为【支付金额-运费-商品成本价】，如果设置的返佣为固定金额，则不会按利润返佣，返佣金额就是设置的固定金额。如果不填则使用通用配置返佣","lang"),type:"info","close-text":" ","show-icon":""}})],1):e("span",[e("el-alert",{staticClass:"alert-text",attrs:{title:$t("4m39whh","返佣计算类型: 【按订单金额分佣】","lang"),description:$t("ptmms72d","计算方式： 订单金额 × 百分比，其中订单金额为【支付金额-运费】，如果设置的返佣为固定金额，则不会按订单金额分佣，返佣金额就是设置的固定金额。如果不填则使用通用配置返佣","lang"),type:"info","close-text":" ","show-icon":""}})],1)]),t._v($t("4gnqgs6"," 商品名称：","lang")+t._s(t.current.item_name)+" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.skuLoading,expression:"skuLoading"}],attrs:{data:t.rebateSpecItems}},[e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.item_spec_desc?e("span",[t._v(t._s(i.row.item_spec_desc))]):e("span",[t._v($t("cvevh3","单规格","lang"))])]}}],null,!1,215542460)}),e("el-table-column",{attrs:{label:$t("m8lft3","销售价","lang"),"min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.price/100)+" ")]}}],null,!1,133717387)}),e("el-table-column",{attrs:{label:$t("lnjk2","类型","lang"),width:"160"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-switch",{attrs:{"active-value":"money","inactive-value":"ratio","active-text":$t("pn1o2","金额","lang"),"inactive-text":$t("irzr2","比例","lang")},model:{value:i.row.rebate_conf.type,callback:function(e){t.$set(i.row.rebate_conf,"type",e)},expression:"scope.row.rebate_conf.type"}})]}}],null,!1,2697424283)}),t._l(t.popularizeSetting.popularize_ratio.profit,function(i,a){return e("el-table-column",{key:a,attrs:{label:i.name,"min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(i){return["money"==i.row.rebate_conf.type?e("el-input",{attrs:{type:"number",size:"mini","suffix-icon":"iconfont icon-yen-sign"},model:{value:i.row.rebate_conf.value[a],callback:function(e){t.$set(i.row.rebate_conf.value,a,e)},expression:"scope.row.rebate_conf.value[key]"}}):e("el-input",{attrs:{size:"mini",type:"number","suffix-icon":"iconfont icon-percent"},model:{value:i.row.rebate_conf.value[a],callback:function(e){t.$set(i.row.rebate_conf.value,a,e)},expression:"scope.row.rebate_conf.value[key]"}})]}}],null,!0)})})],2)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.saveRebateConf}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],1),e("SideBar",{attrs:{visible:t.show_profit_sideBar,name:"show_profit_sideBar",title:$t("nnkb066","商品分销配置","lang"),width:"60"},on:{"update:visible":function(e){t.show_profit_sideBar=e}}},[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[e("el-alert",{staticClass:"alert-text",attrs:{title:$t("vrocgee","导购分润计算类型: 【默认】","lang"),description:$t("61nw3wv","计算方式：默认按照 管理分类分润配置优先,导购分润配置计算其次","lang"),type:"info","close-text":" ","show-icon":""}})],1),e("span",[e("el-alert",{staticClass:"alert-text",attrs:{title:$t("4a8p6gf","导购分润计算类型: 【百分比】","lang"),description:$t("syi2vm1d","计算方式：商品最终金额 ×  百分比，其中计算方式：商品最终金额为【支付金额-运费-商品优惠金额】","lang"),type:"info","close-text":" ","show-icon":""}})],1),e("span",[e("el-alert",{staticClass:"alert-text",attrs:{title:$t("3g3zavg","导购分润计算类型: 【商品金额】","lang"),description:$t("fg6mv9c","计算方式： 固定金额分佣","lang"),type:"info","close-text":" ","show-icon":""}})],1)]),t._v($t("4gnqgs6"," 商品名称：","lang")+t._s(t.current.item_name)+" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.skuLoading,expression:"skuLoading"}],attrs:{data:t.profitSpecItems}},[e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),e("el-table-column",{attrs:{label:$t("ennc2","原价","lang"),prop:"market_price",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.market_price)+" ")]}}],null,!1,1853563886)}),e("el-table-column",{attrs:{label:$t("m8lft3","销售价","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.price)+" ")]}}],null,!1,3098777173)}),e("el-table-column",{attrs:{label:$t("at3kcw4","分润类型","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-select",{attrs:{placeholder:$t("l72nr3","请选择","lang")},model:{value:i.row.profit_type,callback:function(e){t.$set(i.row,"profit_type",e)},expression:"scope.row.profit_type"}},[e("el-option",{attrs:{label:$t("rs982","默认","lang"),value:0}}),e("el-option",{attrs:{label:$t("hrclo3","百分比","lang"),value:1}}),e("el-option",{attrs:{label:$t("b4bjaf4","商品金额","lang"),value:2}})],1)]}}],null,!1,1276163050)}),e("el-table-column",{attrs:{label:$t("o31xzs6","拉新导购分润","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[0==i.row.profit_type?e("div",[e("el-input",{attrs:{disabled:!0,size:"mini",type:"number",value:"0"}})],1):e("div",[e("el-input",{attrs:{size:"mini",type:"number"},model:{value:i.row.profit_conf_profit,callback:function(e){t.$set(i.row,"profit_conf_profit",e)},expression:"scope.row.profit_conf_profit"}},[1==i.row.profit_type?e("template",{slot:"append"},[t._v(" % ")]):t._e()],2)],1)]}}],null,!1,3380461383)}),e("el-table-column",{attrs:{label:$t("uiqdk86","推广导购分润","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[0==i.row.profit_type?e("div",[e("el-input",{attrs:{disabled:!0,size:"mini",type:"number",value:"0"}})],1):e("div",[e("el-input",{attrs:{size:"mini",type:"number"},model:{value:i.row.profit_conf_popularize_profit,callback:function(e){t.$set(i.row,"profit_conf_popularize_profit",e)},expression:"scope.row.profit_conf_popularize_profit"}},[1==i.row.profit_type?e("template",{slot:"append"},[t._v(" % ")]):t._e()],2)],1)]}}],null,!1,4269161675)})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.saveProfitConf}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],1),e("SideBar",{attrs:{visible:t.show_sideBar,title:$t("5gar075","设置会员价","lang"),width:"60"},on:{"update:visible":function(e){t.show_sideBar=e}}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.skuLoading,expression:"skuLoading"}],attrs:{data:t.specItems,height:"100%"}},[e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),e("el-table-column",{attrs:{label:$t("ennc2","原价","lang"),prop:"market_price",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" ¥"+t._s(e.row.market_price)+" ")]}}],null,!1,1853563886)}),e("el-table-column",{attrs:{label:$t("m8lft3","销售价","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.item_id!==t.currentId?e("div",[t._v(" ¥"+t._s(i.row.price)+" "),e("i",{staticClass:"el-input__icon el-icon-edit",on:{click:function(e){return t.editPrice(i.row.item_id,i.row.price)}}})]):e("el-input",{ref:"input_"+i.row.item_id,attrs:{size:"mini"},on:{blur:function(e){return t.handleBlur(i.$index)}},model:{value:t.currentPrice,callback:function(e){t.currentPrice=e},expression:"currentPrice"}})]}}],null,!1,1728626788)}),e("el-table-column",{attrs:{label:$t("dx1a2","会员","lang")}},t._l(t.grade,function(i,a){return e("el-table-column",{key:a,attrs:{label:i.grade_name},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{attrs:{size:"mini",type:"number"},model:{value:i.row.grade[a].mprice,callback:function(e){t.$set(i.row.grade[a],"mprice",e)},expression:"scope.row.grade[index].mprice"}})]}}],null,!0)})}),1),e("el-table-column",{attrs:{label:$t("aj2k674","付费会员","lang")}},t._l(t.vipGrade,function(i,a){return e("el-table-column",{key:a,attrs:{label:i.grade_name},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{attrs:{size:"mini",type:"number"},model:{value:i.row.vipGrade[a].mprice,callback:function(e){t.$set(i.row.vipGrade[a],"mprice",e)},expression:"scope.row.vipGrade[index].mprice"}})]}}],null,!0)})}),1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.savePrice}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],1),e("SideBar",{attrs:{visible:t.show_itemStore,title:$t("q6uygg6","设置商品库存","lang"),width:"60"},on:{"update:visible":function(e){t.show_itemStore=e}}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.skuLoading,expression:"skuLoading"}],attrs:{data:t.storeItemsList,height:"100%"}},[e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),e("el-table-column",{attrs:{label:$t("gl5x2","库存","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{attrs:{size:"mini",type:"number"},model:{value:i.row.store,callback:function(e){t.$set(i.row,"store",e)},expression:"scope.row.store"}})]}}],null,!1,3907094231)})],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.saveItemsStore}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],1),e("el-dialog",{attrs:{title:$t("ez542u6","批量修改库存","lang"),visible:t.storeUpdate,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(e){t.storeUpdate=e}}},[t._v($t("o8ez846"," 统一库存：","lang")),e("el-input",{attrs:{size:"mini",type:"number"},model:{value:t.itemstore,callback:function(e){t.itemstore=e},expression:"itemstore"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.storeUpdate=!1}}},[t._v($t("caoqm3","取 消","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveItemsStore}},[t._v($t("hnjoo3","确 定","lang"))])],1)],1),e("GoodsSelect",{attrs:{"items-visible":t.xpGoodsVisible},on:{chooseGoods:t.chooseGoodsAction,closeGoodsDialog:t.closeGoodsDialogAction}}),e("SpDialog",{ref:"sendNumDialogRef",attrs:{title:$t("t6bruz6","更改商品状态","lang"),width:"500px",form:t.batchChangeStateForm,"form-list":t.batchChangeStateFormList},on:{onSubmit:t.onBatchChangeStateSubmit},model:{value:t.batchChangeStateDialog,callback:function(e){t.batchChangeStateDialog=e},expression:"batchChangeStateDialog"}}),e("SpDialog",{ref:"itemSkuRef",staticClass:"sku-dialog",attrs:{width:"1100px","destroy-on-close":"",title:`${$t("i5i3a25","编辑商品【","lang")}${t.itemSkuForm.itemName}】`,form:t.itemSkuForm,"form-list":t.itemSkuFormList},on:{onSubmit:t.onItemSkuFormSubmit},model:{value:t.itemSkuDialog,callback:function(e){t.itemSkuDialog=e},expression:"itemSkuDialog"}}),e("SpDrawer",{attrs:{title:t.itemSkuDrawerTitle,width:800},on:{confirm:()=>{t.showItemSkuDrawer=!1}},model:{value:t.showItemSkuDrawer,callback:function(e){t.showItemSkuDrawer=e},expression:"showItemSkuDrawer"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.skuLoading,expression:"skuLoading"}],attrs:{border:"",data:t.itemSkuList,height:"100%"}},[e("el-table-column",{attrs:{label:$t("o06w2","规格","lang"),prop:"item_spec_desc","min-width":"120"}}),e("el-table-column",{attrs:{label:$t("vlqz5v5","供应商货号","lang"),prop:"supplier_goods_bn","min-width":"120"}}),e("el-table-column",{attrs:{label:$t("1ttci05","sku编码","lang"),prop:"item_bn","min-width":"120"}})],1)],1)]:t._e(),e("router-view")],2)},[],!1,null,"5c43862e",null).exports}}]);