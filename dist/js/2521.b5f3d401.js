"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2521],{62521:function(t,e,i){i.r(e),i.d(e,{default:function(){return r}});var a=i(95353),s=(i(57270),i(91142)),l=i(81193),n={mixins:[i(77825).v8],props:{status:{type:Boolean,default:!1}},data(){return{isValid:!0,isEdit:!1,editVisible:!1,editTitle:"",editTipsVisible:!1,form:{mobile:"",name:"",tips:""},mobile:"",editMobile:"",editName:"",whitelistList:[],detailData:{},loading:!1,total_count:0,params:{page:1,pageSize:20},whitelist_id:0,datapass_block:1,formData:{mobile:""}}},computed:{...(0,a.L8)(["wheight"])},watch:{status(t){t&&this.getListData()}},mounted(){this.getListData()},methods:{handleClose(t){this.relDistributors.splice(t,1),this.form.distributor_ids.splice(t,1)},handleCancel(){this.editVisible=!1,this.whitelist_id="",this.editMobile="",this.form.mobile="",this.form.name=""},handleCurrentChange(t){this.params.page=t,this.getListData()},addData(){this.handleCancel(),this.editTitle=$t("er0oao5","添加白名单","lang"),this.editVisible=!0,this.isEdit=!1,this.form.mobile="",this.form.name="",this.whitelist_id="",this.editMobile=""},editAction(t,e){this.handleCancel(),this.editTitle=$t("u6rqk87","编辑白名单信息","lang"),this.editVisible=!0,this.isEdit=!0,this.editMobile=e.mobile,this.form.mobile=e.mobile,this.form.name=e.name,this.whitelist_id=e.whitelist_id},submitAction(){this.whitelist_id?(0,s.updateMembersWhitelist)(this.whitelist_id,this.form).then(t=>{this.detailData=t.data.data,this.editVisible=!1,this.getListData()}):(0,s.createMembersWhitelist)(this.form).then(t=>{this.detailData=t.data.data,this.editVisible=!1,this.getListData(),this.handleCancel()})},dataSearch(){this.params.mobile=this.formData.mobile,this.params.page=1,this.getListData()},getListData(){this.loading=!0,(0,s.getMembersWhitelistList)(this.params).then(t=>{this.whitelistList=t.data.data.list,this.total_count=t.data.data.total_count,this.datapass_block=t.data.data.datapass_block,this.loading=!1})},deleteAction(t,e){this.$confirm($t("4o0g7rh","此操作将删除该白名单, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,s.deleteMembersWhitelist)(e.whitelist_id).then(e=>{this.whitelistList.splice(t,1),this.$message({message:$t("azeh8z4","删除成功","lang"),type:"success",duration:5e3})}).catch(()=>{this.$message({type:"error",message:$t("azdahk4","删除失败","lang")})})}).catch(()=>{this.$message({type:"info",message:$t("e68dg3","已取消","lang")})})},setTips(t){this.handleCancel(),this.handleCancelTips(),this.editTitle=$t("mz4wq95","白名单提示","lang"),this.editTipsVisible=!0,(0,l.getWhitelistSetting)().then(t=>{this.form.tips=t.data.data.whitelist_tips})},handleCancelTips(){this.editTipsVisible=!1,this.form.tips=""},submitTipsAction(){const t={whitelist_tips:this.form.tips};(0,l.setWhitelistSetting)(t).then(t=>{this.editTipsVisible=!1,this.handleTipsCancel()})}}},o=(0,i(81656).A)(n,function(){var t=this,e=t._self._c;return e("SpPage",[e("SpFilterForm",{attrs:{model:t.formData},on:{onSearch:t.dataSearch,onReset:t.dataSearch}},[e("SpFilterFormItem",{attrs:{prop:"mobile",label:$t("cttsc24","手机号:","lang")}},[e("el-input",{attrs:{placeholder:$t("7ji3y96","请输入手机号","lang")},model:{value:t.formData.mobile,callback:function(e){t.$set(t.formData,"mobile",e)},expression:"formData.mobile"}})],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addData}},[t._v($t("3jtao07"," 添加白名单 ","lang"))]),e("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.setTips}},[t._v($t("th6xin7"," 白名单提示 ","lang"))])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.whitelistList,height:t.wheight-160}},[e("el-table-column",{attrs:{prop:"mobile",label:$t("ewbd43","手机号","lang")}}),e("el-table-column",{attrs:{prop:"name",label:$t("fqmy2","姓名","lang")}}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang")},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.editAction(i.$index,i.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.deleteAction(i.$index,i.row)}}},[t._v($t("db22k4"," 删除 ","lang"))])]}}])})],1),t.total_count>t.params.pageSize?e("div",{staticClass:"content-center content-top-padded"},[e("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.params.page,total:t.total_count,"page-size":t.params.pageSize},on:{"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1):t._e(),e("el-dialog",{attrs:{title:t.editTitle,visible:t.editVisible,"before-close":t.handleCancel},on:{"update:visible":function(e){t.editVisible=e}}},[[e("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:t.form,"label-width":"120px"}},[e("el-form-item",{attrs:{label:$t("ewbd43","手机号","lang")}},[e("el-col",{attrs:{span:10}},[t.isEdit?e("el-input",{attrs:{disabled:!0},model:{value:t.editMobile,callback:function(e){t.editMobile=e},expression:"editMobile"}}):e("el-input",{attrs:{maxlength:11,placeholder:$t("b2kmjg9","请输入11位手机号","lang")},model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1)],1),e("el-form-item",{attrs:{label:$t("fqmy2","姓名","lang")}},[e("el-col",{attrs:{span:10}},[e("el-input",{attrs:{required:"",placeholder:$t("9hq2ns5","请填写名称","lang"),disabled:1==t.datapass_block&&t.isEdit},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1)],e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{nativeOn:{click:function(e){return t.handleCancel.apply(null,arguments)}}},[t._v($t("dd4ni4"," 取消 ","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitAction}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],2),e("el-dialog",{attrs:{title:t.editTitle,visible:t.editTipsVisible,"before-close":t.handleCancelTips},on:{"update:visible":function(e){t.editTipsVisible=e}}},[[e("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:t.form,"label-width":"120px"}},[e("el-form-item",{attrs:{label:$t("hn562","提示","lang")}},[e("el-col",{attrs:{span:20}},[e("el-input",{attrs:{required:"",placeholder:$t("9hnea95","请填写提示","lang")},model:{value:t.form.tips,callback:function(e){t.$set(t.form,"tips",e)},expression:"form.tips"}})],1)],1)],1)],e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{nativeOn:{click:function(e){return t.handleCancelTips.apply(null,arguments)}}},[t._v($t("dd4ni4"," 取消 ","lang"))]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitTipsAction}},[t._v($t("cp35x4"," 保存 ","lang"))])],1)],2)],1)},[],!1,null,"653865a6",null),r=o.exports}}]);