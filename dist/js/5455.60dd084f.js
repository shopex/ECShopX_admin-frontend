"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[5455],{5455:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});var i=a(22541),n=(a(57270),a(79836)),l=a(25215),r=a(20451),s={components:{loadingBtn:n.default,SpForm:l.default,SpImagePicker:r.default},data(){const t=this.$createElement;return{time:"",begin_time:"",end_time:"",search_options:[],auto_draw_cash:"",form:{cash_amt:"",cash_type:"",invoice_url:""},cash_balance:0,cash_limit:0,available_balance:0,pending_balance:0,formList:[{label:$t("d2v8i44","提现金额","lang"),key:"cash_amt",type:"input",required:!0,width:"300px",placeholder:$t("l6wdl3","请输入","lang"),append:$t("g1v1","元","lang"),component:({key:e},a)=>{const i=Math.max(0,(this.available_balance-this.pending_balance)/100);return t("div",{style:"display: flex; align-items: center; white-space: nowrap;"},[t("el-input",{attrs:{placeholder:$t("l6wdl3","请输入","lang"),type:"number",min:"0",max:i},style:"width: 300px; flex-shrink: 0;",on:{input:t=>{(parseFloat(t)||0)>i&&(a[e]=i.toFixed(2))}},model:{value:a[e],callback:t=>{this.$set(a,e,t)}}},[t("template",{slot:"append"},[$t("g1v1","元","lang")])]),t("span",{style:"margin-left: 12px; color: #0079fe; cursor: pointer; white-space: nowrap; flex-shrink: 0;",on:{click:()=>this.allHandle()}},[$t("avcjts4","全部提现","lang")])])}},{label:$t("d2r9004","提现类型","lang"),key:"cash_type",type:"select",required:!0,width:"300px",placeholder:$t("wvd1c77","请选择提现类型","lang"),options:[{title:"T1",value:"T1"}]},{label:$t("fkyf3"," 发票","lang"),key:"invoice_url",type:"input",required:!0,width:"300px",placeholder:$t("at7pq45","请上传发票","lang"),component:({key:e},a)=>t("div",[t(r.default,{attrs:{max:1,size:"small"},model:{value:a[e],callback:t=>{this.$set(a,e,t)}}})])}]}},computed:{setting(){return(()=>{const t=t=>{if(!t)return"-";var e=new Date(1e3*t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},e=t=>"0"===t?$t("dxb9y3","审核中","lang"):"1"===t?$t("c00pno4","审核通过","lang"):"2"===t?$t("e8vjx3","已拒绝","lang"):"3"===t?$t("dljhn3","处理中","lang"):"4"===t?$t("bpnma94","处理成功","lang"):"5"===t?$t("bpmfiu4","处理失败","lang"):void 0,a=t=>(t/100).toFixed(2).toLocaleString(),n=window.location.href.match(/\/(shopadmin|supplier|merchant)(\/.*)?$/)?.[1],l="merchant"===n;return(0,i.createSetting)({columns:l?[{name:$t("fd5ujm4","申请时间","lang"),key:"created",width:200,formatter:t},{name:$t("fd2q514","申请商户","lang"),key:"merchant_name",width:120},{name:$t("b5ky304","商户id","lang"),key:"merchant_id",width:100},{name:$t("kz6ms95","申请人账号","lang"),key:"operator",width:120},{name:$t("d2r9004","提现类型","lang"),key:"withdraw_type",width:100},{name:$t("d2v8i44","提现金额","lang"),key:"amount",width:120,formatter:a},{name:$t("dllgxp4","查看发票","lang"),key:"invoice_file",width:100,render:(t,{row:e})=>e.invoice_file?t("el-image",{props:{src:e.invoice_file,"preview-src-list":[e.invoice_file],fit:"cover"},style:{width:"50px",height:"50px"}}):t("span","-")},{name:$t("byza2e4","审批时间","lang"),key:"audit_time",width:200,formatter:t},{name:$t("bzq42g4","审核原因","lang"),key:"audit_remark",width:150},{name:$t("d2pmuj4","提现状态","lang"),key:"status",width:100,formatter:e},{name:$t("bu2drp4","失败原因","lang"),key:"failure_reason",width:150}]:[{name:$t("fd5ujm4","申请时间","lang"),key:"created",width:200,formatter:t},{name:$t("kz6ms95","申请人账号","lang"),key:"operator",width:120},{name:$t("fd4l7r4","申请店铺","lang"),key:"distributor_name",width:120},{name:$t("d2r9004","提现类型","lang"),key:"withdraw_type",width:100},{name:$t("d2v8i44","提现金额","lang"),key:"amount",width:120,formatter:a},{name:$t("dllgxp4","查看发票","lang"),key:"invoice_file",width:100,render:(t,{row:e})=>e.invoice_file?t("el-image",{props:{src:e.invoice_file,"preview-src-list":[e.invoice_file],fit:"cover"},style:{width:"50px",height:"50px"}}):t("span","-")},{name:$t("byza2e4","审批时间","lang"),key:"audit_time",width:200,formatter:t},{name:$t("bzr5iw4","审核备注","lang"),key:"audit_remark",width:150},{name:$t("glh41g5","审核人账号","lang"),key:"auditor",width:120},{name:$t("d2pmuj4","提现状态","lang"),key:"status",width:100,formatter:e},{name:$t("d2ul1n4","提现进度","lang"),key:"failure_reason",width:150}]})})()}},async mounted(){await this.getWithdrawBalance()},methods:{reset(){this.time=[],this.begin_time="",this.end_time=""},timeHandle(t){this.begin_time=t[0],this.end_time=t[1]},async btnClick(){try{await this.$refs.ruleForm.handleSubmit();const t={amount:this.form.cash_amt,withdraw_type:this.form.cash_type,invoice_url:this.form.invoice_url},{status:e}=await this.$api.bspay.withdrawApply(t);0==e?(this.$message({message:`${$t("3f78rzf","提现申请提交成功！提现金额：￥","lang")}${this.form.cash_amt}${$t("g1v1","元","lang")}`,type:"success",duration:5e3,showClose:!0}),this.$confirm($t("i38t6zu","提现申请已提交，请等待审核。您可以在下方列表中查看提现记录。","lang"),$t("d2mq9b4","提现成功","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),type:"success",showCancelButton:!1,center:!0}).then(()=>{}),this.$refs.ruleForm.resetFields(),this.$refs.finder.refresh(!0),await this.getWithdrawBalance()):this.$message.error($t("vffl8fc","提现申请提交失败，请重试","lang"))}catch(t){}finally{this.$refs.loadingBtn.closeLoading()}},allHandle(){const t=Math.max(0,(this.available_balance-this.pending_balance)/100);this.form.cash_amt=t.toFixed(2)},beforeSearch(t){return t.begin_time=this.begin_time,t.end_time=this.end_time,t},async getWithdrawBalance(){try{const t=await this.$api.bspay.getWithdrawBalance(),{available_balance:e=0,pending_balance:a=0}=t;this.available_balance=e,this.pending_balance=a}catch(t){}},async afterSearch({data:t}){const{search_options:e={}}=t.data;this.search_options=e.status,await this.getWithdrawBalance()}}},o=(0,a(81656).A)(s,function(){var t=this,e=t._self._c;return e("SpPage",[e("div",{staticClass:"zyk_adapay_withdraw"},[e("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v($t("axlmf44","分账提现","lang"))])]),e("div",{staticClass:"content"},[e("div",{staticClass:"part1"},[e("div",{staticStyle:{"margin-right":"50px"}},[e("div",{staticStyle:{"margin-left":"30px","margin-bottom":"20px",color:"#333"}},[e("span",[t._v($t("7h4l0i9","可申请提现余额：￥","lang")+t._s(t._f("formatNumMoney")(t.available_balance/100)))]),e("span",{staticStyle:{"margin-left":"30px"}},[t._v($t("4erin99","审核中提现余额：￥","lang")+t._s(t._f("formatNumMoney")(t.pending_balance/100)))]),e("span",{staticStyle:{"margin-left":"30px",color:"#0079fe","font-weight":"bold"}},[t._v($t("k1763x7","实际可提现：￥","lang")+t._s(t._f("formatNumMoney")(Math.max(0,(t.available_balance-t.pending_balance)/100))))])]),e("div",[e("SpForm",{ref:"ruleForm",attrs:{value:t.form,"form-list":t.formList,"label-width":"100px",submit:!1},on:{input:e=>t.form=e}})],1),e("div",{staticStyle:{"margin-top":"20px"}},[e("loading-btn",{ref:"loadingBtn",attrs:{size:"medium",type:"primary",text:$t("d2qaro4","提现申请","lang")},on:{clickHandle:t.btnClick}})],1)]),"admin"==t.$store.getters.login_type&&"N"==t.auto_draw_cash?e("div",{staticClass:"tips"},["admin"==t.$store.getters.login_type&&"N"==t.auto_draw_cash?e("p",[t._v($t("e2mh8s1s"," * 分销员提现佣金选择类型为银行卡时，将从可提现金额进行转账，为避免分销员提现时资金不足导致提现失败，请提现时预留部分资金； ","lang"))]):t._e(),"admin"!=t.$store.getters.login_type&&"Y"==t.auto_draw_cash?[e("p",[t._v($t("kr91x75","提现规则：","lang"))]),e("p",[t._v($t("yfdxotc","提现将在每月10号进行；","lang"))]),e("p",[t._v($t("pvywfig","当余额大于10000元时可提现;","lang"))]),e("p",[t._v($t("2w1h1a","提现类型为 T1 。","lang"))])]:t._e(),"N"==t.auto_draw_cash?e("p",[t._v($t("bd1gqp14"," * 提现操作建议在10:00:00-22:00:00进行，以免影响操作时效。 ","lang"))]):t._e()],2):t._e()]),e("div",{staticClass:"list"},[e("SpFinder",{ref:"finder",attrs:{"no-selection":!0,setting:t.setting,url:"/bspay/withdraw/lists",hooks:{beforeSearch:t.beforeSearch,afterSearch:t.afterSearch}},on:{reset:t.reset},scopedSlots:t._u([{key:"date",fn:function(){return[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"range-separator":"-","start-placeholder":$t("cd0ag54","开始日期","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),clearable:!1},on:{change:t.timeHandle},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})]},proxy:!0}])})],1)])])],1)])},[],!1,null,"16f2347a",null).exports}}]);