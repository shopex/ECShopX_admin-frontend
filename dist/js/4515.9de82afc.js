"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[4515],{54515:function(t,a,e){e.r(a),e.d(a,{default:function(){return g}});e(57270);var l=e(21255),s={props:{tmpData:Array,loading:Boolean},data(){return{}},computed:{resetText(){return t=>{var a=$t("g5o72","审核","lang");return"1"==t.status?a=$t("dudn2","下架","lang"):"2"==t.status&&(a=$t("past2","通过","lang")),a}}},mounted(){},methods:{handleEdit(t,a){this.$emit("handleEdit",!0,t)},handleDel(t){this.$emit("handleDel",t.badge_id)},auditNote(t){var a={id_set:[t.badge_id],auditdiff:!1,aloneAuditType:"1"==t.status?"refuse":"pass"};this.$emit("selectNotes",a)}}},i=e(81656),n=(0,i.A)(s,function(){var t=this,a=t._self._c;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"ruleTable",attrs:{data:t.tmpData}},[a("el-table-column",{attrs:{prop:"badge_id",label:"id",width:"100"}}),a("el-table-column",{attrs:{label:$t("htfx6g4","角标名称","lang"),prop:"badge_name"}}),a("el-table-column",{attrs:{label:$t("fqo12","备注","lang"),prop:"badge_memo"}}),a("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.handleDel(e.row)}}},[t._v($t("db22k4"," 删除 ","lang"))])]}}])})],1)],1)},[],!1,null,"0acf378a",null).exports,d={props:{dialogIsShow:Boolean,auditType:String,dufStatus:String},data(){return{notesModalType:"pass",dialogTitle:null,handleText:null,modalInfo:null}},computed:{},watch:{dialogIsShow:{handler(t,a){const{dufStatus:e}=this.$props;null!=e&&(this.$data.notesModalType=e),this.modalInit()},immediate:!0}},mounted(){},methods:{modalInit(){const{auditType:t}=this.$props;switch(t){case"note":this.noteInit();break;case"flag":this.flagInit()}},noteInit(){const{notesModalType:t}=this.$data;var a=$t("5h99x96","笔记状态变更","lang"),e=null,l=null;switch(t){case"pass":e=$t("erte2","发布","lang"),l=$t("9o7dfy1u","笔记发布点击「发布」后已选笔记将被加入小程序展示的队列，并将适配对应展示规则；若您希望将所选笔记的展示位置进行调整，请修改对应排序。","lang");break;case"refuse":e=$t("dudn2","下架","lang"),l=$t("khfbv31h","点击「下架」后已选笔记将不会在小程序中的社区中展示；<br/>同时，已转发/分享/收藏的链接&入口将失效。","lang")}this.$data.dialogTitle=a,this.$data.handleText=e,this.$data.modalInfo=l},flagInit(){const{notesModalType:t}=this.$data;var a=$t("89pbvg6","角标状态变更","lang"),e=null,l=null;switch(t){case"pass":e=$t("erte2","发布","lang"),l=$t("n0c3bf10","点击「发布」后，带有已选角标的笔记将会在小程序社区中显示展示对应的角标。","lang");break;case"refuse":e=$t("dudn2","下架","lang"),l=$t("hj35f3v","点击「下架」后，带有已选角标的笔记依旧存在，但不显示对应角标；","lang")}this.$data.dialogTitle=a,this.$data.handleText=e,this.$data.modalInfo=l},handleCancelLabelsDialog(){this.$emit("cancelLabelsDialog",!1)},modalHandle(){const{notesModalType:t}=this.$data;var a={status:"pass"==t?1:4};this.$emit("modalHandle",a)}}},o=(0,i.A)(d,function(){var t=this,a=t._self._c;return a("div",[a("el-dialog",{attrs:{title:t.dialogTitle,"before-close":t.handleCancelLabelsDialog,visible:t.dialogIsShow,"show-close":!1,width:"30%"},on:{"update:visible":function(a){t.dialogIsShow=a}}},[a("div",[a("el-radio-group",{staticClass:"result",attrs:{size:"small"},on:{change:t.modalInit},model:{value:t.notesModalType,callback:function(a){t.notesModalType=a},expression:"notesModalType"}},[a("el-radio-button",{attrs:{label:"pass"}},[t._v($t("voqx6"," 发布已选 ","lang"))]),a("el-radio-button",{attrs:{label:"refuse"}},[t._v($t("ldi5b66"," 下架已选 ","lang"))])],1),a("div",{staticClass:"cont"},[a("div",{staticClass:"info",domProps:{innerHTML:t._s(t.modalInfo)}})])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.modalHandle}},[t._v(" "+t._s(t.handleText)+" ")]),a("el-button",{on:{click:t.handleCancelLabelsDialog}},[t._v($t("dd4ni4"," 取消 ","lang"))])],1)])],1)},[],!1,null,"7f83395a",null).exports,r={provide(){return{refresh:this.getDataList}},components:{flaglist:n,auditStatus:o},data(){return{loading:!1,params:{page:1,pageSize:10,status:null},pagers:{total:0},id_set:[],flagList:[],ruleForm:{badge_name:null,badge_memo:null},rules:{badge_name:[{required:!0,message:$t("fpn3of7","请输入角标名称","lang"),trigger:"blur"},{max:20,message:$t("ihi3fxa","长度不超过20个字符","lang"),trigger:"blur"}],badge_memo:[{max:50,message:$t("ifupnua","长度不超过50个字符","lang"),trigger:"blur"}]},editFlagShow:!1,dufStatus:null,auditDialogShow:!1}},mounted(){this.getDataList()},methods:{handleCurrentChange(t){this.params.page=t,this.getDataList()},handleSizeChange(t){this.params.page=1,this.params.pageSize=t,this.getDataList()},clearAudioData(){this.$data.id_set=[],this.$data.ruleForm={}},getDataList(){const t=this;var{activeName:a,params:e}=this.$data;t.$data.loading=!0,(0,l.getBadge)(e).then(a=>{var{list:e,total_count:l}=a.data.data;t.$data.flagList=e,t.$data.pagers={total:l},t.$data.loading=!1},a=>{t.$data.loading=!1})},handleEdit(t,a){const{ruleForm:e}=this.$data;this.$data.editFlagShow="boolean"==typeof t&&t,a&&this.rowTransForm(a),e.badge_id&&(this.ruleForm={})},rowTransForm(t){var a={badge_id:t.badge_id,badge_name:t.badge_name,badge_memo:t.badge_memo};this.$data.ruleForm=a},updataFalg(){const t=this,{ruleForm:a}=this.$data;this.$refs.ruleForm.validate(e=>{if(!e)return!1;(0,l.createBadge)(a).then(a=>{var{message:e}=a.data.data;this.$message({type:"success",duration:1500,message:e,onClose(){t.handleEdit(!1),t.clearAudioData(),t.getDataList()}})})})},delFalg(t){var a={badge_id:[t]};this.$confirm($t("j9i48i","此操作将永久删除该角标, 是否继续?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"}).then(()=>{(0,l.badgeDelete)(a).then(t=>{var a=t.data.data.message;this.getDataList(),this.$message({type:"success",message:a})})})},cancelAuditDialog(t){this.$data.auditDialogShow=t},selectNotes(t){this.$data.id_set=t.id_set,t.aloneAuditType?(this.$data.dufStatus=t.aloneAuditType,this.auditHandle()):this.$data.dufStatus="pass"},auditHandle(){const{id_set:t,dufStatus:a}=this.$data;t.length?this.cancelAuditDialog(!0):this.$message({type:"error",message:$t("2edt7y5","请选择话题","lang")})},auditNote(t){const{id_set:a}=this.$data;t.badge_id=a,(0,l.badgeVerify)(t).then(t=>{var a=t.data.data.message;this.cancelAuditDialog(!1),this.clearAudioData(),this.getDataList(),this.$message({type:"success",message:a})})}}},g=(0,i.A)(r,function(){var t=this,a=t._self._c;return a("SpPage",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:2}},[a("div",{staticClass:"p-title"},[t._v($t("2iym966","笔记角标管理","lang"))])]),a("el-col",{attrs:{span:22}},[a("div",{staticClass:"tips"},[t._v($t("wwo57bl"," 在此配置完成角标后，可在笔记中选择角标。","lang")),a("br"),t._v($t("y5h9jg11","一篇笔记仅能与一个角标关联，关联后将在笔记列表页下的笔记右上角展示角标。 ","lang"))])])],1),a("el-row",{staticClass:"margin-col"},[a("el-col",[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.handleEdit(!0)}}},[t._v($t("vuqn36"," 新建角标 ","lang"))])],1)],1),a("el-card",[a("flaglist",{ref:"flaglist",attrs:{"tmp-data":t.flagList,loading:t.loading},on:{handleEdit:t.handleEdit,selectNotes:t.selectNotes,handleDel:t.delFalg}})],1),a("div",{staticClass:"mt-4 text-right"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper",total:t.pagers.total,"page-size":t.params.pageSize},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),a("el-dialog",{attrs:{"before-close":t.handleEdit,visible:t.editFlagShow,title:t.ruleForm.badge_id?$t("gmqsj44","编辑角标","lang"):$t("d8aw5b4","新建角标","lang"),width:"30%"},on:{"update:visible":function(a){t.editFlagShow=a}}},[a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{prop:"badge_name",label:$t("htfx6g4","角标名称","lang")}},[a("el-input",{attrs:{placeholder:$t("htfx6g4","角标名称","lang"),maxlength:"20","show-word-limit":!0},model:{value:t.ruleForm.badge_name,callback:function(a){t.$set(t.ruleForm,"badge_name",a)},expression:"ruleForm.badge_name"}})],1),a("el-form-item",{attrs:{prop:"badge_memo",label:$t("fqo12","备注","lang")}},[a("el-input",{attrs:{maxlength:"50",placeholder:$t("2jaeja5","请输入备注","lang"),"show-word-limit":!0},model:{value:t.ruleForm.badge_memo,callback:function(a){t.$set(t.ruleForm,"badge_memo",a)},expression:"ruleForm.badge_memo"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.updataFalg}},[t._v($t("iv7ii4"," 确认 ","lang"))]),a("el-button",{on:{click:function(a){return t.handleEdit(!1)}}},[t._v($t("dd4ni4"," 取消 ","lang"))])],1)],1)],1),a("auditStatus",{attrs:{"audit-type":"flag","dialog-is-show":t.auditDialogShow,"duf-status":t.dufStatus},on:{modalHandle:t.auditNote,cancelLabelsDialog:t.cancelAuditDialog}})],1)},[],!1,null,"f733751a",null).exports}}]);