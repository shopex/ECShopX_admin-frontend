"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2439],{52439:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var l=a(95353),n=a(59025),o={data(){return{pane_list:[{name:"normal_goods_store",label:$t("udjz637","上传实体类商品","lang")}],loading:!1,total_count:0,pageSize:20,page:1,activeName:"normal_goods_store",uploadList:[]}},computed:{...(0,l.L8)(["wheight"])},mounted(){this.getUploadList()},methods:{handleClick(){this.getUploadList()},uploadHandleChange(e,t){let a={isUploadFile:!0,file_type:this.activeName,file:e.raw};(0,n.handleUploadFile)(a).then(e=>{this.$message({type:"success",message:$t("dn5eu39","上传成功，等待处理","lang")}),this.getUploadList()})},uploadHandleTemplate(){if("normal_goods_store"==this.activeName)var e=$t("wxg0io8","修改实体商品库存","lang");let t={file_type:this.activeName,file_name:e};(0,n.exportUploadTemplate)(t).then(e=>{if(e.data.data.file){var t=document.createElement("a");t.href=e.data.data.file,t.download=e.data.data.name,document.body.appendChild(t),t.click(),t.remove()}else this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})})},exportErrorFile(e,t){let a={file_type:t};(0,n.exportUploadErrorFile)(e,a).then(e=>{if(e.data.data.file){var t=document.createElement("a");t.href=e.data.data.file,t.download=e.data.data.name,document.body.appendChild(t),t.click(),t.remove()}else this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})})},handleCurrentChange(e){this.page=e,this.getUploadList()},getUploadList(){this.loading=!0;let e={file_type:this.activeName,page:this.page,pageSize:this.pageSize};(0,n.getUploadLists)(e).then(e=>{this.uploadList=e.data.data.list,this.total_count=e.data.data.total_count,this.loading=!1})}}},i=(0,a(81656).A)(o,function(){var e=this,t=e._self._c;return t("SpPage",[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("div",{staticClass:"tip-info"},[t("p",[e._v($t("flzk9x1f"," 上传文件如果有处理失败的行数后将会生成错误文件，请及时查看错误信息修改后重新下载，错误描述文件只保留","lang")),t("strong",[e._v($t("1j7p3","15天","lang"))]),e._v("。 ")]),t("p",[e._v($t("ouzm2","超过","lang")),t("strong",[e._v($t("1j7p3","15天","lang"))]),e._v($t("84meojk","的错误描述文件将会删除，不再提供下载查看","lang"))])]),e._l(e.pane_list,function(a,l){return t("div",{key:l},[t("el-tab-pane",{attrs:{label:a.label,name:a.name}},[t("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"100px"}},[t("div",{staticClass:"content-bottom-padded flex items-center"},[t("el-upload",{staticClass:"fl",staticStyle:{"margin-right":"10px"},attrs:{action:"","on-change":e.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v($t("unjubc6"," 点击上传 ","lang"))])],1),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.uploadHandleTemplate()}}},[e._v($t("gb8vax6"," 下载模版 ","lang"))])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.uploadList,height:e.wheight-220,"element-loading-text":$t("go5gpa5","数据加载中","lang")}},[t("el-table-column",{attrs:{prop:"file_name",label:$t("a6fdb94","上传文件","lang"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"created_date",label:$t("a6ftzo4","上传时间","lang"),"min-width":"80"}}),t("el-table-column",{attrs:{prop:"file_size_format",label:$t("d4zx3r4","文件大小","lang"),"min-width":"60"}}),t("el-table-column",{attrs:{label:$t("bpqivh4","处理状态","lang"),"min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(a){return["wait"==a.row.handle_status?t("span",[e._v($t("fy7x7i4","等待处理","lang"))]):e._e(),"processing"==a.row.handle_status?t("span",[e._v($t("dljhn3","处理中","lang"))]):e._e(),"finish"==a.row.handle_status?t("span",[e._v($t("bpmlfq4","处理完成","lang"))]):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{prop:"finish_date",label:$t("w8vqkk6","处理完成时间","lang")}}),t("el-table-column",{attrs:{label:$t("bpnma94","处理成功","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.handle_message?t("span",[e._v(e._s(a.row.handle_message.successLine)+$t("qx81","行","lang"))]):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("bpmfiu4","处理失败","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.handle_message?t("span",[e._v(e._s(a.row.handle_message.errorLine)+$t("qx81","行","lang"))]):e._e(),a.row.handle_message&&a.row.handle_message.errorLine>0?t("a",{attrs:{type:"primary"},on:{click:function(t){return e.exportErrorFile(a.row.id,a.row.file_type)}}},[e._v($t("ols2cn6","下载错误详情","lang"))]):e._e()]}}],null,!0)})],1),e.total_count>e.pageSize?t("div",{staticClass:"content-top-padded content-center"},[t("el-pagination",{attrs:{layout:"total, prev, pager, next",total:e.total_count,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)],1)})],2)],1)},[],!1,null,null,null).exports}}]);