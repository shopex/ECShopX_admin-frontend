"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8699],{78699:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});a(44114);var l=a(1038);const i=[{label:$t("qylb2","首页","lang"),name:"index"},{label:$t("grp7p84","自定义页","lang"),name:"custom"}];var n={data(){return{tabList:i,templateList:[],page_type:"index",page:{page_no:1,page_size:20,total:0},loading:!1,dialogVisible:!1,formData:{theme_pc_template_id:"",template_title:"",template_description:"",page_type:"",status:!1},formRule:{template_title:[{required:!0,message:$t("do8uh37","请输入页面名称","lang"),trigger:"blur"}],template_description:[{required:!0,message:$t("do61mx7","请输入页面描述","lang"),trigger:"blur"}],page_type:[{required:!0,message:$t("do25p67","请输入页面类型","lang"),trigger:"change"}]}}},created(){this.getTemplateList()},methods:{handleDialogClose(){this.dialogVisible=!1,this.resetForm("myForm")},handleTabClick(){this.page.page_no=1,this.loading=!0,this.getTemplateList()},handleEdit(t){this.dialogVisible=!0,this.$nextTick(()=>{this.formData.theme_pc_template_id=t.theme_pc_template_id,this.formData.template_title=t.template_title,this.formData.template_description=t.template_description,this.formData.page_type=t.page_type,this.formData.status="1"===t.status})},handleRenovation({theme_pc_template_id:t}){this.$router.push({path:`/decoration/web/template/edit?id=${t}`})},async handleDisable({status:t,created:e,updated:a,deleted_at:i,...n}){try{this.loading=!0;await(0,l.editPageTemplate)({status:"1"===t?"2":"1",...n});this.loading=!1,this.getTemplateList()}catch(t){this.loading=!1}},async handleDelete({theme_pc_template_id:t}){try{await this.$confirm($t("l6kb0o6","确定删除吗?","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang"),type:"warning"});this.loading=!0;await(0,l.deletePageTemplate)(t);this.loading=!1,this.getTemplateList()}catch(t){this.loading=!1}},submitForm(t){this.$refs[t].validate(async t=>{if(!t)return!1;{const{status:t,theme_pc_template_id:e,...a}=this.formData;this.loading=!0;const i={status:t?"1":"2",version:"v1.0.1",...a};""!==e&&(i.theme_pc_template_id=e);try{if(""===e){const{data:t}=await(0,l.addPageTemplate)(i)}else await(0,l.editPageTemplate)(i)}catch(t){}this.dialogVisible=!1,this.loading=!1,this.resetForm("myForm"),this.getTemplateList()}})},resetForm(t){this.$refs[t].resetFields()},async getTemplateList(){const{page_no:t,page_size:e}=this.page,{page_type:a}=this;this.loading=!0;const i=await(0,l.fetchTemplateList)({page_type:a,page_no:t,page_size:e});this.loading=!1,this.templateList=i.data.data.list,this.page.total=i.data.data.total_count},handleCurrentChange(t){this.page.page_no=t,this.getTemplateList()},handleSizeChange(t){this.page.page_size=t,this.getTemplateList()}}},s=(0,a(81656).A)(n,function(){var t=this,e=t._self._c;return e("SpRouterView",[e("SpPage",[e("div",{staticClass:"website-template"},[-1===t.$route.path.indexOf("editor")?e("div",[e("el-row",{staticClass:"mb-4"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v($t("u1qoz26"," 添加页面 ","lang"))])],1),e("el-row",[e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleTabClick},model:{value:t.page_type,callback:function(e){t.page_type=e},expression:"page_type"}},[t._l(t.tabList,function(a,l){return e("el-tab-pane",{key:l,attrs:{label:a.label,disabled:t.loading,name:a.name}})}),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"",stripe:"",data:t.templateList}},[e("el-table-column",{attrs:{prop:"theme_pc_template_id",label:$t("jufa7c4","页面id","lang")}}),e("el-table-column",{attrs:{prop:"template_title",label:$t("juu6ds4","页面名称","lang")}}),e("el-table-column",{attrs:{prop:"template_description",label:$t("juwz7y4","页面描述","lang")}}),e("el-table-column",{attrs:{prop:"page_type",label:$t("jv0v5p4","页面类型","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s("index"===a.row.page_type?$t("qylb2","首页","lang"):$t("grp7p84","自定义页","lang")))])]}}],null,!1,698665499)}),e("el-table-column",{attrs:{prop:"status",label:$t("d8pu5s4","是否启用","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",["1"===a.row.status?e("el-tag",{attrs:{type:"success"}},[t._v($t("dg9c74"," 启用 ","lang"))]):e("el-tag",{attrs:{type:"info"}},[t._v($t("duwobh5"," 未启用 ","lang"))])],1)]}}],null,!1,1497859762)}),e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"250px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleDisable(a.row)}}},[t._v(" "+t._s("1"===a.row.status?$t("lb5z2","禁用","lang"):$t("eymx2","启用","lang"))+" ")]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleDelete(a.row)}}},[t._v($t("db22k4"," 删除 ","lang"))]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v($t("juz394"," 编辑 ","lang"))]),e("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(e){return t.handleRenovation(a.row)}}},[t._v($t("8d291y6"," 页面装修 ","lang"))])],1)]}}],null,!1,1745813773)})],1)],2)],1),e("div",{staticClass:"content-right mt-4 content-top-padded"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.page_no,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.page_size},on:{"update:currentPage":function(e){return t.$set(t.page,"page_no",e)},"update:current-page":function(e){return t.$set(t.page,"page_no",e)},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),e("el-dialog",{attrs:{title:$t("9es0ya7","添加/编辑页面","lang"),visible:t.dialogVisible,width:"500px","before-close":t.handleDialogClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"myForm",attrs:{model:t.formData,rules:t.formRule,"label-width":"80px"}},[e("el-form-item",{attrs:{label:$t("juu6ds4","页面名称","lang"),prop:"template_title"}},[e("el-input",{attrs:{clearable:"",placeholder:$t("do8uh37","请输入页面名称","lang")},model:{value:t.formData.template_title,callback:function(e){t.$set(t.formData,"template_title",e)},expression:"formData.template_title"}})],1),e("el-form-item",{attrs:{label:$t("juwz7y4","页面描述","lang"),prop:"template_description"}},[e("el-input",{attrs:{clearable:"",placeholder:$t("do61mx7","请输入页面描述","lang")},model:{value:t.formData.template_description,callback:function(e){t.$set(t.formData,"template_description",e)},expression:"formData.template_description"}})],1),e("el-form-item",{attrs:{label:$t("jv0v5p4","页面类型","lang"),prop:"page_type"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.formData.page_type,callback:function(e){t.$set(t.formData,"page_type",e)},expression:"formData.page_type"}},t._l(t.tabList,function(t,a){return e("el-option",{key:a,attrs:{value:t.name,label:t.label}})}),1)],1),e("el-form-item",{attrs:{label:$t("d8pu5s4","是否启用","lang"),prop:"status"}},[e("el-switch",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.submitForm("myForm")}}},[t._v($t("fro49d4","确认保存","lang"))])],1)],1)],1):t._e()])])],1)},[],!1,null,null,null).exports}}]);