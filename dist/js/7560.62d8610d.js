"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[7560],{47560:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});a(18111),a(61701);var o=a(95353),s=a(77825),l=(a(95093),a(26456),a(5134),a(33318)),n={mixins:[s.Ay,s.v8],data(){return{loading:!1,tableList:[],params:{item_type:"normal",keywords:"",item_bn:"",barcode:"",approve_status:"",brand_id:"",category:0,activity_name:"",activity_status:"all"},statusOption:l.W1,goodsBranchList:[],goodsBranchParams:{page:1,pageSize:1e3,attribute_type:"brand",attribute_name:""},categoryList:[],activity_status:[{title:$t("av9wor4","全部商品","lang"),value:"all"},{title:$t("6dsipr6","活动中的商品","lang"),value:"activing"}],sendNumDialog:!1,sendNumFormList:[{label:$t("lf8h13","起送量","lang"),key:"num",type:"input",placeholder:$t("2kttaea","留空则不做起送量限制","lang"),required:!0,message:$t("adohlc4","不能为空","lang")}],sendNumForm:{item_id:"",num:""}}},computed:{...(0,o.L8)(["shopId"])},mounted(){this.getCategory(),this.onSearch()},methods:{async handleAddGoods(){const{data:t}=await this.$picker.goods({data:[100],shopid:this.shopId}),e=t.map(t=>t.item_id);await this.$api.community.addActivityGoods({goods_id:e}),this.onSearch()},async fetchList({pageIndex:t,pageSize:e}){this.loading=!0;let a={page:t,pageSize:e,...this.params};"activing"==a.activity_status&&(a.in_activity=!0),delete a.activity_status;const{list:o,total_count:s}=await this.$api.community.getActivityGoods(a);this.tableList=o,this.page.total=s,this.loading=!1},async getGoodsBranchList(t=""){this.goodsBranchParams.attribute_name=t;const{list:e}=await this.$api.goods.getGoodsAttr(this.goodsBranchParams);this.goodsBranchList=e},async getCategory(){const t=await this.$api.goods.getCategory({is_show:!1});this.categoryList=t},async deleteItem({item_id:t}){await this.$confirm($t("w368ub9","请确认是否删除商品","lang"),$t("hn562","提示","lang"),{confirmButtonText:$t("kzjg2","确定","lang"),cancelButtonText:$t("ev022","取消","lang")}),await this.$api.community.deleteActivityGoods(t),this.onSearch()},modifyItem({item_id:t}){this.sendNumForm.item_id=t,this.sendNumDialog=!0},async onSendNumSubmit(){const{item_id:t,num:e}=this.sendNumForm;await this.$api.community.modifyGoodsDeliverNum({goods_id:t,min_delivery_num:e}),this.$refs.sendNumDialogRef.resetForm(),this.sendNumDialog=!1,this.onRefresh()},async editItemsSort({item_id:t,sort:e}){await this.$api.community.modifyGoodsSort({goods_id:t,sort:e}),this.onRefresh()}}},r=(0,a(81656).A)(n,function(){var t=this,e=t._self._c;return e("SpPage",[e("div",{staticClass:"page-mall-communitygoods"},[e("SpFilterForm",{attrs:{model:t.params},on:{onSearch:t.onSearch,onReset:t.onSearch}},[e("SpFilterFormItem",{attrs:{prop:"keywords",label:$t("aotkhw5","商品名称:","lang")}},[e("el-input",{attrs:{placeholder:$t("mf25uh7","请输入商品名称","lang")},model:{value:t.params.keywords,callback:function(e){t.$set(t.params,"keywords",e)},expression:"params.keywords"}})],1),e("SpFilterFormItem",{attrs:{prop:"item_bn",label:$t("aip3s25","商品编号:","lang")}},[e("el-input",{attrs:{placeholder:$t("mev1tn7","请输入商品编号","lang")},model:{value:t.params.item_bn,callback:function(e){t.$set(t.params,"item_bn",e)},expression:"params.item_bn"}})],1),e("SpFilterFormItem",{attrs:{prop:"barcode",label:$t("dfxwze4","条形码:","lang")}},[e("el-input",{attrs:{placeholder:$t("a6w279a","请输入商品编号条形码","lang")},model:{value:t.params.barcode,callback:function(e){t.$set(t.params,"barcode",e)},expression:"params.barcode"}})],1),e("SpFilterFormItem",{attrs:{prop:"approve_status",label:$t("akgb645","商品状态:","lang")}},[e("el-select",{attrs:{clearable:"",placeholder:$t("l72nr3","请选择","lang")},model:{value:t.params.approve_status,callback:function(e){t.$set(t.params,"approve_status",e)},expression:"params.approve_status"}},t._l(t.statusOption,function(t){return e("el-option",{key:t.value,attrs:{label:t.title,size:"mini",value:t.value}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"brand_id",label:$t("cycj33","品牌:","lang")}},[e("el-select",{attrs:{placeholder:$t("l72nr3","请选择","lang"),remote:"",filterable:"",clearable:"","remote-method":t.getGoodsBranchList},model:{value:t.params.brand_id,callback:function(e){t.$set(t.params,"brand_id",e)},expression:"params.brand_id"}},t._l(t.goodsBranchList,function(t){return e("el-option",{key:t.attribute_id,attrs:{label:t.attribute_name,value:t.attribute_id}})}),1)],1),e("SpFilterFormItem",{attrs:{prop:"category",label:$t("ap3trq5","商品分类:","lang")}},[e("el-cascader",{attrs:{placeholder:$t("l72nr3","请选择","lang"),clearable:"",options:t.categoryList,props:{value:"category_id",checkStrictly:!0}},model:{value:t.params.category,callback:function(e){t.$set(t.params,"category",e)},expression:"params.category"}})],1),e("SpFilterFormItem",{attrs:{prop:"activity_name",label:$t("ge13h3","活动:","lang")}},[e("el-input",{attrs:{placeholder:$t("mf25uh7","请输入商品名称","lang")},model:{value:t.params.activity_name,callback:function(e){t.$set(t.params,"activity_name",e)},expression:"params.activity_name"}})],1)],1),e("div",{staticClass:"action-container"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleAddGoods}},[t._v($t("l5a3w88"," 选择活动商品 ","lang"))])],1),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.onSearch},model:{value:t.params.activity_status,callback:function(e){t.$set(t.params,"activity_status",e)},expression:"params.activity_status"}},[t._l(t.activity_status,function(t){return e("el-tab-pane",{key:t.value,attrs:{label:t.title,name:t.value}})}),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{border:"",data:t.tableList}},[e("el-table-column",{attrs:{prop:"goods_id",label:$t("b3ly1i4","商品ID","lang")}}),e("el-table-column",{attrs:{prop:"itemName",label:$t("eywr2","商品","lang"),width:"300"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"goods-title"},[t._v(" "+t._s(a.row.item_name)+" "),a.row.nospec?t._e():e("el-tag",{attrs:{size:"mini",effect:"plain",type:"primary"}},[t._v($t("caubqm5"," 多规格 ","lang"))])],1),e("div",{staticClass:"goods-code"},[t._v($t("loeoa4"," 货号：","lang")+t._s(a.row.item_bn)+" "),e("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.item_bn,expression:"scope.row.item_bn",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],staticClass:"el-icon-document-copy"})])],1)]}}])}),e("el-table-column",{attrs:{label:$t("lf8h13","起送量","lang"),prop:"min_delivery_num"}}),e("el-table-column",{attrs:{label:$t("idef2","标签","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._l(a.row.tagList,function(a){return e("el-tag",{key:a.index,staticStyle:{display:"inline-block","margin-right":"3px"},style:"color:"+a.font_color,attrs:{color:a.tag_color,size:"mini"}},[t._v(" "+t._s(a.tag_name)+" ")])})]}}])}),e("el-table-column",{attrs:{label:$t("cyko7y4","排序编号","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{staticStyle:{width:"60px"},attrs:{size:"mini"},on:{change:function(e){return t.editItemsSort(a.row)}},model:{value:a.row.sort,callback:function(e){t.$set(a.row,"sort",e)},expression:"scope.row.sort"}})]}}])}),e("el-table-column",{attrs:{prop:"store",label:$t("gl5x2","库存","lang"),width:"80"}}),e("el-table-column",{attrs:{prop:"market_price",label:$t("h76hpo5","原价（¥）","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.market_price/100)+" ")]}}])}),e("el-table-column",{attrs:{prop:"price",label:$t("789h436","销售价（¥）","lang"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.price/100)+" ")]}}])}),e("el-table-column",{attrs:{label:$t("k1e32","状态","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return["processing"==a.row.audit_status?e("span",[t._v($t("fy8avn4","等待审核","lang"))]):"rejected"==a.row.audit_status?e("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:a.row.audit_reason}},[e("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v($t("w1qlxa6"," 审核驳回 ","lang"))])],1):"onsale"==a.row.approve_status?e("span",[t._v($t("aqern84","前台可销","lang"))]):"offline_sale"==a.row.approve_status?e("span",[t._v($t("ekg7gx6","前台不展示 ","lang"))]):"only_show"==a.row.approve_status?e("span",[t._v($t("mfuo7t5","前台仅展示","lang"))]):e("span",[t._v($t("a7er004","不可销售","lang"))])]}}])}),e("el-table-column",{attrs:{prop:"itemCatName",label:$t("b40j3k4","商品分类","lang"),width:"150"}}),e("el-table-column",{attrs:{fixed:"left",label:$t("hkxb2","操作","lang"),width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.deleteItem(a.row)}}},[t._v($t("db22k4"," 删除 ","lang"))]),e("el-button",{staticClass:"btn-gap",attrs:{type:"text"},on:{click:function(e){return t.modifyItem(a.row)}}},[t._v($t("on7m3v7"," 设置起送量 ","lang"))])]}}])})],1),e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.page.pageIndex,"page-sizes":[10,20,50],total:t.page.total,"page-size":t.page.pageSize},on:{"update:currentPage":function(e){return t.$set(t.page,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.page,"pageIndex",e)},"current-change":t.onCurrentChange,"size-change":t.onSizeChange}})],1)],2),e("SpDialog",{ref:"sendNumDialogRef",attrs:{title:$t("56ve8b5","设置起送量","lang"),form:t.sendNumForm,"form-list":t.sendNumFormList},on:{onSubmit:t.onSendNumSubmit},model:{value:t.sendNumDialog,callback:function(e){t.sendNumDialog=e},expression:"sendNumDialog"}})],1)])},[],!1,null,null,null).exports}}]);