"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[2289],{12289:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var l=a(95353),n=a(28308),s={data(){return{pane_list:[{name:"normal_goods",label:$t("udjz637","上传实体类商品","lang")}],loading:!1,total_count:0,pageSize:20,page:1,activeName:"normal_goods",uploadList:[],flie:{file_type:"distributor_info",file_name:$t("deu1z34","更新店铺","lang")}}},computed:{...(0,l.L8)(["wheight"])},mounted(){this.getUploadList()},methods:{handleClick(){this.getUploadList()},async uploadHandleChange(e,t){let a={isUploadFile:!0,file_type:"distributor_info",file:e.raw};await(0,n.uploadFiles)(a),this.$message({type:"success",message:$t("dn5eu39","上传成功，等待处理","lang")}),this.getUploadList()},async uploadHandleTemplate(){try{const{status:e,data:t}=await(0,n.getTemplate)(this.flie);if(200===e){const e=document.createElement("a");e.href=t.data.file,e.download=t.data.name,document.body.appendChild(e),e.click(),e.remove()}}catch(e){this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})}},async exportErrorFile(e,t){let a={file_type:t};try{const{data:t}=await(0,n.exportUploadErrorFile)(e,a);let l=document.createElement("a");l.href=t.data.file,l.download=t.data.name,document.body.appendChild(l),l.click(),l.remove()}catch(e){this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})}},handleCurrentChange(e){this.page=e,this.getUploadList()},async getUploadList(){this.loading=!0;let e={file_type:this.flie.file_type,page:this.page,pageSize:this.pageSize};const{data:t,status:a}=await(0,n.getFlieList)(e);200===a&&(this.uploadList=t.data.list,this.total_count=t.data.total_count,this.loading=!1)}}},i=(0,a(81656).A)(s,function(){var e=this,t=e._self._c;return t("SpPage",[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("div",{staticClass:"tip-info"},[t("p",[e._v($t("flzk9x1f"," 上传文件如果有处理失败的行数后将会生成错误文件，请及时查看错误信息修改后重新下载，错误描述文件只保留","lang")),t("strong",[e._v($t("1j7p3","15天","lang"))]),e._v("。 ")]),t("p",[e._v($t("ouzm2","超过","lang")),t("strong",[e._v($t("1j7p3","15天","lang"))]),e._v($t("84meojk","的错误描述文件将会删除，不再提供下载查看","lang"))])]),e._l(e.pane_list,function(a){return t("div",{key:a.label},[t("el-tab-pane",{attrs:{label:a.label,name:a.name}},[t("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"100px"}},[t("div",{staticClass:"content-bottom-padded"},[t("el-upload",{staticStyle:{"margin-right":"10px",float:"left"},attrs:{action:"","on-change":e.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v($t("unjubc6"," 点击上传 ","lang"))])],1),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.uploadHandleTemplate()}}},[e._v($t("gb8vax6"," 下载模版 ","lang"))])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.uploadList,height:e.wheight-220,"element-loading-text":$t("go5gpa5","数据加载中","lang")}},[t("el-table-column",{attrs:{prop:"file_name",label:$t("a6fdb94","上传文件","lang"),"min-width":"100"}}),t("el-table-column",{attrs:{prop:"created_date",label:$t("a6ftzo4","上传时间","lang"),"min-width":"80"}}),t("el-table-column",{attrs:{prop:"file_size_format",label:$t("d4zx3r4","文件大小","lang"),"min-width":"60"}}),t("el-table-column",{attrs:{label:$t("bpqivh4","处理状态","lang"),"min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(a){return["wait"==a.row.handle_status?t("span",[e._v($t("fy7x7i4","等待处理","lang"))]):e._e(),"processing"==a.row.handle_status?t("span",[e._v($t("dljhn3","处理中","lang"))]):e._e(),"finish"==a.row.handle_status?t("span",[e._v($t("bpmlfq4","处理完成","lang"))]):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{prop:"finish_date",label:$t("w8vqkk6","处理完成时间","lang")}}),t("el-table-column",{attrs:{label:$t("bpnma94","处理成功","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.handle_message?t("span",[e._v(e._s(a.row.handle_message.successLine)+$t("qx81","行","lang"))]):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{label:$t("bpmfiu4","处理失败","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.handle_message?t("span",[e._v(e._s(a.row.handle_message.errorLine)+$t("qx81","行","lang"))]):e._e(),a.row.handle_message&&a.row.handle_message.errorLine>0?t("a",{staticClass:"error_a",attrs:{type:"primary"},on:{click:function(t){return e.exportErrorFile(a.row.id,a.row.file_type)}}},[e._v($t("ols2cn6","下载错误详情","lang"))]):e._e()]}}],null,!0)})],1),e.total_count>e.pageSize?t("div",{staticClass:"content-top-padded content-center"},[t("el-pagination",{attrs:{layout:"total, prev, pager, next",total:e.total_count,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)],1)})],2)],1)},[],!1,null,null,null).exports}}]);