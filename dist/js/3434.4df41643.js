"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[3434],{21053:function(e,a,t){t.r(a),t.d(a,{default:function(){return o}});var l=t(59025),n={data(){return{pane_list:[{name:"normal_pointsmall_goods",label:$t("udjz637","上传实体类商品","lang")}],loading:!1,total_count:0,pageSize:20,page:1,activeName:"normal_pointsmall_goods",uploadList:[]}},computed:{},mounted(){this.getUploadList()},methods:{handleClick(){this.getUploadList()},uploadHandleChange(e,a){let t={isUploadFile:!0,file_type:this.activeName,file:e.raw};(0,l.handleUploadFile)(t).then(e=>{this.$message({type:"success",message:$t("dn5eu39","上传成功，等待处理","lang")}),this.getUploadList()})},uploadHandleTemplate(){if("normal_pointsmall_goods"==this.activeName)var e=$t("9gux0ja","新增积分商城实体商品","lang");let a={file_type:this.activeName,file_name:e};(0,l.exportUploadTemplate)(a).then(e=>{if(e.data.data.file){var a=document.createElement("a");a.href=e.data.data.file,a.download=e.data.data.name,document.body.appendChild(a),a.click(),a.remove()}else this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})})},exportErrorFile(e,a){let t={file_type:a};(0,l.exportUploadErrorFile)(e,t).then(e=>{if(e.data.data.file){var a=document.createElement("a");a.href=e.data.data.file,a.download=e.data.data.name,document.body.appendChild(a),a.click(),a.remove()}else this.$message({type:"error",message:$t("yndnt89","没有相关数据可导出","lang")})})},handleCurrentChange(e){this.page=e,this.getUploadList()},getUploadList(){this.loading=!0;let e={file_type:this.activeName,page:this.page,pageSize:this.pageSize};(0,l.getUploadLists)(e).then(e=>{this.uploadList=e.data.data.list,this.total_count=e.data.data.total_count,this.loading=!1})}}},o=(0,t(81656).A)(n,function(){var e=this,a=e._self._c;return a("div",[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[a("div",{staticClass:"tip-info"},[a("p",[e._v($t("flzk9x1f"," 上传文件如果有处理失败的行数后将会生成错误文件，请及时查看错误信息修改后重新下载，错误描述文件只保留","lang")),a("strong",[e._v($t("1j7p3","15天","lang"))]),e._v("。 ")]),a("p",[e._v($t("ouzm2","超过","lang")),a("strong",[e._v($t("1j7p3","15天","lang"))]),e._v($t("84meojk","的错误描述文件将会删除，不再提供下载查看","lang"))])]),e._l(e.pane_list,function(t){return a("div",[a("el-tab-pane",{attrs:{label:t.label,name:t.name}},[a("el-form",{ref:"form",refInFor:!0,attrs:{"label-width":"100px"}},[a("div",{staticClass:"content-bottom-padded"},[a("el-upload",{staticClass:"fl",staticStyle:{"margin-right":"10px"},attrs:{action:"","on-change":e.uploadHandleChange,"auto-upload":!1,"show-file-list":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v($t("unjubc6"," 点击上传 ","lang"))])],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.uploadHandleTemplate()}}},[e._v($t("gb8vax6"," 下载模版 ","lang"))])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.uploadList,"element-loading-text":$t("go5gpa5","数据加载中","lang")}},[a("el-table-column",{attrs:{prop:"file_name",label:$t("a6fdb94","上传文件","lang"),"min-width":"100"}}),a("el-table-column",{attrs:{prop:"created_date",label:$t("a6ftzo4","上传时间","lang"),"min-width":"80"}}),a("el-table-column",{attrs:{prop:"file_size_format",label:$t("d4zx3r4","文件大小","lang"),"min-width":"60"}}),a("el-table-column",{attrs:{label:$t("bpqivh4","处理状态","lang"),"min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(t){return["wait"==t.row.handle_status?a("span",[e._v($t("fy7x7i4","等待处理","lang"))]):e._e(),"processing"==t.row.handle_status?a("span",[e._v($t("dljhn3","处理中","lang"))]):e._e(),"finish"==t.row.handle_status?a("span",[e._v($t("bpmlfq4","处理完成","lang"))]):e._e()]}}],null,!0)}),a("el-table-column",{attrs:{prop:"finish_date",label:$t("w8vqkk6","处理完成时间","lang")}}),a("el-table-column",{attrs:{label:$t("bpnma94","处理成功","lang")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.handle_message?a("span",[e._v(e._s(t.row.handle_message.successLine)+$t("qx81","行","lang"))]):e._e()]}}],null,!0)}),a("el-table-column",{attrs:{label:$t("bpmfiu4","处理失败","lang")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.handle_message?a("span",[e._v(e._s(t.row.handle_message.errorLine)+$t("qx81","行","lang"))]):e._e(),t.row.handle_message&&t.row.handle_message.errorLine>0?a("a",{attrs:{type:"primary"},on:{click:function(a){return e.exportErrorFile(t.row.id,t.row.file_type)}}},[e._v($t("ols2cn6","下载错误详情","lang"))]):e._e()]}}],null,!0)})],1),e.total_count>e.pageSize?a("div",{staticClass:"content-top-padded content-center"},[a("el-pagination",{attrs:{layout:"total, prev, pager, next",total:e.total_count,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)],1)})],2)],1)},[],!1,null,null,null).exports}}]);