"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[4510],{34510:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});a(44114),a(18111),a(22489),a(7588);var r=a(95353),l=a(41776),s=a(49986),i=a(82997),o=a(59025),n=a(25159),c=a(18306),d={components:{shopSelect:n.default},data(){return{is_distributor:!1,IsDisabled:!1,IsBind:!1,activeName:"all",loading:!1,create_time:"",params:{page:1,pageSize:20,order_class_exclude:"drug"},order_class_array:[{name:$t("i98wni6","积分商城订单","lang"),value:"pointsmall"}],cancelOrderInput:!1,order_cancel_reason:[{name:$t("pz0w3u8","客户现在不想购买","lang"),value:1},{name:$t("s2wbp58","客户商品价格较贵","lang"),value:2},{name:$t("5ub2dc6","客户价格波动","lang"),value:3},{name:$t("54f4lf6","客户商品缺货","lang"),value:4},{name:$t("2iss7z6","客户重复下单","lang"),value:5},{name:$t("s1oguha","客户订单商品选择有误","lang"),value:6},{name:$t("yfg8h2a","客户支付方式选择有误","lang"),value:7},{name:$t("9z46tka","客户收货信息填写有误","lang"),value:8},{name:$t("ozd78ya","客户发票信息填写有误","lang"),value:9},{name:$t("l4oqme8","客户无法支付订单","lang"),value:10},{name:$t("j4es208","客户长时间未付款","lang"),value:11},{name:$t("5mt8x66","客户其他原因","lang"),value:12}],open_status_map:s.Lp,open_status_arr:s.C,order_status:"",time_start_begin:"",time_start_end:"",salesman_mobile:"",total_count:0,order_type:"normal",list:[],identifier:"",source_list:[],source_name:"",source_id:"",order_class:"pointsmall",cancel_order:"",deliveryVisible:!1,deliveryTitle:"",deliveryData:{orderInfo:{}},deliveryForm:{delivery_type:"batch",order_id:"",delivery_corp:"",delivery_code:"",sepInfo:{}},dlycorps:[],cancelVisible:!1,cancelData:{orderInfo:{}},cancelForm:{order_id:"",check_cancel:"1",shop_reject_reason:""},cancelOrderVisible:!1,cancelOrderData:{orderInfo:{}},cancelOrderForm:{order_id:"",cancel_reason:0,other_reason:""},writeoffOrderVisible:!1,writeoffOrderData:{items:{}},writeoffOrderForm:{order_id:"",pickupcode:""},writeoffOrderSuccVisible:!1,writeoffOrderSucc:{msg:""},downloadView:!1,downloadUrl:"",downloadName:"",deliveryVisibleNew:!1,datapass_block:1,exportTab:"",jstErpSetting:{},invoice_status:""}},computed:{...(0,r.L8)(["wheight"])},mounted(){"distributor"===c.A.getters.login_type&&(this.is_distributor=!0),this.$route.query.tab&&(this.activeName=this.$route.query.tab,this.params.order_status=this.$route.query.tab,this.params.page=1),this.params.order_type=this.order_type,this.params.order_class=this.order_class,this.getStatus(),this.getOrders(this.params),this.getAllSourcesList(),this.getJstErpSetting()},methods:{getJstErpSetting(){this.$api.third.getJstErpSetting().then(e=>{this.jstErpSetting=e})},onCopy(){this.$notify({message:$t("bkv2mw4","复制成功","lang"),type:"success"})},handleClick(e,t){this.activeName=e.name,this.params.order_status="all"==e.name?"":e.name,this.params.page=1,this.getParams(),this.getOrders(this.params)},storeSearch(e){e&&e.shop_id,this.params.distributor_id=e.shop_id,this.params.page=1,this.getParams(),this.getOrders(this.params)},TypeHandle(e){this.params.page=1,this.getParams(),this.getOrders(this.params)},numberSearch(e){this.params.page=1,this.getParams(),this.getOrders(this.params)},invoiceStatusChange(e){this.params.invoice_status=e,this.params.page=1,this.getParams(),this.getOrders(this.params)},dateChange(e){e&&e.length>0?(this.time_start_begin=this.dateStrToTimeStamp(e[0]+" 00:00:00"),this.time_start_end=this.dateStrToTimeStamp(e[1]+" 23:59:59")):(this.time_start_begin="",this.time_start_end=""),this.params.page=1,this.getParams(),this.getOrders(this.params)},sourceSearch(e){this.params.source_id=e.source_id,this.params.page=1,this.getParams(),this.getOrders(this.params)},handleCurrentChange(e){this.loading=!1,this.params.page=e,this.getParams(),this.getOrders(this.params)},handleSizeChange(e){this.loading=!1,this.params.page=1,this.params.pageSize=e,this.getParams(),this.getOrders(this.params)},getParams(){this.params.time_start_begin=this.time_start_begin,this.params.time_start_end=this.time_start_end,this.params.order_type=this.order_type,this.params.order_class=this.order_class,this.params.salesman_mobile=this.salesman_mobile,11==this.identifier.length?(this.params.mobile=this.identifier,this.params.order_id=""):(this.params.mobile="",this.params.order_id=this.identifier)},dateStrToTimeStamp(e){return Date.parse(new Date(e))/1e3},getOrders(e){this.loading=!0,(0,l.getOrderList)(e).then(e=>{this.list=e.data.data.list,this.total_count=Number(e.data.data.pager.count),this.datapass_block=e.data.data.datapass_block,this.loading=!1})},getStatus(){(0,l.isBind)().then(e=>{this.IsBind=e.data.data.result})},getAllSourcesList(){(0,i.getSourcesList)({page:1,pageSize:1e3}).then(e=>{e.data.data.list&&e.data.data.list.forEach(e=>{this.source_list.push({value:e.sourceName,source_id:e.sourceId})})})},querySearch(e,t){var a=this.source_list;t(e?a.filter(this.createFilter(e)):a)},createFilter(e){return t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},deliveryAction(e){let t=e.order_id;this.selectItemType=e.delivery_type,this.deliveryTitle=$t("f14m2","发货","lang"),(0,l.getLogisticsList)().then(e=>{this.dlycorps=e.data.data.list}),(0,l.getOrderDetail)(t).then(e=>{if(this.deliveryData=e.data.data,"WAIT_PROCESS"==this.deliveryData.orderInfo.cancel_status)return this.$message.error($t("l30ha0p","客户已经申请退款，请先处理退款操作再决定是否发货!","lang")),!1;"old"==this.selectItemType?this.deliveryVisible=!0:this.deliveryVisibleNew=!0,this.deliveryData&&"PARTAIL"==this.deliveryData.orderInfo.delivery_status&&(this.IsDisabled=!0,this.deliveryForm.delivery_type="sep")}),this.deliveryForm.order_id=t},confirmCancelOrderAction(e){(0,l.getCancelOrderInfo)(e,{order_type:"normal"}).then(e=>{this.cancelData=e.data.data,this.cancelVisible=!0}),this.cancelForm.order_id=e,this.cancelForm.order_type="normal_pointsmall"},handleCancelOrderCancel(){this.cancelVisible=!1,this.cancelForm.order_id="",this.cancelForm.shop_reject_reason="",this.cancelForm.order_type=""},submitCancelConfirmAction(){(0,l.cancelConfirm)(this.cancelForm.order_id,this.cancelForm).then(e=>{var t=e.data.data.refund_status;if("SUCCESS"!=t&&"AUDIT_SUCCESS"!=t)return this.$message.success($t("juhswq4","驳回成功","lang")),this.getOrders(this.params),!1;this.handleCancelOrderCancel(),this.$message.success($t("go0nkr5","审核成功!","lang")),this.getOrders(this.params)})},handleCancel(){this.deliveryVisible=!1,this.deliveryForm.order_id="",this.deliveryForm.delivery_corp="",this.deliveryForm.delivery_code="",this.deliveryVisibleNew=!1,this.deliveryForm={delivery_type:"batch",order_id:"",delivery_corp:"",delivery_code:"",sepInfo:{}},this.IsDisabled=!1},submitDeliveryAction(){this.deliveryForm.type=this.selectItemType,"sep"==this.deliveryForm.delivery_type?"old"==this.selectItemType?(this.deliveryForm.sepInfo=JSON.stringify(this.deliveryData.orderInfo.items),this.deliveryForm.delivery_corp="",this.deliveryForm.delivery_code=""):this.deliveryForm.sepInfo=JSON.stringify(JSON.parse(JSON.stringify(this.deliveryData.orderInfo.items)).filter(e=>e.delivery_num&&""!=e.delivery_num)):this.deliveryForm.sepInfo={},(0,l.delivery)(this.deliveryForm).then(e=>{var t=e.data.data.delivery_status;if(!t||"PENDING"==t)return this.$message.error($t("98zfs95","发货失败!","lang")),!1;this.handleCancel(),this.$message.success($t("97ym6c5","发货成功!","lang")),this.getOrders(this.params)})},cancelOrderAction(e){(0,l.getOrderDetail)(e).then(e=>{if(this.cancelOrderData=e.data.data,"SUCCESS"==this.cancelOrderData.orderInfo.cancel_status)return this.$message.error($t("pnmyxh7","该订单已取消!","lang")),!1;this.cancelOrderVisible=!0}),this.cancelOrderForm.order_id=e},handleCancelOrder(){this.cancel_order="",this.cancelOrderVisible=!1,this.cancelOrderForm.order_id="",this.cancelOrderForm.other_reason="",this.cancelOrderInput=!1},cancelReasonSelect(e){12==e?this.cancelOrderInput=!0:(this.cancelOrderForm.other_reason="",this.cancelOrderInput=!1),this.cancelOrderForm.cancel_reason=e},submitCancelOrderConfirmAction(){return 0==this.cancelOrderForm.cancel_reason?(this.$message.error($t("w6z1cn8","请选择取消原因!","lang")),!1):12==this.cancelOrderForm.cancel_reason&&""==this.cancelOrderForm.other_reason?(this.$message.error($t("cu75ph8","请输入取消原因!","lang")),!1):void(0,l.cancelOrderConfirm)(this.cancelOrderForm.order_id,this.cancelOrderForm).then(e=>{var t=e.data.data.refund_status;if("WAIT_CHECK"!=t&&"SUCCESS"!=t)return this.$message.success($t("rhr7207","取消订单失败!","lang")),this.getOrders(this.params),!1;this.handleCancelOrder(),this.$message.success($t("rgqdg37","取消订单成功!","lang")),this.getOrders(this.params)})},writeoffOrderAction(e){(0,l.getWriteoff)(e).then(e=>{if(this.writeoffOrderData=e.data.data,"DONE"==this.writeoffOrderData.ziti_status)return this.$message.error($t("pqt5tr7","该订单已核销!","lang")),!1;this.writeoffOrderVisible=!0}),this.writeoffOrderForm.order_id=e},handleWriteoffOrder(){this.writeoffOrderVisible=!1,this.writeoffOrderForm.order_id="",this.writeoffOrderForm.pickupcode="",this.writeoffOrderInput=!1},submitWriteoffOrderConfirmAction(){if(1==this.writeoffOrderData.pickupcode_status&&""==this.writeoffOrderForm.pickupcode)return this.$message.error($t("kcmqm87","请输入提货码!","lang")),!1;(0,l.doWriteoff)(this.writeoffOrderForm.order_id,this.writeoffOrderForm).then(e=>{var t=e.data.data.ziti_status,a=e.data.data.order_id;if("DONE"!=t)return this.$message.success($t("cy9a6k9","自提订单核销失败!","lang")),!1;this.handleWriteoffOrder(),this.writeoffOrderSuccVisible=!0,this.writeoffOrderSucc.msg=$t("o7hv2","订单","lang")+a+$t("drin2v4","核销成功","lang")})},handleWriteoffOrderSucc(){this.writeoffOrderSuccVisible=!1,this.writeoffOrderSucc.msg="",this.getOrders(this.params)},exportData(e){this.getParams(),e&&(this.params.type=e),this.params.page=1,"normal"==this.params.order_type?(0,l.orderExport)(this.params).then(t=>{if(t.data.data.status)return this.$message({type:"success",message:$t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")}),void this.$export_open(e);t.data.data.url?(this.downloadUrl=t.data.data.url,this.downloadName=t.data.data.filename,this.downloadView=!0):this.$message({type:"error",message:$t("d17rj2j","无内容可导出 或 执行失败，请检查重试","lang")})}):this.$message({type:"error",message:$t("2miv3db","暂不支持该类型订单导出","lang")})},exportInvoice(){this.getParams(),this.params.type="normal",(0,l.exportInvoice)(this.params).then(e=>{if(e.data.data.status)return this.$message({type:"success",message:$t("xdh90kk","已加入执行队列，请在设置-导出列表中下载","lang")}),void this.$export_open("normal_order");e.data.data.url?(this.downloadUrl=e.data.data.url,this.downloadName=e.data.data.filename,this.downloadView=!0):this.$message({type:"error",message:$t("d17rj2j","无内容可导出 或 执行失败，请检查重试","lang")})})},IsInvoiced(e,t){e.invoice?this.$confirm($t("ektlr8c","确定更新该订单开票状态？","lang"),$t("hn562","提示","lang"),{cancelButtonText:$t("ev022","取消","lang"),confirmButtonText:$t("kzjg2","确定","lang"),type:"warning",beforeClose:(a,r,s)=>{if("confirm"===a){var i={order_id:e.order_id,status:t};(0,l.isInvoiced)(i).then(e=>{e.data.data.success?(this.$message({type:"success",message:$t("75zb4x7","已更新开票状态","lang")}),this.getOrders(this.params)):this.$message({type:"error",message:$t("4q13i58","更新开票状态失败","lang")})})}s()}}):this.$message({type:"info",message:$t("a3f4pa8","此订单无发票信息","lang")})},uploadHandleChange(e,t){let a={isUploadFile:!0,file_type:"normal_orders",file:e.raw};(0,o.handleUploadFile)(a).then(e=>{this.$message({type:"success",message:$t("dn5eu39","上传成功，等待处理","lang")})})}}},p=(0,a(81656).A)(d,function(){var e=this,t=e._self._c;return t("SpPage",[t("div",{},[-1===e.$route.path.indexOf("detail")?t("div",[t("el-row",{staticClass:"filter-header",attrs:{gutter:20}},[t("el-date-picker",{attrs:{type:"daterange","start-placeholder":$t("cd0ag54","开始日期","lang"),"ange-separator":$t("po31","至","lang"),"end-placeholder":$t("gfhy2u4","结束日期","lang"),"value-format":"yyyy/MM/dd",placeholder:$t("to1gvf6","选择日期范围","lang")},on:{change:e.dateChange},model:{value:e.create_time,callback:function(t){e.create_time=t},expression:"create_time"}}),t("el-col",{attrs:{span:8}},[t("el-input",{staticClass:"input-m",attrs:{placeholder:$t("tbbl997","手机号/订单号","lang")},model:{value:e.identifier,callback:function(t){e.identifier=t},expression:"identifier"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.numberSearch},slot:"append"})],1)],1),t("el-select",{attrs:{placeholder:$t("chp4kz4","开票状态","lang"),clearable:""},on:{change:e.invoiceStatusChange},model:{value:e.invoice_status,callback:function(t){e.invoice_status=t},expression:"invoice_status"}},e._l(e.open_status_arr,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),t("el-row",[t("el-col",[t("el-button-group",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.exportData("normal_master_order")}}},[e._v($t("gtsr2o7"," 导出主订单 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.exportData("normal_order")}}},[e._v($t("ih76577"," 导出子订单 ","lang"))])],1),t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:$t("lntxa712","导出任务会以队列执行，点击导出后，请至‘设置-导出列表’页面中查看及下载数据","lang")}},[t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1)],1),t("el-dialog",{attrs:{title:$t("hym6114","订单下载","lang"),visible:e.downloadView,"close-on-click-modal":!1},on:{"update:visible":function(t){e.downloadView=t}}},[e.downloadUrl?[t("a",{attrs:{href:e.downloadUrl,download:""}},[e._v(e._s(e.downloadName))])]:e._e()],2),t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:$t("en402","全部","lang"),name:"all"}}),t("el-tab-pane",{attrs:{label:$t("eepbv3","待发货","lang"),name:"notship"}}),t("el-tab-pane",{attrs:{label:$t("eor5v3","待退款","lang"),name:"cancelapply"}}),t("el-tab-pane",{attrs:{label:$t("ehnue3","待收货","lang"),name:"shipping"}}),t("el-tab-pane",{attrs:{label:$t("flmib3","未支付","lang"),name:"notpay"}}),t("el-tab-pane",{attrs:{label:$t("ifjian7","已取消/已关闭","lang"),name:"cancel"}}),t("el-tab-pane",{attrs:{label:$t("e7hbq3","已完成","lang"),name:"finish"}}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.list,"element-loading-text":$t("go5gpa5","数据加载中","lang")}},[t("el-table-column",{attrs:{width:"280",prop:"order_id",label:$t("hym7z54","订单信息","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"order-num"},[e._v(" "+e._s(a.row.order_id)+" "),t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.order_id,expression:"scope.row.order_id",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"el-icon-document-copy"})])],1),a.row.distributor_name?t("div",{staticClass:"order-store"},[t("el-tooltip",{attrs:{effect:"dark",content:$t("ekkkq3","店铺名","lang"),placement:"top-start"}},[t("i",{staticClass:"el-icon-office-building"})]),e._v(" "+e._s(a.row.distributor_name)+" ")],1):e._e(),t("div",{staticClass:"order-time"},[t("el-tooltip",{attrs:{effect:"dark",content:$t("a72nl44","下单时间","lang"),placement:"top-start"}},[t("i",{staticClass:"el-icon-time"})]),e._v(" "+e._s(e._f("datetime")(a.row.create_time,"YYYY-MM-DD HH:mm:ss"))+" ")],1)]}}],null,!1,3443093217)}),t("el-table-column",{attrs:{width:"80",label:$t("p8ix2","运费","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["cash"==a.row.freight_type?t("span",[t("span",{staticClass:"cur"},[e._v(e._s(a.row.fee_symbol))]),e._v(e._s(a.row.freight_fee/100))]):t("span",[e._v(e._s(a.row.freight_fee)+$t("l6uv2","积分","lang"))])]}}],null,!1,375190642)}),t("el-table-column",{attrs:{prop:"point",width:"200",label:$t("b3zwdc4","商品价格","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(a.row.item_point)+$t("i8wll3","积分 ","lang")),a.row.item_fee>0?t("span",[e._v("+"),t("span",{staticClass:"cur"},[e._v(e._s(a.row.fee_symbol))]),e._v(e._s(a.row.item_fee/100))]):e._e()]}}],null,!1,215279343)}),t("el-table-column",{attrs:{prop:"mobile",width:"160",label:$t("gph41i4","联系手机","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("i",{staticClass:"el-icon-mobile"}),e._v(" "+e._s(a.row.mobile)+" "),0==e.datapass_block?t("el-tooltip",{attrs:{effect:"dark",content:$t("fljd2","复制","lang"),placement:"top-start"}},[t("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:a.row.mobile,expression:"scope.row.mobile",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"el-icon-document-copy"})]):e._e()]}}],null,!1,3171601862)}),"all"==e.activeName?t("el-table-column",{attrs:{width:"120",prop:"order_status",label:$t("k1e32","状态","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["PAYED"==a.row.order_status?t("span",[e._v($t("e90jf3","已支付","lang"))]):e._e(),"NOTPAY"==a.row.order_status?t("span",[e._v($t("flmib3","未支付","lang"))]):e._e(),"CANCEL"==a.row.order_status_des?t("span",[e._v($t("e68dg3","已取消","lang"))]):e._e(),"CLOSED"==a.row.order_status_des?t("span",[e._v(e._s(a.row.order_status_msg))]):e._e(),"WAIT_BUYER_CONFIRM"==a.row.order_status?t("span",[e._v($t("ehnue3","待收货","lang"))]):e._e(),"REFUND_SUCCESS"==a.row.order_status?t("span",[e._v($t("eggc03","已退款","lang"))]):e._e(),"WAIT_GROUPS_SUCCESS"==a.row.order_status?t("span",[e._v($t("fy9aum4","等待成团","lang"))]):e._e(),"PART_PAYMENT"==a.row.order_status?t("span",[e._v($t("imd7no4","部分付款","lang"))]):e._e(),"DONE"==a.row.order_status?t("span",[e._v($t("e7hbq3","已完成","lang"))]):e._e(),"CANCEL"!=a.row.order_status&&"REFUND_SUCCESS"!=a.row.order_status&&"WAIT_GROUPS_SUCCESS"!=a.row.order_status?["WAIT_PROCESS"==a.row.cancel_status?t("span",[e._v($t("d4uvqn5","取消待退款","lang"))]):e._e(),"PARTAIL"==a.row.delivery_status?t("span",[e._v($t("ime8t04","部分发货","lang"))]):e._e(),"ziti"==a.row.receipt_type&&"PENDING"==a.row.ziti_status?t("span",[e._v($t("embfv3","待自提","lang"))]):e._e(),"logistics"==a.row.receipt_type&&"PENDING"==a.row.delivery_status&&"PART_PAYMENT"!==a.row.order_status?t("span",[e._v($t("eepbv3","待发货","lang"))]):e._e()]:e._e()]}}],null,!1,3414220673)}):e._e(),t("el-table-column",{attrs:{prop:"invoice_status",label:$t("chp4kz4","开票状态","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return["success"===a.row.invoice_status?t("span",{staticStyle:{color:"green"}},[e._v(" "+e._s(e.open_status_map[a.row.invoice_status])+" ")]):"failed"===a.row.invoice_status?t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.open_status_map[a.row.invoice_status])+" ")]):t("span",[e._v(" "+e._s(e.open_status_map[a.row.invoice_status])+" ")])]}}],null,!1,3590597070)}),t("el-table-column",{attrs:{width:"200",label:$t("hkxb2","操作","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"}},[t("router-link",{attrs:{to:{path:e.matchRoutePath("detail"),query:{orderId:a.row.order_id,resource:e.$route.path}}}},[e._v($t("likox4"," 详情 ","lang"))])],1),!e.VERSION_STANDARD()&&!e.is_distributor&&0!=a.row.distributor_id||"NO_APPLY_CANCEL"!=a.row.cancel_status||"NOTPAY"!=a.row.order_status&&"PAYED"!=a.row.order_status?e._e():t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.cancelOrderAction(a.row.order_id)}}},[e._v($t("26qq4b6"," 取消订单 ","lang"))]),(e.VERSION_STANDARD()||e.is_distributor||0==a.row.distributor_id)&&"PAYED"==a.row.order_status&&"ziti"==a.row.receipt_type&&"PENDING"==a.row.ziti_status?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.writeoffOrderAction(a.row.order_id)}}},[e._v($t("gjbjs4"," 核销 ","lang"))]):e._e(),e.IsBind||!e.VERSION_STANDARD()&&!e.is_distributor&&0!=a.row.distributor_id?e._e():["logistics"!=a.row.receipt_type||"PAYED"!=a.row.order_status||"DONE"==a.row.delivery_status||e.jstErpSetting?.is_open?e._e():t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deliveryAction(a.row)}}},[e._v($t("diekq4"," 发货 ","lang"))]),"WAIT_PROCESS"==a.row.cancel_status&&"PAYED"==a.row.order_status?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.confirmCancelOrderAction(a.row.order_id)}}},[e._v($t("m5zeq4"," 退款 ","lang"))]):e._e()],"1"==a.row.is_invoiced&&a.row.invoice?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.IsInvoiced(a.row,0)}}},[e._v($t("cxsu9f5"," 待开票 ","lang"))]):e._e()]}}],null,!1,1620836236)})],1),t("div",{staticClass:"mt-4 text-right"},[t("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":e.params.page,"page-sizes":[10,20,50],total:e.total_count,"page-size":e.params.pageSize},on:{"update:currentPage":function(t){return e.$set(e.params,"page",t)},"update:current-page":function(t){return e.$set(e.params,"page",t)},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),t("el-dialog",{attrs:{title:e.deliveryTitle,visible:e.deliveryVisible,"before-close":e.handleCancel,width:"65%"},on:{"update:visible":function(t){e.deliveryVisible=t}}},[[t("el-form",{ref:"deliveryForm",staticClass:"demo-ruleForm",attrs:{model:e.deliveryForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:$t("kuwys3","订单号","lang")}},[t("el-col",{attrs:{span:20}},[e._v(" "+e._s(e.deliveryData.orderInfo.order_id)+" ")])],1),t("el-form-item",{attrs:{label:$t("b5urmu4","发货类型","lang")}},[t("el-radio-group",{attrs:{disabled:e.IsDisabled},model:{value:e.deliveryForm.delivery_type,callback:function(t){e.$set(e.deliveryForm,"delivery_type",t)},expression:"deliveryForm.delivery_type"}},[t("el-radio",{attrs:{label:"batch"}},[e._v($t("3hga7r6"," 整单发货 ","lang"))]),t("el-radio",{attrs:{label:"sep"}},[e._v($t("e4l1va6"," 拆分发货 ","lang"))])],1)],1),t("el-form-item",{attrs:{label:$t("b400fd4","商品信息","lang")}},[t("el-col",{attrs:{span:30}},[t("el-table",{attrs:{data:e.deliveryData.orderInfo.items}},[t("el-table-column",{attrs:{prop:"item_name",label:$t("cwisy3","商品名","lang"),width:"180"}}),t("el-table-column",{attrs:{prop:"num",label:$t("i1y72","数量","lang"),width:"180"}}),t("el-table-column",{attrs:{label:$t("gsv02","总价","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.item_point)+$t("l6uv2","积分","lang"))]),a.row.item_fee>0?t("span",[e._v("+"+e._s(a.row.fee_symbol)+e._s(a.row.item_fee/100))]):e._e()]}}],null,!1,2252298054)}),"sep"==e.deliveryForm.delivery_type?[t("el-table-column",{attrs:{label:$t("cp0yj74","快递公司","lang"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{filterable:"",placeholder:$t("30xktvb","请选择快递公司，可搜索","lang")},model:{value:a.row.delivery_corp,callback:function(t){e.$set(a.row,"delivery_corp",t)},expression:"scope.row.delivery_corp"}},e._l(e.dlycorps,function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)]}}],null,!1,1397891712)}),t("el-table-column",{attrs:{label:$t("evwh164","物流单号","lang"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{maxlength:20,placeholder:$t("s5y24m6","物流公司单号","lang")},model:{value:a.row.delivery_code,callback:function(t){e.$set(a.row,"delivery_code",t)},expression:"scope.row.delivery_code"}})]}}],null,!1,2798900684)})]:e._e()],2)],1)],1),"batch"==e.deliveryForm.delivery_type?[t("el-form-item",{attrs:{label:$t("cp0yj74","快递公司","lang")}},[t("el-col",[t("el-select",{attrs:{filterable:"",placeholder:$t("30xktvb","请选择快递公司，可搜索","lang")},model:{value:e.deliveryForm.delivery_corp,callback:function(t){e.$set(e.deliveryForm,"delivery_corp",t)},expression:"deliveryForm.delivery_corp"}},e._l(e.dlycorps,function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)],1),t("el-form-item",{attrs:{label:$t("evwh164","物流单号","lang")}},[t("el-col",{attrs:{span:14}},[t("el-input",{attrs:{maxlength:20,placeholder:$t("s5y24m6","物流公司单号","lang")},model:{value:e.deliveryForm.delivery_code,callback:function(t){e.$set(e.deliveryForm,"delivery_code",t)},expression:"deliveryForm.delivery_code"}})],1)],1)]:e._e()],2)],t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.handleCancel.apply(null,arguments)}}},[e._v($t("dd4ni4"," 取消 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitDeliveryAction}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)],2),t("el-dialog",{attrs:{title:e.deliveryTitle,visible:e.deliveryVisibleNew,"before-close":e.handleCancel,width:"65%"},on:{"update:visible":function(t){e.deliveryVisibleNew=t}}},[[t("el-form",{ref:"deliveryForm",staticClass:"demo-ruleForm",attrs:{model:e.deliveryForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:$t("kuwys3","订单号","lang")}},[t("el-col",{attrs:{span:20}},[e._v(" "+e._s(e.deliveryData.orderInfo.order_id)+" ")])],1),t("el-form-item",{attrs:{label:$t("b5urmu4","发货类型","lang")}},[t("el-radio-group",{attrs:{disabled:e.IsDisabled},model:{value:e.deliveryForm.delivery_type,callback:function(t){e.$set(e.deliveryForm,"delivery_type",t)},expression:"deliveryForm.delivery_type"}},[t("el-radio",{attrs:{label:"batch"}},[e._v($t("3hga7r6"," 整单发货 ","lang"))]),t("el-radio",{attrs:{label:"sep"}},[e._v($t("e4l1va6"," 拆分发货 ","lang"))])],1)],1),t("el-form-item",{attrs:{label:$t("b400fd4","商品信息","lang")}},[t("el-table",{attrs:{data:e.deliveryData.orderInfo.items}},[t("el-table-column",{attrs:{prop:"item_name",label:$t("cwisy3","商品名","lang"),width:"180"}}),t("el-table-column",{attrs:{prop:"num",label:$t("i1y72","数量","lang"),width:"180"}}),t("el-table-column",{attrs:{prop:"delivery_item_num",label:$t("nbuukn5","已发货数量","lang"),width:"180"}}),t("el-table-column",{attrs:{label:$t("ck5fn74","总支付价","lang")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.item_point)+$t("l6uv2","积分","lang"))]),a.row.item_fee>0?t("span",[e._v("+"+e._s(a.row.fee_symbol)+e._s(a.row.item_fee/100))]):e._e()]}}],null,!1,2252298054)}),"sep"==e.deliveryForm.delivery_type?[t("el-table-column",{attrs:{label:$t("b5r61h4","发货数量","lang"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.num-a.row.delivery_item_num!=0?t("el-input-number",{attrs:{placeholder:$t("b5r61h4","发货数量","lang"),"controls-position":"right",min:0,max:a.row.num-a.row.delivery_item_num},model:{value:a.row.delivery_num,callback:function(t){e.$set(a.row,"delivery_num",t)},expression:"scope.row.delivery_num"}}):e._e(),a.row.num-a.row.delivery_item_num==0?t("span",[e._v($t("e64p93","已发完","lang"))]):e._e()]}}],null,!1,3220528706)})]:e._e()],2)],1),t("el-form-item",{attrs:{label:$t("cp0yj74","快递公司","lang")}},[t("el-col",[t("el-select",{attrs:{filterable:"",placeholder:$t("30xktvb","请选择快递公司，可搜索","lang")},model:{value:e.deliveryForm.delivery_corp,callback:function(t){e.$set(e.deliveryForm,"delivery_corp",t)},expression:"deliveryForm.delivery_corp"}},e._l(e.dlycorps,function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)],1),t("el-form-item",{attrs:{label:$t("evwh164","物流单号","lang")}},[t("el-col",{attrs:{span:14}},[t("el-input",{attrs:{maxlength:20,placeholder:$t("s5y24m6","物流公司单号","lang")},model:{value:e.deliveryForm.delivery_code,callback:function(t){e.$set(e.deliveryForm,"delivery_code",t)},expression:"deliveryForm.delivery_code"}})],1)],1)],1)],t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.handleCancel.apply(null,arguments)}}},[e._v($t("dd4ni4"," 取消 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitDeliveryAction}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)],2),t("el-dialog",{attrs:{title:$t("6va38a8","取消订单退款审核","lang"),visible:e.cancelVisible,"before-close":e.handleCancelOrderCancel,width:"57%"},on:{"update:visible":function(t){e.cancelVisible=t}}},[[t("el-row",{attrs:{gutter:100}},[t("el-col",{attrs:{span:24}},[t("span",{staticClass:"grid-content"},[e._v($t("hymdzq4","订单号:","lang")+e._s(e.cancelData.order_id))])]),t("el-col",{attrs:{span:24}},["buyer"==e.cancelData.cancel_from?t("span",[e._v($t("9o66w5a","取消来源:消费者申请","lang"))]):t("span",[e._v($t("p3onm9b","取消来源:系统自动取消","lang"))])]),t("el-col",{attrs:{span:24}},[t("span",[e._v($t("kvr2w85","申请时间:","lang")+e._s(e._f("datetime")(e.cancelData.create_time,"YYYY-MM-DD HH:mm:ss")))])]),t("el-col",{attrs:{span:24}},[t("span",[e._v($t("8smf0x5","退款状态:","lang"))]),"WAIT_CHECK"==e.cancelData.refund_status?t("span",[e._v($t("eftvg3","待审核","lang"))]):e._e(),"FAILS"==e.cancelData.refund_status?t("span",[e._v($t("ilzzyq4","退款失败","lang"))]):e._e(),"SUCCESS"==e.cancelData.refund_status?t("span",[e._v($t("im16q54","退款成功","lang"))]):e._e(),"SHOP_CHECK_FAILS"==e.cancelData.refund_status?t("span",[e._v($t("pivtzh7","商家审核不通过","lang"))]):e._e(),"WAIT_REFUND"==e.cancelData.refund_status?t("span",[e._v($t("fyh8624","等待退款","lang"))]):e._e()]),t("el-col",{attrs:{span:24}},[t("span",[e._v($t("84jfe55","处理进度:","lang"))]),"0"==e.cancelData.progress?t("span",[e._v($t("efg7b3","待处理","lang"))]):e._e(),"1"==e.cancelData.progress?t("span",[e._v($t("e68dg3","已取消","lang"))]):e._e(),"2"==e.cancelData.progress?t("span",[e._v($t("llz8v3","退款中","lang"))]):e._e(),"3"==e.cancelData.progress?t("span",[e._v($t("e7hbq3","已完成","lang"))]):e._e()]),t("el-col",{attrs:{span:24}},[t("span",[e._v($t("8tm4h15","退款积分:","lang")+e._s(e.cancelData.point)+$t("l6uv2","积分","lang"))])]),t("el-col",{attrs:{span:24}},[t("span",[e._v($t("8xg2c05","退款金额:","lang")+e._s(e.cancelData.fee_symbol)+e._s(e.cancelData.total_fee/100))])]),t("el-col",{attrs:{span:24}},["wxpay"==e.cancelData.pay_type?t("span",[e._v($t("4j54rt9","支付方式:微信支付","lang"))]):e._e()]),t("el-col",{attrs:{span:24}},[t("span",[e._v($t("d6vxbt5","取消原因:","lang")+e._s(e.cancelData.cancel_reason))])])],1),t("el-divider"),t("el-form",{ref:"cancelForm",attrs:{model:e.cancelForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:$t("82359r5","处理结果:","lang")}},[t("el-row",[t("el-col",{attrs:{span:20}},[[t("el-radio",{attrs:{label:"0"},model:{value:e.cancelForm.check_cancel,callback:function(t){e.$set(e.cancelForm,"check_cancel",t)},expression:"cancelForm.check_cancel"}},[e._v($t("aorgmo5"," 不同意 ","lang"))]),t("el-radio",{attrs:{label:"1"},model:{value:e.cancelForm.check_cancel,callback:function(t){e.$set(e.cancelForm,"check_cancel",t)},expression:"cancelForm.check_cancel"}},[e._v($t("dc4bh4"," 同意 ","lang"))])]],2)],1)],1),"0"==e.cancelForm.check_cancel?t("el-form-item",{attrs:{label:$t("ng42cy5","拒绝原因:","lang")}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:$t("kjdze37","请输入拒绝原因","lang")},model:{value:e.cancelForm.shop_reject_reason,callback:function(t){e.$set(e.cancelForm,"shop_reject_reason",t)},expression:"cancelForm.shop_reject_reason"}})],1)],1)],1):e._e()],1)],t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.handleCancelOrderCancel.apply(null,arguments)}}},[e._v($t("dd4ni4"," 取消 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitCancelConfirmAction}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)],2),t("el-dialog",{attrs:{title:$t("b1drz94","取消订单","lang"),visible:e.cancelOrderVisible,"before-close":e.handleCancelOrder,width:"57%"},on:{"update:visible":function(t){e.cancelOrderVisible=t}}},[[t("el-form",{ref:"cancelForm",attrs:{model:e.cancelOrderForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:$t("hymdzq4","订单号:","lang")}},[t("el-col",{attrs:{span:20}},[e._v(" "+e._s(e.cancelOrderData.orderInfo.order_id)+" ")])],1),t("el-form-item",{attrs:{label:$t("d6vxbt5","取消原因:","lang")}},[t("el-row",[t("el-col",{attrs:{span:20}},[[t("el-select",{attrs:{filterable:"",placeholder:$t("amt70d9","请选择取消订单原因","lang")},on:{change:e.cancelReasonSelect},model:{value:e.cancel_order,callback:function(t){e.cancel_order=t},expression:"cancel_order"}},e._l(e.order_cancel_reason,function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1),t("el-input",{directives:[{name:"show",rawName:"v-show",value:e.cancelOrderInput,expression:"cancelOrderInput"}],staticStyle:{width:"200px","margin-top":"10px"},attrs:{type:"textarea",rows:3,resize:"none",placeholder:$t("bf9qgl9","请填写取消订单原因","lang")},model:{value:e.cancelOrderForm.other_reason,callback:function(t){e.$set(e.cancelOrderForm,"other_reason",t)},expression:"cancelOrderForm.other_reason"}})]],2)],1)],1)],1)],t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.handleCancelOrder.apply(null,arguments)}}},[e._v($t("dd4ni4"," 取消 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitCancelOrderConfirmAction}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)],2),t("el-dialog",{attrs:{title:$t("v07py96","自提订单核销","lang"),visible:e.writeoffOrderVisible,"before-close":e.handleWriteoffOrder,width:"57%"},on:{"update:visible":function(t){e.writeoffOrderVisible=t}}},[[t("el-form",{ref:"cancelForm",attrs:{model:e.writeoffOrderForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:$t("hymdzq4","订单号:","lang")}},[t("el-col",{attrs:{span:20}},[e._v(" "+e._s(e.writeoffOrderData.order_id)+" ")])],1),t("el-form-item",{attrs:{label:$t("cw28v3","商品:","lang")}},e._l(e.writeoffOrderData.items,function(a){return t("el-col",{key:a.item_id},[e._v(" "+e._s(a.item_name)+" "+e._s(a.item_spec_desc)+" × "+e._s(a.num)+" ")])}),1),e.writeoffOrderData.pickupcode_status?t("el-form-item",{attrs:{label:$t("d6ga9c4","提货码:","lang")}},[t("el-input",{staticStyle:{width:"180px"},attrs:{maxlength:6,type:"text",placeholder:$t("7j3g5b6","请输入提货码","lang")},model:{value:e.writeoffOrderForm.pickupcode,callback:function(t){e.$set(e.writeoffOrderForm,"pickupcode",t)},expression:"writeoffOrderForm.pickupcode"}})],1):e._e()],1)],t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.handleWriteoffOrder.apply(null,arguments)}}},[e._v($t("dd4ni4"," 取消 ","lang"))]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitWriteoffOrderConfirmAction}},[e._v($t("in1ck4"," 确定 ","lang"))])],1)],2),t("el-dialog",{attrs:{title:$t("gt0wha4","自提核销","lang"),visible:e.writeoffOrderSuccVisible,"before-close":e.handleWriteoffOrderSucc,width:"57%"},on:{"update:visible":function(t){e.writeoffOrderSuccVisible=t}}},[[t("span",[e._v(e._s(e.writeoffOrderSucc.msg))])],t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(t){return e.handleWriteoffOrderSucc.apply(null,arguments)}}},[e._v($t("g7i0w85"," 知道了 ","lang"))])],1)],2)],1):e._e(),t("router-view")],1)])},[],!1,null,null,null),m=p.exports}}]);