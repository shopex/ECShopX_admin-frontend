"use strict";(self.webpackChunkecshopx_admin=self.webpackChunkecshopx_admin||[]).push([[8050],{78050:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});a(57270);var s=a(21255),l=(a(44114),a(18111),a(7588),{props:{tmpData:Array,handleType:String,loading:Boolean},data(){return{}},computed:{resetText(){return t=>{var e=$t("g5o72","审核","lang");return"1"==t.status?e=$t("hi6j2","拒绝","lang"):"2"==t.status&&(e=$t("past2","通过","lang")),e}}},mounted(){},methods:{whereDisable(t){return!0},viewDetails(t){this.$refs.notestable.clearSelection(),this.$refs.notestable.toggleRowSelection(t),this.$emit("viewDetails",t.comment_id)},auditNote(t){var e={id_set:[t.comment_id],auditdiff:!1,aloneAuditType:"1"==t.status?"refuse":"pass"};this.$refs.notestable.clearSelection(),this.$refs.notestable.toggleRowSelection(t),this.$emit("selectNotes",e)},checkChange(t){var e=[],a=!1,s=null;t.forEach(t=>{e.push(t.comment_id),null==s?s=t.status:s!=t.status&&(a=!0)});var l={id_set:e,auditdiff:a};this.$emit("selectNotes",l)}}}),i=a(81656),n=(0,i.A)(l,function(){var t=this,e=t._self._c;return e("div",[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"notestable",attrs:{data:t.tmpData},on:{"selection-change":t.checkChange}},[e("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.whereDisable}}),e("el-table-column",{attrs:{prop:"comment_id",label:"id",width:"100"}}),e("el-table-column",{attrs:{prop:"content",label:$t("i7hjuy4","评论内容","lang")}}),e("el-table-column",{attrs:{prop:"status_text",label:$t("i7n7y94","评论状态","lang")}}),e("el-table-column",{attrs:{label:$t("chizf3","创建人","lang")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.userInfo?e("div",[t._v(" "+t._s(a.row.userInfo.nickanme)),e("br"),t._v(t._s(a.row.userInfo.mobile)+" ")]):e("div",[t._v($t("io38z3","管理员","lang"))])]}}])}),e("el-table-column",{attrs:{prop:"created_text",label:$t("i7lcj84","评论时间","lang")}}),t.handleType?e("el-table-column",{attrs:{label:$t("hkxb2","操作","lang"),width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"operating-icons"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.viewDetails(a.row,a.$index)}}},[t._v($t("likox4"," 详情 ","lang"))]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.auditNote(a.row)}}},[t._v(" "+t._s(t.resetText(a.row))+" ")])],1)]}}],null,!1,35798018)}):t._e()],1)],1)},[],!1,null,"ac5e1ea8",null).exports,o=a(37505),r={components:{},props:{comment_id:String,dialogIsShow:Boolean},data(){return{dialogTitle:$t("i7ric54","评论详情","lang"),commentInfo:{}}},computed:{},watch:{comment_id:{handler(t,e){this.fetch()},immediate:!0}},mounted(){},methods:{fetch(){const t=this,{comment_id:e}=this.$props;(0,s.getCommentDetail)({comment_id:e}).then(e=>{var a=e.data.data.comment_info;t.$data.commentInfo=a},e=>{t.$data.post_info={},t.$data.errInfo=e})},handleCancelLabelsDialog(){this.$emit("cancelLabelsDialog",!1)},handleAudit(){const{commentInfo:t}=this.$data;var e={id_set:[t.comment_id],auditdiff:!1,aloneAuditType:"pass"};this.handleCancelLabelsDialog(),this.$emit("notesAuditHandle",e)},toUserInfo(t){this.$router.push({path:"/member/member",query:{mobile:t.mobile}})}}},c=(0,i.A)(r,function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:t.dialogTitle,"before-close":t.handleCancelLabelsDialog,visible:t.dialogIsShow,width:"40%"},on:{"update:visible":function(e){t.dialogIsShow=e}}},[e("div",{staticClass:"notesinfo"},[e("el-row",[e("el-col",{staticClass:"name",attrs:{span:4}},[t._v($t("bcnkhi6"," 评论内容 ","lang"))]),e("el-col",{staticClass:"value",attrs:{span:20}},[e("pre",{staticClass:"info-content",domProps:{innerHTML:t._s(t.commentInfo.content)}})])],1),t.commentInfo.userInfo?e("el-row",{staticClass:"bor-top"},[e("el-col",{staticClass:"name",attrs:{span:4}},[t._v($t("b60xgq6"," 用户昵称 ","lang"))]),e("el-col",{staticClass:"value",attrs:{span:20}},[e("div",{staticClass:"user-name",on:{click:function(e){return t.toUserInfo(t.commentInfo.userInfo)}}},[t._v(" "+t._s(t.commentInfo.userInfo.nickanme)+" ")])])],1):t._e(),t.commentInfo.userInfo?e("el-row",[e("el-col",{staticClass:"name",attrs:{span:4}},[t._v($t("dbf7aw5"," 手机号 ","lang"))]),e("el-col",{staticClass:"value",attrs:{span:20}},[t._v(" "+t._s(t.commentInfo.userInfo.mobile)+" ")])],1):t._e(),e("el-row",[e("el-col",{staticClass:"name",attrs:{span:4}},[t._v($t("bfx9e46"," 评论时间 ","lang"))]),e("el-col",{staticClass:"value",attrs:{span:20}},[t._v(" "+t._s(t.commentInfo.created_text)+" ")])],1),e("el-row",{staticClass:"bor-top"},[e("el-col",{staticClass:"name",attrs:{span:4}},[t._v($t("rgitl16"," 当前状态 ","lang"))]),e("el-col",{staticClass:"value",attrs:{span:20}},[t._v(" "+t._s(t.commentInfo.status_text)+" ")])],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"0"==t.commentInfo.status?"primary":"danger"},on:{click:t.handleAudit}},[t._v(" "+t._s("0"==t.commentInfo.status?$t("g5o72","审核","lang"):$t("pawk2","重审","lang"))+" ")]),e("el-button",{on:{click:t.handleCancelLabelsDialog}},[t._v($t("dd4ni4"," 取消 ","lang"))])],1)])],1)},[],!1,null,"6114613e",null).exports,d={provide(){return{refresh:this.getDataList}},components:{reviewlist:n,auditNote:o.A,viewReview:c},data(){return{activeName:"first",loading:!1,total_count:0,params:{page:1,pageSize:10,status:null},pagers:{total:0},reviewList:[],id_set:[],searchkey:"",searchtype:"nickname",searPlace:$t("2j83985","请输入昵称","lang"),auditdiff:!1,auditDialogShow:!1,dufStatus:null,comment_id:null,reviewDialogShow:!1}},mounted(){this.getDataList()},methods:{handleCurrentChange(t){this.params.page=t,this.getDataList()},handleSizeChange(t){this.params.page=1,this.params.pageSize=t,this.getDataList()},researchMsg(t){var e=$t("2j83985","请输入昵称","lang");return"content"==t?e=$t("7lr2i56","请输入关键字","lang"):"mobile"==t&&(e=$t("7ji3y96","请输入手机号","lang")),this.params.nickname=null,this.params.content=null,this.params.mobile=null,e},searchData(t){const{searchkey:e,searchtype:a}=this.$data;if("searchkey"==t&&""==e){var s=this.researchMsg(a);return this.$message({type:"error",message:s,duration:1500}),!1}this.$data.pagers={total:0},this.params.page=1,this.clearAudioData(),this.getDataList()},changeName(){const{searchtype:t}=this.$data;var e=this.researchMsg(t);this.$data.searPlace=e},clearAudioData(){this.$data.id_set=[],this.$data.aloneForm={},this.$data.auditdiff=!1},getDataList(){const t=this;var{activeName:e,params:a,searchtype:l,searchkey:i}=this.$data;a[l]=""!=i?i:null,t.loading=!0,(0,s.getComment)(a).then(e=>{var{list:a,total_count:s}=e.data.data;t.$data.reviewList=a,t.$data.pagers={total:s},t.loading=!1},e=>{t.$data.loading=!1})},handleClick(t,e){var{activeName:a,params:s}=this.$data;"first"===this.activeName?s.status=null:"second"===this.activeName?s.status="0":"third"===this.activeName?s.status="1":"fourth"===this.activeName&&(s.status="4"),this.searchData()},viewDetails(t){this.$data.comment_id=t,this.cancelReviewDialog(!0)},cancelReviewDialog(t){this.$data.reviewDialogShow=t},cancelAuditDialog(t){this.$data.auditDialogShow=t},selectNotes(t){this.$data.id_set=t.id_set,this.$data.auditdiff=t.auditdiff,t.aloneAuditType?(this.$data.dufStatus=t.aloneAuditType,this.auditHandle()):this.$data.dufStatus="pass"},auditHandle(){const{id_set:t,dufStatus:e}=this.$data;t.length?this.cancelAuditDialog(!0):this.$message({type:"error",message:$t("2edwcz5","请选择评论","lang")})},auditNote(t){const{id_set:e,aloneForm:a}=this.$data;$t("aytobl4","发布成功","lang");"refuse"==t.notesModalType&&$t("aa12vu4","下架成功","lang"),a&&(t={...t,...a}),t.comment_id=e,(0,s.commentVerify)(t).then(t=>{var e=t.data.data.message;this.cancelAuditDialog(!1),this.clearAudioData(),this.getDataList(),this.$message({type:"success",message:e})})}}},u=(0,i.A)(d,function(){var t=this,e=t._self._c;return e("SpPage",[e("el-row",{staticClass:"action-container",attrs:{gutter:20}},[e("el-col",{attrs:{span:18}},[e("el-button",{attrs:{type:"primary"},on:{click:t.auditHandle}},[t._v($t("78btvx6"," 批量审核 ","lang"))])],1),e("el-col",{attrs:{span:6}},[e("el-input",{attrs:{placeholder:t.searPlace},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchData("searchkey")}},model:{value:t.searchkey,callback:function(e){t.searchkey=e},expression:"searchkey"}},[e("el-select",{staticClass:"barSelect",attrs:{slot:"prepend",placeholder:$t("l72nr3","请选择","lang")},on:{change:t.changeName},slot:"prepend",model:{value:t.searchtype,callback:function(e){t.searchtype=e},expression:"searchtype"}},[e("el-option",{attrs:{label:$t("f6ukdm4","用户昵称","lang"),value:"nickname"}}),e("el-option",{attrs:{label:$t("qc473b5","用户手机号","lang"),value:"mobile"}}),e("el-option",{attrs:{label:$t("5naff5","标题关键字","lang"),value:"content"}})],1),e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return t.searchData("searchkey")}},slot:"append"})],1)],1)],1),e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:$t("avez634","全部状态","lang"),name:"first"}},[e("reviewlist",{ref:"notestable",attrs:{"tmp-data":t.reviewList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes,viewDetails:t.viewDetails}})],1),e("el-tab-pane",{attrs:{label:$t("eftvg3","待审核","lang"),name:"second"}},[e("reviewlist",{ref:"notestable",attrs:{"tmp-data":t.reviewList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes,viewDetails:t.viewDetails}})],1),e("el-tab-pane",{attrs:{label:$t("ego673","已通过","lang"),name:"third"}},[e("reviewlist",{ref:"notestable",attrs:{"tmp-data":t.reviewList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes,viewDetails:t.viewDetails}})],1),e("el-tab-pane",{attrs:{label:$t("e8vjx3","已拒绝","lang"),name:"fourth"}},[e("reviewlist",{ref:"notestable",attrs:{"tmp-data":t.reviewList,loading:t.loading,"handle-type":"view"},on:{selectNotes:t.selectNotes,viewDetails:t.viewDetails}})],1)],1),e("div",{staticClass:"mt-4 text-right"},[e("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper",total:t.pagers.total,"page-size":t.params.pageSize},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("auditNote",{attrs:{"audit-type":"review","dialog-is-show":t.auditDialogShow,auditdiff:t.auditdiff,"duf-status":t.dufStatus},on:{notesAuditHandle:t.auditNote,cancelLabelsDialog:t.cancelAuditDialog}}),t.comment_id?e("viewReview",{attrs:{"dialog-is-show":t.reviewDialogShow,comment_id:t.comment_id},on:{notesAuditHandle:t.selectNotes,cancelLabelsDialog:t.cancelReviewDialog}}):t._e()],1)},[],!1,null,"59d240b0",null).exports}}]);